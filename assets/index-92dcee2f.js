var H_=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var EU=H_((RU,U_)=>{function G_(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const o in r)if(o!=="default"&&!(o in e)){const i=Object.getOwnPropertyDescriptor(r,o);i&&Object.defineProperty(e,o,i.get?i:{enumerable:!0,get:()=>r[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();var K_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Nb(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Ko(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var o=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,o.get?o:{enumerable:!0,get:function(){return e[r]}})}),n}var Pb={exports:{}},ad={},Db={exports:{}},Ce={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bu=Symbol.for("react.element"),q_=Symbol.for("react.portal"),X_=Symbol.for("react.fragment"),Y_=Symbol.for("react.strict_mode"),Q_=Symbol.for("react.profiler"),J_=Symbol.for("react.provider"),Z_=Symbol.for("react.context"),eR=Symbol.for("react.forward_ref"),tR=Symbol.for("react.suspense"),nR=Symbol.for("react.memo"),rR=Symbol.for("react.lazy"),D0=Symbol.iterator;function oR(e){return e===null||typeof e!="object"?null:(e=D0&&e[D0]||e["@@iterator"],typeof e=="function"?e:null)}var Mb={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Fb=Object.assign,Ob={};function Ha(e,t,n){this.props=e,this.context=t,this.refs=Ob,this.updater=n||Mb}Ha.prototype.isReactComponent={};Ha.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ha.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Bb(){}Bb.prototype=Ha.prototype;function zm(e,t,n){this.props=e,this.context=t,this.refs=Ob,this.updater=n||Mb}var Vm=zm.prototype=new Bb;Vm.constructor=zm;Fb(Vm,Ha.prototype);Vm.isPureReactComponent=!0;var M0=Array.isArray,Lb=Object.prototype.hasOwnProperty,$m={current:null},jb={key:!0,ref:!0,__self:!0,__source:!0};function zb(e,t,n){var r,o={},i=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(i=""+t.key),t)Lb.call(t,r)&&!jb.hasOwnProperty(r)&&(o[r]=t[r]);var s=arguments.length-2;if(s===1)o.children=n;else if(1<s){for(var u=Array(s),l=0;l<s;l++)u[l]=arguments[l+2];o.children=u}if(e&&e.defaultProps)for(r in s=e.defaultProps,s)o[r]===void 0&&(o[r]=s[r]);return{$$typeof:bu,type:e,key:i,ref:a,props:o,_owner:$m.current}}function iR(e,t){return{$$typeof:bu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Wm(e){return typeof e=="object"&&e!==null&&e.$$typeof===bu}function aR(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var F0=/\/+/g;function Nf(e,t){return typeof e=="object"&&e!==null&&e.key!=null?aR(""+e.key):t.toString(36)}function Dl(e,t,n,r,o){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case bu:case q_:a=!0}}if(a)return a=e,o=o(a),e=r===""?"."+Nf(a,0):r,M0(o)?(n="",e!=null&&(n=e.replace(F0,"$&/")+"/"),Dl(o,t,n,"",function(l){return l})):o!=null&&(Wm(o)&&(o=iR(o,n+(!o.key||a&&a.key===o.key?"":(""+o.key).replace(F0,"$&/")+"/")+e)),t.push(o)),1;if(a=0,r=r===""?".":r+":",M0(e))for(var s=0;s<e.length;s++){i=e[s];var u=r+Nf(i,s);a+=Dl(i,t,n,u,o)}else if(u=oR(e),typeof u=="function")for(e=u.call(e),s=0;!(i=e.next()).done;)i=i.value,u=r+Nf(i,s++),a+=Dl(i,t,n,u,o);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Ku(e,t,n){if(e==null)return e;var r=[],o=0;return Dl(e,r,"","",function(i){return t.call(n,i,o++)}),r}function sR(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Qt={current:null},Ml={transition:null},uR={ReactCurrentDispatcher:Qt,ReactCurrentBatchConfig:Ml,ReactCurrentOwner:$m};function Vb(){throw Error("act(...) is not supported in production builds of React.")}Ce.Children={map:Ku,forEach:function(e,t,n){Ku(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Ku(e,function(){t++}),t},toArray:function(e){return Ku(e,function(t){return t})||[]},only:function(e){if(!Wm(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ce.Component=Ha;Ce.Fragment=X_;Ce.Profiler=Q_;Ce.PureComponent=zm;Ce.StrictMode=Y_;Ce.Suspense=tR;Ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=uR;Ce.act=Vb;Ce.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Fb({},e.props),o=e.key,i=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,a=$m.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(u in t)Lb.call(t,u)&&!jb.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&s!==void 0?s[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){s=Array(u);for(var l=0;l<u;l++)s[l]=arguments[l+2];r.children=s}return{$$typeof:bu,type:e.type,key:o,ref:i,props:r,_owner:a}};Ce.createContext=function(e){return e={$$typeof:Z_,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:J_,_context:e},e.Consumer=e};Ce.createElement=zb;Ce.createFactory=function(e){var t=zb.bind(null,e);return t.type=e,t};Ce.createRef=function(){return{current:null}};Ce.forwardRef=function(e){return{$$typeof:eR,render:e}};Ce.isValidElement=Wm;Ce.lazy=function(e){return{$$typeof:rR,_payload:{_status:-1,_result:e},_init:sR}};Ce.memo=function(e,t){return{$$typeof:nR,type:e,compare:t===void 0?null:t}};Ce.startTransition=function(e){var t=Ml.transition;Ml.transition={};try{e()}finally{Ml.transition=t}};Ce.unstable_act=Vb;Ce.useCallback=function(e,t){return Qt.current.useCallback(e,t)};Ce.useContext=function(e){return Qt.current.useContext(e)};Ce.useDebugValue=function(){};Ce.useDeferredValue=function(e){return Qt.current.useDeferredValue(e)};Ce.useEffect=function(e,t){return Qt.current.useEffect(e,t)};Ce.useId=function(){return Qt.current.useId()};Ce.useImperativeHandle=function(e,t,n){return Qt.current.useImperativeHandle(e,t,n)};Ce.useInsertionEffect=function(e,t){return Qt.current.useInsertionEffect(e,t)};Ce.useLayoutEffect=function(e,t){return Qt.current.useLayoutEffect(e,t)};Ce.useMemo=function(e,t){return Qt.current.useMemo(e,t)};Ce.useReducer=function(e,t,n){return Qt.current.useReducer(e,t,n)};Ce.useRef=function(e){return Qt.current.useRef(e)};Ce.useState=function(e){return Qt.current.useState(e)};Ce.useSyncExternalStore=function(e,t,n){return Qt.current.useSyncExternalStore(e,t,n)};Ce.useTransition=function(){return Qt.current.useTransition()};Ce.version="18.3.1";Db.exports=Ce;var P=Db.exports;const Hn=Nb(P),O0=G_({__proto__:null,default:Hn},[P]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lR=P,cR=Symbol.for("react.element"),dR=Symbol.for("react.fragment"),fR=Object.prototype.hasOwnProperty,hR=lR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,pR={key:!0,ref:!0,__self:!0,__source:!0};function $b(e,t,n){var r,o={},i=null,a=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)fR.call(t,r)&&!pR.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)o[r]===void 0&&(o[r]=t[r]);return{$$typeof:cR,type:e,key:i,ref:a,props:o,_owner:hR.current}}ad.Fragment=dR;ad.jsx=$b;ad.jsxs=$b;Pb.exports=ad;var x=Pb.exports,Jh={},Wb={exports:{}},Tn={},Ub={exports:{}},Hb={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(M,B){var z=M.length;M.push(B);e:for(;0<z;){var G=z-1>>>1,X=M[G];if(0<o(X,B))M[G]=B,M[z]=X,z=G;else break e}}function n(M){return M.length===0?null:M[0]}function r(M){if(M.length===0)return null;var B=M[0],z=M.pop();if(z!==B){M[0]=z;e:for(var G=0,X=M.length,te=X>>>1;G<te;){var ae=2*(G+1)-1,ue=M[ae],se=ae+1,me=M[se];if(0>o(ue,z))se<X&&0>o(me,ue)?(M[G]=me,M[se]=z,G=se):(M[G]=ue,M[ae]=z,G=ae);else if(se<X&&0>o(me,z))M[G]=me,M[se]=z,G=se;else break e}}return B}function o(M,B){var z=M.sortIndex-B.sortIndex;return z!==0?z:M.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,s=a.now();e.unstable_now=function(){return a.now()-s}}var u=[],l=[],c=1,d=null,f=3,h=!1,p=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(M){for(var B=n(l);B!==null;){if(B.callback===null)r(l);else if(B.startTime<=M)r(l),B.sortIndex=B.expirationTime,t(u,B);else break;B=n(l)}}function w(M){if(m=!1,b(M),!p)if(n(u)!==null)p=!0,$(C);else{var B=n(l);B!==null&&U(w,B.startTime-M)}}function C(M,B){p=!1,m&&(m=!1,v(k),k=-1),h=!0;var z=f;try{for(b(B),d=n(u);d!==null&&(!(d.expirationTime>B)||M&&!N());){var G=d.callback;if(typeof G=="function"){d.callback=null,f=d.priorityLevel;var X=G(d.expirationTime<=B);B=e.unstable_now(),typeof X=="function"?d.callback=X:d===n(u)&&r(u),b(B)}else r(u);d=n(u)}if(d!==null)var te=!0;else{var ae=n(l);ae!==null&&U(w,ae.startTime-B),te=!1}return te}finally{d=null,f=z,h=!1}}var S=!1,E=null,k=-1,R=5,_=-1;function N(){return!(e.unstable_now()-_<R)}function I(){if(E!==null){var M=e.unstable_now();_=M;var B=!0;try{B=E(!0,M)}finally{B?L():(S=!1,E=null)}}else S=!1}var L;if(typeof y=="function")L=function(){y(I)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,V=O.port2;O.port1.onmessage=I,L=function(){V.postMessage(null)}}else L=function(){g(I,0)};function $(M){E=M,S||(S=!0,L())}function U(M,B){k=g(function(){M(e.unstable_now())},B)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(M){M.callback=null},e.unstable_continueExecution=function(){p||h||(p=!0,$(C))},e.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<M?Math.floor(1e3/M):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(M){switch(f){case 1:case 2:case 3:var B=3;break;default:B=f}var z=f;f=B;try{return M()}finally{f=z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(M,B){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var z=f;f=M;try{return B()}finally{f=z}},e.unstable_scheduleCallback=function(M,B,z){var G=e.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?G+z:G):z=G,M){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=z+X,M={id:c++,callback:B,priorityLevel:M,startTime:z,expirationTime:X,sortIndex:-1},z>G?(M.sortIndex=z,t(l,M),n(u)===null&&M===n(l)&&(m?(v(k),k=-1):m=!0,U(w,z-G))):(M.sortIndex=X,t(u,M),p||h||(p=!0,$(C))),M},e.unstable_shouldYield=N,e.unstable_wrapCallback=function(M){var B=f;return function(){var z=f;f=B;try{return M.apply(this,arguments)}finally{f=z}}}})(Hb);Ub.exports=Hb;var mR=Ub.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vR=P,_n=mR;function q(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Gb=new Set,$s={};function Ti(e,t){Na(e,t),Na(e+"Capture",t)}function Na(e,t){for($s[e]=t,e=0;e<t.length;e++)Gb.add(t[e])}var eo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Zh=Object.prototype.hasOwnProperty,gR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,B0={},L0={};function yR(e){return Zh.call(L0,e)?!0:Zh.call(B0,e)?!1:gR.test(e)?L0[e]=!0:(B0[e]=!0,!1)}function xR(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function bR(e,t,n,r){if(t===null||typeof t>"u"||xR(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Jt(e,t,n,r,o,i,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var Dt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Dt[e]=new Jt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Dt[t]=new Jt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Dt[e]=new Jt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Dt[e]=new Jt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Dt[e]=new Jt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Dt[e]=new Jt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Dt[e]=new Jt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Dt[e]=new Jt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Dt[e]=new Jt(e,5,!1,e.toLowerCase(),null,!1,!1)});var Um=/[\-:]([a-z])/g;function Hm(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Um,Hm);Dt[t]=new Jt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Um,Hm);Dt[t]=new Jt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Um,Hm);Dt[t]=new Jt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Dt[e]=new Jt(e,1,!1,e.toLowerCase(),null,!1,!1)});Dt.xlinkHref=new Jt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Dt[e]=new Jt(e,1,!1,e.toLowerCase(),null,!0,!0)});function Gm(e,t,n,r){var o=Dt.hasOwnProperty(t)?Dt[t]:null;(o!==null?o.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(bR(t,n,o,r)&&(n=null),r||o===null?yR(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=n===null?o.type===3?!1:"":n:(t=o.attributeName,r=o.attributeNamespace,n===null?e.removeAttribute(t):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var ao=vR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,qu=Symbol.for("react.element"),Zi=Symbol.for("react.portal"),ea=Symbol.for("react.fragment"),Km=Symbol.for("react.strict_mode"),ep=Symbol.for("react.profiler"),Kb=Symbol.for("react.provider"),qb=Symbol.for("react.context"),qm=Symbol.for("react.forward_ref"),tp=Symbol.for("react.suspense"),np=Symbol.for("react.suspense_list"),Xm=Symbol.for("react.memo"),yo=Symbol.for("react.lazy"),Xb=Symbol.for("react.offscreen"),j0=Symbol.iterator;function ns(e){return e===null||typeof e!="object"?null:(e=j0&&e[j0]||e["@@iterator"],typeof e=="function"?e:null)}var Je=Object.assign,Pf;function ys(e){if(Pf===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Pf=t&&t[1]||""}return`
`+Pf+e}var Df=!1;function Mf(e,t){if(!e||Df)return"";Df=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var o=l.stack.split(`
`),i=r.stack.split(`
`),a=o.length-1,s=i.length-1;1<=a&&0<=s&&o[a]!==i[s];)s--;for(;1<=a&&0<=s;a--,s--)if(o[a]!==i[s]){if(a!==1||s!==1)do if(a--,s--,0>s||o[a]!==i[s]){var u=`
`+o[a].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=a&&0<=s);break}}}finally{Df=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?ys(e):""}function wR(e){switch(e.tag){case 5:return ys(e.type);case 16:return ys("Lazy");case 13:return ys("Suspense");case 19:return ys("SuspenseList");case 0:case 2:case 15:return e=Mf(e.type,!1),e;case 11:return e=Mf(e.type.render,!1),e;case 1:return e=Mf(e.type,!0),e;default:return""}}function rp(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ea:return"Fragment";case Zi:return"Portal";case ep:return"Profiler";case Km:return"StrictMode";case tp:return"Suspense";case np:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case qb:return(e.displayName||"Context")+".Consumer";case Kb:return(e._context.displayName||"Context")+".Provider";case qm:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Xm:return t=e.displayName||null,t!==null?t:rp(e.type)||"Memo";case yo:t=e._payload,e=e._init;try{return rp(e(t))}catch{}}return null}function CR(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return rp(t);case 8:return t===Km?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Vo(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Yb(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function SR(e){var t=Yb(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Xu(e){e._valueTracker||(e._valueTracker=SR(e))}function Qb(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Yb(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function ec(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function op(e,t){var n=t.checked;return Je({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function z0(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Vo(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Jb(e,t){t=t.checked,t!=null&&Gm(e,"checked",t,!1)}function ip(e,t){Jb(e,t);var n=Vo(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?ap(e,t.type,n):t.hasOwnProperty("defaultValue")&&ap(e,t.type,Vo(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function V0(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function ap(e,t,n){(t!=="number"||ec(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var xs=Array.isArray;function ma(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Vo(n),t=null,o=0;o<e.length;o++){if(e[o].value===n){e[o].selected=!0,r&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function sp(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(q(91));return Je({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function $0(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(q(92));if(xs(n)){if(1<n.length)throw Error(q(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Vo(n)}}function Zb(e,t){var n=Vo(t.value),r=Vo(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function W0(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function ew(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function up(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?ew(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Yu,tw=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,o){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Yu=Yu||document.createElement("div"),Yu.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Yu.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ws(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Ss={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ER=["Webkit","ms","Moz","O"];Object.keys(Ss).forEach(function(e){ER.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ss[t]=Ss[e]})});function nw(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Ss.hasOwnProperty(e)&&Ss[e]?(""+t).trim():t+"px"}function rw(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,o=nw(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}var kR=Je({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function lp(e,t){if(t){if(kR[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(q(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(q(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(q(61))}if(t.style!=null&&typeof t.style!="object")throw Error(q(62))}}function cp(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dp=null;function Ym(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var fp=null,va=null,ga=null;function U0(e){if(e=Su(e)){if(typeof fp!="function")throw Error(q(280));var t=e.stateNode;t&&(t=dd(t),fp(e.stateNode,e.type,t))}}function ow(e){va?ga?ga.push(e):ga=[e]:va=e}function iw(){if(va){var e=va,t=ga;if(ga=va=null,U0(e),t)for(e=0;e<t.length;e++)U0(t[e])}}function aw(e,t){return e(t)}function sw(){}var Ff=!1;function uw(e,t,n){if(Ff)return e(t,n);Ff=!0;try{return aw(e,t,n)}finally{Ff=!1,(va!==null||ga!==null)&&(sw(),iw())}}function Us(e,t){var n=e.stateNode;if(n===null)return null;var r=dd(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(q(231,t,typeof n));return n}var hp=!1;if(eo)try{var rs={};Object.defineProperty(rs,"passive",{get:function(){hp=!0}}),window.addEventListener("test",rs,rs),window.removeEventListener("test",rs,rs)}catch{hp=!1}function _R(e,t,n,r,o,i,a,s,u){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(c){this.onError(c)}}var Es=!1,tc=null,nc=!1,pp=null,RR={onError:function(e){Es=!0,tc=e}};function TR(e,t,n,r,o,i,a,s,u){Es=!1,tc=null,_R.apply(RR,arguments)}function AR(e,t,n,r,o,i,a,s,u){if(TR.apply(this,arguments),Es){if(Es){var l=tc;Es=!1,tc=null}else throw Error(q(198));nc||(nc=!0,pp=l)}}function Ai(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function lw(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function H0(e){if(Ai(e)!==e)throw Error(q(188))}function IR(e){var t=e.alternate;if(!t){if(t=Ai(e),t===null)throw Error(q(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(o===null)break;var i=o.alternate;if(i===null){if(r=o.return,r!==null){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return H0(o),e;if(i===r)return H0(o),t;i=i.sibling}throw Error(q(188))}if(n.return!==r.return)n=o,r=i;else{for(var a=!1,s=o.child;s;){if(s===n){a=!0,n=o,r=i;break}if(s===r){a=!0,r=o,n=i;break}s=s.sibling}if(!a){for(s=i.child;s;){if(s===n){a=!0,n=i,r=o;break}if(s===r){a=!0,r=i,n=o;break}s=s.sibling}if(!a)throw Error(q(189))}}if(n.alternate!==r)throw Error(q(190))}if(n.tag!==3)throw Error(q(188));return n.stateNode.current===n?e:t}function cw(e){return e=IR(e),e!==null?dw(e):null}function dw(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=dw(e);if(t!==null)return t;e=e.sibling}return null}var fw=_n.unstable_scheduleCallback,G0=_n.unstable_cancelCallback,NR=_n.unstable_shouldYield,PR=_n.unstable_requestPaint,at=_n.unstable_now,DR=_n.unstable_getCurrentPriorityLevel,Qm=_n.unstable_ImmediatePriority,hw=_n.unstable_UserBlockingPriority,rc=_n.unstable_NormalPriority,MR=_n.unstable_LowPriority,pw=_n.unstable_IdlePriority,sd=null,Ar=null;function FR(e){if(Ar&&typeof Ar.onCommitFiberRoot=="function")try{Ar.onCommitFiberRoot(sd,e,void 0,(e.current.flags&128)===128)}catch{}}var lr=Math.clz32?Math.clz32:LR,OR=Math.log,BR=Math.LN2;function LR(e){return e>>>=0,e===0?32:31-(OR(e)/BR|0)|0}var Qu=64,Ju=4194304;function bs(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function oc(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,o=e.suspendedLanes,i=e.pingedLanes,a=n&268435455;if(a!==0){var s=a&~o;s!==0?r=bs(s):(i&=a,i!==0&&(r=bs(i)))}else a=n&~o,a!==0?r=bs(a):i!==0&&(r=bs(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&o)&&(o=r&-r,i=t&-t,o>=i||o===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-lr(t),o=1<<n,r|=e[n],t&=~o;return r}function jR(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zR(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-lr(i),s=1<<a,u=o[a];u===-1?(!(s&n)||s&r)&&(o[a]=jR(s,t)):u<=t&&(e.expiredLanes|=s),i&=~s}}function mp(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function mw(){var e=Qu;return Qu<<=1,!(Qu&4194240)&&(Qu=64),e}function Of(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function wu(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-lr(t),e[t]=n}function VR(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-lr(n),i=1<<o;t[o]=0,r[o]=-1,e[o]=-1,n&=~i}}function Jm(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-lr(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}var Pe=0;function vw(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var gw,Zm,yw,xw,bw,vp=!1,Zu=[],To=null,Ao=null,Io=null,Hs=new Map,Gs=new Map,wo=[],$R="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function K0(e,t){switch(e){case"focusin":case"focusout":To=null;break;case"dragenter":case"dragleave":Ao=null;break;case"mouseover":case"mouseout":Io=null;break;case"pointerover":case"pointerout":Hs.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gs.delete(t.pointerId)}}function os(e,t,n,r,o,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[o]},t!==null&&(t=Su(t),t!==null&&Zm(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function WR(e,t,n,r,o){switch(t){case"focusin":return To=os(To,e,t,n,r,o),!0;case"dragenter":return Ao=os(Ao,e,t,n,r,o),!0;case"mouseover":return Io=os(Io,e,t,n,r,o),!0;case"pointerover":var i=o.pointerId;return Hs.set(i,os(Hs.get(i)||null,e,t,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,Gs.set(i,os(Gs.get(i)||null,e,t,n,r,o)),!0}return!1}function ww(e){var t=di(e.target);if(t!==null){var n=Ai(t);if(n!==null){if(t=n.tag,t===13){if(t=lw(n),t!==null){e.blockedOn=t,bw(e.priority,function(){yw(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Fl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=gp(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);dp=r,n.target.dispatchEvent(r),dp=null}else return t=Su(n),t!==null&&Zm(t),e.blockedOn=n,!1;t.shift()}return!0}function q0(e,t,n){Fl(e)&&n.delete(t)}function UR(){vp=!1,To!==null&&Fl(To)&&(To=null),Ao!==null&&Fl(Ao)&&(Ao=null),Io!==null&&Fl(Io)&&(Io=null),Hs.forEach(q0),Gs.forEach(q0)}function is(e,t){e.blockedOn===t&&(e.blockedOn=null,vp||(vp=!0,_n.unstable_scheduleCallback(_n.unstable_NormalPriority,UR)))}function Ks(e){function t(o){return is(o,e)}if(0<Zu.length){is(Zu[0],e);for(var n=1;n<Zu.length;n++){var r=Zu[n];r.blockedOn===e&&(r.blockedOn=null)}}for(To!==null&&is(To,e),Ao!==null&&is(Ao,e),Io!==null&&is(Io,e),Hs.forEach(t),Gs.forEach(t),n=0;n<wo.length;n++)r=wo[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<wo.length&&(n=wo[0],n.blockedOn===null);)ww(n),n.blockedOn===null&&wo.shift()}var ya=ao.ReactCurrentBatchConfig,ic=!0;function HR(e,t,n,r){var o=Pe,i=ya.transition;ya.transition=null;try{Pe=1,ev(e,t,n,r)}finally{Pe=o,ya.transition=i}}function GR(e,t,n,r){var o=Pe,i=ya.transition;ya.transition=null;try{Pe=4,ev(e,t,n,r)}finally{Pe=o,ya.transition=i}}function ev(e,t,n,r){if(ic){var o=gp(e,t,n,r);if(o===null)Gf(e,t,r,ac,n),K0(e,r);else if(WR(o,e,t,n,r))r.stopPropagation();else if(K0(e,r),t&4&&-1<$R.indexOf(e)){for(;o!==null;){var i=Su(o);if(i!==null&&gw(i),i=gp(e,t,n,r),i===null&&Gf(e,t,r,ac,n),i===o)break;o=i}o!==null&&r.stopPropagation()}else Gf(e,t,r,null,n)}}var ac=null;function gp(e,t,n,r){if(ac=null,e=Ym(r),e=di(e),e!==null)if(t=Ai(e),t===null)e=null;else if(n=t.tag,n===13){if(e=lw(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ac=e,null}function Cw(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(DR()){case Qm:return 1;case hw:return 4;case rc:case MR:return 16;case pw:return 536870912;default:return 16}default:return 16}}var Eo=null,tv=null,Ol=null;function Sw(){if(Ol)return Ol;var e,t=tv,n=t.length,r,o="value"in Eo?Eo.value:Eo.textContent,i=o.length;for(e=0;e<n&&t[e]===o[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===o[i-r];r++);return Ol=o.slice(e,1<r?1-r:void 0)}function Bl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function el(){return!0}function X0(){return!1}function An(e){function t(n,r,o,i,a){this._reactName=n,this._targetInst=o,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var s in e)e.hasOwnProperty(s)&&(n=e[s],this[s]=n?n(i):i[s]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?el:X0,this.isPropagationStopped=X0,this}return Je(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=el)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=el)},persist:function(){},isPersistent:el}),t}var Ga={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nv=An(Ga),Cu=Je({},Ga,{view:0,detail:0}),KR=An(Cu),Bf,Lf,as,ud=Je({},Cu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rv,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==as&&(as&&e.type==="mousemove"?(Bf=e.screenX-as.screenX,Lf=e.screenY-as.screenY):Lf=Bf=0,as=e),Bf)},movementY:function(e){return"movementY"in e?e.movementY:Lf}}),Y0=An(ud),qR=Je({},ud,{dataTransfer:0}),XR=An(qR),YR=Je({},Cu,{relatedTarget:0}),jf=An(YR),QR=Je({},Ga,{animationName:0,elapsedTime:0,pseudoElement:0}),JR=An(QR),ZR=Je({},Ga,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),eT=An(ZR),tT=Je({},Ga,{data:0}),Q0=An(tT),nT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},rT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},oT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function iT(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=oT[e])?!!t[e]:!1}function rv(){return iT}var aT=Je({},Cu,{key:function(e){if(e.key){var t=nT[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Bl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?rT[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rv,charCode:function(e){return e.type==="keypress"?Bl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Bl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),sT=An(aT),uT=Je({},ud,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),J0=An(uT),lT=Je({},Cu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rv}),cT=An(lT),dT=Je({},Ga,{propertyName:0,elapsedTime:0,pseudoElement:0}),fT=An(dT),hT=Je({},ud,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),pT=An(hT),mT=[9,13,27,32],ov=eo&&"CompositionEvent"in window,ks=null;eo&&"documentMode"in document&&(ks=document.documentMode);var vT=eo&&"TextEvent"in window&&!ks,Ew=eo&&(!ov||ks&&8<ks&&11>=ks),Z0=String.fromCharCode(32),ey=!1;function kw(e,t){switch(e){case"keyup":return mT.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _w(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ta=!1;function gT(e,t){switch(e){case"compositionend":return _w(t);case"keypress":return t.which!==32?null:(ey=!0,Z0);case"textInput":return e=t.data,e===Z0&&ey?null:e;default:return null}}function yT(e,t){if(ta)return e==="compositionend"||!ov&&kw(e,t)?(e=Sw(),Ol=tv=Eo=null,ta=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ew&&t.locale!=="ko"?null:t.data;default:return null}}var xT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ty(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!xT[e.type]:t==="textarea"}function Rw(e,t,n,r){ow(r),t=sc(t,"onChange"),0<t.length&&(n=new nv("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var _s=null,qs=null;function bT(e){Lw(e,0)}function ld(e){var t=oa(e);if(Qb(t))return e}function wT(e,t){if(e==="change")return t}var Tw=!1;if(eo){var zf;if(eo){var Vf="oninput"in document;if(!Vf){var ny=document.createElement("div");ny.setAttribute("oninput","return;"),Vf=typeof ny.oninput=="function"}zf=Vf}else zf=!1;Tw=zf&&(!document.documentMode||9<document.documentMode)}function ry(){_s&&(_s.detachEvent("onpropertychange",Aw),qs=_s=null)}function Aw(e){if(e.propertyName==="value"&&ld(qs)){var t=[];Rw(t,qs,e,Ym(e)),uw(bT,t)}}function CT(e,t,n){e==="focusin"?(ry(),_s=t,qs=n,_s.attachEvent("onpropertychange",Aw)):e==="focusout"&&ry()}function ST(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ld(qs)}function ET(e,t){if(e==="click")return ld(t)}function kT(e,t){if(e==="input"||e==="change")return ld(t)}function _T(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var fr=typeof Object.is=="function"?Object.is:_T;function Xs(e,t){if(fr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!Zh.call(t,o)||!fr(e[o],t[o]))return!1}return!0}function oy(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function iy(e,t){var n=oy(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=oy(n)}}function Iw(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Iw(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Nw(){for(var e=window,t=ec();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=ec(e.document)}return t}function iv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function RT(e){var t=Nw(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Iw(n.ownerDocument.documentElement,n)){if(r!==null&&iv(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=n.textContent.length,i=Math.min(r.start,o);r=r.end===void 0?i:Math.min(r.end,o),!e.extend&&i>r&&(o=r,r=i,i=o),o=iy(n,i);var a=iy(n,r);o&&a&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var TT=eo&&"documentMode"in document&&11>=document.documentMode,na=null,yp=null,Rs=null,xp=!1;function ay(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;xp||na==null||na!==ec(r)||(r=na,"selectionStart"in r&&iv(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Rs&&Xs(Rs,r)||(Rs=r,r=sc(yp,"onSelect"),0<r.length&&(t=new nv("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=na)))}function tl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ra={animationend:tl("Animation","AnimationEnd"),animationiteration:tl("Animation","AnimationIteration"),animationstart:tl("Animation","AnimationStart"),transitionend:tl("Transition","TransitionEnd")},$f={},Pw={};eo&&(Pw=document.createElement("div").style,"AnimationEvent"in window||(delete ra.animationend.animation,delete ra.animationiteration.animation,delete ra.animationstart.animation),"TransitionEvent"in window||delete ra.transitionend.transition);function cd(e){if($f[e])return $f[e];if(!ra[e])return e;var t=ra[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Pw)return $f[e]=t[n];return e}var Dw=cd("animationend"),Mw=cd("animationiteration"),Fw=cd("animationstart"),Ow=cd("transitionend"),Bw=new Map,sy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qo(e,t){Bw.set(e,t),Ti(t,[e])}for(var Wf=0;Wf<sy.length;Wf++){var Uf=sy[Wf],AT=Uf.toLowerCase(),IT=Uf[0].toUpperCase()+Uf.slice(1);qo(AT,"on"+IT)}qo(Dw,"onAnimationEnd");qo(Mw,"onAnimationIteration");qo(Fw,"onAnimationStart");qo("dblclick","onDoubleClick");qo("focusin","onFocus");qo("focusout","onBlur");qo(Ow,"onTransitionEnd");Na("onMouseEnter",["mouseout","mouseover"]);Na("onMouseLeave",["mouseout","mouseover"]);Na("onPointerEnter",["pointerout","pointerover"]);Na("onPointerLeave",["pointerout","pointerover"]);Ti("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ti("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ti("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ti("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ti("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ti("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ws="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),NT=new Set("cancel close invalid load scroll toggle".split(" ").concat(ws));function uy(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,AR(r,t,void 0,e),e.currentTarget=null}function Lw(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],u=s.instance,l=s.currentTarget;if(s=s.listener,u!==i&&o.isPropagationStopped())break e;uy(o,s,l),i=u}else for(a=0;a<r.length;a++){if(s=r[a],u=s.instance,l=s.currentTarget,s=s.listener,u!==i&&o.isPropagationStopped())break e;uy(o,s,l),i=u}}}if(nc)throw e=pp,nc=!1,pp=null,e}function Ve(e,t){var n=t[Ep];n===void 0&&(n=t[Ep]=new Set);var r=e+"__bubble";n.has(r)||(jw(t,e,2,!1),n.add(r))}function Hf(e,t,n){var r=0;t&&(r|=4),jw(n,e,r,t)}var nl="_reactListening"+Math.random().toString(36).slice(2);function Ys(e){if(!e[nl]){e[nl]=!0,Gb.forEach(function(n){n!=="selectionchange"&&(NT.has(n)||Hf(n,!1,e),Hf(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[nl]||(t[nl]=!0,Hf("selectionchange",!1,t))}}function jw(e,t,n,r){switch(Cw(t)){case 1:var o=HR;break;case 4:o=GR;break;default:o=ev}n=o.bind(null,t,n,e),o=void 0,!hp||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),r?o!==void 0?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):o!==void 0?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function Gf(e,t,n,r,o){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var s=r.stateNode.containerInfo;if(s===o||s.nodeType===8&&s.parentNode===o)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===o||u.nodeType===8&&u.parentNode===o))return;a=a.return}for(;s!==null;){if(a=di(s),a===null)return;if(u=a.tag,u===5||u===6){r=i=a;continue e}s=s.parentNode}}r=r.return}uw(function(){var l=i,c=Ym(n),d=[];e:{var f=Bw.get(e);if(f!==void 0){var h=nv,p=e;switch(e){case"keypress":if(Bl(n)===0)break e;case"keydown":case"keyup":h=sT;break;case"focusin":p="focus",h=jf;break;case"focusout":p="blur",h=jf;break;case"beforeblur":case"afterblur":h=jf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Y0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=XR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=cT;break;case Dw:case Mw:case Fw:h=JR;break;case Ow:h=fT;break;case"scroll":h=KR;break;case"wheel":h=pT;break;case"copy":case"cut":case"paste":h=eT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=J0}var m=(t&4)!==0,g=!m&&e==="scroll",v=m?f!==null?f+"Capture":null:f;m=[];for(var y=l,b;y!==null;){b=y;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,v!==null&&(w=Us(y,v),w!=null&&m.push(Qs(y,w,b)))),g)break;y=y.return}0<m.length&&(f=new h(f,p,null,n,c),d.push({event:f,listeners:m}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",f&&n!==dp&&(p=n.relatedTarget||n.fromElement)&&(di(p)||p[to]))break e;if((h||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,h?(p=n.relatedTarget||n.toElement,h=l,p=p?di(p):null,p!==null&&(g=Ai(p),p!==g||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=l),h!==p)){if(m=Y0,w="onMouseLeave",v="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(m=J0,w="onPointerLeave",v="onPointerEnter",y="pointer"),g=h==null?f:oa(h),b=p==null?f:oa(p),f=new m(w,y+"leave",h,n,c),f.target=g,f.relatedTarget=b,w=null,di(c)===l&&(m=new m(v,y+"enter",p,n,c),m.target=b,m.relatedTarget=g,w=m),g=w,h&&p)t:{for(m=h,v=p,y=0,b=m;b;b=Bi(b))y++;for(b=0,w=v;w;w=Bi(w))b++;for(;0<y-b;)m=Bi(m),y--;for(;0<b-y;)v=Bi(v),b--;for(;y--;){if(m===v||v!==null&&m===v.alternate)break t;m=Bi(m),v=Bi(v)}m=null}else m=null;h!==null&&ly(d,f,h,m,!1),p!==null&&g!==null&&ly(d,g,p,m,!0)}}e:{if(f=l?oa(l):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var C=wT;else if(ty(f))if(Tw)C=kT;else{C=ST;var S=CT}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(C=ET);if(C&&(C=C(e,l))){Rw(d,C,n,c);break e}S&&S(e,f,l),e==="focusout"&&(S=f._wrapperState)&&S.controlled&&f.type==="number"&&ap(f,"number",f.value)}switch(S=l?oa(l):window,e){case"focusin":(ty(S)||S.contentEditable==="true")&&(na=S,yp=l,Rs=null);break;case"focusout":Rs=yp=na=null;break;case"mousedown":xp=!0;break;case"contextmenu":case"mouseup":case"dragend":xp=!1,ay(d,n,c);break;case"selectionchange":if(TT)break;case"keydown":case"keyup":ay(d,n,c)}var E;if(ov)e:{switch(e){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else ta?kw(e,n)&&(k="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(Ew&&n.locale!=="ko"&&(ta||k!=="onCompositionStart"?k==="onCompositionEnd"&&ta&&(E=Sw()):(Eo=c,tv="value"in Eo?Eo.value:Eo.textContent,ta=!0)),S=sc(l,k),0<S.length&&(k=new Q0(k,e,null,n,c),d.push({event:k,listeners:S}),E?k.data=E:(E=_w(n),E!==null&&(k.data=E)))),(E=vT?gT(e,n):yT(e,n))&&(l=sc(l,"onBeforeInput"),0<l.length&&(c=new Q0("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:l}),c.data=E))}Lw(d,t)})}function Qs(e,t,n){return{instance:e,listener:t,currentTarget:n}}function sc(e,t){for(var n=t+"Capture",r=[];e!==null;){var o=e,i=o.stateNode;o.tag===5&&i!==null&&(o=i,i=Us(e,n),i!=null&&r.unshift(Qs(e,i,o)),i=Us(e,t),i!=null&&r.push(Qs(e,i,o))),e=e.return}return r}function Bi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function ly(e,t,n,r,o){for(var i=t._reactName,a=[];n!==null&&n!==r;){var s=n,u=s.alternate,l=s.stateNode;if(u!==null&&u===r)break;s.tag===5&&l!==null&&(s=l,o?(u=Us(n,i),u!=null&&a.unshift(Qs(n,u,s))):o||(u=Us(n,i),u!=null&&a.push(Qs(n,u,s)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var PT=/\r\n?/g,DT=/\u0000|\uFFFD/g;function cy(e){return(typeof e=="string"?e:""+e).replace(PT,`
`).replace(DT,"")}function rl(e,t,n){if(t=cy(t),cy(e)!==t&&n)throw Error(q(425))}function uc(){}var bp=null,wp=null;function Cp(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Sp=typeof setTimeout=="function"?setTimeout:void 0,MT=typeof clearTimeout=="function"?clearTimeout:void 0,dy=typeof Promise=="function"?Promise:void 0,FT=typeof queueMicrotask=="function"?queueMicrotask:typeof dy<"u"?function(e){return dy.resolve(null).then(e).catch(OT)}:Sp;function OT(e){setTimeout(function(){throw e})}function Kf(e,t){var n=t,r=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(r===0){e.removeChild(o),Ks(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=o}while(n);Ks(t)}function No(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function fy(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Ka=Math.random().toString(36).slice(2),kr="__reactFiber$"+Ka,Js="__reactProps$"+Ka,to="__reactContainer$"+Ka,Ep="__reactEvents$"+Ka,BT="__reactListeners$"+Ka,LT="__reactHandles$"+Ka;function di(e){var t=e[kr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[to]||n[kr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=fy(e);e!==null;){if(n=e[kr])return n;e=fy(e)}return t}e=n,n=e.parentNode}return null}function Su(e){return e=e[kr]||e[to],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function oa(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(q(33))}function dd(e){return e[Js]||null}var kp=[],ia=-1;function Xo(e){return{current:e}}function We(e){0>ia||(e.current=kp[ia],kp[ia]=null,ia--)}function Oe(e,t){ia++,kp[ia]=e.current,e.current=t}var $o={},Ut=Xo($o),an=Xo(!1),wi=$o;function Pa(e,t){var n=e.type.contextTypes;if(!n)return $o;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o={},i;for(i in n)o[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function sn(e){return e=e.childContextTypes,e!=null}function lc(){We(an),We(Ut)}function hy(e,t,n){if(Ut.current!==$o)throw Error(q(168));Oe(Ut,t),Oe(an,n)}function zw(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var o in r)if(!(o in t))throw Error(q(108,CR(e)||"Unknown",o));return Je({},n,r)}function cc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||$o,wi=Ut.current,Oe(Ut,e),Oe(an,an.current),!0}function py(e,t,n){var r=e.stateNode;if(!r)throw Error(q(169));n?(e=zw(e,t,wi),r.__reactInternalMemoizedMergedChildContext=e,We(an),We(Ut),Oe(Ut,e)):We(an),Oe(an,n)}var Gr=null,fd=!1,qf=!1;function Vw(e){Gr===null?Gr=[e]:Gr.push(e)}function jT(e){fd=!0,Vw(e)}function Yo(){if(!qf&&Gr!==null){qf=!0;var e=0,t=Pe;try{var n=Gr;for(Pe=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Gr=null,fd=!1}catch(o){throw Gr!==null&&(Gr=Gr.slice(e+1)),fw(Qm,Yo),o}finally{Pe=t,qf=!1}}return null}var aa=[],sa=0,dc=null,fc=0,zn=[],Vn=0,Ci=null,qr=1,Xr="";function ri(e,t){aa[sa++]=fc,aa[sa++]=dc,dc=e,fc=t}function $w(e,t,n){zn[Vn++]=qr,zn[Vn++]=Xr,zn[Vn++]=Ci,Ci=e;var r=qr;e=Xr;var o=32-lr(r)-1;r&=~(1<<o),n+=1;var i=32-lr(t)+o;if(30<i){var a=o-o%5;i=(r&(1<<a)-1).toString(32),r>>=a,o-=a,qr=1<<32-lr(t)+o|n<<o|r,Xr=i+e}else qr=1<<i|n<<o|r,Xr=e}function av(e){e.return!==null&&(ri(e,1),$w(e,1,0))}function sv(e){for(;e===dc;)dc=aa[--sa],aa[sa]=null,fc=aa[--sa],aa[sa]=null;for(;e===Ci;)Ci=zn[--Vn],zn[Vn]=null,Xr=zn[--Vn],zn[Vn]=null,qr=zn[--Vn],zn[Vn]=null}var Sn=null,xn=null,Ge=!1,ar=null;function Ww(e,t){var n=Gn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function my(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Sn=e,xn=No(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Sn=e,xn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Ci!==null?{id:qr,overflow:Xr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Gn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Sn=e,xn=null,!0):!1;default:return!1}}function _p(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Rp(e){if(Ge){var t=xn;if(t){var n=t;if(!my(e,t)){if(_p(e))throw Error(q(418));t=No(n.nextSibling);var r=Sn;t&&my(e,t)?Ww(r,n):(e.flags=e.flags&-4097|2,Ge=!1,Sn=e)}}else{if(_p(e))throw Error(q(418));e.flags=e.flags&-4097|2,Ge=!1,Sn=e}}}function vy(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Sn=e}function ol(e){if(e!==Sn)return!1;if(!Ge)return vy(e),Ge=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Cp(e.type,e.memoizedProps)),t&&(t=xn)){if(_p(e))throw Uw(),Error(q(418));for(;t;)Ww(e,t),t=No(t.nextSibling)}if(vy(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(q(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){xn=No(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}xn=null}}else xn=Sn?No(e.stateNode.nextSibling):null;return!0}function Uw(){for(var e=xn;e;)e=No(e.nextSibling)}function Da(){xn=Sn=null,Ge=!1}function uv(e){ar===null?ar=[e]:ar.push(e)}var zT=ao.ReactCurrentBatchConfig;function ss(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(q(309));var r=n.stateNode}if(!r)throw Error(q(147,e));var o=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(a){var s=o.refs;a===null?delete s[i]:s[i]=a},t._stringRef=i,t)}if(typeof e!="string")throw Error(q(284));if(!n._owner)throw Error(q(290,e))}return e}function il(e,t){throw e=Object.prototype.toString.call(t),Error(q(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function gy(e){var t=e._init;return t(e._payload)}function Hw(e){function t(v,y){if(e){var b=v.deletions;b===null?(v.deletions=[y],v.flags|=16):b.push(y)}}function n(v,y){if(!e)return null;for(;y!==null;)t(v,y),y=y.sibling;return null}function r(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function o(v,y){return v=Fo(v,y),v.index=0,v.sibling=null,v}function i(v,y,b){return v.index=b,e?(b=v.alternate,b!==null?(b=b.index,b<y?(v.flags|=2,y):b):(v.flags|=2,y)):(v.flags|=1048576,y)}function a(v){return e&&v.alternate===null&&(v.flags|=2),v}function s(v,y,b,w){return y===null||y.tag!==6?(y=th(b,v.mode,w),y.return=v,y):(y=o(y,b),y.return=v,y)}function u(v,y,b,w){var C=b.type;return C===ea?c(v,y,b.props.children,w,b.key):y!==null&&(y.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===yo&&gy(C)===y.type)?(w=o(y,b.props),w.ref=ss(v,y,b),w.return=v,w):(w=Ul(b.type,b.key,b.props,null,v.mode,w),w.ref=ss(v,y,b),w.return=v,w)}function l(v,y,b,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=nh(b,v.mode,w),y.return=v,y):(y=o(y,b.children||[]),y.return=v,y)}function c(v,y,b,w,C){return y===null||y.tag!==7?(y=xi(b,v.mode,w,C),y.return=v,y):(y=o(y,b),y.return=v,y)}function d(v,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=th(""+y,v.mode,b),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case qu:return b=Ul(y.type,y.key,y.props,null,v.mode,b),b.ref=ss(v,null,y),b.return=v,b;case Zi:return y=nh(y,v.mode,b),y.return=v,y;case yo:var w=y._init;return d(v,w(y._payload),b)}if(xs(y)||ns(y))return y=xi(y,v.mode,b,null),y.return=v,y;il(v,y)}return null}function f(v,y,b,w){var C=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return C!==null?null:s(v,y,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case qu:return b.key===C?u(v,y,b,w):null;case Zi:return b.key===C?l(v,y,b,w):null;case yo:return C=b._init,f(v,y,C(b._payload),w)}if(xs(b)||ns(b))return C!==null?null:c(v,y,b,w,null);il(v,b)}return null}function h(v,y,b,w,C){if(typeof w=="string"&&w!==""||typeof w=="number")return v=v.get(b)||null,s(y,v,""+w,C);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case qu:return v=v.get(w.key===null?b:w.key)||null,u(y,v,w,C);case Zi:return v=v.get(w.key===null?b:w.key)||null,l(y,v,w,C);case yo:var S=w._init;return h(v,y,b,S(w._payload),C)}if(xs(w)||ns(w))return v=v.get(b)||null,c(y,v,w,C,null);il(y,w)}return null}function p(v,y,b,w){for(var C=null,S=null,E=y,k=y=0,R=null;E!==null&&k<b.length;k++){E.index>k?(R=E,E=null):R=E.sibling;var _=f(v,E,b[k],w);if(_===null){E===null&&(E=R);break}e&&E&&_.alternate===null&&t(v,E),y=i(_,y,k),S===null?C=_:S.sibling=_,S=_,E=R}if(k===b.length)return n(v,E),Ge&&ri(v,k),C;if(E===null){for(;k<b.length;k++)E=d(v,b[k],w),E!==null&&(y=i(E,y,k),S===null?C=E:S.sibling=E,S=E);return Ge&&ri(v,k),C}for(E=r(v,E);k<b.length;k++)R=h(E,v,k,b[k],w),R!==null&&(e&&R.alternate!==null&&E.delete(R.key===null?k:R.key),y=i(R,y,k),S===null?C=R:S.sibling=R,S=R);return e&&E.forEach(function(N){return t(v,N)}),Ge&&ri(v,k),C}function m(v,y,b,w){var C=ns(b);if(typeof C!="function")throw Error(q(150));if(b=C.call(b),b==null)throw Error(q(151));for(var S=C=null,E=y,k=y=0,R=null,_=b.next();E!==null&&!_.done;k++,_=b.next()){E.index>k?(R=E,E=null):R=E.sibling;var N=f(v,E,_.value,w);if(N===null){E===null&&(E=R);break}e&&E&&N.alternate===null&&t(v,E),y=i(N,y,k),S===null?C=N:S.sibling=N,S=N,E=R}if(_.done)return n(v,E),Ge&&ri(v,k),C;if(E===null){for(;!_.done;k++,_=b.next())_=d(v,_.value,w),_!==null&&(y=i(_,y,k),S===null?C=_:S.sibling=_,S=_);return Ge&&ri(v,k),C}for(E=r(v,E);!_.done;k++,_=b.next())_=h(E,v,k,_.value,w),_!==null&&(e&&_.alternate!==null&&E.delete(_.key===null?k:_.key),y=i(_,y,k),S===null?C=_:S.sibling=_,S=_);return e&&E.forEach(function(I){return t(v,I)}),Ge&&ri(v,k),C}function g(v,y,b,w){if(typeof b=="object"&&b!==null&&b.type===ea&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case qu:e:{for(var C=b.key,S=y;S!==null;){if(S.key===C){if(C=b.type,C===ea){if(S.tag===7){n(v,S.sibling),y=o(S,b.props.children),y.return=v,v=y;break e}}else if(S.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===yo&&gy(C)===S.type){n(v,S.sibling),y=o(S,b.props),y.ref=ss(v,S,b),y.return=v,v=y;break e}n(v,S);break}else t(v,S);S=S.sibling}b.type===ea?(y=xi(b.props.children,v.mode,w,b.key),y.return=v,v=y):(w=Ul(b.type,b.key,b.props,null,v.mode,w),w.ref=ss(v,y,b),w.return=v,v=w)}return a(v);case Zi:e:{for(S=b.key;y!==null;){if(y.key===S)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){n(v,y.sibling),y=o(y,b.children||[]),y.return=v,v=y;break e}else{n(v,y);break}else t(v,y);y=y.sibling}y=nh(b,v.mode,w),y.return=v,v=y}return a(v);case yo:return S=b._init,g(v,y,S(b._payload),w)}if(xs(b))return p(v,y,b,w);if(ns(b))return m(v,y,b,w);il(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(n(v,y.sibling),y=o(y,b),y.return=v,v=y):(n(v,y),y=th(b,v.mode,w),y.return=v,v=y),a(v)):n(v,y)}return g}var Ma=Hw(!0),Gw=Hw(!1),hc=Xo(null),pc=null,ua=null,lv=null;function cv(){lv=ua=pc=null}function dv(e){var t=hc.current;We(hc),e._currentValue=t}function Tp(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function xa(e,t){pc=e,lv=ua=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(rn=!0),e.firstContext=null)}function Xn(e){var t=e._currentValue;if(lv!==e)if(e={context:e,memoizedValue:t,next:null},ua===null){if(pc===null)throw Error(q(308));ua=e,pc.dependencies={lanes:0,firstContext:e}}else ua=ua.next=e;return t}var fi=null;function fv(e){fi===null?fi=[e]:fi.push(e)}function Kw(e,t,n,r){var o=t.interleaved;return o===null?(n.next=n,fv(t)):(n.next=o.next,o.next=n),t.interleaved=n,no(e,r)}function no(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var xo=!1;function hv(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function qw(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Qr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Po(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,ke&2){var o=r.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),r.pending=t,no(e,n)}return o=r.interleaved,o===null?(t.next=t,fv(r)):(t.next=o.next,o.next=t),r.interleaved=t,no(e,n)}function Ll(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Jm(e,n)}}function yy(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var o=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?o=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?o=i=t:i=i.next=t}else o=i=t;n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function mc(e,t,n,r){var o=e.updateQueue;xo=!1;var i=o.firstBaseUpdate,a=o.lastBaseUpdate,s=o.shared.pending;if(s!==null){o.shared.pending=null;var u=s,l=u.next;u.next=null,a===null?i=l:a.next=l,a=u;var c=e.alternate;c!==null&&(c=c.updateQueue,s=c.lastBaseUpdate,s!==a&&(s===null?c.firstBaseUpdate=l:s.next=l,c.lastBaseUpdate=u))}if(i!==null){var d=o.baseState;a=0,c=l=u=null,s=i;do{var f=s.lane,h=s.eventTime;if((r&f)===f){c!==null&&(c=c.next={eventTime:h,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var p=e,m=s;switch(f=t,h=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(h,d,f);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,f=typeof p=="function"?p.call(h,d,f):p,f==null)break e;d=Je({},d,f);break e;case 2:xo=!0}}s.callback!==null&&s.lane!==0&&(e.flags|=64,f=o.effects,f===null?o.effects=[s]:f.push(s))}else h={eventTime:h,lane:f,tag:s.tag,payload:s.payload,callback:s.callback,next:null},c===null?(l=c=h,u=d):c=c.next=h,a|=f;if(s=s.next,s===null){if(s=o.shared.pending,s===null)break;f=s,s=f.next,f.next=null,o.lastBaseUpdate=f,o.shared.pending=null}}while(1);if(c===null&&(u=d),o.baseState=u,o.firstBaseUpdate=l,o.lastBaseUpdate=c,t=o.shared.interleaved,t!==null){o=t;do a|=o.lane,o=o.next;while(o!==t)}else i===null&&(o.shared.lanes=0);Ei|=a,e.lanes=a,e.memoizedState=d}}function xy(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(o!==null){if(r.callback=null,r=n,typeof o!="function")throw Error(q(191,o));o.call(r)}}}var Eu={},Ir=Xo(Eu),Zs=Xo(Eu),eu=Xo(Eu);function hi(e){if(e===Eu)throw Error(q(174));return e}function pv(e,t){switch(Oe(eu,t),Oe(Zs,e),Oe(Ir,Eu),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:up(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=up(t,e)}We(Ir),Oe(Ir,t)}function Fa(){We(Ir),We(Zs),We(eu)}function Xw(e){hi(eu.current);var t=hi(Ir.current),n=up(t,e.type);t!==n&&(Oe(Zs,e),Oe(Ir,n))}function mv(e){Zs.current===e&&(We(Ir),We(Zs))}var Ke=Xo(0);function vc(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Xf=[];function vv(){for(var e=0;e<Xf.length;e++)Xf[e]._workInProgressVersionPrimary=null;Xf.length=0}var jl=ao.ReactCurrentDispatcher,Yf=ao.ReactCurrentBatchConfig,Si=0,Qe=null,pt=null,Ct=null,gc=!1,Ts=!1,tu=0,VT=0;function Mt(){throw Error(q(321))}function gv(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!fr(e[n],t[n]))return!1;return!0}function yv(e,t,n,r,o,i){if(Si=i,Qe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,jl.current=e===null||e.memoizedState===null?HT:GT,e=n(r,o),Ts){i=0;do{if(Ts=!1,tu=0,25<=i)throw Error(q(301));i+=1,Ct=pt=null,t.updateQueue=null,jl.current=KT,e=n(r,o)}while(Ts)}if(jl.current=yc,t=pt!==null&&pt.next!==null,Si=0,Ct=pt=Qe=null,gc=!1,t)throw Error(q(300));return e}function xv(){var e=tu!==0;return tu=0,e}function br(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ct===null?Qe.memoizedState=Ct=e:Ct=Ct.next=e,Ct}function Yn(){if(pt===null){var e=Qe.alternate;e=e!==null?e.memoizedState:null}else e=pt.next;var t=Ct===null?Qe.memoizedState:Ct.next;if(t!==null)Ct=t,pt=e;else{if(e===null)throw Error(q(310));pt=e,e={memoizedState:pt.memoizedState,baseState:pt.baseState,baseQueue:pt.baseQueue,queue:pt.queue,next:null},Ct===null?Qe.memoizedState=Ct=e:Ct=Ct.next=e}return Ct}function nu(e,t){return typeof t=="function"?t(e):t}function Qf(e){var t=Yn(),n=t.queue;if(n===null)throw Error(q(311));n.lastRenderedReducer=e;var r=pt,o=r.baseQueue,i=n.pending;if(i!==null){if(o!==null){var a=o.next;o.next=i.next,i.next=a}r.baseQueue=o=i,n.pending=null}if(o!==null){i=o.next,r=r.baseState;var s=a=null,u=null,l=i;do{var c=l.lane;if((Si&c)===c)u!==null&&(u=u.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var d={lane:c,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};u===null?(s=u=d,a=r):u=u.next=d,Qe.lanes|=c,Ei|=c}l=l.next}while(l!==null&&l!==i);u===null?a=r:u.next=s,fr(r,t.memoizedState)||(rn=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){o=e;do i=o.lane,Qe.lanes|=i,Ei|=i,o=o.next;while(o!==e)}else o===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Jf(e){var t=Yn(),n=t.queue;if(n===null)throw Error(q(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,i=t.memoizedState;if(o!==null){n.pending=null;var a=o=o.next;do i=e(i,a.action),a=a.next;while(a!==o);fr(i,t.memoizedState)||(rn=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function Yw(){}function Qw(e,t){var n=Qe,r=Yn(),o=t(),i=!fr(r.memoizedState,o);if(i&&(r.memoizedState=o,rn=!0),r=r.queue,bv(e2.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||Ct!==null&&Ct.memoizedState.tag&1){if(n.flags|=2048,ru(9,Zw.bind(null,n,r,o,t),void 0,null),St===null)throw Error(q(349));Si&30||Jw(n,t,o)}return o}function Jw(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Qe.updateQueue,t===null?(t={lastEffect:null,stores:null},Qe.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Zw(e,t,n,r){t.value=n,t.getSnapshot=r,t2(t)&&n2(e)}function e2(e,t,n){return n(function(){t2(t)&&n2(e)})}function t2(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!fr(e,n)}catch{return!0}}function n2(e){var t=no(e,1);t!==null&&cr(t,e,1,-1)}function by(e){var t=br();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:nu,lastRenderedState:e},t.queue=e,e=e.dispatch=UT.bind(null,Qe,e),[t.memoizedState,e]}function ru(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Qe.updateQueue,t===null?(t={lastEffect:null,stores:null},Qe.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function r2(){return Yn().memoizedState}function zl(e,t,n,r){var o=br();Qe.flags|=e,o.memoizedState=ru(1|t,n,void 0,r===void 0?null:r)}function hd(e,t,n,r){var o=Yn();r=r===void 0?null:r;var i=void 0;if(pt!==null){var a=pt.memoizedState;if(i=a.destroy,r!==null&&gv(r,a.deps)){o.memoizedState=ru(t,n,i,r);return}}Qe.flags|=e,o.memoizedState=ru(1|t,n,i,r)}function wy(e,t){return zl(8390656,8,e,t)}function bv(e,t){return hd(2048,8,e,t)}function o2(e,t){return hd(4,2,e,t)}function i2(e,t){return hd(4,4,e,t)}function a2(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function s2(e,t,n){return n=n!=null?n.concat([e]):null,hd(4,4,a2.bind(null,t,e),n)}function wv(){}function u2(e,t){var n=Yn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&gv(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function l2(e,t){var n=Yn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&gv(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function c2(e,t,n){return Si&21?(fr(n,t)||(n=mw(),Qe.lanes|=n,Ei|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,rn=!0),e.memoizedState=n)}function $T(e,t){var n=Pe;Pe=n!==0&&4>n?n:4,e(!0);var r=Yf.transition;Yf.transition={};try{e(!1),t()}finally{Pe=n,Yf.transition=r}}function d2(){return Yn().memoizedState}function WT(e,t,n){var r=Mo(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},f2(e))h2(t,n);else if(n=Kw(e,t,n,r),n!==null){var o=Yt();cr(n,e,r,o),p2(n,t,r)}}function UT(e,t,n){var r=Mo(e),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(f2(e))h2(t,o);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var a=t.lastRenderedState,s=i(a,n);if(o.hasEagerState=!0,o.eagerState=s,fr(s,a)){var u=t.interleaved;u===null?(o.next=o,fv(t)):(o.next=u.next,u.next=o),t.interleaved=o;return}}catch{}finally{}n=Kw(e,t,o,r),n!==null&&(o=Yt(),cr(n,e,r,o),p2(n,t,r))}}function f2(e){var t=e.alternate;return e===Qe||t!==null&&t===Qe}function h2(e,t){Ts=gc=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function p2(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Jm(e,n)}}var yc={readContext:Xn,useCallback:Mt,useContext:Mt,useEffect:Mt,useImperativeHandle:Mt,useInsertionEffect:Mt,useLayoutEffect:Mt,useMemo:Mt,useReducer:Mt,useRef:Mt,useState:Mt,useDebugValue:Mt,useDeferredValue:Mt,useTransition:Mt,useMutableSource:Mt,useSyncExternalStore:Mt,useId:Mt,unstable_isNewReconciler:!1},HT={readContext:Xn,useCallback:function(e,t){return br().memoizedState=[e,t===void 0?null:t],e},useContext:Xn,useEffect:wy,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,zl(4194308,4,a2.bind(null,t,e),n)},useLayoutEffect:function(e,t){return zl(4194308,4,e,t)},useInsertionEffect:function(e,t){return zl(4,2,e,t)},useMemo:function(e,t){var n=br();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=br();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=WT.bind(null,Qe,e),[r.memoizedState,e]},useRef:function(e){var t=br();return e={current:e},t.memoizedState=e},useState:by,useDebugValue:wv,useDeferredValue:function(e){return br().memoizedState=e},useTransition:function(){var e=by(!1),t=e[0];return e=$T.bind(null,e[1]),br().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Qe,o=br();if(Ge){if(n===void 0)throw Error(q(407));n=n()}else{if(n=t(),St===null)throw Error(q(349));Si&30||Jw(r,t,n)}o.memoizedState=n;var i={value:n,getSnapshot:t};return o.queue=i,wy(e2.bind(null,r,i,e),[e]),r.flags|=2048,ru(9,Zw.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=br(),t=St.identifierPrefix;if(Ge){var n=Xr,r=qr;n=(r&~(1<<32-lr(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=tu++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=VT++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},GT={readContext:Xn,useCallback:u2,useContext:Xn,useEffect:bv,useImperativeHandle:s2,useInsertionEffect:o2,useLayoutEffect:i2,useMemo:l2,useReducer:Qf,useRef:r2,useState:function(){return Qf(nu)},useDebugValue:wv,useDeferredValue:function(e){var t=Yn();return c2(t,pt.memoizedState,e)},useTransition:function(){var e=Qf(nu)[0],t=Yn().memoizedState;return[e,t]},useMutableSource:Yw,useSyncExternalStore:Qw,useId:d2,unstable_isNewReconciler:!1},KT={readContext:Xn,useCallback:u2,useContext:Xn,useEffect:bv,useImperativeHandle:s2,useInsertionEffect:o2,useLayoutEffect:i2,useMemo:l2,useReducer:Jf,useRef:r2,useState:function(){return Jf(nu)},useDebugValue:wv,useDeferredValue:function(e){var t=Yn();return pt===null?t.memoizedState=e:c2(t,pt.memoizedState,e)},useTransition:function(){var e=Jf(nu)[0],t=Yn().memoizedState;return[e,t]},useMutableSource:Yw,useSyncExternalStore:Qw,useId:d2,unstable_isNewReconciler:!1};function or(e,t){if(e&&e.defaultProps){t=Je({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Ap(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Je({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var pd={isMounted:function(e){return(e=e._reactInternals)?Ai(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Yt(),o=Mo(e),i=Qr(r,o);i.payload=t,n!=null&&(i.callback=n),t=Po(e,i,o),t!==null&&(cr(t,e,o,r),Ll(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Yt(),o=Mo(e),i=Qr(r,o);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Po(e,i,o),t!==null&&(cr(t,e,o,r),Ll(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Yt(),r=Mo(e),o=Qr(n,r);o.tag=2,t!=null&&(o.callback=t),t=Po(e,o,r),t!==null&&(cr(t,e,r,n),Ll(t,e,r))}};function Cy(e,t,n,r,o,i,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,a):t.prototype&&t.prototype.isPureReactComponent?!Xs(n,r)||!Xs(o,i):!0}function m2(e,t,n){var r=!1,o=$o,i=t.contextType;return typeof i=="object"&&i!==null?i=Xn(i):(o=sn(t)?wi:Ut.current,r=t.contextTypes,i=(r=r!=null)?Pa(e,o):$o),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=pd,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=i),t}function Sy(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&pd.enqueueReplaceState(t,t.state,null)}function Ip(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},hv(e);var i=t.contextType;typeof i=="object"&&i!==null?o.context=Xn(i):(i=sn(t)?wi:Ut.current,o.context=Pa(e,i)),o.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Ap(e,t,i,n),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&pd.enqueueReplaceState(o,o.state,null),mc(e,n,o,r),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function Oa(e,t){try{var n="",r=t;do n+=wR(r),r=r.return;while(r);var o=n}catch(i){o=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:o,digest:null}}function Zf(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Np(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var qT=typeof WeakMap=="function"?WeakMap:Map;function v2(e,t,n){n=Qr(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){bc||(bc=!0,Vp=r),Np(e,t)},n}function g2(e,t,n){n=Qr(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var o=t.value;n.payload=function(){return r(o)},n.callback=function(){Np(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Np(e,t),typeof r!="function"&&(Do===null?Do=new Set([this]):Do.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function Ey(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new qT;var o=new Set;r.set(t,o)}else o=r.get(t),o===void 0&&(o=new Set,r.set(t,o));o.has(n)||(o.add(n),e=uA.bind(null,e,t,n),t.then(e,e))}function ky(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function _y(e,t,n,r,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Qr(-1,1),t.tag=2,Po(n,t,1))),n.lanes|=1),e)}var XT=ao.ReactCurrentOwner,rn=!1;function Xt(e,t,n,r){t.child=e===null?Gw(t,null,n,r):Ma(t,e.child,n,r)}function Ry(e,t,n,r,o){n=n.render;var i=t.ref;return xa(t,o),r=yv(e,t,n,r,i,o),n=xv(),e!==null&&!rn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,ro(e,t,o)):(Ge&&n&&av(t),t.flags|=1,Xt(e,t,r,o),t.child)}function Ty(e,t,n,r,o){if(e===null){var i=n.type;return typeof i=="function"&&!Av(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,y2(e,t,i,r,o)):(e=Ul(n.type,null,r,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&o)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:Xs,n(a,r)&&e.ref===t.ref)return ro(e,t,o)}return t.flags|=1,e=Fo(i,r),e.ref=t.ref,e.return=t,t.child=e}function y2(e,t,n,r,o){if(e!==null){var i=e.memoizedProps;if(Xs(i,r)&&e.ref===t.ref)if(rn=!1,t.pendingProps=r=i,(e.lanes&o)!==0)e.flags&131072&&(rn=!0);else return t.lanes=e.lanes,ro(e,t,o)}return Pp(e,t,n,r,o)}function x2(e,t,n){var r=t.pendingProps,o=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Oe(ca,mn),mn|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Oe(ca,mn),mn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Oe(ca,mn),mn|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,Oe(ca,mn),mn|=r;return Xt(e,t,o,n),t.child}function b2(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Pp(e,t,n,r,o){var i=sn(n)?wi:Ut.current;return i=Pa(t,i),xa(t,o),n=yv(e,t,n,r,i,o),r=xv(),e!==null&&!rn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,ro(e,t,o)):(Ge&&r&&av(t),t.flags|=1,Xt(e,t,n,o),t.child)}function Ay(e,t,n,r,o){if(sn(n)){var i=!0;cc(t)}else i=!1;if(xa(t,o),t.stateNode===null)Vl(e,t),m2(t,n,r),Ip(t,n,r,o),r=!0;else if(e===null){var a=t.stateNode,s=t.memoizedProps;a.props=s;var u=a.context,l=n.contextType;typeof l=="object"&&l!==null?l=Xn(l):(l=sn(n)?wi:Ut.current,l=Pa(t,l));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==r||u!==l)&&Sy(t,a,r,l),xo=!1;var f=t.memoizedState;a.state=f,mc(t,r,a,o),u=t.memoizedState,s!==r||f!==u||an.current||xo?(typeof c=="function"&&(Ap(t,n,c,r),u=t.memoizedState),(s=xo||Cy(t,n,s,r,f,u,l))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),a.props=r,a.state=u,a.context=l,r=s):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,qw(e,t),s=t.memoizedProps,l=t.type===t.elementType?s:or(t.type,s),a.props=l,d=t.pendingProps,f=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=Xn(u):(u=sn(n)?wi:Ut.current,u=Pa(t,u));var h=n.getDerivedStateFromProps;(c=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==d||f!==u)&&Sy(t,a,r,u),xo=!1,f=t.memoizedState,a.state=f,mc(t,r,a,o);var p=t.memoizedState;s!==d||f!==p||an.current||xo?(typeof h=="function"&&(Ap(t,n,h,r),p=t.memoizedState),(l=xo||Cy(t,n,l,r,f,p,u)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,p,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,p,u)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),a.props=r,a.state=p,a.context=u,r=l):(typeof a.componentDidUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return Dp(e,t,n,r,i,o)}function Dp(e,t,n,r,o,i){b2(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return o&&py(t,n,!1),ro(e,t,i);r=t.stateNode,XT.current=t;var s=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=Ma(t,e.child,null,i),t.child=Ma(t,null,s,i)):Xt(e,t,s,i),t.memoizedState=r.state,o&&py(t,n,!0),t.child}function w2(e){var t=e.stateNode;t.pendingContext?hy(e,t.pendingContext,t.pendingContext!==t.context):t.context&&hy(e,t.context,!1),pv(e,t.containerInfo)}function Iy(e,t,n,r,o){return Da(),uv(o),t.flags|=256,Xt(e,t,n,r),t.child}var Mp={dehydrated:null,treeContext:null,retryLane:0};function Fp(e){return{baseLanes:e,cachePool:null,transitions:null}}function C2(e,t,n){var r=t.pendingProps,o=Ke.current,i=!1,a=(t.flags&128)!==0,s;if((s=a)||(s=e!==null&&e.memoizedState===null?!1:(o&2)!==0),s?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),Oe(Ke,o&1),e===null)return Rp(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,i?(r=t.mode,i=t.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=gd(a,r,0,null),e=xi(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Fp(n),t.memoizedState=Mp,e):Cv(t,a));if(o=e.memoizedState,o!==null&&(s=o.dehydrated,s!==null))return YT(e,t,a,r,s,o,n);if(i){i=r.fallback,a=t.mode,o=e.child,s=o.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&t.child!==o?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=Fo(o,u),r.subtreeFlags=o.subtreeFlags&14680064),s!==null?i=Fo(s,i):(i=xi(i,a,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,a=e.child.memoizedState,a=a===null?Fp(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=e.childLanes&~n,t.memoizedState=Mp,r}return i=e.child,e=i.sibling,r=Fo(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Cv(e,t){return t=gd({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function al(e,t,n,r){return r!==null&&uv(r),Ma(t,e.child,null,n),e=Cv(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function YT(e,t,n,r,o,i,a){if(n)return t.flags&256?(t.flags&=-257,r=Zf(Error(q(422))),al(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,o=t.mode,r=gd({mode:"visible",children:r.children},o,0,null),i=xi(i,o,a,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&Ma(t,e.child,null,a),t.child.memoizedState=Fp(a),t.memoizedState=Mp,i);if(!(t.mode&1))return al(e,t,a,null);if(o.data==="$!"){if(r=o.nextSibling&&o.nextSibling.dataset,r)var s=r.dgst;return r=s,i=Error(q(419)),r=Zf(i,r,void 0),al(e,t,a,r)}if(s=(a&e.childLanes)!==0,rn||s){if(r=St,r!==null){switch(a&-a){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(r.suspendedLanes|a)?0:o,o!==0&&o!==i.retryLane&&(i.retryLane=o,no(e,o),cr(r,e,o,-1))}return Tv(),r=Zf(Error(q(421))),al(e,t,a,r)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=lA.bind(null,e),o._reactRetry=t,null):(e=i.treeContext,xn=No(o.nextSibling),Sn=t,Ge=!0,ar=null,e!==null&&(zn[Vn++]=qr,zn[Vn++]=Xr,zn[Vn++]=Ci,qr=e.id,Xr=e.overflow,Ci=t),t=Cv(t,r.children),t.flags|=4096,t)}function Ny(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Tp(e.return,t,n)}function eh(e,t,n,r,o){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=o)}function S2(e,t,n){var r=t.pendingProps,o=r.revealOrder,i=r.tail;if(Xt(e,t,r.children,n),r=Ke.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Ny(e,n,t);else if(e.tag===19)Ny(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Oe(Ke,r),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;n!==null;)e=n.alternate,e!==null&&vc(e)===null&&(o=n),n=n.sibling;n=o,n===null?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),eh(t,!1,o,n,i);break;case"backwards":for(n=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&vc(e)===null){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}eh(t,!0,n,null,i);break;case"together":eh(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Vl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ro(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Ei|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(q(153));if(t.child!==null){for(e=t.child,n=Fo(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Fo(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function QT(e,t,n){switch(t.tag){case 3:w2(t),Da();break;case 5:Xw(t);break;case 1:sn(t.type)&&cc(t);break;case 4:pv(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,o=t.memoizedProps.value;Oe(hc,r._currentValue),r._currentValue=o;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Oe(Ke,Ke.current&1),t.flags|=128,null):n&t.child.childLanes?C2(e,t,n):(Oe(Ke,Ke.current&1),e=ro(e,t,n),e!==null?e.sibling:null);Oe(Ke,Ke.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return S2(e,t,n);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Oe(Ke,Ke.current),r)break;return null;case 22:case 23:return t.lanes=0,x2(e,t,n)}return ro(e,t,n)}var E2,Op,k2,_2;E2=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Op=function(){};k2=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,hi(Ir.current);var i=null;switch(n){case"input":o=op(e,o),r=op(e,r),i=[];break;case"select":o=Je({},o,{value:void 0}),r=Je({},r,{value:void 0}),i=[];break;case"textarea":o=sp(e,o),r=sp(e,r),i=[];break;default:typeof o.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=uc)}lp(n,r);var a;n=null;for(l in o)if(!r.hasOwnProperty(l)&&o.hasOwnProperty(l)&&o[l]!=null)if(l==="style"){var s=o[l];for(a in s)s.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&($s.hasOwnProperty(l)?i||(i=[]):(i=i||[]).push(l,null));for(l in r){var u=r[l];if(s=o!=null?o[l]:void 0,r.hasOwnProperty(l)&&u!==s&&(u!=null||s!=null))if(l==="style")if(s){for(a in s)!s.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&s[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(i||(i=[]),i.push(l,n)),n=u;else l==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,s=s?s.__html:void 0,u!=null&&s!==u&&(i=i||[]).push(l,u)):l==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(l,""+u):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&($s.hasOwnProperty(l)?(u!=null&&l==="onScroll"&&Ve("scroll",e),i||s===u||(i=[])):(i=i||[]).push(l,u))}n&&(i=i||[]).push("style",n);var l=i;(t.updateQueue=l)&&(t.flags|=4)}};_2=function(e,t,n,r){n!==r&&(t.flags|=4)};function us(e,t){if(!Ge)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ft(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags&14680064,r|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function JT(e,t,n){var r=t.pendingProps;switch(sv(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ft(t),null;case 1:return sn(t.type)&&lc(),Ft(t),null;case 3:return r=t.stateNode,Fa(),We(an),We(Ut),vv(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(ol(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ar!==null&&(Up(ar),ar=null))),Op(e,t),Ft(t),null;case 5:mv(t);var o=hi(eu.current);if(n=t.type,e!==null&&t.stateNode!=null)k2(e,t,n,r,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(q(166));return Ft(t),null}if(e=hi(Ir.current),ol(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[kr]=t,r[Js]=i,e=(t.mode&1)!==0,n){case"dialog":Ve("cancel",r),Ve("close",r);break;case"iframe":case"object":case"embed":Ve("load",r);break;case"video":case"audio":for(o=0;o<ws.length;o++)Ve(ws[o],r);break;case"source":Ve("error",r);break;case"img":case"image":case"link":Ve("error",r),Ve("load",r);break;case"details":Ve("toggle",r);break;case"input":z0(r,i),Ve("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ve("invalid",r);break;case"textarea":$0(r,i),Ve("invalid",r)}lp(n,i),o=null;for(var a in i)if(i.hasOwnProperty(a)){var s=i[a];a==="children"?typeof s=="string"?r.textContent!==s&&(i.suppressHydrationWarning!==!0&&rl(r.textContent,s,e),o=["children",s]):typeof s=="number"&&r.textContent!==""+s&&(i.suppressHydrationWarning!==!0&&rl(r.textContent,s,e),o=["children",""+s]):$s.hasOwnProperty(a)&&s!=null&&a==="onScroll"&&Ve("scroll",r)}switch(n){case"input":Xu(r),V0(r,i,!0);break;case"textarea":Xu(r),W0(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=uc)}r=o,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=ew(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[kr]=t,e[Js]=r,E2(e,t,!1,!1),t.stateNode=e;e:{switch(a=cp(n,r),n){case"dialog":Ve("cancel",e),Ve("close",e),o=r;break;case"iframe":case"object":case"embed":Ve("load",e),o=r;break;case"video":case"audio":for(o=0;o<ws.length;o++)Ve(ws[o],e);o=r;break;case"source":Ve("error",e),o=r;break;case"img":case"image":case"link":Ve("error",e),Ve("load",e),o=r;break;case"details":Ve("toggle",e),o=r;break;case"input":z0(e,r),o=op(e,r),Ve("invalid",e);break;case"option":o=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=Je({},r,{value:void 0}),Ve("invalid",e);break;case"textarea":$0(e,r),o=sp(e,r),Ve("invalid",e);break;default:o=r}lp(n,o),s=o;for(i in s)if(s.hasOwnProperty(i)){var u=s[i];i==="style"?rw(e,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&tw(e,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Ws(e,u):typeof u=="number"&&Ws(e,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&($s.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Ve("scroll",e):u!=null&&Gm(e,i,u,a))}switch(n){case"input":Xu(e),V0(e,r,!1);break;case"textarea":Xu(e),W0(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Vo(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?ma(e,!!r.multiple,i,!1):r.defaultValue!=null&&ma(e,!!r.multiple,r.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=uc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ft(t),null;case 6:if(e&&t.stateNode!=null)_2(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(q(166));if(n=hi(eu.current),hi(Ir.current),ol(t)){if(r=t.stateNode,n=t.memoizedProps,r[kr]=t,(i=r.nodeValue!==n)&&(e=Sn,e!==null))switch(e.tag){case 3:rl(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&rl(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[kr]=t,t.stateNode=r}return Ft(t),null;case 13:if(We(Ke),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ge&&xn!==null&&t.mode&1&&!(t.flags&128))Uw(),Da(),t.flags|=98560,i=!1;else if(i=ol(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(q(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(q(317));i[kr]=t}else Da(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ft(t),i=!1}else ar!==null&&(Up(ar),ar=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Ke.current&1?mt===0&&(mt=3):Tv())),t.updateQueue!==null&&(t.flags|=4),Ft(t),null);case 4:return Fa(),Op(e,t),e===null&&Ys(t.stateNode.containerInfo),Ft(t),null;case 10:return dv(t.type._context),Ft(t),null;case 17:return sn(t.type)&&lc(),Ft(t),null;case 19:if(We(Ke),i=t.memoizedState,i===null)return Ft(t),null;if(r=(t.flags&128)!==0,a=i.rendering,a===null)if(r)us(i,!1);else{if(mt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=vc(e),a!==null){for(t.flags|=128,us(i,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Oe(Ke,Ke.current&1|2),t.child}e=e.sibling}i.tail!==null&&at()>Ba&&(t.flags|=128,r=!0,us(i,!1),t.lanes=4194304)}else{if(!r)if(e=vc(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),us(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Ge)return Ft(t),null}else 2*at()-i.renderingStartTime>Ba&&n!==1073741824&&(t.flags|=128,r=!0,us(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(n=i.last,n!==null?n.sibling=a:t.child=a,i.last=a)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=at(),t.sibling=null,n=Ke.current,Oe(Ke,r?n&1|2:n&1),t):(Ft(t),null);case 22:case 23:return Rv(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?mn&1073741824&&(Ft(t),t.subtreeFlags&6&&(t.flags|=8192)):Ft(t),null;case 24:return null;case 25:return null}throw Error(q(156,t.tag))}function ZT(e,t){switch(sv(t),t.tag){case 1:return sn(t.type)&&lc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Fa(),We(an),We(Ut),vv(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return mv(t),null;case 13:if(We(Ke),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(q(340));Da()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return We(Ke),null;case 4:return Fa(),null;case 10:return dv(t.type._context),null;case 22:case 23:return Rv(),null;case 24:return null;default:return null}}var sl=!1,jt=!1,eA=typeof WeakSet=="function"?WeakSet:Set,J=null;function la(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){rt(e,t,r)}else n.current=null}function Bp(e,t,n){try{n()}catch(r){rt(e,t,r)}}var Py=!1;function tA(e,t){if(bp=ic,e=Nw(),iv(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var o=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,s=-1,u=-1,l=0,c=0,d=e,f=null;t:for(;;){for(var h;d!==n||o!==0&&d.nodeType!==3||(s=a+o),d!==i||r!==0&&d.nodeType!==3||(u=a+r),d.nodeType===3&&(a+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===e)break t;if(f===n&&++l===o&&(s=a),f===i&&++c===r&&(u=a),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=s===-1||u===-1?null:{start:s,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(wp={focusedElem:e,selectionRange:n},ic=!1,J=t;J!==null;)if(t=J,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,J=e;else for(;J!==null;){t=J;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,g=p.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?m:or(t.type,m),g);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(q(163))}}catch(w){rt(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,J=e;break}J=t.return}return p=Py,Py=!1,p}function As(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&e)===e){var i=o.destroy;o.destroy=void 0,i!==void 0&&Bp(t,n,i)}o=o.next}while(o!==r)}}function md(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Lp(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function R2(e){var t=e.alternate;t!==null&&(e.alternate=null,R2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[kr],delete t[Js],delete t[Ep],delete t[BT],delete t[LT])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function T2(e){return e.tag===5||e.tag===3||e.tag===4}function Dy(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||T2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function jp(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=uc));else if(r!==4&&(e=e.child,e!==null))for(jp(e,t,n),e=e.sibling;e!==null;)jp(e,t,n),e=e.sibling}function zp(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(zp(e,t,n),e=e.sibling;e!==null;)zp(e,t,n),e=e.sibling}var Rt=null,ir=!1;function po(e,t,n){for(n=n.child;n!==null;)A2(e,t,n),n=n.sibling}function A2(e,t,n){if(Ar&&typeof Ar.onCommitFiberUnmount=="function")try{Ar.onCommitFiberUnmount(sd,n)}catch{}switch(n.tag){case 5:jt||la(n,t);case 6:var r=Rt,o=ir;Rt=null,po(e,t,n),Rt=r,ir=o,Rt!==null&&(ir?(e=Rt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Rt.removeChild(n.stateNode));break;case 18:Rt!==null&&(ir?(e=Rt,n=n.stateNode,e.nodeType===8?Kf(e.parentNode,n):e.nodeType===1&&Kf(e,n),Ks(e)):Kf(Rt,n.stateNode));break;case 4:r=Rt,o=ir,Rt=n.stateNode.containerInfo,ir=!0,po(e,t,n),Rt=r,ir=o;break;case 0:case 11:case 14:case 15:if(!jt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){o=r=r.next;do{var i=o,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Bp(n,t,a),o=o.next}while(o!==r)}po(e,t,n);break;case 1:if(!jt&&(la(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){rt(n,t,s)}po(e,t,n);break;case 21:po(e,t,n);break;case 22:n.mode&1?(jt=(r=jt)||n.memoizedState!==null,po(e,t,n),jt=r):po(e,t,n);break;default:po(e,t,n)}}function My(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new eA),t.forEach(function(r){var o=cA.bind(null,e,r);n.has(r)||(n.add(r),r.then(o,o))})}}function rr(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var o=n[r];try{var i=e,a=t,s=a;e:for(;s!==null;){switch(s.tag){case 5:Rt=s.stateNode,ir=!1;break e;case 3:Rt=s.stateNode.containerInfo,ir=!0;break e;case 4:Rt=s.stateNode.containerInfo,ir=!0;break e}s=s.return}if(Rt===null)throw Error(q(160));A2(i,a,o),Rt=null,ir=!1;var u=o.alternate;u!==null&&(u.return=null),o.return=null}catch(l){rt(o,t,l)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)I2(t,e),t=t.sibling}function I2(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(rr(t,e),yr(e),r&4){try{As(3,e,e.return),md(3,e)}catch(m){rt(e,e.return,m)}try{As(5,e,e.return)}catch(m){rt(e,e.return,m)}}break;case 1:rr(t,e),yr(e),r&512&&n!==null&&la(n,n.return);break;case 5:if(rr(t,e),yr(e),r&512&&n!==null&&la(n,n.return),e.flags&32){var o=e.stateNode;try{Ws(o,"")}catch(m){rt(e,e.return,m)}}if(r&4&&(o=e.stateNode,o!=null)){var i=e.memoizedProps,a=n!==null?n.memoizedProps:i,s=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{s==="input"&&i.type==="radio"&&i.name!=null&&Jb(o,i),cp(s,a);var l=cp(s,i);for(a=0;a<u.length;a+=2){var c=u[a],d=u[a+1];c==="style"?rw(o,d):c==="dangerouslySetInnerHTML"?tw(o,d):c==="children"?Ws(o,d):Gm(o,c,d,l)}switch(s){case"input":ip(o,i);break;case"textarea":Zb(o,i);break;case"select":var f=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?ma(o,!!i.multiple,h,!1):f!==!!i.multiple&&(i.defaultValue!=null?ma(o,!!i.multiple,i.defaultValue,!0):ma(o,!!i.multiple,i.multiple?[]:"",!1))}o[Js]=i}catch(m){rt(e,e.return,m)}}break;case 6:if(rr(t,e),yr(e),r&4){if(e.stateNode===null)throw Error(q(162));o=e.stateNode,i=e.memoizedProps;try{o.nodeValue=i}catch(m){rt(e,e.return,m)}}break;case 3:if(rr(t,e),yr(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ks(t.containerInfo)}catch(m){rt(e,e.return,m)}break;case 4:rr(t,e),yr(e);break;case 13:rr(t,e),yr(e),o=e.child,o.flags&8192&&(i=o.memoizedState!==null,o.stateNode.isHidden=i,!i||o.alternate!==null&&o.alternate.memoizedState!==null||(kv=at())),r&4&&My(e);break;case 22:if(c=n!==null&&n.memoizedState!==null,e.mode&1?(jt=(l=jt)||c,rr(t,e),jt=l):rr(t,e),yr(e),r&8192){if(l=e.memoizedState!==null,(e.stateNode.isHidden=l)&&!c&&e.mode&1)for(J=e,c=e.child;c!==null;){for(d=J=c;J!==null;){switch(f=J,h=f.child,f.tag){case 0:case 11:case 14:case 15:As(4,f,f.return);break;case 1:la(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){r=f,n=f.return;try{t=r,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(m){rt(r,n,m)}}break;case 5:la(f,f.return);break;case 22:if(f.memoizedState!==null){Oy(d);continue}}h!==null?(h.return=f,J=h):Oy(d)}c=c.sibling}e:for(c=null,d=e;;){if(d.tag===5){if(c===null){c=d;try{o=d.stateNode,l?(i=o.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(s=d.stateNode,u=d.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,s.style.display=nw("display",a))}catch(m){rt(e,e.return,m)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=l?"":d.memoizedProps}catch(m){rt(e,e.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:rr(t,e),yr(e),r&4&&My(e);break;case 21:break;default:rr(t,e),yr(e)}}function yr(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(T2(n)){var r=n;break e}n=n.return}throw Error(q(160))}switch(r.tag){case 5:var o=r.stateNode;r.flags&32&&(Ws(o,""),r.flags&=-33);var i=Dy(e);zp(e,i,o);break;case 3:case 4:var a=r.stateNode.containerInfo,s=Dy(e);jp(e,s,a);break;default:throw Error(q(161))}}catch(u){rt(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function nA(e,t,n){J=e,N2(e)}function N2(e,t,n){for(var r=(e.mode&1)!==0;J!==null;){var o=J,i=o.child;if(o.tag===22&&r){var a=o.memoizedState!==null||sl;if(!a){var s=o.alternate,u=s!==null&&s.memoizedState!==null||jt;s=sl;var l=jt;if(sl=a,(jt=u)&&!l)for(J=o;J!==null;)a=J,u=a.child,a.tag===22&&a.memoizedState!==null?By(o):u!==null?(u.return=a,J=u):By(o);for(;i!==null;)J=i,N2(i),i=i.sibling;J=o,sl=s,jt=l}Fy(e)}else o.subtreeFlags&8772&&i!==null?(i.return=o,J=i):Fy(e)}}function Fy(e){for(;J!==null;){var t=J;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:jt||md(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!jt)if(n===null)r.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:or(t.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&xy(t,i,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}xy(t,a,n)}break;case 5:var s=t.stateNode;if(n===null&&t.flags&4){n=s;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var l=t.alternate;if(l!==null){var c=l.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&Ks(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(q(163))}jt||t.flags&512&&Lp(t)}catch(f){rt(t,t.return,f)}}if(t===e){J=null;break}if(n=t.sibling,n!==null){n.return=t.return,J=n;break}J=t.return}}function Oy(e){for(;J!==null;){var t=J;if(t===e){J=null;break}var n=t.sibling;if(n!==null){n.return=t.return,J=n;break}J=t.return}}function By(e){for(;J!==null;){var t=J;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{md(4,t)}catch(u){rt(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var o=t.return;try{r.componentDidMount()}catch(u){rt(t,o,u)}}var i=t.return;try{Lp(t)}catch(u){rt(t,i,u)}break;case 5:var a=t.return;try{Lp(t)}catch(u){rt(t,a,u)}}}catch(u){rt(t,t.return,u)}if(t===e){J=null;break}var s=t.sibling;if(s!==null){s.return=t.return,J=s;break}J=t.return}}var rA=Math.ceil,xc=ao.ReactCurrentDispatcher,Sv=ao.ReactCurrentOwner,qn=ao.ReactCurrentBatchConfig,ke=0,St=null,dt=null,Pt=0,mn=0,ca=Xo(0),mt=0,ou=null,Ei=0,vd=0,Ev=0,Is=null,Zt=null,kv=0,Ba=1/0,Hr=null,bc=!1,Vp=null,Do=null,ul=!1,ko=null,wc=0,Ns=0,$p=null,$l=-1,Wl=0;function Yt(){return ke&6?at():$l!==-1?$l:$l=at()}function Mo(e){return e.mode&1?ke&2&&Pt!==0?Pt&-Pt:zT.transition!==null?(Wl===0&&(Wl=mw()),Wl):(e=Pe,e!==0||(e=window.event,e=e===void 0?16:Cw(e.type)),e):1}function cr(e,t,n,r){if(50<Ns)throw Ns=0,$p=null,Error(q(185));wu(e,n,r),(!(ke&2)||e!==St)&&(e===St&&(!(ke&2)&&(vd|=n),mt===4&&Co(e,Pt)),un(e,r),n===1&&ke===0&&!(t.mode&1)&&(Ba=at()+500,fd&&Yo()))}function un(e,t){var n=e.callbackNode;zR(e,t);var r=oc(e,e===St?Pt:0);if(r===0)n!==null&&G0(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&G0(n),t===1)e.tag===0?jT(Ly.bind(null,e)):Vw(Ly.bind(null,e)),FT(function(){!(ke&6)&&Yo()}),n=null;else{switch(vw(r)){case 1:n=Qm;break;case 4:n=hw;break;case 16:n=rc;break;case 536870912:n=pw;break;default:n=rc}n=j2(n,P2.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function P2(e,t){if($l=-1,Wl=0,ke&6)throw Error(q(327));var n=e.callbackNode;if(ba()&&e.callbackNode!==n)return null;var r=oc(e,e===St?Pt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Cc(e,r);else{t=r;var o=ke;ke|=2;var i=M2();(St!==e||Pt!==t)&&(Hr=null,Ba=at()+500,yi(e,t));do try{aA();break}catch(s){D2(e,s)}while(1);cv(),xc.current=i,ke=o,dt!==null?t=0:(St=null,Pt=0,t=mt)}if(t!==0){if(t===2&&(o=mp(e),o!==0&&(r=o,t=Wp(e,o))),t===1)throw n=ou,yi(e,0),Co(e,r),un(e,at()),n;if(t===6)Co(e,r);else{if(o=e.current.alternate,!(r&30)&&!oA(o)&&(t=Cc(e,r),t===2&&(i=mp(e),i!==0&&(r=i,t=Wp(e,i))),t===1))throw n=ou,yi(e,0),Co(e,r),un(e,at()),n;switch(e.finishedWork=o,e.finishedLanes=r,t){case 0:case 1:throw Error(q(345));case 2:oi(e,Zt,Hr);break;case 3:if(Co(e,r),(r&130023424)===r&&(t=kv+500-at(),10<t)){if(oc(e,0)!==0)break;if(o=e.suspendedLanes,(o&r)!==r){Yt(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=Sp(oi.bind(null,e,Zt,Hr),t);break}oi(e,Zt,Hr);break;case 4:if(Co(e,r),(r&4194240)===r)break;for(t=e.eventTimes,o=-1;0<r;){var a=31-lr(r);i=1<<a,a=t[a],a>o&&(o=a),r&=~i}if(r=o,r=at()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*rA(r/1960))-r,10<r){e.timeoutHandle=Sp(oi.bind(null,e,Zt,Hr),r);break}oi(e,Zt,Hr);break;case 5:oi(e,Zt,Hr);break;default:throw Error(q(329))}}}return un(e,at()),e.callbackNode===n?P2.bind(null,e):null}function Wp(e,t){var n=Is;return e.current.memoizedState.isDehydrated&&(yi(e,t).flags|=256),e=Cc(e,t),e!==2&&(t=Zt,Zt=n,t!==null&&Up(t)),e}function Up(e){Zt===null?Zt=e:Zt.push.apply(Zt,e)}function oA(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var o=n[r],i=o.getSnapshot;o=o.value;try{if(!fr(i(),o))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Co(e,t){for(t&=~Ev,t&=~vd,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-lr(t),r=1<<n;e[n]=-1,t&=~r}}function Ly(e){if(ke&6)throw Error(q(327));ba();var t=oc(e,0);if(!(t&1))return un(e,at()),null;var n=Cc(e,t);if(e.tag!==0&&n===2){var r=mp(e);r!==0&&(t=r,n=Wp(e,r))}if(n===1)throw n=ou,yi(e,0),Co(e,t),un(e,at()),n;if(n===6)throw Error(q(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,oi(e,Zt,Hr),un(e,at()),null}function _v(e,t){var n=ke;ke|=1;try{return e(t)}finally{ke=n,ke===0&&(Ba=at()+500,fd&&Yo())}}function ki(e){ko!==null&&ko.tag===0&&!(ke&6)&&ba();var t=ke;ke|=1;var n=qn.transition,r=Pe;try{if(qn.transition=null,Pe=1,e)return e()}finally{Pe=r,qn.transition=n,ke=t,!(ke&6)&&Yo()}}function Rv(){mn=ca.current,We(ca)}function yi(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,MT(n)),dt!==null)for(n=dt.return;n!==null;){var r=n;switch(sv(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&lc();break;case 3:Fa(),We(an),We(Ut),vv();break;case 5:mv(r);break;case 4:Fa();break;case 13:We(Ke);break;case 19:We(Ke);break;case 10:dv(r.type._context);break;case 22:case 23:Rv()}n=n.return}if(St=e,dt=e=Fo(e.current,null),Pt=mn=t,mt=0,ou=null,Ev=vd=Ei=0,Zt=Is=null,fi!==null){for(t=0;t<fi.length;t++)if(n=fi[t],r=n.interleaved,r!==null){n.interleaved=null;var o=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=o,r.next=a}n.pending=r}fi=null}return e}function D2(e,t){do{var n=dt;try{if(cv(),jl.current=yc,gc){for(var r=Qe.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}gc=!1}if(Si=0,Ct=pt=Qe=null,Ts=!1,tu=0,Sv.current=null,n===null||n.return===null){mt=1,ou=t,dt=null;break}e:{var i=e,a=n.return,s=n,u=t;if(t=Pt,s.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var l=u,c=s,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var h=ky(a);if(h!==null){h.flags&=-257,_y(h,a,s,i,t),h.mode&1&&Ey(i,l,t),t=h,u=l;var p=t.updateQueue;if(p===null){var m=new Set;m.add(u),t.updateQueue=m}else p.add(u);break e}else{if(!(t&1)){Ey(i,l,t),Tv();break e}u=Error(q(426))}}else if(Ge&&s.mode&1){var g=ky(a);if(g!==null){!(g.flags&65536)&&(g.flags|=256),_y(g,a,s,i,t),uv(Oa(u,s));break e}}i=u=Oa(u,s),mt!==4&&(mt=2),Is===null?Is=[i]:Is.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var v=v2(i,u,t);yy(i,v);break e;case 1:s=u;var y=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Do===null||!Do.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t;var w=g2(i,s,t);yy(i,w);break e}}i=i.return}while(i!==null)}O2(n)}catch(C){t=C,dt===n&&n!==null&&(dt=n=n.return);continue}break}while(1)}function M2(){var e=xc.current;return xc.current=yc,e===null?yc:e}function Tv(){(mt===0||mt===3||mt===2)&&(mt=4),St===null||!(Ei&268435455)&&!(vd&268435455)||Co(St,Pt)}function Cc(e,t){var n=ke;ke|=2;var r=M2();(St!==e||Pt!==t)&&(Hr=null,yi(e,t));do try{iA();break}catch(o){D2(e,o)}while(1);if(cv(),ke=n,xc.current=r,dt!==null)throw Error(q(261));return St=null,Pt=0,mt}function iA(){for(;dt!==null;)F2(dt)}function aA(){for(;dt!==null&&!NR();)F2(dt)}function F2(e){var t=L2(e.alternate,e,mn);e.memoizedProps=e.pendingProps,t===null?O2(e):dt=t,Sv.current=null}function O2(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=ZT(n,t),n!==null){n.flags&=32767,dt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{mt=6,dt=null;return}}else if(n=JT(n,t,mn),n!==null){dt=n;return}if(t=t.sibling,t!==null){dt=t;return}dt=t=e}while(t!==null);mt===0&&(mt=5)}function oi(e,t,n){var r=Pe,o=qn.transition;try{qn.transition=null,Pe=1,sA(e,t,n,r)}finally{qn.transition=o,Pe=r}return null}function sA(e,t,n,r){do ba();while(ko!==null);if(ke&6)throw Error(q(327));n=e.finishedWork;var o=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(q(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(VR(e,i),e===St&&(dt=St=null,Pt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ul||(ul=!0,j2(rc,function(){return ba(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=qn.transition,qn.transition=null;var a=Pe;Pe=1;var s=ke;ke|=4,Sv.current=null,tA(e,n),I2(n,e),RT(wp),ic=!!bp,wp=bp=null,e.current=n,nA(n),PR(),ke=s,Pe=a,qn.transition=i}else e.current=n;if(ul&&(ul=!1,ko=e,wc=o),i=e.pendingLanes,i===0&&(Do=null),FR(n.stateNode),un(e,at()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(bc)throw bc=!1,e=Vp,Vp=null,e;return wc&1&&e.tag!==0&&ba(),i=e.pendingLanes,i&1?e===$p?Ns++:(Ns=0,$p=e):Ns=0,Yo(),null}function ba(){if(ko!==null){var e=vw(wc),t=qn.transition,n=Pe;try{if(qn.transition=null,Pe=16>e?16:e,ko===null)var r=!1;else{if(e=ko,ko=null,wc=0,ke&6)throw Error(q(331));var o=ke;for(ke|=4,J=e.current;J!==null;){var i=J,a=i.child;if(J.flags&16){var s=i.deletions;if(s!==null){for(var u=0;u<s.length;u++){var l=s[u];for(J=l;J!==null;){var c=J;switch(c.tag){case 0:case 11:case 15:As(8,c,i)}var d=c.child;if(d!==null)d.return=c,J=d;else for(;J!==null;){c=J;var f=c.sibling,h=c.return;if(R2(c),c===l){J=null;break}if(f!==null){f.return=h,J=f;break}J=h}}}var p=i.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}J=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,J=a;else e:for(;J!==null;){if(i=J,i.flags&2048)switch(i.tag){case 0:case 11:case 15:As(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,J=v;break e}J=i.return}}var y=e.current;for(J=y;J!==null;){a=J;var b=a.child;if(a.subtreeFlags&2064&&b!==null)b.return=a,J=b;else e:for(a=y;J!==null;){if(s=J,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:md(9,s)}}catch(C){rt(s,s.return,C)}if(s===a){J=null;break e}var w=s.sibling;if(w!==null){w.return=s.return,J=w;break e}J=s.return}}if(ke=o,Yo(),Ar&&typeof Ar.onPostCommitFiberRoot=="function")try{Ar.onPostCommitFiberRoot(sd,e)}catch{}r=!0}return r}finally{Pe=n,qn.transition=t}}return!1}function jy(e,t,n){t=Oa(n,t),t=v2(e,t,1),e=Po(e,t,1),t=Yt(),e!==null&&(wu(e,1,t),un(e,t))}function rt(e,t,n){if(e.tag===3)jy(e,e,n);else for(;t!==null;){if(t.tag===3){jy(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Do===null||!Do.has(r))){e=Oa(n,e),e=g2(t,e,1),t=Po(t,e,1),e=Yt(),t!==null&&(wu(t,1,e),un(t,e));break}}t=t.return}}function uA(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Yt(),e.pingedLanes|=e.suspendedLanes&n,St===e&&(Pt&n)===n&&(mt===4||mt===3&&(Pt&130023424)===Pt&&500>at()-kv?yi(e,0):Ev|=n),un(e,t)}function B2(e,t){t===0&&(e.mode&1?(t=Ju,Ju<<=1,!(Ju&130023424)&&(Ju=4194304)):t=1);var n=Yt();e=no(e,t),e!==null&&(wu(e,t,n),un(e,n))}function lA(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),B2(e,n)}function cA(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,o=e.memoizedState;o!==null&&(n=o.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(q(314))}r!==null&&r.delete(t),B2(e,n)}var L2;L2=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||an.current)rn=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return rn=!1,QT(e,t,n);rn=!!(e.flags&131072)}else rn=!1,Ge&&t.flags&1048576&&$w(t,fc,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Vl(e,t),e=t.pendingProps;var o=Pa(t,Ut.current);xa(t,n),o=yv(null,t,r,e,o,n);var i=xv();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,sn(r)?(i=!0,cc(t)):i=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,hv(t),o.updater=pd,t.stateNode=o,o._reactInternals=t,Ip(t,r,e,n),t=Dp(null,t,r,!0,i,n)):(t.tag=0,Ge&&i&&av(t),Xt(null,t,o,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Vl(e,t),e=t.pendingProps,o=r._init,r=o(r._payload),t.type=r,o=t.tag=fA(r),e=or(r,e),o){case 0:t=Pp(null,t,r,e,n);break e;case 1:t=Ay(null,t,r,e,n);break e;case 11:t=Ry(null,t,r,e,n);break e;case 14:t=Ty(null,t,r,or(r.type,e),n);break e}throw Error(q(306,r,""))}return t;case 0:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:or(r,o),Pp(e,t,r,o,n);case 1:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:or(r,o),Ay(e,t,r,o,n);case 3:e:{if(w2(t),e===null)throw Error(q(387));r=t.pendingProps,i=t.memoizedState,o=i.element,qw(e,t),mc(t,r,null,n);var a=t.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){o=Oa(Error(q(423)),t),t=Iy(e,t,r,n,o);break e}else if(r!==o){o=Oa(Error(q(424)),t),t=Iy(e,t,r,n,o);break e}else for(xn=No(t.stateNode.containerInfo.firstChild),Sn=t,Ge=!0,ar=null,n=Gw(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Da(),r===o){t=ro(e,t,n);break e}Xt(e,t,r,n)}t=t.child}return t;case 5:return Xw(t),e===null&&Rp(t),r=t.type,o=t.pendingProps,i=e!==null?e.memoizedProps:null,a=o.children,Cp(r,o)?a=null:i!==null&&Cp(r,i)&&(t.flags|=32),b2(e,t),Xt(e,t,a,n),t.child;case 6:return e===null&&Rp(t),null;case 13:return C2(e,t,n);case 4:return pv(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Ma(t,null,r,n):Xt(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:or(r,o),Ry(e,t,r,o,n);case 7:return Xt(e,t,t.pendingProps,n),t.child;case 8:return Xt(e,t,t.pendingProps.children,n),t.child;case 12:return Xt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,o=t.pendingProps,i=t.memoizedProps,a=o.value,Oe(hc,r._currentValue),r._currentValue=a,i!==null)if(fr(i.value,a)){if(i.children===o.children&&!an.current){t=ro(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var s=i.dependencies;if(s!==null){a=i.child;for(var u=s.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Qr(-1,n&-n),u.tag=2;var l=i.updateQueue;if(l!==null){l=l.shared;var c=l.pending;c===null?u.next=u:(u.next=c.next,c.next=u),l.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Tp(i.return,n,t),s.lanes|=n;break}u=u.next}}else if(i.tag===10)a=i.type===t.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(q(341));a.lanes|=n,s=a.alternate,s!==null&&(s.lanes|=n),Tp(a,n,t),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Xt(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=t.pendingProps.children,xa(t,n),o=Xn(o),r=r(o),t.flags|=1,Xt(e,t,r,n),t.child;case 14:return r=t.type,o=or(r,t.pendingProps),o=or(r.type,o),Ty(e,t,r,o,n);case 15:return y2(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:or(r,o),Vl(e,t),t.tag=1,sn(r)?(e=!0,cc(t)):e=!1,xa(t,n),m2(t,r,o),Ip(t,r,o,n),Dp(null,t,r,!0,e,n);case 19:return S2(e,t,n);case 22:return x2(e,t,n)}throw Error(q(156,t.tag))};function j2(e,t){return fw(e,t)}function dA(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Gn(e,t,n,r){return new dA(e,t,n,r)}function Av(e){return e=e.prototype,!(!e||!e.isReactComponent)}function fA(e){if(typeof e=="function")return Av(e)?1:0;if(e!=null){if(e=e.$$typeof,e===qm)return 11;if(e===Xm)return 14}return 2}function Fo(e,t){var n=e.alternate;return n===null?(n=Gn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ul(e,t,n,r,o,i){var a=2;if(r=e,typeof e=="function")Av(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case ea:return xi(n.children,o,i,t);case Km:a=8,o|=8;break;case ep:return e=Gn(12,n,t,o|2),e.elementType=ep,e.lanes=i,e;case tp:return e=Gn(13,n,t,o),e.elementType=tp,e.lanes=i,e;case np:return e=Gn(19,n,t,o),e.elementType=np,e.lanes=i,e;case Xb:return gd(n,o,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Kb:a=10;break e;case qb:a=9;break e;case qm:a=11;break e;case Xm:a=14;break e;case yo:a=16,r=null;break e}throw Error(q(130,e==null?e:typeof e,""))}return t=Gn(a,n,t,o),t.elementType=e,t.type=r,t.lanes=i,t}function xi(e,t,n,r){return e=Gn(7,e,r,t),e.lanes=n,e}function gd(e,t,n,r){return e=Gn(22,e,r,t),e.elementType=Xb,e.lanes=n,e.stateNode={isHidden:!1},e}function th(e,t,n){return e=Gn(6,e,null,t),e.lanes=n,e}function nh(e,t,n){return t=Gn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function hA(e,t,n,r,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Of(0),this.expirationTimes=Of(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Of(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Iv(e,t,n,r,o,i,a,s,u){return e=new hA(e,t,n,s,u),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Gn(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},hv(i),e}function pA(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Zi,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function z2(e){if(!e)return $o;e=e._reactInternals;e:{if(Ai(e)!==e||e.tag!==1)throw Error(q(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(sn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(q(171))}if(e.tag===1){var n=e.type;if(sn(n))return zw(e,n,t)}return t}function V2(e,t,n,r,o,i,a,s,u){return e=Iv(n,r,!0,e,o,i,a,s,u),e.context=z2(null),n=e.current,r=Yt(),o=Mo(n),i=Qr(r,o),i.callback=t??null,Po(n,i,o),e.current.lanes=o,wu(e,o,r),un(e,r),e}function yd(e,t,n,r){var o=t.current,i=Yt(),a=Mo(o);return n=z2(n),t.context===null?t.context=n:t.pendingContext=n,t=Qr(i,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Po(o,t,a),e!==null&&(cr(e,o,a,i),Ll(e,o,a)),a}function Sc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function zy(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Nv(e,t){zy(e,t),(e=e.alternate)&&zy(e,t)}function mA(){return null}var $2=typeof reportError=="function"?reportError:function(e){console.error(e)};function Pv(e){this._internalRoot=e}xd.prototype.render=Pv.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(q(409));yd(e,t,null,null)};xd.prototype.unmount=Pv.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ki(function(){yd(null,e,null,null)}),t[to]=null}};function xd(e){this._internalRoot=e}xd.prototype.unstable_scheduleHydration=function(e){if(e){var t=xw();e={blockedOn:null,target:e,priority:t};for(var n=0;n<wo.length&&t!==0&&t<wo[n].priority;n++);wo.splice(n,0,e),n===0&&ww(e)}};function Dv(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function bd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Vy(){}function vA(e,t,n,r,o){if(o){if(typeof r=="function"){var i=r;r=function(){var l=Sc(a);i.call(l)}}var a=V2(t,r,e,0,null,!1,!1,"",Vy);return e._reactRootContainer=a,e[to]=a.current,Ys(e.nodeType===8?e.parentNode:e),ki(),a}for(;o=e.lastChild;)e.removeChild(o);if(typeof r=="function"){var s=r;r=function(){var l=Sc(u);s.call(l)}}var u=Iv(e,0,!1,null,null,!1,!1,"",Vy);return e._reactRootContainer=u,e[to]=u.current,Ys(e.nodeType===8?e.parentNode:e),ki(function(){yd(t,u,n,r)}),u}function wd(e,t,n,r,o){var i=n._reactRootContainer;if(i){var a=i;if(typeof o=="function"){var s=o;o=function(){var u=Sc(a);s.call(u)}}yd(t,a,e,o)}else a=vA(n,t,e,o,r);return Sc(a)}gw=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=bs(t.pendingLanes);n!==0&&(Jm(t,n|1),un(t,at()),!(ke&6)&&(Ba=at()+500,Yo()))}break;case 13:ki(function(){var r=no(e,1);if(r!==null){var o=Yt();cr(r,e,1,o)}}),Nv(e,1)}};Zm=function(e){if(e.tag===13){var t=no(e,134217728);if(t!==null){var n=Yt();cr(t,e,134217728,n)}Nv(e,134217728)}};yw=function(e){if(e.tag===13){var t=Mo(e),n=no(e,t);if(n!==null){var r=Yt();cr(n,e,t,r)}Nv(e,t)}};xw=function(){return Pe};bw=function(e,t){var n=Pe;try{return Pe=e,t()}finally{Pe=n}};fp=function(e,t,n){switch(t){case"input":if(ip(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=dd(r);if(!o)throw Error(q(90));Qb(r),ip(r,o)}}}break;case"textarea":Zb(e,n);break;case"select":t=n.value,t!=null&&ma(e,!!n.multiple,t,!1)}};aw=_v;sw=ki;var gA={usingClientEntryPoint:!1,Events:[Su,oa,dd,ow,iw,_v]},ls={findFiberByHostInstance:di,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},yA={bundleType:ls.bundleType,version:ls.version,rendererPackageName:ls.rendererPackageName,rendererConfig:ls.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ao.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=cw(e),e===null?null:e.stateNode},findFiberByHostInstance:ls.findFiberByHostInstance||mA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ll=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ll.isDisabled&&ll.supportsFiber)try{sd=ll.inject(yA),Ar=ll}catch{}}Tn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gA;Tn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Dv(t))throw Error(q(200));return pA(e,t,null,n)};Tn.createRoot=function(e,t){if(!Dv(e))throw Error(q(299));var n=!1,r="",o=$2;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=Iv(e,1,!1,null,null,n,!1,r,o),e[to]=t.current,Ys(e.nodeType===8?e.parentNode:e),new Pv(t)};Tn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(q(188)):(e=Object.keys(e).join(","),Error(q(268,e)));return e=cw(t),e=e===null?null:e.stateNode,e};Tn.flushSync=function(e){return ki(e)};Tn.hydrate=function(e,t,n){if(!bd(t))throw Error(q(200));return wd(null,e,t,!0,n)};Tn.hydrateRoot=function(e,t,n){if(!Dv(e))throw Error(q(405));var r=n!=null&&n.hydratedSources||null,o=!1,i="",a=$2;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=V2(t,null,e,1,n??null,o,!1,i,a),e[to]=t.current,Ys(e),r)for(e=0;e<r.length;e++)n=r[e],o=n._getVersion,o=o(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new xd(t)};Tn.render=function(e,t,n){if(!bd(t))throw Error(q(200));return wd(null,e,t,!1,n)};Tn.unmountComponentAtNode=function(e){if(!bd(e))throw Error(q(40));return e._reactRootContainer?(ki(function(){wd(null,null,e,!1,function(){e._reactRootContainer=null,e[to]=null})}),!0):!1};Tn.unstable_batchedUpdates=_v;Tn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!bd(n))throw Error(q(200));if(e==null||e._reactInternals===void 0)throw Error(q(38));return wd(e,t,n,!1,r)};Tn.version="18.3.1-next-f1338f8080-20240426";function W2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(W2)}catch(e){console.error(e)}}W2(),Wb.exports=Tn;var xA=Wb.exports,$y=xA;Jh.createRoot=$y.createRoot,Jh.hydrateRoot=$y.hydrateRoot;const U2=P.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),Cd=P.createContext({}),Sd=P.createContext(null),Ed=typeof document<"u",Mv=Ed?P.useLayoutEffect:P.useEffect,H2=P.createContext({strict:!1}),Fv=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),bA="framerAppearId",G2="data-"+Fv(bA);function wA(e,t,n,r){const{visualElement:o}=P.useContext(Cd),i=P.useContext(H2),a=P.useContext(Sd),s=P.useContext(U2).reducedMotion,u=P.useRef();r=r||i.renderer,!u.current&&r&&(u.current=r(e,{visualState:t,parent:o,props:n,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:s}));const l=u.current;P.useInsertionEffect(()=>{l&&l.update(n,a)});const c=P.useRef(!!(n[G2]&&!window.HandoffComplete));return Mv(()=>{l&&(l.render(),c.current&&l.animationState&&l.animationState.animateChanges())}),P.useEffect(()=>{l&&(l.updateFeatures(),!c.current&&l.animationState&&l.animationState.animateChanges(),c.current&&(c.current=!1,window.HandoffComplete=!0))}),l}function da(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function CA(e,t,n){return P.useCallback(r=>{r&&e.mount&&e.mount(r),t&&(r?t.mount(r):t.unmount()),n&&(typeof n=="function"?n(r):da(n)&&(n.current=r))},[t])}function iu(e){return typeof e=="string"||Array.isArray(e)}function kd(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const Ov=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Bv=["initial",...Ov];function _d(e){return kd(e.animate)||Bv.some(t=>iu(e[t]))}function K2(e){return!!(_d(e)||e.variants)}function SA(e,t){if(_d(e)){const{initial:n,animate:r}=e;return{initial:n===!1||iu(n)?n:void 0,animate:iu(r)?r:void 0}}return e.inherit!==!1?t:{}}function EA(e){const{initial:t,animate:n}=SA(e,P.useContext(Cd));return P.useMemo(()=>({initial:t,animate:n}),[Wy(t),Wy(n)])}function Wy(e){return Array.isArray(e)?e.join(" "):e}const Uy={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},au={};for(const e in Uy)au[e]={isEnabled:t=>Uy[e].some(n=>!!t[n])};function kA(e){for(const t in e)au[t]={...au[t],...e[t]}}const Lv=P.createContext({}),q2=P.createContext({}),_A=Symbol.for("motionComponentSymbol");function RA({preloadedFeatures:e,createVisualElement:t,useRender:n,useVisualState:r,Component:o}){e&&kA(e);function i(s,u){let l;const c={...P.useContext(U2),...s,layoutId:TA(s)},{isStatic:d}=c,f=EA(s),h=r(s,d);if(!d&&Ed){f.visualElement=wA(o,h,c,t);const p=P.useContext(q2),m=P.useContext(H2).strict;f.visualElement&&(l=f.visualElement.loadFeatures(c,m,e,p))}return P.createElement(Cd.Provider,{value:f},l&&f.visualElement?P.createElement(l,{visualElement:f.visualElement,...c}):null,n(o,s,CA(h,f.visualElement,u),h,d,f.visualElement))}const a=P.forwardRef(i);return a[_A]=o,a}function TA({layoutId:e}){const t=P.useContext(Lv).id;return t&&e!==void 0?t+"-"+e:e}function AA(e){function t(r,o={}){return RA(e(r,o))}if(typeof Proxy>"u")return t;const n=new Map;return new Proxy(t,{get:(r,o)=>(n.has(o)||n.set(o,t(o)),n.get(o))})}const IA=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function jv(e){return typeof e!="string"||e.includes("-")?!1:!!(IA.indexOf(e)>-1||/[A-Z]/.test(e))}const Ec={};function NA(e){Object.assign(Ec,e)}const ku=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Ii=new Set(ku);function X2(e,{layout:t,layoutId:n}){return Ii.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!Ec[e]||e==="opacity")}const cn=e=>!!(e&&e.getVelocity),PA={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},DA=ku.length;function MA(e,{enableHardwareAcceleration:t=!0,allowTransformNone:n=!0},r,o){let i="";for(let a=0;a<DA;a++){const s=ku[a];if(e[s]!==void 0){const u=PA[s]||s;i+=`${u}(${e[s]}) `}}return t&&!e.z&&(i+="translateZ(0)"),i=i.trim(),o?i=o(e,r?"":i):n&&r&&(i="none"),i}const Y2=e=>t=>typeof t=="string"&&t.startsWith(e),Q2=Y2("--"),Hp=Y2("var(--"),FA=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,OA=(e,t)=>t&&typeof e=="number"?t.transform(e):e,Wo=(e,t,n)=>Math.min(Math.max(n,e),t),Ni={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Ps={...Ni,transform:e=>Wo(0,1,e)},cl={...Ni,default:1},Ds=e=>Math.round(e*1e5)/1e5,Rd=/(-)?([\d]*\.?[\d])+/g,J2=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,BA=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function _u(e){return typeof e=="string"}const Ru=e=>({test:t=>_u(t)&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),go=Ru("deg"),Nr=Ru("%"),le=Ru("px"),LA=Ru("vh"),jA=Ru("vw"),Hy={...Nr,parse:e=>Nr.parse(e)/100,transform:e=>Nr.transform(e*100)},Gy={...Ni,transform:Math.round},Z2={borderWidth:le,borderTopWidth:le,borderRightWidth:le,borderBottomWidth:le,borderLeftWidth:le,borderRadius:le,radius:le,borderTopLeftRadius:le,borderTopRightRadius:le,borderBottomRightRadius:le,borderBottomLeftRadius:le,width:le,maxWidth:le,height:le,maxHeight:le,size:le,top:le,right:le,bottom:le,left:le,padding:le,paddingTop:le,paddingRight:le,paddingBottom:le,paddingLeft:le,margin:le,marginTop:le,marginRight:le,marginBottom:le,marginLeft:le,rotate:go,rotateX:go,rotateY:go,rotateZ:go,scale:cl,scaleX:cl,scaleY:cl,scaleZ:cl,skew:go,skewX:go,skewY:go,distance:le,translateX:le,translateY:le,translateZ:le,x:le,y:le,z:le,perspective:le,transformPerspective:le,opacity:Ps,originX:Hy,originY:Hy,originZ:le,zIndex:Gy,fillOpacity:Ps,strokeOpacity:Ps,numOctaves:Gy};function zv(e,t,n,r){const{style:o,vars:i,transform:a,transformOrigin:s}=e;let u=!1,l=!1,c=!0;for(const d in t){const f=t[d];if(Q2(d)){i[d]=f;continue}const h=Z2[d],p=OA(f,h);if(Ii.has(d)){if(u=!0,a[d]=p,!c)continue;f!==(h.default||0)&&(c=!1)}else d.startsWith("origin")?(l=!0,s[d]=p):o[d]=p}if(t.transform||(u||r?o.transform=MA(e.transform,n,c,r):o.transform&&(o.transform="none")),l){const{originX:d="50%",originY:f="50%",originZ:h=0}=s;o.transformOrigin=`${d} ${f} ${h}`}}const Vv=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function eC(e,t,n){for(const r in t)!cn(t[r])&&!X2(r,n)&&(e[r]=t[r])}function zA({transformTemplate:e},t,n){return P.useMemo(()=>{const r=Vv();return zv(r,t,{enableHardwareAcceleration:!n},e),Object.assign({},r.vars,r.style)},[t])}function VA(e,t,n){const r=e.style||{},o={};return eC(o,r,e),Object.assign(o,zA(e,t,n)),e.transformValues?e.transformValues(o):o}function $A(e,t,n){const r={},o=VA(e,t,n);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,o.userSelect=o.WebkitUserSelect=o.WebkitTouchCallout="none",o.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=o,r}const WA=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function kc(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||WA.has(e)}let tC=e=>!kc(e);function UA(e){e&&(tC=t=>t.startsWith("on")?!kc(t):e(t))}try{UA(require("@emotion/is-prop-valid").default)}catch{}function HA(e,t,n){const r={};for(const o in e)o==="values"&&typeof e.values=="object"||(tC(o)||n===!0&&kc(o)||!t&&!kc(o)||e.draggable&&o.startsWith("onDrag"))&&(r[o]=e[o]);return r}function Ky(e,t,n){return typeof e=="string"?e:le.transform(t+n*e)}function GA(e,t,n){const r=Ky(t,e.x,e.width),o=Ky(n,e.y,e.height);return`${r} ${o}`}const KA={offset:"stroke-dashoffset",array:"stroke-dasharray"},qA={offset:"strokeDashoffset",array:"strokeDasharray"};function XA(e,t,n=1,r=0,o=!0){e.pathLength=1;const i=o?KA:qA;e[i.offset]=le.transform(-r);const a=le.transform(t),s=le.transform(n);e[i.array]=`${a} ${s}`}function $v(e,{attrX:t,attrY:n,attrScale:r,originX:o,originY:i,pathLength:a,pathSpacing:s=1,pathOffset:u=0,...l},c,d,f){if(zv(e,l,c,f),d){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:h,style:p,dimensions:m}=e;h.transform&&(m&&(p.transform=h.transform),delete h.transform),m&&(o!==void 0||i!==void 0||p.transform)&&(p.transformOrigin=GA(m,o!==void 0?o:.5,i!==void 0?i:.5)),t!==void 0&&(h.x=t),n!==void 0&&(h.y=n),r!==void 0&&(h.scale=r),a!==void 0&&XA(h,a,s,u,!1)}const nC=()=>({...Vv(),attrs:{}}),Wv=e=>typeof e=="string"&&e.toLowerCase()==="svg";function YA(e,t,n,r){const o=P.useMemo(()=>{const i=nC();return $v(i,t,{enableHardwareAcceleration:!1},Wv(r),e.transformTemplate),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};eC(i,e.style,e),o.style={...i,...o.style}}return o}function QA(e=!1){return(n,r,o,{latestValues:i},a)=>{const u=(jv(n)?YA:$A)(r,i,a,n),c={...HA(r,typeof n=="string",e),...u,ref:o},{children:d}=r,f=P.useMemo(()=>cn(d)?d.get():d,[d]);return P.createElement(n,{...c,children:f})}}function rC(e,{style:t,vars:n},r,o){Object.assign(e.style,t,o&&o.getProjectionStyles(r));for(const i in n)e.style.setProperty(i,n[i])}const oC=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function iC(e,t,n,r){rC(e,t,void 0,r);for(const o in t.attrs)e.setAttribute(oC.has(o)?o:Fv(o),t.attrs[o])}function Uv(e,t){const{style:n}=e,r={};for(const o in n)(cn(n[o])||t.style&&cn(t.style[o])||X2(o,e))&&(r[o]=n[o]);return r}function aC(e,t){const n=Uv(e,t);for(const r in e)if(cn(e[r])||cn(t[r])){const o=ku.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;n[o]=e[r]}return n}function Hv(e,t,n,r={},o={}){return typeof t=="function"&&(t=t(n!==void 0?n:e.custom,r,o)),typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"&&(t=t(n!==void 0?n:e.custom,r,o)),t}function sC(e){const t=P.useRef(null);return t.current===null&&(t.current=e()),t.current}const _c=e=>Array.isArray(e),JA=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),ZA=e=>_c(e)?e[e.length-1]||0:e;function Hl(e){const t=cn(e)?e.get():e;return JA(t)?t.toValue():t}function e4({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:n},r,o,i){const a={latestValues:t4(r,o,i,e),renderState:t()};return n&&(a.mount=s=>n(r,s,a)),a}const uC=e=>(t,n)=>{const r=P.useContext(Cd),o=P.useContext(Sd),i=()=>e4(e,t,r,o);return n?i():sC(i)};function t4(e,t,n,r){const o={},i=r(e,{});for(const f in i)o[f]=Hl(i[f]);let{initial:a,animate:s}=e;const u=_d(e),l=K2(e);t&&l&&!u&&e.inherit!==!1&&(a===void 0&&(a=t.initial),s===void 0&&(s=t.animate));let c=n?n.initial===!1:!1;c=c||a===!1;const d=c?s:a;return d&&typeof d!="boolean"&&!kd(d)&&(Array.isArray(d)?d:[d]).forEach(h=>{const p=Hv(e,h);if(!p)return;const{transitionEnd:m,transition:g,...v}=p;for(const y in v){let b=v[y];if(Array.isArray(b)){const w=c?b.length-1:0;b=b[w]}b!==null&&(o[y]=b)}for(const y in m)o[y]=m[y]}),o}const ot=e=>e;class qy{constructor(){this.order=[],this.scheduled=new Set}add(t){if(!this.scheduled.has(t))return this.scheduled.add(t),this.order.push(t),!0}remove(t){const n=this.order.indexOf(t);n!==-1&&(this.order.splice(n,1),this.scheduled.delete(t))}clear(){this.order.length=0,this.scheduled.clear()}}function n4(e){let t=new qy,n=new qy,r=0,o=!1,i=!1;const a=new WeakSet,s={schedule:(u,l=!1,c=!1)=>{const d=c&&o,f=d?t:n;return l&&a.add(u),f.add(u)&&d&&o&&(r=t.order.length),u},cancel:u=>{n.remove(u),a.delete(u)},process:u=>{if(o){i=!0;return}if(o=!0,[t,n]=[n,t],n.clear(),r=t.order.length,r)for(let l=0;l<r;l++){const c=t.order[l];c(u),a.has(c)&&(s.schedule(c),e())}o=!1,i&&(i=!1,s.process(u))}};return s}const dl=["prepare","read","update","preRender","render","postRender"],r4=40;function o4(e,t){let n=!1,r=!0;const o={delta:0,timestamp:0,isProcessing:!1},i=dl.reduce((d,f)=>(d[f]=n4(()=>n=!0),d),{}),a=d=>i[d].process(o),s=()=>{const d=performance.now();n=!1,o.delta=r?1e3/60:Math.max(Math.min(d-o.timestamp,r4),1),o.timestamp=d,o.isProcessing=!0,dl.forEach(a),o.isProcessing=!1,n&&t&&(r=!1,e(s))},u=()=>{n=!0,r=!0,o.isProcessing||e(s)};return{schedule:dl.reduce((d,f)=>{const h=i[f];return d[f]=(p,m=!1,g=!1)=>(n||u(),h.schedule(p,m,g)),d},{}),cancel:d=>dl.forEach(f=>i[f].cancel(d)),state:o,steps:i}}const{schedule:Be,cancel:oo,state:Bt,steps:rh}=o4(typeof requestAnimationFrame<"u"?requestAnimationFrame:ot,!0),i4={useVisualState:uC({scrapeMotionValuesFromProps:aC,createRenderState:nC,onMount:(e,t,{renderState:n,latestValues:r})=>{Be.read(()=>{try{n.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{n.dimensions={x:0,y:0,width:0,height:0}}}),Be.render(()=>{$v(n,r,{enableHardwareAcceleration:!1},Wv(t.tagName),e.transformTemplate),iC(t,n)})}})},a4={useVisualState:uC({scrapeMotionValuesFromProps:Uv,createRenderState:Vv})};function s4(e,{forwardMotionProps:t=!1},n,r){return{...jv(e)?i4:a4,preloadedFeatures:n,useRender:QA(t),createVisualElement:r,Component:e}}function Yr(e,t,n,r={passive:!0}){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}const lC=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function Td(e,t="page"){return{point:{x:e[t+"X"],y:e[t+"Y"]}}}const u4=e=>t=>lC(t)&&e(t,Td(t));function Jr(e,t,n,r){return Yr(e,t,u4(n),r)}const l4=(e,t)=>n=>t(e(n)),Oo=(...e)=>e.reduce(l4);function cC(e){let t=null;return()=>{const n=()=>{t=null};return t===null?(t=e,n):!1}}const Xy=cC("dragHorizontal"),Yy=cC("dragVertical");function dC(e){let t=!1;if(e==="y")t=Yy();else if(e==="x")t=Xy();else{const n=Xy(),r=Yy();n&&r?t=()=>{n(),r()}:(n&&n(),r&&r())}return t}function fC(){const e=dC(!0);return e?(e(),!1):!0}class Qo{constructor(t){this.isMounted=!1,this.node=t}update(){}}function Qy(e,t){const n="pointer"+(t?"enter":"leave"),r="onHover"+(t?"Start":"End"),o=(i,a)=>{if(i.pointerType==="touch"||fC())return;const s=e.getProps();e.animationState&&s.whileHover&&e.animationState.setActive("whileHover",t),s[r]&&Be.update(()=>s[r](i,a))};return Jr(e.current,n,o,{passive:!e.getProps()[r]})}class c4 extends Qo{mount(){this.unmount=Oo(Qy(this.node,!0),Qy(this.node,!1))}unmount(){}}class d4 extends Qo{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Oo(Yr(this.node.current,"focus",()=>this.onFocus()),Yr(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const hC=(e,t)=>t?e===t?!0:hC(e,t.parentElement):!1;function oh(e,t){if(!t)return;const n=new PointerEvent("pointer"+e);t(n,Td(n))}class f4 extends Qo{constructor(){super(...arguments),this.removeStartListeners=ot,this.removeEndListeners=ot,this.removeAccessibleListeners=ot,this.startPointerPress=(t,n)=>{if(this.isPressing)return;this.removeEndListeners();const r=this.node.getProps(),i=Jr(window,"pointerup",(s,u)=>{if(!this.checkPressEnd())return;const{onTap:l,onTapCancel:c,globalTapTarget:d}=this.node.getProps();Be.update(()=>{!d&&!hC(this.node.current,s.target)?c&&c(s,u):l&&l(s,u)})},{passive:!(r.onTap||r.onPointerUp)}),a=Jr(window,"pointercancel",(s,u)=>this.cancelPress(s,u),{passive:!(r.onTapCancel||r.onPointerCancel)});this.removeEndListeners=Oo(i,a),this.startPress(t,n)},this.startAccessiblePress=()=>{const t=i=>{if(i.key!=="Enter"||this.isPressing)return;const a=s=>{s.key!=="Enter"||!this.checkPressEnd()||oh("up",(u,l)=>{const{onTap:c}=this.node.getProps();c&&Be.update(()=>c(u,l))})};this.removeEndListeners(),this.removeEndListeners=Yr(this.node.current,"keyup",a),oh("down",(s,u)=>{this.startPress(s,u)})},n=Yr(this.node.current,"keydown",t),r=()=>{this.isPressing&&oh("cancel",(i,a)=>this.cancelPress(i,a))},o=Yr(this.node.current,"blur",r);this.removeAccessibleListeners=Oo(n,o)}}startPress(t,n){this.isPressing=!0;const{onTapStart:r,whileTap:o}=this.node.getProps();o&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),r&&Be.update(()=>r(t,n))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!fC()}cancelPress(t,n){if(!this.checkPressEnd())return;const{onTapCancel:r}=this.node.getProps();r&&Be.update(()=>r(t,n))}mount(){const t=this.node.getProps(),n=Jr(t.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),r=Yr(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Oo(n,r)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const Gp=new WeakMap,ih=new WeakMap,h4=e=>{const t=Gp.get(e.target);t&&t(e)},p4=e=>{e.forEach(h4)};function m4({root:e,...t}){const n=e||document;ih.has(n)||ih.set(n,{});const r=ih.get(n),o=JSON.stringify(t);return r[o]||(r[o]=new IntersectionObserver(p4,{root:e,...t})),r[o]}function v4(e,t,n){const r=m4(t);return Gp.set(e,n),r.observe(e),()=>{Gp.delete(e),r.unobserve(e)}}const g4={some:0,all:1};class y4 extends Qo{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:r,amount:o="some",once:i}=t,a={root:n?n.current:void 0,rootMargin:r,threshold:typeof o=="number"?o:g4[o]},s=u=>{const{isIntersecting:l}=u;if(this.isInView===l||(this.isInView=l,i&&!l&&this.hasEnteredView))return;l&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",l);const{onViewportEnter:c,onViewportLeave:d}=this.node.getProps(),f=l?c:d;f&&f(u)};return v4(this.node.current,a,s)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(x4(t,n))&&this.startObserver()}unmount(){}}function x4({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const b4={inView:{Feature:y4},tap:{Feature:f4},focus:{Feature:d4},hover:{Feature:c4}};function pC(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function w4(e){const t={};return e.values.forEach((n,r)=>t[r]=n.get()),t}function C4(e){const t={};return e.values.forEach((n,r)=>t[r]=n.getVelocity()),t}function Ad(e,t,n){const r=e.getProps();return Hv(r,t,n!==void 0?n:r.custom,w4(e),C4(e))}let S4=ot,Gv=ot;const Bo=e=>e*1e3,Zr=e=>e/1e3,E4={current:!1},mC=e=>Array.isArray(e)&&typeof e[0]=="number";function vC(e){return!!(!e||typeof e=="string"&&gC[e]||mC(e)||Array.isArray(e)&&e.every(vC))}const Cs=([e,t,n,r])=>`cubic-bezier(${e}, ${t}, ${n}, ${r})`,gC={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Cs([0,.65,.55,1]),circOut:Cs([.55,0,1,.45]),backIn:Cs([.31,.01,.66,-.59]),backOut:Cs([.33,1.53,.69,.99])};function yC(e){if(e)return mC(e)?Cs(e):Array.isArray(e)?e.map(yC):gC[e]}function k4(e,t,n,{delay:r=0,duration:o,repeat:i=0,repeatType:a="loop",ease:s,times:u}={}){const l={[t]:n};u&&(l.offset=u);const c=yC(s);return Array.isArray(c)&&(l.easing=c),e.animate(l,{delay:r,duration:o,easing:Array.isArray(c)?"linear":c,fill:"both",iterations:i+1,direction:a==="reverse"?"alternate":"normal"})}function _4(e,{repeat:t,repeatType:n="loop"}){const r=t&&n!=="loop"&&t%2===1?0:e.length-1;return e[r]}const xC=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,R4=1e-7,T4=12;function A4(e,t,n,r,o){let i,a,s=0;do a=t+(n-t)/2,i=xC(a,r,o)-e,i>0?n=a:t=a;while(Math.abs(i)>R4&&++s<T4);return a}function Tu(e,t,n,r){if(e===t&&n===r)return ot;const o=i=>A4(i,0,1,e,n);return i=>i===0||i===1?i:xC(o(i),t,r)}const I4=Tu(.42,0,1,1),N4=Tu(0,0,.58,1),bC=Tu(.42,0,.58,1),P4=e=>Array.isArray(e)&&typeof e[0]!="number",wC=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,CC=e=>t=>1-e(1-t),Kv=e=>1-Math.sin(Math.acos(e)),SC=CC(Kv),D4=wC(Kv),EC=Tu(.33,1.53,.69,.99),qv=CC(EC),M4=wC(qv),F4=e=>(e*=2)<1?.5*qv(e):.5*(2-Math.pow(2,-10*(e-1))),O4={linear:ot,easeIn:I4,easeInOut:bC,easeOut:N4,circIn:Kv,circInOut:D4,circOut:SC,backIn:qv,backInOut:M4,backOut:EC,anticipate:F4},Jy=e=>{if(Array.isArray(e)){Gv(e.length===4);const[t,n,r,o]=e;return Tu(t,n,r,o)}else if(typeof e=="string")return O4[e];return e},Xv=(e,t)=>n=>!!(_u(n)&&BA.test(n)&&n.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(n,t)),kC=(e,t,n)=>r=>{if(!_u(r))return r;const[o,i,a,s]=r.match(Rd);return{[e]:parseFloat(o),[t]:parseFloat(i),[n]:parseFloat(a),alpha:s!==void 0?parseFloat(s):1}},B4=e=>Wo(0,255,e),ah={...Ni,transform:e=>Math.round(B4(e))},pi={test:Xv("rgb","red"),parse:kC("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:r=1})=>"rgba("+ah.transform(e)+", "+ah.transform(t)+", "+ah.transform(n)+", "+Ds(Ps.transform(r))+")"};function L4(e){let t="",n="",r="",o="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),o=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),o=e.substring(4,5),t+=t,n+=n,r+=r,o+=o),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:o?parseInt(o,16)/255:1}}const Kp={test:Xv("#"),parse:L4,transform:pi.transform},fa={test:Xv("hsl","hue"),parse:kC("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:r=1})=>"hsla("+Math.round(e)+", "+Nr.transform(Ds(t))+", "+Nr.transform(Ds(n))+", "+Ds(Ps.transform(r))+")"},qt={test:e=>pi.test(e)||Kp.test(e)||fa.test(e),parse:e=>pi.test(e)?pi.parse(e):fa.test(e)?fa.parse(e):Kp.parse(e),transform:e=>_u(e)?e:e.hasOwnProperty("red")?pi.transform(e):fa.transform(e)},Xe=(e,t,n)=>-n*e+n*t+e;function sh(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function j4({hue:e,saturation:t,lightness:n,alpha:r}){e/=360,t/=100,n/=100;let o=0,i=0,a=0;if(!t)o=i=a=n;else{const s=n<.5?n*(1+t):n+t-n*t,u=2*n-s;o=sh(u,s,e+1/3),i=sh(u,s,e),a=sh(u,s,e-1/3)}return{red:Math.round(o*255),green:Math.round(i*255),blue:Math.round(a*255),alpha:r}}const uh=(e,t,n)=>{const r=e*e;return Math.sqrt(Math.max(0,n*(t*t-r)+r))},z4=[Kp,pi,fa],V4=e=>z4.find(t=>t.test(e));function Zy(e){const t=V4(e);let n=t.parse(e);return t===fa&&(n=j4(n)),n}const _C=(e,t)=>{const n=Zy(e),r=Zy(t),o={...n};return i=>(o.red=uh(n.red,r.red,i),o.green=uh(n.green,r.green,i),o.blue=uh(n.blue,r.blue,i),o.alpha=Xe(n.alpha,r.alpha,i),pi.transform(o))};function $4(e){var t,n;return isNaN(e)&&_u(e)&&(((t=e.match(Rd))===null||t===void 0?void 0:t.length)||0)+(((n=e.match(J2))===null||n===void 0?void 0:n.length)||0)>0}const RC={regex:FA,countKey:"Vars",token:"${v}",parse:ot},TC={regex:J2,countKey:"Colors",token:"${c}",parse:qt.parse},AC={regex:Rd,countKey:"Numbers",token:"${n}",parse:Ni.parse};function lh(e,{regex:t,countKey:n,token:r,parse:o}){const i=e.tokenised.match(t);i&&(e["num"+n]=i.length,e.tokenised=e.tokenised.replace(t,r),e.values.push(...i.map(o)))}function Rc(e){const t=e.toString(),n={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return n.value.includes("var(--")&&lh(n,RC),lh(n,TC),lh(n,AC),n}function IC(e){return Rc(e).values}function NC(e){const{values:t,numColors:n,numVars:r,tokenised:o}=Rc(e),i=t.length;return a=>{let s=o;for(let u=0;u<i;u++)u<r?s=s.replace(RC.token,a[u]):u<r+n?s=s.replace(TC.token,qt.transform(a[u])):s=s.replace(AC.token,Ds(a[u]));return s}}const W4=e=>typeof e=="number"?0:e;function U4(e){const t=IC(e);return NC(e)(t.map(W4))}const Uo={test:$4,parse:IC,createTransformer:NC,getAnimatableNone:U4},PC=(e,t)=>n=>`${n>0?t:e}`;function DC(e,t){return typeof e=="number"?n=>Xe(e,t,n):qt.test(e)?_C(e,t):e.startsWith("var(")?PC(e,t):FC(e,t)}const MC=(e,t)=>{const n=[...e],r=n.length,o=e.map((i,a)=>DC(i,t[a]));return i=>{for(let a=0;a<r;a++)n[a]=o[a](i);return n}},H4=(e,t)=>{const n={...e,...t},r={};for(const o in n)e[o]!==void 0&&t[o]!==void 0&&(r[o]=DC(e[o],t[o]));return o=>{for(const i in r)n[i]=r[i](o);return n}},FC=(e,t)=>{const n=Uo.createTransformer(t),r=Rc(e),o=Rc(t);return r.numVars===o.numVars&&r.numColors===o.numColors&&r.numNumbers>=o.numNumbers?Oo(MC(r.values,o.values),n):PC(e,t)},su=(e,t,n)=>{const r=t-e;return r===0?1:(n-e)/r},e1=(e,t)=>n=>Xe(e,t,n);function G4(e){return typeof e=="number"?e1:typeof e=="string"?qt.test(e)?_C:FC:Array.isArray(e)?MC:typeof e=="object"?H4:e1}function K4(e,t,n){const r=[],o=n||G4(e[0]),i=e.length-1;for(let a=0;a<i;a++){let s=o(e[a],e[a+1]);if(t){const u=Array.isArray(t)?t[a]||ot:t;s=Oo(u,s)}r.push(s)}return r}function OC(e,t,{clamp:n=!0,ease:r,mixer:o}={}){const i=e.length;if(Gv(i===t.length),i===1)return()=>t[0];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const a=K4(t,r,o),s=a.length,u=l=>{let c=0;if(s>1)for(;c<e.length-2&&!(l<e[c+1]);c++);const d=su(e[c],e[c+1],l);return a[c](d)};return n?l=>u(Wo(e[0],e[i-1],l)):u}function q4(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const o=su(0,t,r);e.push(Xe(n,1,o))}}function X4(e){const t=[0];return q4(t,e.length-1),t}function Y4(e,t){return e.map(n=>n*t)}function Q4(e,t){return e.map(()=>t||bC).splice(0,e.length-1)}function Tc({duration:e=300,keyframes:t,times:n,ease:r="easeInOut"}){const o=P4(r)?r.map(Jy):Jy(r),i={done:!1,value:t[0]},a=Y4(n&&n.length===t.length?n:X4(t),e),s=OC(a,t,{ease:Array.isArray(o)?o:Q4(t,o)});return{calculatedDuration:e,next:u=>(i.value=s(u),i.done=u>=e,i)}}function BC(e,t){return t?e*(1e3/t):0}const J4=5;function LC(e,t,n){const r=Math.max(t-J4,0);return BC(n-e(r),t-r)}const ch=.001,Z4=.01,t1=10,eI=.05,tI=1;function nI({duration:e=800,bounce:t=.25,velocity:n=0,mass:r=1}){let o,i;S4(e<=Bo(t1));let a=1-t;a=Wo(eI,tI,a),e=Wo(Z4,t1,Zr(e)),a<1?(o=l=>{const c=l*a,d=c*e,f=c-n,h=qp(l,a),p=Math.exp(-d);return ch-f/h*p},i=l=>{const d=l*a*e,f=d*n+n,h=Math.pow(a,2)*Math.pow(l,2)*e,p=Math.exp(-d),m=qp(Math.pow(l,2),a);return(-o(l)+ch>0?-1:1)*((f-h)*p)/m}):(o=l=>{const c=Math.exp(-l*e),d=(l-n)*e+1;return-ch+c*d},i=l=>{const c=Math.exp(-l*e),d=(n-l)*(e*e);return c*d});const s=5/e,u=oI(o,i,s);if(e=Bo(e),isNaN(u))return{stiffness:100,damping:10,duration:e};{const l=Math.pow(u,2)*r;return{stiffness:l,damping:a*2*Math.sqrt(r*l),duration:e}}}const rI=12;function oI(e,t,n){let r=n;for(let o=1;o<rI;o++)r=r-e(r)/t(r);return r}function qp(e,t){return e*Math.sqrt(1-t*t)}const iI=["duration","bounce"],aI=["stiffness","damping","mass"];function n1(e,t){return t.some(n=>e[n]!==void 0)}function sI(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!n1(e,aI)&&n1(e,iI)){const n=nI(e);t={...t,...n,mass:1},t.isResolvedFromDuration=!0}return t}function jC({keyframes:e,restDelta:t,restSpeed:n,...r}){const o=e[0],i=e[e.length-1],a={done:!1,value:o},{stiffness:s,damping:u,mass:l,duration:c,velocity:d,isResolvedFromDuration:f}=sI({...r,velocity:-Zr(r.velocity||0)}),h=d||0,p=u/(2*Math.sqrt(s*l)),m=i-o,g=Zr(Math.sqrt(s/l)),v=Math.abs(m)<5;n||(n=v?.01:2),t||(t=v?.005:.5);let y;if(p<1){const b=qp(g,p);y=w=>{const C=Math.exp(-p*g*w);return i-C*((h+p*g*m)/b*Math.sin(b*w)+m*Math.cos(b*w))}}else if(p===1)y=b=>i-Math.exp(-g*b)*(m+(h+g*m)*b);else{const b=g*Math.sqrt(p*p-1);y=w=>{const C=Math.exp(-p*g*w),S=Math.min(b*w,300);return i-C*((h+p*g*m)*Math.sinh(S)+b*m*Math.cosh(S))/b}}return{calculatedDuration:f&&c||null,next:b=>{const w=y(b);if(f)a.done=b>=c;else{let C=h;b!==0&&(p<1?C=LC(y,b,w):C=0);const S=Math.abs(C)<=n,E=Math.abs(i-w)<=t;a.done=S&&E}return a.value=a.done?i:w,a}}}function r1({keyframes:e,velocity:t=0,power:n=.8,timeConstant:r=325,bounceDamping:o=10,bounceStiffness:i=500,modifyTarget:a,min:s,max:u,restDelta:l=.5,restSpeed:c}){const d=e[0],f={done:!1,value:d},h=k=>s!==void 0&&k<s||u!==void 0&&k>u,p=k=>s===void 0?u:u===void 0||Math.abs(s-k)<Math.abs(u-k)?s:u;let m=n*t;const g=d+m,v=a===void 0?g:a(g);v!==g&&(m=v-d);const y=k=>-m*Math.exp(-k/r),b=k=>v+y(k),w=k=>{const R=y(k),_=b(k);f.done=Math.abs(R)<=l,f.value=f.done?v:_};let C,S;const E=k=>{h(f.value)&&(C=k,S=jC({keyframes:[f.value,p(f.value)],velocity:LC(b,k,f.value),damping:o,stiffness:i,restDelta:l,restSpeed:c}))};return E(0),{calculatedDuration:null,next:k=>{let R=!1;return!S&&C===void 0&&(R=!0,w(k),E(k)),C!==void 0&&k>C?S.next(k-C):(!R&&w(k),f)}}}const uI=e=>{const t=({timestamp:n})=>e(n);return{start:()=>Be.update(t,!0),stop:()=>oo(t),now:()=>Bt.isProcessing?Bt.timestamp:performance.now()}},o1=2e4;function i1(e){let t=0;const n=50;let r=e.next(t);for(;!r.done&&t<o1;)t+=n,r=e.next(t);return t>=o1?1/0:t}const lI={decay:r1,inertia:r1,tween:Tc,keyframes:Tc,spring:jC};function Ac({autoplay:e=!0,delay:t=0,driver:n=uI,keyframes:r,type:o="keyframes",repeat:i=0,repeatDelay:a=0,repeatType:s="loop",onPlay:u,onStop:l,onComplete:c,onUpdate:d,...f}){let h=1,p=!1,m,g;const v=()=>{g=new Promise(G=>{m=G})};v();let y;const b=lI[o]||Tc;let w;b!==Tc&&typeof r[0]!="number"&&(w=OC([0,100],r,{clamp:!1}),r=[0,100]);const C=b({...f,keyframes:r});let S;s==="mirror"&&(S=b({...f,keyframes:[...r].reverse(),velocity:-(f.velocity||0)}));let E="idle",k=null,R=null,_=null;C.calculatedDuration===null&&i&&(C.calculatedDuration=i1(C));const{calculatedDuration:N}=C;let I=1/0,L=1/0;N!==null&&(I=N+a,L=I*(i+1)-a);let O=0;const V=G=>{if(R===null)return;h>0&&(R=Math.min(R,G)),h<0&&(R=Math.min(G-L/h,R)),k!==null?O=k:O=Math.round(G-R)*h;const X=O-t*(h>=0?1:-1),te=h>=0?X<0:X>L;O=Math.max(X,0),E==="finished"&&k===null&&(O=L);let ae=O,ue=C;if(i){const ce=Math.min(O,L)/I;let Me=Math.floor(ce),he=ce%1;!he&&ce>=1&&(he=1),he===1&&Me--,Me=Math.min(Me,i+1),!!(Me%2)&&(s==="reverse"?(he=1-he,a&&(he-=a/I)):s==="mirror"&&(ue=S)),ae=Wo(0,1,he)*I}const se=te?{done:!1,value:r[0]}:ue.next(ae);w&&(se.value=w(se.value));let{done:me}=se;!te&&N!==null&&(me=h>=0?O>=L:O<=0);const xe=k===null&&(E==="finished"||E==="running"&&me);return d&&d(se.value),xe&&M(),se},$=()=>{y&&y.stop(),y=void 0},U=()=>{E="idle",$(),m(),v(),R=_=null},M=()=>{E="finished",c&&c(),$(),m()},B=()=>{if(p)return;y||(y=n(V));const G=y.now();u&&u(),k!==null?R=G-k:(!R||E==="finished")&&(R=G),E==="finished"&&v(),_=R,k=null,E="running",y.start()};e&&B();const z={then(G,X){return g.then(G,X)},get time(){return Zr(O)},set time(G){G=Bo(G),O=G,k!==null||!y||h===0?k=G:R=y.now()-G/h},get duration(){const G=C.calculatedDuration===null?i1(C):C.calculatedDuration;return Zr(G)},get speed(){return h},set speed(G){G===h||!y||(h=G,z.time=Zr(O))},get state(){return E},play:B,pause:()=>{E="paused",k=O},stop:()=>{p=!0,E!=="idle"&&(E="idle",l&&l(),U())},cancel:()=>{_!==null&&V(_),U()},complete:()=>{E="finished"},sample:G=>(R=0,V(G))};return z}function cI(e){let t;return()=>(t===void 0&&(t=e()),t)}const dI=cI(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),fI=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),fl=10,hI=2e4,pI=(e,t)=>t.type==="spring"||e==="backgroundColor"||!vC(t.ease);function mI(e,t,{onUpdate:n,onComplete:r,...o}){if(!(dI()&&fI.has(t)&&!o.repeatDelay&&o.repeatType!=="mirror"&&o.damping!==0&&o.type!=="inertia"))return!1;let a=!1,s,u,l=!1;const c=()=>{u=new Promise(b=>{s=b})};c();let{keyframes:d,duration:f=300,ease:h,times:p}=o;if(pI(t,o)){const b=Ac({...o,repeat:0,delay:0});let w={done:!1,value:d[0]};const C=[];let S=0;for(;!w.done&&S<hI;)w=b.sample(S),C.push(w.value),S+=fl;p=void 0,d=C,f=S-fl,h="linear"}const m=k4(e.owner.current,t,d,{...o,duration:f,ease:h,times:p}),g=()=>{l=!1,m.cancel()},v=()=>{l=!0,Be.update(g),s(),c()};return m.onfinish=()=>{l||(e.set(_4(d,o)),r&&r(),v())},{then(b,w){return u.then(b,w)},attachTimeline(b){return m.timeline=b,m.onfinish=null,ot},get time(){return Zr(m.currentTime||0)},set time(b){m.currentTime=Bo(b)},get speed(){return m.playbackRate},set speed(b){m.playbackRate=b},get duration(){return Zr(f)},play:()=>{a||(m.play(),oo(g))},pause:()=>m.pause(),stop:()=>{if(a=!0,m.playState==="idle")return;const{currentTime:b}=m;if(b){const w=Ac({...o,autoplay:!1});e.setWithVelocity(w.sample(b-fl).value,w.sample(b).value,fl)}v()},complete:()=>{l||m.finish()},cancel:v}}function vI({keyframes:e,delay:t,onUpdate:n,onComplete:r}){const o=()=>(n&&n(e[e.length-1]),r&&r(),{time:0,speed:1,duration:0,play:ot,pause:ot,stop:ot,then:i=>(i(),Promise.resolve()),cancel:ot,complete:ot});return t?Ac({keyframes:[0,1],duration:0,delay:t,onComplete:o}):o()}const gI={type:"spring",stiffness:500,damping:25,restSpeed:10},yI=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),xI={type:"keyframes",duration:.8},bI={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},wI=(e,{keyframes:t})=>t.length>2?xI:Ii.has(e)?e.startsWith("scale")?yI(t[1]):gI:bI,Xp=(e,t)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Uo.test(t)||t==="0")&&!t.startsWith("url(")),CI=new Set(["brightness","contrast","saturate","opacity"]);function SI(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[r]=n.match(Rd)||[];if(!r)return e;const o=n.replace(r,"");let i=CI.has(t)?1:0;return r!==n&&(i*=100),t+"("+i+o+")"}const EI=/([a-z-]*)\(.*?\)/g,Yp={...Uo,getAnimatableNone:e=>{const t=e.match(EI);return t?t.map(SI).join(" "):e}},kI={...Z2,color:qt,backgroundColor:qt,outlineColor:qt,fill:qt,stroke:qt,borderColor:qt,borderTopColor:qt,borderRightColor:qt,borderBottomColor:qt,borderLeftColor:qt,filter:Yp,WebkitFilter:Yp},Yv=e=>kI[e];function zC(e,t){let n=Yv(e);return n!==Yp&&(n=Uo),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const VC=e=>/^0[^.\s]+$/.test(e);function _I(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||VC(e)}function RI(e,t,n,r){const o=Xp(t,n);let i;Array.isArray(n)?i=[...n]:i=[null,n];const a=r.from!==void 0?r.from:e.get();let s;const u=[];for(let l=0;l<i.length;l++)i[l]===null&&(i[l]=l===0?a:i[l-1]),_I(i[l])&&u.push(l),typeof i[l]=="string"&&i[l]!=="none"&&i[l]!=="0"&&(s=i[l]);if(o&&u.length&&s)for(let l=0;l<u.length;l++){const c=u[l];i[c]=zC(t,s)}return i}function TI({when:e,delay:t,delayChildren:n,staggerChildren:r,staggerDirection:o,repeat:i,repeatType:a,repeatDelay:s,from:u,elapsed:l,...c}){return!!Object.keys(c).length}function Qv(e,t){return e[t]||e.default||e}const AI={skipAnimations:!1},Jv=(e,t,n,r={})=>o=>{const i=Qv(r,e)||{},a=i.delay||r.delay||0;let{elapsed:s=0}=r;s=s-Bo(a);const u=RI(t,e,n,i),l=u[0],c=u[u.length-1],d=Xp(e,l),f=Xp(e,c);let h={keyframes:u,velocity:t.getVelocity(),ease:"easeOut",...i,delay:-s,onUpdate:p=>{t.set(p),i.onUpdate&&i.onUpdate(p)},onComplete:()=>{o(),i.onComplete&&i.onComplete()}};if(TI(i)||(h={...h,...wI(e,h)}),h.duration&&(h.duration=Bo(h.duration)),h.repeatDelay&&(h.repeatDelay=Bo(h.repeatDelay)),!d||!f||E4.current||i.type===!1||AI.skipAnimations)return vI(h);if(!r.isHandoff&&t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const p=mI(t,e,h);if(p)return p}return Ac(h)};function Ic(e){return!!(cn(e)&&e.add)}const $C=e=>/^\-?\d*\.?\d+$/.test(e);function Zv(e,t){e.indexOf(t)===-1&&e.push(t)}function eg(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class tg{constructor(){this.subscriptions=[]}add(t){return Zv(this.subscriptions,t),()=>eg(this.subscriptions,t)}notify(t,n,r){const o=this.subscriptions.length;if(o)if(o===1)this.subscriptions[0](t,n,r);else for(let i=0;i<o;i++){const a=this.subscriptions[i];a&&a(t,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const II=e=>!isNaN(parseFloat(e));class NI{constructor(t,n={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(r,o=!0)=>{this.prev=this.current,this.current=r;const{delta:i,timestamp:a}=Bt;this.lastUpdated!==a&&(this.timeDelta=i,this.lastUpdated=a,Be.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),o&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>Be.postRender(this.velocityCheck),this.velocityCheck=({timestamp:r})=>{r!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=II(this.current),this.owner=n.owner}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new tg);const r=this.events[t].add(n);return t==="change"?()=>{r(),Be.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t,n=!0){!n||!this.passiveEffect?this.updateAndNotify(t,n):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,n,r){this.set(n),this.prev=t,this.timeDelta=r}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?BC(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function La(e,t){return new NI(e,t)}const WC=e=>t=>t.test(e),PI={test:e=>e==="auto",parse:e=>e},UC=[Ni,le,Nr,go,jA,LA,PI],cs=e=>UC.find(WC(e)),DI=[...UC,qt,Uo],MI=e=>DI.find(WC(e));function FI(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,La(n))}function OI(e,t){const n=Ad(e,t);let{transitionEnd:r={},transition:o={},...i}=n?e.makeTargetAnimatable(n,!1):{};i={...i,...r};for(const a in i){const s=ZA(i[a]);FI(e,a,s)}}function BI(e,t,n){var r,o;const i=Object.keys(t).filter(s=>!e.hasValue(s)),a=i.length;if(a)for(let s=0;s<a;s++){const u=i[s],l=t[u];let c=null;Array.isArray(l)&&(c=l[0]),c===null&&(c=(o=(r=n[u])!==null&&r!==void 0?r:e.readValue(u))!==null&&o!==void 0?o:t[u]),c!=null&&(typeof c=="string"&&($C(c)||VC(c))?c=parseFloat(c):!MI(c)&&Uo.test(l)&&(c=zC(u,l)),e.addValue(u,La(c,{owner:e})),n[u]===void 0&&(n[u]=c),c!==null&&e.setBaseTarget(u,c))}}function LI(e,t){return t?(t[e]||t.default||t).from:void 0}function jI(e,t,n){const r={};for(const o in e){const i=LI(o,t);if(i!==void 0)r[o]=i;else{const a=n.getValue(o);a&&(r[o]=a.get())}}return r}function zI({protectedKeys:e,needsAnimating:t},n){const r=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,r}function VI(e,t){const n=e.get();if(Array.isArray(t)){for(let r=0;r<t.length;r++)if(t[r]!==n)return!0}else return n!==t}function HC(e,t,{delay:n=0,transitionOverride:r,type:o}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:a,...s}=e.makeTargetAnimatable(t);const u=e.getValue("willChange");r&&(i=r);const l=[],c=o&&e.animationState&&e.animationState.getState()[o];for(const d in s){const f=e.getValue(d),h=s[d];if(!f||h===void 0||c&&zI(c,d))continue;const p={delay:n,elapsed:0,...Qv(i||{},d)};if(window.HandoffAppearAnimations){const v=e.getProps()[G2];if(v){const y=window.HandoffAppearAnimations(v,d,f,Be);y!==null&&(p.elapsed=y,p.isHandoff=!0)}}let m=!p.isHandoff&&!VI(f,h);if(p.type==="spring"&&(f.getVelocity()||p.velocity)&&(m=!1),f.animation&&(m=!1),m)continue;f.start(Jv(d,f,h,e.shouldReduceMotion&&Ii.has(d)?{type:!1}:p));const g=f.animation;Ic(u)&&(u.add(d),g.then(()=>u.remove(d))),l.push(g)}return a&&Promise.all(l).then(()=>{a&&OI(e,a)}),l}function Qp(e,t,n={}){const r=Ad(e,t,n.custom);let{transition:o=e.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(o=n.transitionOverride);const i=r?()=>Promise.all(HC(e,r,n)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?(u=0)=>{const{delayChildren:l=0,staggerChildren:c,staggerDirection:d}=o;return $I(e,t,l+u,c,d,n)}:()=>Promise.resolve(),{when:s}=o;if(s){const[u,l]=s==="beforeChildren"?[i,a]:[a,i];return u().then(()=>l())}else return Promise.all([i(),a(n.delay)])}function $I(e,t,n=0,r=0,o=1,i){const a=[],s=(e.variantChildren.size-1)*r,u=o===1?(l=0)=>l*r:(l=0)=>s-l*r;return Array.from(e.variantChildren).sort(WI).forEach((l,c)=>{l.notify("AnimationStart",t),a.push(Qp(l,t,{...i,delay:n+u(c)}).then(()=>l.notify("AnimationComplete",t)))}),Promise.all(a)}function WI(e,t){return e.sortNodePosition(t)}function UI(e,t,n={}){e.notify("AnimationStart",t);let r;if(Array.isArray(t)){const o=t.map(i=>Qp(e,i,n));r=Promise.all(o)}else if(typeof t=="string")r=Qp(e,t,n);else{const o=typeof t=="function"?Ad(e,t,n.custom):t;r=Promise.all(HC(e,o,n))}return r.then(()=>e.notify("AnimationComplete",t))}const HI=[...Ov].reverse(),GI=Ov.length;function KI(e){return t=>Promise.all(t.map(({animation:n,options:r})=>UI(e,n,r)))}function qI(e){let t=KI(e);const n=YI();let r=!0;const o=(u,l)=>{const c=Ad(e,l);if(c){const{transition:d,transitionEnd:f,...h}=c;u={...u,...h,...f}}return u};function i(u){t=u(e)}function a(u,l){const c=e.getProps(),d=e.getVariantContext(!0)||{},f=[],h=new Set;let p={},m=1/0;for(let v=0;v<GI;v++){const y=HI[v],b=n[y],w=c[y]!==void 0?c[y]:d[y],C=iu(w),S=y===l?b.isActive:null;S===!1&&(m=v);let E=w===d[y]&&w!==c[y]&&C;if(E&&r&&e.manuallyAnimateOnMount&&(E=!1),b.protectedKeys={...p},!b.isActive&&S===null||!w&&!b.prevProp||kd(w)||typeof w=="boolean")continue;let R=XI(b.prevProp,w)||y===l&&b.isActive&&!E&&C||v>m&&C,_=!1;const N=Array.isArray(w)?w:[w];let I=N.reduce(o,{});S===!1&&(I={});const{prevResolvedValues:L={}}=b,O={...L,...I},V=$=>{R=!0,h.has($)&&(_=!0,h.delete($)),b.needsAnimating[$]=!0};for(const $ in O){const U=I[$],M=L[$];if(p.hasOwnProperty($))continue;let B=!1;_c(U)&&_c(M)?B=!pC(U,M):B=U!==M,B?U!==void 0?V($):h.add($):U!==void 0&&h.has($)?V($):b.protectedKeys[$]=!0}b.prevProp=w,b.prevResolvedValues=I,b.isActive&&(p={...p,...I}),r&&e.blockInitialAnimation&&(R=!1),R&&(!E||_)&&f.push(...N.map($=>({animation:$,options:{type:y,...u}})))}if(h.size){const v={};h.forEach(y=>{const b=e.getBaseTarget(y);b!==void 0&&(v[y]=b)}),f.push({animation:v})}let g=!!f.length;return r&&(c.initial===!1||c.initial===c.animate)&&!e.manuallyAnimateOnMount&&(g=!1),r=!1,g?t(f):Promise.resolve()}function s(u,l,c){var d;if(n[u].isActive===l)return Promise.resolve();(d=e.variantChildren)===null||d===void 0||d.forEach(h=>{var p;return(p=h.animationState)===null||p===void 0?void 0:p.setActive(u,l)}),n[u].isActive=l;const f=a(c,u);for(const h in n)n[h].protectedKeys={};return f}return{animateChanges:a,setActive:s,setAnimateFunction:i,getState:()=>n}}function XI(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!pC(t,e):!1}function ti(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function YI(){return{animate:ti(!0),whileInView:ti(),whileHover:ti(),whileTap:ti(),whileDrag:ti(),whileFocus:ti(),exit:ti()}}class QI extends Qo{constructor(t){super(t),t.animationState||(t.animationState=qI(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();this.unmount(),kd(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){}}let JI=0;class ZI extends Qo{constructor(){super(...arguments),this.id=JI++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n,custom:r}=this.node.presenceContext,{isPresent:o}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===o)return;const i=this.node.animationState.setActive("exit",!t,{custom:r??this.node.getProps().custom});n&&!t&&i.then(()=>n(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const eN={animation:{Feature:QI},exit:{Feature:ZI}},a1=(e,t)=>Math.abs(e-t);function tN(e,t){const n=a1(e.x,t.x),r=a1(e.y,t.y);return Math.sqrt(n**2+r**2)}class GC{constructor(t,n,{transformPagePoint:r,contextWindow:o,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const d=fh(this.lastMoveEventInfo,this.history),f=this.startEvent!==null,h=tN(d.offset,{x:0,y:0})>=3;if(!f&&!h)return;const{point:p}=d,{timestamp:m}=Bt;this.history.push({...p,timestamp:m});const{onStart:g,onMove:v}=this.handlers;f||(g&&g(this.lastMoveEvent,d),this.startEvent=this.lastMoveEvent),v&&v(this.lastMoveEvent,d)},this.handlePointerMove=(d,f)=>{this.lastMoveEvent=d,this.lastMoveEventInfo=dh(f,this.transformPagePoint),Be.update(this.updatePoint,!0)},this.handlePointerUp=(d,f)=>{this.end();const{onEnd:h,onSessionEnd:p,resumeAnimation:m}=this.handlers;if(this.dragSnapToOrigin&&m&&m(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=fh(d.type==="pointercancel"?this.lastMoveEventInfo:dh(f,this.transformPagePoint),this.history);this.startEvent&&h&&h(d,g),p&&p(d,g)},!lC(t))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=r,this.contextWindow=o||window;const a=Td(t),s=dh(a,this.transformPagePoint),{point:u}=s,{timestamp:l}=Bt;this.history=[{...u,timestamp:l}];const{onSessionStart:c}=n;c&&c(t,fh(s,this.history)),this.removeListeners=Oo(Jr(this.contextWindow,"pointermove",this.handlePointerMove),Jr(this.contextWindow,"pointerup",this.handlePointerUp),Jr(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),oo(this.updatePoint)}}function dh(e,t){return t?{point:t(e.point)}:e}function s1(e,t){return{x:e.x-t.x,y:e.y-t.y}}function fh({point:e},t){return{point:e,delta:s1(e,KC(t)),offset:s1(e,nN(t)),velocity:rN(t,.1)}}function nN(e){return e[0]}function KC(e){return e[e.length-1]}function rN(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null;const o=KC(e);for(;n>=0&&(r=e[n],!(o.timestamp-r.timestamp>Bo(t)));)n--;if(!r)return{x:0,y:0};const i=Zr(o.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const a={x:(o.x-r.x)/i,y:(o.y-r.y)/i};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function Rn(e){return e.max-e.min}function Jp(e,t=0,n=.01){return Math.abs(e-t)<=n}function u1(e,t,n,r=.5){e.origin=r,e.originPoint=Xe(t.min,t.max,e.origin),e.scale=Rn(n)/Rn(t),(Jp(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=Xe(n.min,n.max,e.origin)-e.originPoint,(Jp(e.translate)||isNaN(e.translate))&&(e.translate=0)}function Ms(e,t,n,r){u1(e.x,t.x,n.x,r?r.originX:void 0),u1(e.y,t.y,n.y,r?r.originY:void 0)}function l1(e,t,n){e.min=n.min+t.min,e.max=e.min+Rn(t)}function oN(e,t,n){l1(e.x,t.x,n.x),l1(e.y,t.y,n.y)}function c1(e,t,n){e.min=t.min-n.min,e.max=e.min+Rn(t)}function Fs(e,t,n){c1(e.x,t.x,n.x),c1(e.y,t.y,n.y)}function iN(e,{min:t,max:n},r){return t!==void 0&&e<t?e=r?Xe(t,e,r.min):Math.max(e,t):n!==void 0&&e>n&&(e=r?Xe(n,e,r.max):Math.min(e,n)),e}function d1(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function aN(e,{top:t,left:n,bottom:r,right:o}){return{x:d1(e.x,n,o),y:d1(e.y,t,r)}}function f1(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}function sN(e,t){return{x:f1(e.x,t.x),y:f1(e.y,t.y)}}function uN(e,t){let n=.5;const r=Rn(e),o=Rn(t);return o>r?n=su(t.min,t.max-r,e.min):r>o&&(n=su(e.min,e.max-o,t.min)),Wo(0,1,n)}function lN(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const Zp=.35;function cN(e=Zp){return e===!1?e=0:e===!0&&(e=Zp),{x:h1(e,"left","right"),y:h1(e,"top","bottom")}}function h1(e,t,n){return{min:p1(e,t),max:p1(e,n)}}function p1(e,t){return typeof e=="number"?e:e[t]||0}const m1=()=>({translate:0,scale:1,origin:0,originPoint:0}),ha=()=>({x:m1(),y:m1()}),v1=()=>({min:0,max:0}),lt=()=>({x:v1(),y:v1()});function On(e){return[e("x"),e("y")]}function qC({top:e,left:t,right:n,bottom:r}){return{x:{min:t,max:n},y:{min:e,max:r}}}function dN({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function fN(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function hh(e){return e===void 0||e===1}function em({scale:e,scaleX:t,scaleY:n}){return!hh(e)||!hh(t)||!hh(n)}function ii(e){return em(e)||XC(e)||e.z||e.rotate||e.rotateX||e.rotateY}function XC(e){return g1(e.x)||g1(e.y)}function g1(e){return e&&e!=="0%"}function Nc(e,t,n){const r=e-n,o=t*r;return n+o}function y1(e,t,n,r,o){return o!==void 0&&(e=Nc(e,o,r)),Nc(e,n,r)+t}function tm(e,t=0,n=1,r,o){e.min=y1(e.min,t,n,r,o),e.max=y1(e.max,t,n,r,o)}function YC(e,{x:t,y:n}){tm(e.x,t.translate,t.scale,t.originPoint),tm(e.y,n.translate,n.scale,n.originPoint)}function hN(e,t,n,r=!1){const o=n.length;if(!o)return;t.x=t.y=1;let i,a;for(let s=0;s<o;s++){i=n[s],a=i.projectionDelta;const u=i.instance;u&&u.style&&u.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&pa(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,YC(e,a)),r&&ii(i.latestValues)&&pa(e,i.latestValues))}t.x=x1(t.x),t.y=x1(t.y)}function x1(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function bo(e,t){e.min=e.min+t,e.max=e.max+t}function b1(e,t,[n,r,o]){const i=t[o]!==void 0?t[o]:.5,a=Xe(e.min,e.max,i);tm(e,t[n],t[r],a,t.scale)}const pN=["x","scaleX","originX"],mN=["y","scaleY","originY"];function pa(e,t){b1(e.x,t,pN),b1(e.y,t,mN)}function QC(e,t){return qC(fN(e.getBoundingClientRect(),t))}function vN(e,t,n){const r=QC(e,n),{scroll:o}=t;return o&&(bo(r.x,o.offset.x),bo(r.y,o.offset.y)),r}const JC=({current:e})=>e?e.ownerDocument.defaultView:null,gN=new WeakMap;class yN{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=lt(),this.visualElement=t}start(t,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const o=c=>{const{dragSnapToOrigin:d}=this.getProps();d?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Td(c,"page").point)},i=(c,d)=>{const{drag:f,dragPropagation:h,onDragStart:p}=this.getProps();if(f&&!h&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=dC(f),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),On(g=>{let v=this.getAxisMotionValue(g).get()||0;if(Nr.test(v)){const{projection:y}=this.visualElement;if(y&&y.layout){const b=y.layout.layoutBox[g];b&&(v=Rn(b)*(parseFloat(v)/100))}}this.originPoint[g]=v}),p&&Be.update(()=>p(c,d),!1,!0);const{animationState:m}=this.visualElement;m&&m.setActive("whileDrag",!0)},a=(c,d)=>{const{dragPropagation:f,dragDirectionLock:h,onDirectionLock:p,onDrag:m}=this.getProps();if(!f&&!this.openGlobalLock)return;const{offset:g}=d;if(h&&this.currentDirection===null){this.currentDirection=xN(g),this.currentDirection!==null&&p&&p(this.currentDirection);return}this.updateAxis("x",d.point,g),this.updateAxis("y",d.point,g),this.visualElement.render(),m&&m(c,d)},s=(c,d)=>this.stop(c,d),u=()=>On(c=>{var d;return this.getAnimationState(c)==="paused"&&((d=this.getAxisMotionValue(c).animation)===null||d===void 0?void 0:d.play())}),{dragSnapToOrigin:l}=this.getProps();this.panSession=new GC(t,{onSessionStart:o,onStart:i,onMove:a,onSessionEnd:s,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:l,contextWindow:JC(this.visualElement)})}stop(t,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:o}=n;this.startAnimation(o);const{onDragEnd:i}=this.getProps();i&&Be.update(()=>i(t,n))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,r){const{drag:o}=this.getProps();if(!r||!hl(t,o,this.currentDirection))return;const i=this.getAxisMotionValue(t);let a=this.originPoint[t]+r[t];this.constraints&&this.constraints[t]&&(a=iN(a,this.constraints[t],this.elastic[t])),i.set(a)}resolveConstraints(){var t;const{dragConstraints:n,dragElastic:r}=this.getProps(),o=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,i=this.constraints;n&&da(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&o?this.constraints=aN(o.layoutBox,n):this.constraints=!1,this.elastic=cN(r),i!==this.constraints&&o&&this.constraints&&!this.hasMutatedConstraints&&On(a=>{this.getAxisMotionValue(a)&&(this.constraints[a]=lN(o.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!da(t))return!1;const r=t.current,{projection:o}=this.visualElement;if(!o||!o.layout)return!1;const i=vN(r,o.root,this.visualElement.getTransformPagePoint());let a=sN(o.layout.layoutBox,i);if(n){const s=n(dN(a));this.hasMutatedConstraints=!!s,s&&(a=qC(s))}return a}startAnimation(t){const{drag:n,dragMomentum:r,dragElastic:o,dragTransition:i,dragSnapToOrigin:a,onDragTransitionEnd:s}=this.getProps(),u=this.constraints||{},l=On(c=>{if(!hl(c,n,this.currentDirection))return;let d=u&&u[c]||{};a&&(d={min:0,max:0});const f=o?200:1e6,h=o?40:1e7,p={type:"inertia",velocity:r?t[c]:0,bounceStiffness:f,bounceDamping:h,timeConstant:750,restDelta:1,restSpeed:10,...i,...d};return this.startAxisValueAnimation(c,p)});return Promise.all(l).then(s)}startAxisValueAnimation(t,n){const r=this.getAxisMotionValue(t);return r.start(Jv(t,r,0,n))}stopAnimation(){On(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){On(t=>{var n;return(n=this.getAxisMotionValue(t).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(t){var n;return(n=this.getAxisMotionValue(t).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(t){const n="_drag"+t.toUpperCase(),r=this.visualElement.getProps(),o=r[n];return o||this.visualElement.getValue(t,(r.initial?r.initial[t]:void 0)||0)}snapToCursor(t){On(n=>{const{drag:r}=this.getProps();if(!hl(n,r,this.currentDirection))return;const{projection:o}=this.visualElement,i=this.getAxisMotionValue(n);if(o&&o.layout){const{min:a,max:s}=o.layout.layoutBox[n];i.set(t[n]-Xe(a,s,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!da(n)||!r||!this.constraints)return;this.stopAnimation();const o={x:0,y:0};On(a=>{const s=this.getAxisMotionValue(a);if(s){const u=s.get();o[a]=uN({min:u,max:u},this.constraints[a])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),On(a=>{if(!hl(a,t,null))return;const s=this.getAxisMotionValue(a),{min:u,max:l}=this.constraints[a];s.set(Xe(u,l,o[a]))})}addListeners(){if(!this.visualElement.current)return;gN.set(this.visualElement,this);const t=this.visualElement.current,n=Jr(t,"pointerdown",u=>{const{drag:l,dragListener:c=!0}=this.getProps();l&&c&&this.start(u)}),r=()=>{const{dragConstraints:u}=this.getProps();da(u)&&(this.constraints=this.resolveRefConstraints())},{projection:o}=this.visualElement,i=o.addEventListener("measure",r);o&&!o.layout&&(o.root&&o.root.updateScroll(),o.updateLayout()),r();const a=Yr(window,"resize",()=>this.scalePositionWithinConstraints()),s=o.addEventListener("didUpdate",({delta:u,hasLayoutChanged:l})=>{this.isDragging&&l&&(On(c=>{const d=this.getAxisMotionValue(c);d&&(this.originPoint[c]+=u[c].translate,d.set(d.get()+u[c].translate))}),this.visualElement.render())});return()=>{a(),n(),i(),s&&s()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:o=!1,dragConstraints:i=!1,dragElastic:a=Zp,dragMomentum:s=!0}=t;return{...t,drag:n,dragDirectionLock:r,dragPropagation:o,dragConstraints:i,dragElastic:a,dragMomentum:s}}}function hl(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function xN(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class bN extends Qo{constructor(t){super(t),this.removeGroupControls=ot,this.removeListeners=ot,this.controls=new yN(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ot}unmount(){this.removeGroupControls(),this.removeListeners()}}const w1=e=>(t,n)=>{e&&Be.update(()=>e(t,n))};class wN extends Qo{constructor(){super(...arguments),this.removePointerDownListener=ot}onPointerDown(t){this.session=new GC(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:JC(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:r,onPanEnd:o}=this.node.getProps();return{onSessionStart:w1(t),onStart:w1(n),onMove:r,onEnd:(i,a)=>{delete this.session,o&&Be.update(()=>o(i,a))}}}mount(){this.removePointerDownListener=Jr(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function CN(){const e=P.useContext(Sd);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:n,register:r}=e,o=P.useId();return P.useEffect(()=>r(o),[]),!t&&n?[!1,()=>n&&n(o)]:[!0]}const Gl={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function C1(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const ds={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(le.test(e))e=parseFloat(e);else return e;const n=C1(e,t.target.x),r=C1(e,t.target.y);return`${n}% ${r}%`}},SN={correct:(e,{treeScale:t,projectionDelta:n})=>{const r=e,o=Uo.parse(e);if(o.length>5)return r;const i=Uo.createTransformer(e),a=typeof o[0]!="number"?1:0,s=n.x.scale*t.x,u=n.y.scale*t.y;o[0+a]/=s,o[1+a]/=u;const l=Xe(s,u,.5);return typeof o[2+a]=="number"&&(o[2+a]/=l),typeof o[3+a]=="number"&&(o[3+a]/=l),i(o)}};class EN extends Hn.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r,layoutId:o}=this.props,{projection:i}=t;NA(kN),i&&(n.group&&n.group.add(i),r&&r.register&&o&&r.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),Gl.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:r,drag:o,isPresent:i}=this.props,a=r.projection;return a&&(a.isPresent=i,o||t.layoutDependency!==n||n===void 0?a.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?a.promote():a.relegate()||Be.postRender(()=>{const s=a.getStack();(!s||!s.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),queueMicrotask(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:o}=t;o&&(o.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(o),r&&r.deregister&&r.deregister(o))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function ZC(e){const[t,n]=CN(),r=P.useContext(Lv);return Hn.createElement(EN,{...e,layoutGroup:r,switchLayoutGroup:P.useContext(q2),isPresent:t,safeToRemove:n})}const kN={borderRadius:{...ds,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:ds,borderTopRightRadius:ds,borderBottomLeftRadius:ds,borderBottomRightRadius:ds,boxShadow:SN},eS=["TopLeft","TopRight","BottomLeft","BottomRight"],_N=eS.length,S1=e=>typeof e=="string"?parseFloat(e):e,E1=e=>typeof e=="number"||le.test(e);function RN(e,t,n,r,o,i){o?(e.opacity=Xe(0,n.opacity!==void 0?n.opacity:1,TN(r)),e.opacityExit=Xe(t.opacity!==void 0?t.opacity:1,0,AN(r))):i&&(e.opacity=Xe(t.opacity!==void 0?t.opacity:1,n.opacity!==void 0?n.opacity:1,r));for(let a=0;a<_N;a++){const s=`border${eS[a]}Radius`;let u=k1(t,s),l=k1(n,s);if(u===void 0&&l===void 0)continue;u||(u=0),l||(l=0),u===0||l===0||E1(u)===E1(l)?(e[s]=Math.max(Xe(S1(u),S1(l),r),0),(Nr.test(l)||Nr.test(u))&&(e[s]+="%")):e[s]=l}(t.rotate||n.rotate)&&(e.rotate=Xe(t.rotate||0,n.rotate||0,r))}function k1(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const TN=tS(0,.5,SC),AN=tS(.5,.95,ot);function tS(e,t,n){return r=>r<e?0:r>t?1:n(su(e,t,r))}function _1(e,t){e.min=t.min,e.max=t.max}function Fn(e,t){_1(e.x,t.x),_1(e.y,t.y)}function R1(e,t,n,r,o){return e-=t,e=Nc(e,1/n,r),o!==void 0&&(e=Nc(e,1/o,r)),e}function IN(e,t=0,n=1,r=.5,o,i=e,a=e){if(Nr.test(t)&&(t=parseFloat(t),t=Xe(a.min,a.max,t/100)-a.min),typeof t!="number")return;let s=Xe(i.min,i.max,r);e===i&&(s-=t),e.min=R1(e.min,t,n,s,o),e.max=R1(e.max,t,n,s,o)}function T1(e,t,[n,r,o],i,a){IN(e,t[n],t[r],t[o],t.scale,i,a)}const NN=["x","scaleX","originX"],PN=["y","scaleY","originY"];function A1(e,t,n,r){T1(e.x,t,NN,n?n.x:void 0,r?r.x:void 0),T1(e.y,t,PN,n?n.y:void 0,r?r.y:void 0)}function I1(e){return e.translate===0&&e.scale===1}function nS(e){return I1(e.x)&&I1(e.y)}function DN(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}function rS(e,t){return Math.round(e.x.min)===Math.round(t.x.min)&&Math.round(e.x.max)===Math.round(t.x.max)&&Math.round(e.y.min)===Math.round(t.y.min)&&Math.round(e.y.max)===Math.round(t.y.max)}function N1(e){return Rn(e.x)/Rn(e.y)}class MN{constructor(){this.members=[]}add(t){Zv(this.members,t),t.scheduleRender()}remove(t){if(eg(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(o=>t===o);if(n===0)return!1;let r;for(let o=n;o>=0;o--){const i=this.members[o];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(t,n){const r=this.lead;if(t!==r&&(this.prevLead=r,this.lead=t,t.show(),r)){r.instance&&r.scheduleRender(),t.scheduleRender(),t.resumeFrom=r,n&&(t.resumeFrom.preserveOpacity=!0),r.snapshot&&(t.snapshot=r.snapshot,t.snapshot.latestValues=r.animationValues||r.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:o}=t.options;o===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:r}=t;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function P1(e,t,n){let r="";const o=e.x.translate/t.x,i=e.y.translate/t.y;if((o||i)&&(r=`translate3d(${o}px, ${i}px, 0) `),(t.x!==1||t.y!==1)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),n){const{rotate:u,rotateX:l,rotateY:c}=n;u&&(r+=`rotate(${u}deg) `),l&&(r+=`rotateX(${l}deg) `),c&&(r+=`rotateY(${c}deg) `)}const a=e.x.scale*t.x,s=e.y.scale*t.y;return(a!==1||s!==1)&&(r+=`scale(${a}, ${s})`),r||"none"}const FN=(e,t)=>e.depth-t.depth;class ON{constructor(){this.children=[],this.isDirty=!1}add(t){Zv(this.children,t),this.isDirty=!0}remove(t){eg(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(FN),this.isDirty=!1,this.children.forEach(t)}}function BN(e,t){const n=performance.now(),r=({timestamp:o})=>{const i=o-n;i>=t&&(oo(r),e(i-t))};return Be.read(r,!0),()=>oo(r)}function LN(e){window.MotionDebug&&window.MotionDebug.record(e)}function jN(e){return e instanceof SVGElement&&e.tagName!=="svg"}function zN(e,t,n){const r=cn(e)?e:La(e);return r.start(Jv("",r,t,n)),r.animation}const D1=["","X","Y","Z"],VN={visibility:"hidden"},M1=1e3;let $N=0;const ai={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function oS({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:r,resetTransform:o}){return class{constructor(a={},s=t==null?void 0:t()){this.id=$N++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,ai.totalNodes=ai.resolvedTargetDeltas=ai.recalculatedProjection=0,this.nodes.forEach(HN),this.nodes.forEach(YN),this.nodes.forEach(QN),this.nodes.forEach(GN),LN(ai)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=s?s.root||s:this,this.path=s?[...s.path,s]:[],this.parent=s,this.depth=s?s.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new ON)}addEventListener(a,s){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new tg),this.eventHandlers.get(a).add(s)}notifyListeners(a,...s){const u=this.eventHandlers.get(a);u&&u.notify(...s)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,s=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=jN(a),this.instance=a;const{layoutId:u,layout:l,visualElement:c}=this.options;if(c&&!c.current&&c.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),s&&(l||u)&&(this.isLayoutDirty=!0),e){let d;const f=()=>this.root.updateBlockedByResize=!1;e(a,()=>{this.root.updateBlockedByResize=!0,d&&d(),d=BN(f,250),Gl.hasAnimatedSinceResize&&(Gl.hasAnimatedSinceResize=!1,this.nodes.forEach(O1))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&c&&(u||l)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:f,hasRelativeTargetChanged:h,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const m=this.options.transition||c.getDefaultTransition()||nP,{onLayoutAnimationStart:g,onLayoutAnimationComplete:v}=c.getProps(),y=!this.targetLayout||!rS(this.targetLayout,p)||h,b=!f&&h;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||b||f&&(y||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(d,b);const w={...Qv(m,"layout"),onPlay:g,onComplete:v};(c.shouldReduceMotion||this.options.layoutRoot)&&(w.delay=0,w.type=!1),this.startAnimation(w)}else f||O1(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,oo(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(JN),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let c=0;c<this.path.length;c++){const d=this.path[c];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:s,layout:u}=this.options;if(s===void 0&&!u)return;const l=this.getTransformTemplate();this.prevTransformTemplateValue=l?l(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(F1);return}this.isUpdating||this.nodes.forEach(qN),this.isUpdating=!1,this.nodes.forEach(XN),this.nodes.forEach(WN),this.nodes.forEach(UN),this.clearAllSnapshots();const s=performance.now();Bt.delta=Wo(0,1e3/60,s-Bt.timestamp),Bt.timestamp=s,Bt.isProcessing=!0,rh.update.process(Bt),rh.preRender.process(Bt),rh.render.process(Bt),Bt.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(KN),this.sharedNodes.forEach(ZN)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Be.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Be.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=lt(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:s}=this.options;s&&s.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let s=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(s=!1),s&&(this.scroll={animationId:this.root.animationId,phase:a,isRoot:r(this.instance),offset:n(this.instance)})}resetTransform(){if(!o)return;const a=this.isLayoutDirty||this.shouldResetTransform,s=this.projectionDelta&&!nS(this.projectionDelta),u=this.getTransformTemplate(),l=u?u(this.latestValues,""):void 0,c=l!==this.prevTransformTemplateValue;a&&(s||ii(this.latestValues)||c)&&(o(this.instance,l),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const s=this.measurePageBox();let u=this.removeElementScroll(s);return a&&(u=this.removeTransform(u)),rP(u),{animationId:this.root.animationId,measuredBox:s,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:a}=this.options;if(!a)return lt();const s=a.measureViewportBox(),{scroll:u}=this.root;return u&&(bo(s.x,u.offset.x),bo(s.y,u.offset.y)),s}removeElementScroll(a){const s=lt();Fn(s,a);for(let u=0;u<this.path.length;u++){const l=this.path[u],{scroll:c,options:d}=l;if(l!==this.root&&c&&d.layoutScroll){if(c.isRoot){Fn(s,a);const{scroll:f}=this.root;f&&(bo(s.x,-f.offset.x),bo(s.y,-f.offset.y))}bo(s.x,c.offset.x),bo(s.y,c.offset.y)}}return s}applyTransform(a,s=!1){const u=lt();Fn(u,a);for(let l=0;l<this.path.length;l++){const c=this.path[l];!s&&c.options.layoutScroll&&c.scroll&&c!==c.root&&pa(u,{x:-c.scroll.offset.x,y:-c.scroll.offset.y}),ii(c.latestValues)&&pa(u,c.latestValues)}return ii(this.latestValues)&&pa(u,this.latestValues),u}removeTransform(a){const s=lt();Fn(s,a);for(let u=0;u<this.path.length;u++){const l=this.path[u];if(!l.instance||!ii(l.latestValues))continue;em(l.latestValues)&&l.updateSnapshot();const c=lt(),d=l.measurePageBox();Fn(c,d),A1(s,l.latestValues,l.snapshot?l.snapshot.layoutBox:void 0,c)}return ii(this.latestValues)&&A1(s,this.latestValues),s}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Bt.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var s;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==u;if(!(a||l&&this.isSharedProjectionDirty||this.isProjectionDirty||!((s=this.parent)===null||s===void 0)&&s.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:d,layoutId:f}=this.options;if(!(!this.layout||!(d||f))){if(this.resolvedRelativeTargetAt=Bt.timestamp,!this.targetDelta&&!this.relativeTarget){const h=this.getClosestProjectingParent();h&&h.layout&&this.animationProgress!==1?(this.relativeParent=h,this.forceRelativeParentToResolveTarget(),this.relativeTarget=lt(),this.relativeTargetOrigin=lt(),Fs(this.relativeTargetOrigin,this.layout.layoutBox,h.layout.layoutBox),Fn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=lt(),this.targetWithTransforms=lt()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),oN(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Fn(this.target,this.layout.layoutBox),YC(this.target,this.targetDelta)):Fn(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const h=this.getClosestProjectingParent();h&&!!h.resumingFrom==!!this.resumingFrom&&!h.options.layoutScroll&&h.target&&this.animationProgress!==1?(this.relativeParent=h,this.forceRelativeParentToResolveTarget(),this.relativeTarget=lt(),this.relativeTargetOrigin=lt(),Fs(this.relativeTargetOrigin,this.target,h.target),Fn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}ai.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||em(this.parent.latestValues)||XC(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const s=this.getLead(),u=!!this.resumingFrom||this!==s;let l=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(l=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===Bt.timestamp&&(l=!1),l)return;const{layout:c,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||d))return;Fn(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,h=this.treeScale.y;hN(this.layoutCorrected,this.treeScale,this.path,u),s.layout&&!s.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(s.target=s.layout.layoutBox);const{target:p}=s;if(!p){this.projectionTransform&&(this.projectionDelta=ha(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=ha(),this.projectionDeltaWithTransform=ha());const m=this.projectionTransform;Ms(this.projectionDelta,this.layoutCorrected,p,this.latestValues),this.projectionTransform=P1(this.projectionDelta,this.treeScale),(this.projectionTransform!==m||this.treeScale.x!==f||this.treeScale.y!==h)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p)),ai.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),a){const s=this.getStack();s&&s.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(a,s=!1){const u=this.snapshot,l=u?u.latestValues:{},c={...this.latestValues},d=ha();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!s;const f=lt(),h=u?u.source:void 0,p=this.layout?this.layout.source:void 0,m=h!==p,g=this.getStack(),v=!g||g.members.length<=1,y=!!(m&&!v&&this.options.crossfade===!0&&!this.path.some(tP));this.animationProgress=0;let b;this.mixTargetDelta=w=>{const C=w/1e3;B1(d.x,a.x,C),B1(d.y,a.y,C),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Fs(f,this.layout.layoutBox,this.relativeParent.layout.layoutBox),eP(this.relativeTarget,this.relativeTargetOrigin,f,C),b&&DN(this.relativeTarget,b)&&(this.isProjectionDirty=!1),b||(b=lt()),Fn(b,this.relativeTarget)),m&&(this.animationValues=c,RN(c,l,this.latestValues,C,y,v)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=C},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(oo(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Be.update(()=>{Gl.hasAnimatedSinceResize=!0,this.currentAnimation=zN(0,M1,{...a,onUpdate:s=>{this.mixTargetDelta(s),a.onUpdate&&a.onUpdate(s)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(M1),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:s,target:u,layout:l,latestValues:c}=a;if(!(!s||!u||!l)){if(this!==a&&this.layout&&l&&iS(this.options.animationType,this.layout.layoutBox,l.layoutBox)){u=this.target||lt();const d=Rn(this.layout.layoutBox.x);u.x.min=a.target.x.min,u.x.max=u.x.min+d;const f=Rn(this.layout.layoutBox.y);u.y.min=a.target.y.min,u.y.max=u.y.min+f}Fn(s,u),pa(s,c),Ms(this.projectionDeltaWithTransform,this.layoutCorrected,s,c)}}registerSharedNode(a,s){this.sharedNodes.has(a)||this.sharedNodes.set(a,new MN),this.sharedNodes.get(a).add(s);const l=s.options.initialPromotionConfig;s.promote({transition:l?l.transition:void 0,preserveFollowOpacity:l&&l.shouldPreserveFollowOpacity?l.shouldPreserveFollowOpacity(s):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:s}=this.options;return s?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:s}=this.options;return s?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:s,preserveFollowOpacity:u}={}){const l=this.getStack();l&&l.promote(this,u),a&&(this.projectionDelta=void 0,this.needsReset=!0),s&&this.setOptions({transition:s})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetRotation(){const{visualElement:a}=this.options;if(!a)return;let s=!1;const{latestValues:u}=a;if((u.rotate||u.rotateX||u.rotateY||u.rotateZ)&&(s=!0),!s)return;const l={};for(let c=0;c<D1.length;c++){const d="rotate"+D1[c];u[d]&&(l[d]=u[d],a.setStaticValue(d,0))}a.render();for(const c in l)a.setStaticValue(c,l[c]);a.scheduleRender()}getProjectionStyles(a){var s,u;if(!this.instance||this.isSVG)return;if(!this.isVisible)return VN;const l={visibility:""},c=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,l.opacity="",l.pointerEvents=Hl(a==null?void 0:a.pointerEvents)||"",l.transform=c?c(this.latestValues,""):"none",l;const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){const m={};return this.options.layoutId&&(m.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,m.pointerEvents=Hl(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!ii(this.latestValues)&&(m.transform=c?c({},""):"none",this.hasProjected=!1),m}const f=d.animationValues||d.latestValues;this.applyTransformsToTarget(),l.transform=P1(this.projectionDeltaWithTransform,this.treeScale,f),c&&(l.transform=c(f,l.transform));const{x:h,y:p}=this.projectionDelta;l.transformOrigin=`${h.origin*100}% ${p.origin*100}% 0`,d.animationValues?l.opacity=d===this?(u=(s=f.opacity)!==null&&s!==void 0?s:this.latestValues.opacity)!==null&&u!==void 0?u:1:this.preserveOpacity?this.latestValues.opacity:f.opacityExit:l.opacity=d===this?f.opacity!==void 0?f.opacity:"":f.opacityExit!==void 0?f.opacityExit:0;for(const m in Ec){if(f[m]===void 0)continue;const{correct:g,applyTo:v}=Ec[m],y=l.transform==="none"?f[m]:g(f[m],d);if(v){const b=v.length;for(let w=0;w<b;w++)l[v[w]]=y}else l[m]=y}return this.options.layoutId&&(l.pointerEvents=d===this?Hl(a==null?void 0:a.pointerEvents)||"":"none"),l}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var s;return(s=a.currentAnimation)===null||s===void 0?void 0:s.stop()}),this.root.nodes.forEach(F1),this.root.sharedNodes.clear()}}}function WN(e){e.updateLayout()}function UN(e){var t;const n=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&n&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:o}=e.layout,{animationType:i}=e.options,a=n.source!==e.layout.source;i==="size"?On(d=>{const f=a?n.measuredBox[d]:n.layoutBox[d],h=Rn(f);f.min=r[d].min,f.max=f.min+h}):iS(i,n.layoutBox,r)&&On(d=>{const f=a?n.measuredBox[d]:n.layoutBox[d],h=Rn(r[d]);f.max=f.min+h,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[d].max=e.relativeTarget[d].min+h)});const s=ha();Ms(s,r,n.layoutBox);const u=ha();a?Ms(u,e.applyTransform(o,!0),n.measuredBox):Ms(u,r,n.layoutBox);const l=!nS(s);let c=!1;if(!e.resumeFrom){const d=e.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:f,layout:h}=d;if(f&&h){const p=lt();Fs(p,n.layoutBox,f.layoutBox);const m=lt();Fs(m,r,h.layoutBox),rS(p,m)||(c=!0),d.options.layoutRoot&&(e.relativeTarget=m,e.relativeTargetOrigin=p,e.relativeParent=d)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:n,delta:u,layoutDelta:s,hasLayoutChanged:l,hasRelativeTargetChanged:c})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function HN(e){ai.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function GN(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function KN(e){e.clearSnapshot()}function F1(e){e.clearMeasurements()}function qN(e){e.isLayoutDirty=!1}function XN(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function O1(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function YN(e){e.resolveTargetDelta()}function QN(e){e.calcProjection()}function JN(e){e.resetRotation()}function ZN(e){e.removeLeadSnapshot()}function B1(e,t,n){e.translate=Xe(t.translate,0,n),e.scale=Xe(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function L1(e,t,n,r){e.min=Xe(t.min,n.min,r),e.max=Xe(t.max,n.max,r)}function eP(e,t,n,r){L1(e.x,t.x,n.x,r),L1(e.y,t.y,n.y,r)}function tP(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const nP={duration:.45,ease:[.4,0,.1,1]},j1=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),z1=j1("applewebkit/")&&!j1("chrome/")?Math.round:ot;function V1(e){e.min=z1(e.min),e.max=z1(e.max)}function rP(e){V1(e.x),V1(e.y)}function iS(e,t,n){return e==="position"||e==="preserve-aspect"&&!Jp(N1(t),N1(n),.2)}const oP=oS({attachResizeListener:(e,t)=>Yr(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),ph={current:void 0},aS=oS({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!ph.current){const e=new oP({});e.mount(window),e.setOptions({layoutScroll:!0}),ph.current=e}return ph.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),iP={pan:{Feature:wN},drag:{Feature:bN,ProjectionNode:aS,MeasureLayout:ZC}},aP=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function sP(e){const t=aP.exec(e);if(!t)return[,];const[,n,r]=t;return[n,r]}function nm(e,t,n=1){const[r,o]=sP(e);if(!r)return;const i=window.getComputedStyle(t).getPropertyValue(r);if(i){const a=i.trim();return $C(a)?parseFloat(a):a}else return Hp(o)?nm(o,t,n+1):o}function uP(e,{...t},n){const r=e.current;if(!(r instanceof Element))return{target:t,transitionEnd:n};n&&(n={...n}),e.values.forEach(o=>{const i=o.get();if(!Hp(i))return;const a=nm(i,r);a&&o.set(a)});for(const o in t){const i=t[o];if(!Hp(i))continue;const a=nm(i,r);a&&(t[o]=a,n||(n={}),n[o]===void 0&&(n[o]=i))}return{target:t,transitionEnd:n}}const lP=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),sS=e=>lP.has(e),cP=e=>Object.keys(e).some(sS),$1=e=>e===Ni||e===le,W1=(e,t)=>parseFloat(e.split(", ")[t]),U1=(e,t)=>(n,{transform:r})=>{if(r==="none"||!r)return 0;const o=r.match(/^matrix3d\((.+)\)$/);if(o)return W1(o[1],t);{const i=r.match(/^matrix\((.+)\)$/);return i?W1(i[1],e):0}},dP=new Set(["x","y","z"]),fP=ku.filter(e=>!dP.has(e));function hP(e){const t=[];return fP.forEach(n=>{const r=e.getValue(n);r!==void 0&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t.length&&e.render(),t}const ja={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:U1(4,13),y:U1(5,14)};ja.translateX=ja.x;ja.translateY=ja.y;const pP=(e,t,n)=>{const r=t.measureViewportBox(),o=t.current,i=getComputedStyle(o),{display:a}=i,s={};a==="none"&&t.setStaticValue("display",e.display||"block"),n.forEach(l=>{s[l]=ja[l](r,i)}),t.render();const u=t.measureViewportBox();return n.forEach(l=>{const c=t.getValue(l);c&&c.jump(s[l]),e[l]=ja[l](u,i)}),e},mP=(e,t,n={},r={})=>{t={...t},r={...r};const o=Object.keys(t).filter(sS);let i=[],a=!1;const s=[];if(o.forEach(u=>{const l=e.getValue(u);if(!e.hasValue(u))return;let c=n[u],d=cs(c);const f=t[u];let h;if(_c(f)){const p=f.length,m=f[0]===null?1:0;c=f[m],d=cs(c);for(let g=m;g<p&&f[g]!==null;g++)h?Gv(cs(f[g])===h):h=cs(f[g])}else h=cs(f);if(d!==h)if($1(d)&&$1(h)){const p=l.get();typeof p=="string"&&l.set(parseFloat(p)),typeof f=="string"?t[u]=parseFloat(f):Array.isArray(f)&&h===le&&(t[u]=f.map(parseFloat))}else d!=null&&d.transform&&(h!=null&&h.transform)&&(c===0||f===0)?c===0?l.set(h.transform(c)):t[u]=d.transform(f):(a||(i=hP(e),a=!0),s.push(u),r[u]=r[u]!==void 0?r[u]:t[u],l.jump(f))}),s.length){const u=s.indexOf("height")>=0?window.pageYOffset:null,l=pP(t,e,s);return i.length&&i.forEach(([c,d])=>{e.getValue(c).set(d)}),e.render(),Ed&&u!==null&&window.scrollTo({top:u}),{target:l,transitionEnd:r}}else return{target:t,transitionEnd:r}};function vP(e,t,n,r){return cP(t)?mP(e,t,n,r):{target:t,transitionEnd:r}}const gP=(e,t,n,r)=>{const o=uP(e,t,r);return t=o.target,r=o.transitionEnd,vP(e,t,n,r)},rm={current:null},uS={current:!1};function yP(){if(uS.current=!0,!!Ed)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>rm.current=e.matches;e.addListener(t),t()}else rm.current=!1}function xP(e,t,n){const{willChange:r}=t;for(const o in t){const i=t[o],a=n[o];if(cn(i))e.addValue(o,i),Ic(r)&&r.add(o);else if(cn(a))e.addValue(o,La(i,{owner:e})),Ic(r)&&r.remove(o);else if(a!==i)if(e.hasValue(o)){const s=e.getValue(o);!s.hasAnimated&&s.set(i)}else{const s=e.getStaticValue(o);e.addValue(o,La(s!==void 0?s:i,{owner:e}))}}for(const o in n)t[o]===void 0&&e.removeValue(o);return t}const H1=new WeakMap,lS=Object.keys(au),bP=lS.length,G1=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],wP=Bv.length;class CP{constructor({parent:t,props:n,presenceContext:r,reducedMotionConfig:o,visualState:i},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>Be.render(this.render,!1,!0);const{latestValues:s,renderState:u}=i;this.latestValues=s,this.baseTarget={...s},this.initialValues=n.initial?{...s}:{},this.renderState=u,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=o,this.options=a,this.isControllingVariants=_d(n),this.isVariantNode=K2(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:l,...c}=this.scrapeMotionValuesFromProps(n,{});for(const d in c){const f=c[d];s[d]!==void 0&&cn(f)&&(f.set(s[d],!1),Ic(l)&&l.add(d))}}scrapeMotionValuesFromProps(t,n){return{}}mount(t){this.current=t,H1.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),uS.current||yP(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:rm.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){H1.delete(this.current),this.projection&&this.projection.unmount(),oo(this.notifyUpdate),oo(this.render),this.valueSubscriptions.forEach(t=>t()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,n){const r=Ii.has(t),o=n.on("change",a=>{this.latestValues[t]=a,this.props.onUpdate&&Be.update(this.notifyUpdate,!1,!0),r&&this.projection&&(this.projection.isTransformDirty=!0)}),i=n.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,()=>{o(),i()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}loadFeatures({children:t,...n},r,o,i){let a,s;for(let u=0;u<bP;u++){const l=lS[u],{isEnabled:c,Feature:d,ProjectionNode:f,MeasureLayout:h}=au[l];f&&(a=f),c(n)&&(!this.features[l]&&d&&(this.features[l]=new d(this)),h&&(s=h))}if((this.type==="html"||this.type==="svg")&&!this.projection&&a){this.projection=new a(this.latestValues,this.parent&&this.parent.projection);const{layoutId:u,layout:l,drag:c,dragConstraints:d,layoutScroll:f,layoutRoot:h}=n;this.projection.setOptions({layoutId:u,layout:l,alwaysMeasureLayout:!!c||d&&da(d),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof l=="string"?l:"both",initialPromotionConfig:i,layoutScroll:f,layoutRoot:h})}return s}updateFeatures(){for(const t in this.features){const n=this.features[t];n.isMounted?n.update():(n.mount(),n.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):lt()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}makeTargetAnimatable(t,n=!0){return this.makeTargetAnimatableFromInstance(t,this.props,n)}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<G1.length;r++){const o=G1[r];this.propEventSubscriptions[o]&&(this.propEventSubscriptions[o](),delete this.propEventSubscriptions[o]);const i=t["on"+o];i&&(this.propEventSubscriptions[o]=this.on(o,i))}this.prevMotionValues=xP(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const r=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(r.initial=this.props.initial),r}const n={};for(let r=0;r<wP;r++){const o=Bv[r],i=this.props[o];(iu(i)||i===!1)&&(n[o]=i)}return n}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){n!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,n)),this.values.set(t,n),this.latestValues[t]=n.get()}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let r=this.values.get(t);return r===void 0&&n!==void 0&&(r=La(n,{owner:this}),this.addValue(t,r)),r}readValue(t){var n;return this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(n=this.getBaseTargetFromProps(this.props,t))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,t,this.options)}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){var n;const{initial:r}=this.props,o=typeof r=="string"||typeof r=="object"?(n=Hv(this.props,r))===null||n===void 0?void 0:n[t]:void 0;if(r&&o!==void 0)return o;const i=this.getBaseTargetFromProps(this.props,t);return i!==void 0&&!cn(i)?i:this.initialValues[t]!==void 0&&o===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new tg),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}}class cS extends CP{sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){return t.style?t.style[n]:void 0}removeValueFromRenderState(t,{vars:n,style:r}){delete n[t],delete r[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:n,...r},{transformValues:o},i){let a=jI(r,t||{},this);if(o&&(n&&(n=o(n)),r&&(r=o(r)),a&&(a=o(a))),i){BI(this,r,a);const s=gP(this,r,a,n);n=s.transitionEnd,r=s.target}return{transition:t,transitionEnd:n,...r}}}function SP(e){return window.getComputedStyle(e)}class EP extends cS{constructor(){super(...arguments),this.type="html"}readValueFromInstance(t,n){if(Ii.has(n)){const r=Yv(n);return r&&r.default||0}else{const r=SP(t),o=(Q2(n)?r.getPropertyValue(n):r[n])||0;return typeof o=="string"?o.trim():o}}measureInstanceViewportBox(t,{transformPagePoint:n}){return QC(t,n)}build(t,n,r,o){zv(t,n,r,o.transformTemplate)}scrapeMotionValuesFromProps(t,n){return Uv(t,n)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;cn(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}renderInstance(t,n,r,o){rC(t,n,r,o)}}class kP extends cS{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(Ii.has(n)){const r=Yv(n);return r&&r.default||0}return n=oC.has(n)?n:Fv(n),t.getAttribute(n)}measureInstanceViewportBox(){return lt()}scrapeMotionValuesFromProps(t,n){return aC(t,n)}build(t,n,r,o){$v(t,n,r,this.isSVGTag,o.transformTemplate)}renderInstance(t,n,r,o){iC(t,n,r,o)}mount(t){this.isSVGTag=Wv(t.tagName),super.mount(t)}}const _P=(e,t)=>jv(e)?new kP(t,{enableHardwareAcceleration:!1}):new EP(t,{enableHardwareAcceleration:!0}),RP={layout:{ProjectionNode:aS,MeasureLayout:ZC}},TP={...eN,...b4,...iP,...RP},Ie=AA((e,t)=>s4(e,t,TP,_P));function dS(){const e=P.useRef(!1);return Mv(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function AP(){const e=dS(),[t,n]=P.useState(0),r=P.useCallback(()=>{e.current&&n(t+1)},[t]);return[P.useCallback(()=>Be.postRender(r),[r]),t]}class IP extends P.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function NP({children:e,isPresent:t}){const n=P.useId(),r=P.useRef(null),o=P.useRef({width:0,height:0,top:0,left:0});return P.useInsertionEffect(()=>{const{width:i,height:a,top:s,left:u}=o.current;if(t||!r.current||!i||!a)return;r.current.dataset.motionPopId=n;const l=document.createElement("style");return document.head.appendChild(l),l.sheet&&l.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${a}px !important;
            top: ${s}px !important;
            left: ${u}px !important;
          }
        `),()=>{document.head.removeChild(l)}},[t]),P.createElement(IP,{isPresent:t,childRef:r,sizeRef:o},P.cloneElement(e,{ref:r}))}const mh=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:o,presenceAffectsLayout:i,mode:a})=>{const s=sC(PP),u=P.useId(),l=P.useMemo(()=>({id:u,initial:t,isPresent:n,custom:o,onExitComplete:c=>{s.set(c,!0);for(const d of s.values())if(!d)return;r&&r()},register:c=>(s.set(c,!1),()=>s.delete(c))}),i?void 0:[n]);return P.useMemo(()=>{s.forEach((c,d)=>s.set(d,!1))},[n]),P.useEffect(()=>{!n&&!s.size&&r&&r()},[n]),a==="popLayout"&&(e=P.createElement(NP,{isPresent:n},e)),P.createElement(Sd.Provider,{value:l},e)};function PP(){return new Map}function DP(e){return P.useEffect(()=>()=>e(),[])}const si=e=>e.key||"";function MP(e,t){e.forEach(n=>{const r=si(n);t.set(r,n)})}function FP(e){const t=[];return P.Children.forEach(e,n=>{P.isValidElement(n)&&t.push(n)}),t}const Id=({children:e,custom:t,initial:n=!0,onExitComplete:r,exitBeforeEnter:o,presenceAffectsLayout:i=!0,mode:a="sync"})=>{const s=P.useContext(Lv).forceRender||AP()[0],u=dS(),l=FP(e);let c=l;const d=P.useRef(new Map).current,f=P.useRef(c),h=P.useRef(new Map).current,p=P.useRef(!0);if(Mv(()=>{p.current=!1,MP(l,h),f.current=c}),DP(()=>{p.current=!0,h.clear(),d.clear()}),p.current)return P.createElement(P.Fragment,null,c.map(y=>P.createElement(mh,{key:si(y),isPresent:!0,initial:n?void 0:!1,presenceAffectsLayout:i,mode:a},y)));c=[...c];const m=f.current.map(si),g=l.map(si),v=m.length;for(let y=0;y<v;y++){const b=m[y];g.indexOf(b)===-1&&!d.has(b)&&d.set(b,void 0)}return a==="wait"&&d.size&&(c=[]),d.forEach((y,b)=>{if(g.indexOf(b)!==-1)return;const w=h.get(b);if(!w)return;const C=m.indexOf(b);let S=y;if(!S){const E=()=>{d.delete(b);const k=Array.from(h.keys()).filter(R=>!g.includes(R));if(k.forEach(R=>h.delete(R)),f.current=l.filter(R=>{const _=si(R);return _===b||k.includes(_)}),!d.size){if(u.current===!1)return;s(),r&&r()}};S=P.createElement(mh,{key:si(w),isPresent:!1,onExitComplete:E,custom:t,presenceAffectsLayout:i,mode:a},w),d.set(b,S)}c.splice(C,0,S)}),c=c.map(y=>{const b=y.key;return d.has(b)?y:P.createElement(mh,{key:si(y),isPresent:!0,presenceAffectsLayout:i,mode:a},y)}),P.createElement(P.Fragment,null,d.size?c:c.map(y=>P.cloneElement(y)))},OP=({text:e,label:t,className:n=""})=>{const[r,o]=P.useState(!1),i=async()=>{try{await navigator.clipboard.writeText(e),o(!0),setTimeout(()=>o(!1),2e3)}catch(a){console.error("Failed to copy text:",a)}};return x.jsxs("button",{onClick:i,className:`inline-flex items-center gap-2 px-3 py-1 rounded-md 
        bg-gray-100 hover:bg-gray-200 
        dark:bg-gray-700 dark:hover:bg-gray-600 
        transition-colors ${n}`,children:[x.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:t||e}),r?x.jsx("svg",{className:"w-4 h-4 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):x.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"})})]})},fS=P.createContext(void 0),BP=({children:e})=>{const[t,n]=P.useState([]);return x.jsx(fS.Provider,{value:{detections:t,setDetections:n},children:e})},ng=()=>{const e=P.useContext(fS);if(e===void 0)throw new Error("useEmotionContext must be used within an EmotionProvider");return e};function hS(e){let t="neutral",n=0;return Object.entries(e).forEach(([r,o])=>{o>n&&(n=o,t=r)}),n<.5?"neutral":t}function pS(e){const t={happy:"",sad:"",angry:"",fearful:"",disgusted:"",surprised:"",neutral:""};return t[e]||t.neutral}const LP=()=>{const{detections:e}=ng(),t=e.length>0?hS(e[0].expressions):"neutral",n=pS(t);return x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("div",{className:"bg-card border border-border rounded-xl px-4 py-2",children:x.jsxs("div",{className:"relative",children:[x.jsx("span",{className:`text-2xl font-black tracking-normal bg-gradient-to-r from-[#4F46E5] to-[#7C3AED] bg-clip-text text-transparent 
            relative z-10 font-display uppercase`,children:"PELIOS"}),x.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-[#4F46E5]/20 to-[#7C3AED]/20 blur-lg rounded-lg"})]})}),x.jsx("div",{className:"flex items-center",children:x.jsx("span",{className:"text-2xl transform hover:scale-110 transition-transform duration-200 cursor-default opacity-80",children:n})})]})},mS=P.createContext(void 0),jP=({children:e})=>{const[t,n]=P.useState(()=>{const i=localStorage.getItem("currentProfile");return i?JSON.parse(i):null}),[r,o]=P.useState(()=>localStorage.getItem("hasSeenSplash")==="true");return P.useEffect(()=>{t?(localStorage.setItem("currentProfile",JSON.stringify(t)),r||(localStorage.setItem("hasSeenSplash","true"),o(!0))):localStorage.removeItem("currentProfile")},[t,r]),x.jsx(mS.Provider,{value:{currentProfile:t,setCurrentProfile:n,hasSeenSplash:r},children:e})},hr=()=>{const e=P.useContext(mS);if(!e)throw new Error("useProfile must be used within a ProfileProvider");return e},zP=[{id:"1",name:"Happy",color:"#D97706",emoji:""},{id:"2",name:"Sad",color:"#3B82F6",emoji:""},{id:"3",name:"Angry",color:"#EF4444",emoji:""},{id:"4",name:"Fearful",color:"#8B5CF6",emoji:""},{id:"5",name:"Disgusted",color:"#10B981",emoji:""},{id:"6",name:"Surprised",color:"#EC4899",emoji:""}],VP=()=>{const{currentProfile:e,setCurrentProfile:t}=hr(),[n,r]=P.useState(!1);return e?x.jsxs("div",{className:"relative",children:[x.jsxs("button",{onClick:()=>r(!n),className:"flex items-center gap-2 px-3 py-1.5 rounded-lg transition-colors hover:bg-white/5",children:[x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("span",{className:"text-xl",children:e.emoji}),x.jsx("span",{className:"text-sm font-medium text-foreground",children:e.name})]}),x.jsx(Ie.svg,{className:"w-4 h-4 text-foreground/60",viewBox:"0 0 20 20",fill:"currentColor",animate:{rotate:n?180:0},transition:{duration:.2},children:x.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),x.jsx(Id,{children:n&&x.jsxs(x.Fragment,{children:[x.jsx(Ie.div,{className:"fixed inset-0 z-40",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>r(!1)}),x.jsx(Ie.div,{className:"absolute right-0 mt-2 w-48 rounded-xl bg-white/80 dark:bg-card/80 backdrop-blur-xl border border-border shadow-lg z-50",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},children:x.jsx("div",{className:"p-2 space-y-1",children:zP.map(o=>x.jsxs("button",{onClick:()=>{t(o),r(!1)},className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg text-left transition-colors
                      ${e.id===o.id?"bg-primary/10 text-primary":"hover:bg-white/5 text-foreground"}`,style:{"--tw-text-opacity":1,color:e.id===o.id?o.color:void 0},children:[x.jsx("span",{className:"text-xl",children:o.emoji}),x.jsx("span",{className:"text-sm font-medium",children:o.name})]},o.id))})})]})})]}):null},vS=P.createContext(void 0),$P=({children:e})=>{const[t,n]=P.useState(()=>{const o=localStorage.getItem("theme");return o?o==="dark":!0});P.useEffect(()=>{const o=document.documentElement;t?(o.classList.remove("light"),o.classList.add("dark")):(o.classList.remove("dark"),o.classList.add("light")),localStorage.setItem("theme",t?"dark":"light")},[t]);const r=()=>n(!t);return x.jsx(vS.Provider,{value:{isDark:t,toggleTheme:r},children:e})},gS=()=>{const e=P.useContext(vS);if(!e)throw new Error("useTheme must be used within ThemeProvider");return e},WP=({checked:e,onChange:t})=>x.jsx("button",{onClick:t,className:`
        relative w-12 h-7 rounded-full p-1 transition-colors duration-200
        ${e?"bg-primary":"bg-muted"}
      `,"aria-label":"Toggle theme",children:x.jsx(Ie.div,{initial:!1,animate:{x:e?"20px":"0px"},transition:{type:"spring",stiffness:500,damping:30},className:"w-5 h-5 rounded-full bg-white shadow-sm"})}),yS=()=>{const{isDark:e,toggleTheme:t}=gS();return x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("svg",{className:"w-4 h-4 text-muted-foreground",fill:"currentColor",viewBox:"0 0 20 20",children:x.jsx("path",{d:"M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"})}),x.jsx(WP,{checked:e,onChange:t}),x.jsx("svg",{className:"w-4 h-4 text-muted-foreground",fill:"currentColor",viewBox:"0 0 20 20",children:x.jsx("path",{d:"M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"})})]})},xS=P.createContext(void 0);function rg(){const e=P.useContext(xS);if(!e)throw new Error("useTab must be used within a TabProvider");return e}function UP({children:e}){const[t,n]=P.useState("landing"),[r,o]=P.useState("landing"),i=a=>{o(t),n(a)};return x.jsx(xS.Provider,{value:{activeTab:t,previousTab:r,setActiveTab:i},children:e})}const HP=()=>{const{currentProfile:e}=hr(),{activeTab:t,setActiveTab:n}=rg();return Hn.useEffect(()=>{t==="surprised-chat"&&(e==null?void 0:e.name)!=="Surprised"&&n("landing")},[t,e,n]),x.jsx(Ie.header,{layout:!0,className:"bg-white/80 dark:bg-card/80 backdrop-blur-xl border-b border-border sticky top-0 z-50",children:x.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsxs("div",{className:"flex items-center",children:[x.jsx(LP,{}),x.jsx("span",{className:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gradient-to-r from-blue-500/20 to-purple-500/20 text-blue-400 border border-blue-500/30",children:"Beta"})]}),x.jsxs("div",{className:"flex items-center gap-6",children:[x.jsx(Id,{mode:"wait",children:x.jsxs(Ie.div,{className:"flex items-center gap-4",initial:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{type:"spring",stiffness:300,damping:30},children:[x.jsx("span",{className:"text-sm text-muted-foreground font-medium",children:"Contract Address:"}),x.jsx(OP,{text:"ASDASDASDA"}),x.jsx(Ie.a,{href:"https://x.com",target:"_blank",rel:"noopener noreferrer",className:"p-2 rounded-lg text-muted-foreground hover:text-foreground transition-colors","aria-label":"Follow on X (Twitter)",whileHover:{scale:1.05},whileTap:{scale:.95},children:x.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:x.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})})})]},"contract")}),x.jsx(yS,{}),x.jsx(VP,{})]})]})})})};var bS={exports:{}};(function(e,t){(function(r,o){e.exports=o(P)})(K_,function(n){return function(r){var o={};function i(a){if(o[a])return o[a].exports;var s=o[a]={i:a,l:!1,exports:{}};return r[a].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=r,i.c=o,i.d=function(a,s,u){i.o(a,s)||Object.defineProperty(a,s,{enumerable:!0,get:u})},i.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},i.t=function(a,s){if(s&1&&(a=i(a)),s&8||s&4&&typeof a=="object"&&a&&a.__esModule)return a;var u=Object.create(null);if(i.r(u),Object.defineProperty(u,"default",{enumerable:!0,value:a}),s&2&&typeof a!="string")for(var l in a)i.d(u,l,(function(c){return a[c]}).bind(null,l));return u},i.n=function(a){var s=a&&a.__esModule?function(){return a.default}:function(){return a};return i.d(s,"a",s),s},i.o=function(a,s){return Object.prototype.hasOwnProperty.call(a,s)},i.p="",i(i.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(r,o,i){i.r(o);var a=i("react"),s=function(){var f=function(h,p){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,g){m.__proto__=g}||function(m,g){for(var v in g)g.hasOwnProperty(v)&&(m[v]=g[v])},f(h,p)};return function(h,p){f(h,p);function m(){this.constructor=h}h.prototype=p===null?Object.create(p):(m.prototype=p.prototype,new m)}}(),u=function(){return u=Object.assign||function(f){for(var h,p=1,m=arguments.length;p<m;p++){h=arguments[p];for(var g in h)Object.prototype.hasOwnProperty.call(h,g)&&(f[g]=h[g])}return f},u.apply(this,arguments)},l=function(f,h){var p={};for(var m in f)Object.prototype.hasOwnProperty.call(f,m)&&h.indexOf(m)<0&&(p[m]=f[m]);if(f!=null&&typeof Object.getOwnPropertySymbols=="function")for(var g=0,m=Object.getOwnPropertySymbols(f);g<m.length;g++)h.indexOf(m[g])<0&&Object.prototype.propertyIsEnumerable.call(f,m[g])&&(p[m[g]]=f[m[g]]);return p};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(h){var p=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return p?new Promise(function(m,g){p.call(navigator,h,m,g)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function c(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var d=function(f){s(h,f);function h(p){var m=f.call(this,p)||this;return m.canvas=null,m.ctx=null,m.requestUserMediaId=0,m.unmounted=!1,m.state={hasUserMedia:!1},m}return h.prototype.componentDidMount=function(){var p=this,m=p.state,g=p.props;if(this.unmounted=!1,!c()){g.onUserMediaError("getUserMedia not supported");return}m.hasUserMedia||this.requestUserMedia(),g.children&&typeof g.children!="function"&&console.warn("children must be a function")},h.prototype.componentDidUpdate=function(p){var m=this.props;if(!c()){m.onUserMediaError("getUserMedia not supported");return}var g=JSON.stringify(p.audioConstraints)!==JSON.stringify(m.audioConstraints),v=JSON.stringify(p.videoConstraints)!==JSON.stringify(m.videoConstraints),y=p.minScreenshotWidth!==m.minScreenshotWidth,b=p.minScreenshotHeight!==m.minScreenshotHeight;(v||y||b)&&(this.canvas=null,this.ctx=null),(g||v)&&(this.stopAndCleanup(),this.requestUserMedia())},h.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},h.stopMediaStream=function(p){p&&(p.getVideoTracks&&p.getAudioTracks?(p.getVideoTracks().map(function(m){p.removeTrack(m),m.stop()}),p.getAudioTracks().map(function(m){p.removeTrack(m),m.stop()})):p.stop())},h.prototype.stopAndCleanup=function(){var p=this.state;p.hasUserMedia&&(h.stopMediaStream(this.stream),p.src&&window.URL.revokeObjectURL(p.src))},h.prototype.getScreenshot=function(p){var m=this,g=m.state,v=m.props;if(!g.hasUserMedia)return null;var y=this.getCanvas(p);return y&&y.toDataURL(v.screenshotFormat,v.screenshotQuality)},h.prototype.getCanvas=function(p){var m=this,g=m.state,v=m.props;if(!this.video||!g.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var y=this.video.videoWidth,b=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var w=y/b;y=v.minScreenshotWidth||this.video.clientWidth,b=y/w,v.minScreenshotHeight&&b<v.minScreenshotHeight&&(b=v.minScreenshotHeight,y=b*w)}this.canvas=document.createElement("canvas"),this.canvas.width=(p==null?void 0:p.width)||y,this.canvas.height=(p==null?void 0:p.height)||b,this.ctx=this.canvas.getContext("2d")}var C=this,S=C.ctx,E=C.canvas;return S&&E&&(E.width=(p==null?void 0:p.width)||E.width,E.height=(p==null?void 0:p.height)||E.height,v.mirrored&&(S.translate(E.width,0),S.scale(-1,1)),S.imageSmoothingEnabled=v.imageSmoothing,S.drawImage(this.video,0,0,(p==null?void 0:p.width)||E.width,(p==null?void 0:p.height)||E.height),v.mirrored&&(S.scale(-1,1),S.translate(-E.width,0))),E},h.prototype.requestUserMedia=function(){var p=this,m=this.props,g=function(b,w){var C={video:typeof w<"u"?w:!0};m.audio&&(C.audio=typeof b<"u"?b:!0),p.requestUserMediaId++;var S=p.requestUserMediaId;navigator.mediaDevices.getUserMedia(C).then(function(E){p.unmounted||S!==p.requestUserMediaId?h.stopMediaStream(E):p.handleUserMedia(null,E)}).catch(function(E){p.handleUserMedia(E)})};if("mediaDevices"in navigator)g(m.audioConstraints,m.videoConstraints);else{var v=function(b){return{optional:[{sourceId:b}]}},y=function(b){var w=b.deviceId;return typeof w=="string"?w:Array.isArray(w)&&w.length>0?w[0]:typeof w=="object"&&w.ideal?w.ideal:null};MediaStreamTrack.getSources(function(b){var w=null,C=null;b.forEach(function(k){k.kind==="audio"?w=k.id:k.kind==="video"&&(C=k.id)});var S=y(m.audioConstraints);S&&(w=S);var E=y(m.videoConstraints);E&&(C=E),g(v(w),v(C))})}},h.prototype.handleUserMedia=function(p,m){var g=this.props;if(p||!m){this.setState({hasUserMedia:!1}),g.onUserMediaError(p);return}this.stream=m;try{this.video&&(this.video.srcObject=m),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(m)})}g.onUserMedia(m)},h.prototype.render=function(){var p=this,m=this,g=m.state,v=m.props,y=v.audio;v.forceScreenshotSourceSize;var b=v.disablePictureInPicture;v.onUserMedia,v.onUserMediaError,v.screenshotFormat,v.screenshotQuality,v.minScreenshotWidth,v.minScreenshotHeight,v.audioConstraints,v.videoConstraints,v.imageSmoothing;var w=v.mirrored,C=v.style,S=C===void 0?{}:C,E=v.children,k=l(v,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),R=w?u(u({},S),{transform:(S.transform||"")+" scaleX(-1)"}):S,_={getScreenshot:this.getScreenshot.bind(this)};return a.createElement(a.Fragment,null,a.createElement("video",u({autoPlay:!0,disablePictureInPicture:b,src:g.src,muted:!y,playsInline:!0,ref:function(N){p.video=N},style:R},k)),E&&E(_))},h.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},h}(a.Component);o.default=d},react:function(r,o){r.exports=n}}).default})})(bS);var GP=bS.exports;const KP=Nb(GP);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var wS=function(e,t){return(wS=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r.hasOwnProperty(o)&&(n[o]=r[o])})(e,t)};function pr(e,t){function n(){this.constructor=e}wS(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function Z(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(l){try{u(r.next(l))}catch(c){i(c)}}function s(l){try{u(r.throw(l))}catch(c){i(c)}}function u(l){l.done?o(l.value):new n(function(c){c(l.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})}function ee(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){a=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(c[0]===6&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(d){c=[6,d],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}var qP=function(){function e(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(t,n){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+n+"."),this.platformName=t,this.platform=n},e.prototype.registerFlag=function(t,n,r){if(this.flagRegistry[t]={evaluationFn:n,setHook:r},this.urlFlags[t]!=null){var o=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+o+"."),this.set(t,o)}},e.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},e.prototype.getNumber=function(t){return this.get(t)},e.prototype.getBool=function(t){return this.get(t)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(t,n){if(this.flagRegistry[t]==null)throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)},e.prototype.evaluateFlag=function(t){if(this.flagRegistry[t]==null)throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},e.prototype.setFlags=function(t){this.flags=Object.assign({},t)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var t=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var n,r,o=(n=this.global.location.search,r={},n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(i){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];return XP(r,a[0],a[1]),a.join("=")}),r);"tfjsflags"in o&&o.tfjsflags.split(",").forEach(function(i){var a=i.split(":"),s=a[0],u=a[1];t.urlFlags[s]=function(l,c){if((c=c.toLowerCase())==="true"||c==="false")return c==="true";if(""+ +c===c)return+c;throw new Error("Could not parse value flag value "+c+" for flag "+l+".")}(s,u)})}},e}();function XP(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function H(){return CS}var CS=null,Pc=new Map,om=new Map;function SS(e,t){var n=kS(e,t);return Pc.get(n)}function YP(e){return om.get(e)}function K1(e){for(var t=Pc.entries(),n=[];;){var r=t.next(),o=r.done,i=r.value;if(o)break;var a=i[0],s=i[1];a.split("_")[0]===e&&n.push(s)}return n}function ES(e){var t=e.kernelName,n=e.backendName,r=kS(t,n);if(Pc.has(r))throw new Error("The kernel '"+t+"' for backend '"+n+"' is already registered");Pc.set(r,e)}function QP(e){var t=e.kernelName;om.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),om.set(t,e)}function kS(e,t){return t+"_"+e}function im(e,t,n){return Math.max(e,Math.min(t,n))}function _S(e){return e%2==0?e:e+1}function JP(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function A(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function Ne(e,t,n){n===void 0&&(n=""),A(Et(e,t),function(){return n+" Shapes "+e+" and "+t+" must match"})}function qa(e){A(e!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function za(e,t,n){if(t===void 0&&(t=[]),n===void 0&&(n=!1),t==null&&(t=[]),Array.isArray(e)||Pr(e)&&!n)for(var r=0;r<e.length;++r)za(e[r],t,n);else t.push(e);return t}function ne(e){if(e.length===0)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function Et(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function it(e){return e%1==0}function ZP(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function am(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function wa(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function q1(e,t,n){return t===void 0&&(t=function(r){return 0}),new Promise(function(r,o){var i=0,a=function(){if(e())r();else{i++;var s=t(i);n!=null&&i>=n?o():setTimeout(a,s)}};a()})}function e3(e,t){for(var n=1,r=-1,o=0;o<e.length;++o)if(e[o]>=0)n*=e[o];else if(e[o]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+o);r=o}else if(e[o]<0)throw Error("Shapes can not be < 0. Found "+e[o]+" at dim "+o);if(r===-1){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(n===0)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var i=e.slice();return i[r]=t/n,i}function bt(e,t){var n=t.length;return A((e=e==null?t.map(function(r,o){return o}):[].concat(e)).every(function(r){return r>=-n&&r<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e}),A(e.every(function(r){return it(r)}),function(){return"All values in axis param must be integers but got axis "+e}),e.map(function(r){return r<0?n+r:r})}function ci(e,t){for(var n=[],r=[],o=t!=null&&Array.isArray(t)&&t.length===0,i=t==null||o?null:bt(t,e).sort(),a=0,s=0;s<e.length;++s){if(i!=null){if(i[a]===s&&e[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(i[a]==null||i[a]>s)&&e[s]===1&&(n.push(e[s]),r.push(s)),i[a]<=s&&a++}e[s]!==1&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function uu(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else{if(e!=="bool")throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function Dc(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else{if(e!=="string")throw new Error("Unknown data type "+e);n=new Array(t)}return n}function t3(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function n3(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function r3(e,t){return t!=="complex64"&&(t!=="float32"||e==="complex64")&&(t!=="int32"||e==="float32"||e==="complex64")&&(t!=="bool"||e!=="bool")}function Pr(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function RS(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error("Unknown dtype "+e)}function o3(e){if(e==null)return 0;var t=0;return e.forEach(function(n){return t+=n.length}),t}function og(e){return typeof e=="string"||e instanceof String}function i3(e){return typeof e=="boolean"}function a3(e){return typeof e=="number"}function Au(e){return Array.isArray(e)?Au(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":a3(e)?"float32":og(e)?"string":i3(e)?"bool":"float32"}function sm(e){return!!(e&&e.constructor&&e.call&&e.apply)}function um(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function Dr(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function TS(e,t,n){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=za(e)),n&&t3(e,t),function(i,a){return i instanceof Float32Array&&a==="float32"||i instanceof Int32Array&&a==="int32"||i instanceof Uint8Array&&a==="bool"}(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){for(var r=new Uint8Array(e.length),o=0;o<r.length;++o)Math.round(e[o])!==0&&(r[o]=1);return r}throw new Error("Unknown data type "+t)}function X1(e,t){if(e.length===0)return t[0];var n=e.reduce(function(r,o){return r*o});if(n===0)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return function r(o,i,a){var s=new Array;if(i.length===1)for(var u=i[0],l=0;l<u;l++)s[l]=a[o+l];else{u=i[0];var c=i.slice(1),d=c.reduce(function(f,h){return f*h});for(l=0;l<u;l++)s[l]=r(o+l*d,c,a)}return s}(0,e,t)}function AS(e,t){for(var n=Iu(e,t),r=0;r<n.length;r++)n[r]=1;return n}function Iu(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error("Unknown data type "+t)}function Cr(){return H().platform.now()}function IS(e){e.forEach(function(t){A(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."})})}function s3(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",H().platform.encode(e,t)}function Mc(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",H().platform.decode(e,t)}function Y1(e,t,n){if(t===0)return 0;if(t===1)return e[0];for(var r=e[e.length-1],o=0;o<e.length-1;++o)r+=n[o]*e[o];return r}function u3(e,t,n){if(t===0)return[];if(t===1)return[e];for(var r=new Array(t),o=0;o<r.length-1;++o)r[o]=Math.floor(e/n[o]),e-=r[o]*n[o];return r[r.length-1]=e,r}var l3=function(){function e(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new c3)}return e.prototype.profileKernel=function(t,n,r){var o,i=this,a=this.backendTimer.time(function(){o=r()});return o.forEach(function(s){s.data().then(function(u){(function(l,c,d){if(c!=="float32")return!1;for(var f=0;f<l.length;f++){var h=l[f];if(isNaN(h)||!isFinite(h))return console.warn("Found "+h+" in the result of '"+d+"'"),!0}})(u,s.dtype,t),a.then(function(l){var c="";l.getExtraProfileInfo!=null&&(c=l.getExtraProfileInfo()),i.logger.logKernelProfile(t,s,u,l.kernelMs,n,c)})})}),o},e}(),c3=function(){function e(){}return e.prototype.logKernelProfile=function(t,n,r,o,i,a){var s=typeof o=="number"?wa(o+"ms",9):o.error,u=wa(t,25),l=n.rank,c=n.size,d=wa(n.shape.toString(),14),f="";for(var h in i){var p=i[h].shape||n.shape,m=p.length;f+=h+": "+m+"D "+(m>0?p:"")+" "}console.log("%c"+u+"	%c"+s+"	%c"+l+"D "+d+"	%c"+c+"	%c"+f+"	%c"+a,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}(),Q1=20,fs=3,vh=7;function d3(e,t,n,r){var o=Dr(t),i=function(l,c,d,f){var h=ne(c),p=f[f.length-1],m=new Array(p).fill(0),g=c.length,v=d==="complex64"?ps(l):l;if(g>1)for(var y=0;y<h/p;y++)for(var b=y*p,w=0;w<p;w++)m[w]=Math.max(m[w],hs(v[b+w],0,d).length);return m}(e,t,n,o),a=t.length,s=function l(c,d,f,h,p,m){m===void 0&&(m=!0);var g=f==="complex64"?2:1,v=d[0],y=d.length;if(y===0)return f==="complex64"?[hs(ps(c)[0],0,f)]:f==="bool"?[NS(c[0])]:[c[0].toString()];if(y===1){if(v>Q1){var b=fs*g,w=Array.from(c.slice(0,b)),C=Array.from(c.slice((v-fs)*g,v*g));return f==="complex64"&&(w=ps(w),C=ps(C)),["["+w.map(function(V,$){return hs(V,p[$],f)}).join(", ")+", ..., "+C.map(function(V,$){return hs(V,p[v-fs+$],f)}).join(", ")+"]"]}return["["+(f==="complex64"?ps(c):Array.from(c)).map(function(V,$){return hs(V,p[$],f)}).join(", ")+"]"]}var S=d.slice(1),E=h.slice(1),k=h[0]*g,R=[];if(v>Q1){for(var _=0;_<fs;_++){var N=(I=_*k)+k;R.push.apply(R,l(c.slice(I,N),S,f,E,p,!1))}for(R.push("..."),_=v-fs;_<v;_++)N=(I=_*k)+k,R.push.apply(R,l(c.slice(I,N),S,f,E,p,_===v-1))}else for(_=0;_<v;_++){var I;N=(I=_*k)+k,R.push.apply(R,l(c.slice(I,N),S,f,E,p,_===v-1))}var L=y===2?",":"";for(R[0]="["+R[0]+L,_=1;_<R.length-1;_++)R[_]=" "+R[_]+L;var O=`,
`;for(_=2;_<y;_++)O+=`
`;return R[R.length-1]=" "+R[R.length-1]+"]"+(m?"":O),R}(e,t,n,o,i),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+a),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(s.map(function(l){return"    "+l}).join(`
`)),u.join(`
`)}function hs(e,t,n){return wa(Array.isArray(e)?parseFloat(e[0].toFixed(vh))+" + "+parseFloat(e[1].toFixed(vh))+"j":og(e)?"'"+e+"'":n==="bool"?NS(e):parseFloat(e.toFixed(vh)).toString(),t)}function NS(e){return e===0?"false":"true"}function ps(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var lu=function(){function e(t,n,r){var o=this;if(this.dtype=n,this.shape=t.slice(),this.size=ne(t),r!=null){var i=r.length;A(i===this.size,function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+o.size+"'."})}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Dc(n,this.size),this.strides=Dr(t)}return e.prototype.set=function(t){for(var n=this,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];r.length===0&&(r=[0]),A(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+n.rank+")"});var i=this.locToIndex(r);this.values[i]=t},e.prototype.get=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.length===0&&(t=[0]);for(var r=0,o=0,i=t;o<i.length;o++){var a=i[o];if(a<0||a>=this.shape[r]){var s="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(s)}r++}for(var u=t[t.length-1],l=0;l<t.length-1;++l)u+=this.strides[l]*t[l];return this.values[u]},e.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var n=t[t.length-1],r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return n},e.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var n=new Array(this.shape.length),r=0;r<n.length-1;++r)n[r]=Math.floor(t/this.strides[r]),t-=n[r]*this.strides[r];return n[n.length-1]=t,n},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return _r().makeTensor(this.values,this.shape,this.dtype)},e}(),_r=null,W=null,PS=null,qe=function(){function e(t,n,r,o){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=ne(t),this.strides=Dr(t),this.dataId=r,this.id=o,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),A(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(t,n){return this.throwIfDisposed(),this.reshape([t,n])},e.prototype.as3D=function(t,n,r){return this.throwIfDisposed(),this.reshape([t,n,r])},e.prototype.as4D=function(t,n,r,o){return this.throwIfDisposed(),this.reshape([t,n,r,o])},e.prototype.as5D=function(t,n,r,o,i){return this.throwIfDisposed(),this.reshape([t,n,r,o,i])},e.prototype.asType=function(t){return this.throwIfDisposed(),W.cast(this,t)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return Z(this,void 0,void 0,function(){var t;return ee(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,W.buffer(this.shape,this.dtype,t)]}})})},e.prototype.bufferSync=function(){return W.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return Z(this,void 0,void 0,function(){var t;return ee(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,X1(this.shape,t)]}})})},e.prototype.arraySync=function(){return X1(this.shape,this.dataSync())},e.prototype.data=function(){return Z(this,void 0,void 0,function(){var t,n;return ee(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),t=_r().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:n=r.sent();try{return[2,n.map(function(o){return Mc(o)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,t]}})})},e.prototype.dataSync=function(){this.throwIfDisposed();var t=_r().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(n){return Mc(n)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},e.prototype.bytes=function(){return Z(this,void 0,void 0,function(){var t;return ee(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),[4,_r().read(this.dataId)];case 1:return t=n.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},e.prototype.dispose=function(){this.isDisposed||(_r().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(t){return t===void 0&&(t=!1),W.print(this,t)},e.prototype.reshape=function(t){return this.throwIfDisposed(),W.reshape(this,t)},e.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},e.prototype.expandDims=function(t){return t===void 0&&(t=0),W.expandDims(this,t)},e.prototype.cumsum=function(t,n,r){return t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1),W.cumsum(this,t,n,r)},e.prototype.squeeze=function(t){return this.throwIfDisposed(),W.squeeze(this,t)},e.prototype.clone=function(){return this.throwIfDisposed(),W.clone(this)},e.prototype.oneHot=function(t,n,r){return this.throwIfDisposed(),W.oneHot(this,t,n,r)},e.prototype.toString=function(t){return t===void 0&&(t=!1),d3(this.dataSync(),this.shape,this.dtype,t)},e.prototype.tile=function(t){return this.throwIfDisposed(),W.tile(this,t)},e.prototype.gather=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),W.gather(this,t,n)},e.prototype.matMul=function(t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!1),this.throwIfDisposed(),W.matMul(this,t,n,r)},e.prototype.dot=function(t){return this.throwIfDisposed(),W.dot(this,t)},e.prototype.norm=function(t,n,r){return t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1),this.throwIfDisposed(),W.norm(this,t,n,r)},e.prototype.slice=function(t,n){return this.throwIfDisposed(),W.slice(this,t,n)},e.prototype.reverse=function(t){return this.throwIfDisposed(),W.reverse(this,t)},e.prototype.concat=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),W.concat([this].concat(t),n)},e.prototype.split=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),W.split(this,t,n)},e.prototype.stack=function(t,n){return n===void 0&&(n=0),W.stack([this,t],n)},e.prototype.unstack=function(t){return t===void 0&&(t=0),W.unstack(this,t)},e.prototype.pad=function(t,n){return n===void 0&&(n=0),W.pad(this,t,n)},e.prototype.batchNormalization=function(t,n,r,o,i){return r===void 0&&(r=.001),PS("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,n,i,o,r)},e.prototype.batchNorm=function(t,n,r,o,i){return i===void 0&&(i=.001),this.throwIfDisposed(),W.batchNorm(this,t,n,r,o,i)},e.prototype.all=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),W.all(this,t,n)},e.prototype.any=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),W.any(this,t,n)},e.prototype.logSumExp=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),W.logSumExp(this,t,n)},e.prototype.sum=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),W.sum(this,t,n)},e.prototype.prod=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),W.prod(this,t,n)},e.prototype.mean=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),W.mean(this,t,n)},e.prototype.min=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),W.min(this,t,n)},e.prototype.max=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),W.max(this,t,n)},e.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),W.argMin(this,t)},e.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),W.argMax(this,t)},e.prototype.cast=function(t){return this.throwIfDisposed(),W.cast(this,t)},e.prototype.add=function(t){return this.throwIfDisposed(),W.add(this,t)},e.prototype.addStrict=function(t){return this.throwIfDisposed(),W.addStrict(this,t)},e.prototype.atan2=function(t){return this.throwIfDisposed(),W.atan2(this,t)},e.prototype.sub=function(t){return this.throwIfDisposed(),W.sub(this,t)},e.prototype.subStrict=function(t){return this.throwIfDisposed(),W.subStrict(this,t)},e.prototype.pow=function(t){return this.throwIfDisposed(),W.pow(this,t)},e.prototype.powStrict=function(t){return this.throwIfDisposed(),W.powStrict(this,t)},e.prototype.mul=function(t){return this.throwIfDisposed(),W.mul(this,t)},e.prototype.mulStrict=function(t){return this.throwIfDisposed(),W.mulStrict(this,t)},e.prototype.div=function(t){return this.throwIfDisposed(),W.div(this,t)},e.prototype.divNoNan=function(t){return this.throwIfDisposed(),W.divNoNan(this,t)},e.prototype.floorDiv=function(t){return this.throwIfDisposed(),W.floorDiv(this,t)},e.prototype.divStrict=function(t){return this.throwIfDisposed(),W.divStrict(this,t)},e.prototype.minimum=function(t){return this.throwIfDisposed(),W.minimum(this,t)},e.prototype.minimumStrict=function(t){return this.throwIfDisposed(),W.minimumStrict(this,t)},e.prototype.maximum=function(t){return this.throwIfDisposed(),W.maximum(this,t)},e.prototype.maximumStrict=function(t){return this.throwIfDisposed(),W.maximumStrict(this,t)},e.prototype.mod=function(t){return this.throwIfDisposed(),W.mod(this,t)},e.prototype.modStrict=function(t){return this.throwIfDisposed(),W.modStrict(this,t)},e.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),W.squaredDifferenceStrict(this,t)},e.prototype.transpose=function(t){return this.throwIfDisposed(),W.transpose(this,t)},e.prototype.notEqual=function(t){return this.throwIfDisposed(),W.notEqual(this,t)},e.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),W.notEqualStrict(this,t)},e.prototype.less=function(t){return this.throwIfDisposed(),W.less(this,t)},e.prototype.lessStrict=function(t){return this.throwIfDisposed(),W.lessStrict(this,t)},e.prototype.equal=function(t){return this.throwIfDisposed(),W.equal(this,t)},e.prototype.equalStrict=function(t){return this.throwIfDisposed(),W.equalStrict(this,t)},e.prototype.lessEqual=function(t){return this.throwIfDisposed(),W.lessEqual(this,t)},e.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),W.lessEqualStrict(this,t)},e.prototype.greater=function(t){return this.throwIfDisposed(),W.greater(this,t)},e.prototype.greaterStrict=function(t){return this.throwIfDisposed(),W.greaterStrict(this,t)},e.prototype.greaterEqual=function(t){return this.throwIfDisposed(),W.greaterEqual(this,t)},e.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),W.greaterEqualStrict(this,t)},e.prototype.logicalAnd=function(t){return this.throwIfDisposed(),W.logicalAnd(this,t)},e.prototype.logicalOr=function(t){return this.throwIfDisposed(),W.logicalOr(this,t)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),W.logicalNot(this)},e.prototype.logicalXor=function(t){return this.throwIfDisposed(),W.logicalXor(this,t)},e.prototype.where=function(t,n){return this.throwIfDisposed(),W.where(t,this,n)},e.prototype.neg=function(){return this.throwIfDisposed(),W.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),W.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),W.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),W.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),W.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),W.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),W.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),W.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),W.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),W.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),W.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),W.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),W.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),W.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),W.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),W.abs(this)},e.prototype.clipByValue=function(t,n){return this.throwIfDisposed(),W.clipByValue(this,t,n)},e.prototype.relu=function(){return this.throwIfDisposed(),W.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),W.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),W.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),W.selu(this)},e.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),W.leakyRelu(this,t)},e.prototype.prelu=function(t){return this.throwIfDisposed(),W.prelu(this,t)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),W.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),W.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),W.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),W.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),W.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),W.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),W.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),W.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),W.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),W.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),W.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),W.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),W.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),W.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),W.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),W.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),W.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),W.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),W.round(this)},e.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),W.step(this,t)},e.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),W.softmax(this,t)},e.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),W.logSoftmax(this,t)},e.prototype.resizeBilinear=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),W.image.resizeBilinear(this,t,n)},e.prototype.resizeNearestNeighbor=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),W.image.resizeNearestNeighbor(this,t,n)},e.prototype.conv1d=function(t,n,r,o,i,a){return o===void 0&&(o="NWC"),i===void 0&&(i=1),this.throwIfDisposed(),W.conv1d(this,t,n,r,o,i,a)},e.prototype.conv2d=function(t,n,r,o,i,a){return o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),W.conv2d(this,t,n,r,o,i,a)},e.prototype.conv2dTranspose=function(t,n,r,o,i){return this.throwIfDisposed(),W.conv2dTranspose(this,t,n,r,o,i)},e.prototype.depthwiseConv2D=function(t,n,r,o,i,a){return o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),W.depthwiseConv2d(this,t,n,r,o,i,a)},e.prototype.separableConv2d=function(t,n,r,o,i,a){return i===void 0&&(i=[1,1]),a===void 0&&(a="NHWC"),this.throwIfDisposed(),W.separableConv2d(this,t,n,r,o,i,a)},e.prototype.avgPool=function(t,n,r,o){return this.throwIfDisposed(),W.avgPool(this,t,n,r,o)},e.prototype.maxPool=function(t,n,r,o){return this.throwIfDisposed(),W.maxPool(this,t,n,r,o)},e.prototype.localResponseNormalization=function(t,n,r,o){return t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),o===void 0&&(o=.5),W.localResponseNormalization(this,t,n,r,o)},e.prototype.pool=function(t,n,r,o,i){return this.throwIfDisposed(),W.pool(this,t,n,r,o,i)},e.prototype.variable=function(t,n,r){return t===void 0&&(t=!0),this.throwIfDisposed(),_r().makeVariable(this,t,n,r)},e.prototype.unsortedSegmentSum=function(t,n){return this.throwIfDisposed(),W.unsortedSegmentSum(this,t,n)},e.prototype.batchToSpaceND=function(t,n){return this.throwIfDisposed(),W.batchToSpaceND(this,t,n)},e.prototype.spaceToBatchND=function(t,n){return this.throwIfDisposed(),W.spaceToBatchND(this,t,n)},e.prototype.topk=function(t,n){return t===void 0&&(t=1),n===void 0&&(n=!0),this.throwIfDisposed(),W.topk(this,t,n)},e.prototype.stridedSlice=function(t,n,r,o,i,a,s,u){return o===void 0&&(o=0),i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=0),u===void 0&&(u=0),this.throwIfDisposed(),W.stridedSlice(this,t,n,r,o,i,a,s,u)},e.prototype.depthToSpace=function(t,n){return this.throwIfDisposed(),W.depthToSpace(this,t,n)},e.prototype.fft=function(){return this.throwIfDisposed(),W.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),W.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),W.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),W.spectral.irfft(this)},e}();Object.defineProperty(qe,Symbol.hasInstance,{value:function(e){return!!e&&e.dataId!=null&&e.shape!=null&&e.dtype!=null}});var J1,lm,cm,dm,fm,Va=function(e){function t(n,r,o,i){var a=e.call(this,n.shape,n.dtype,n.dataId,i)||this;return a.trainable=r,a.name=o,a}return pr(t,e),t.prototype.assign=function(n){if(n.dtype!==this.dtype)throw new Error("dtype of the new value ("+n.dtype+") and previous value ("+this.dtype+") must match");if(!Et(n.shape,this.shape))throw new Error("shape of the new value ("+n.shape+") and previous value ("+this.shape+") must match");_r().disposeTensor(this),this.dataId=n.dataId,_r().incRef(this,null)},t.prototype.dispose=function(){_r().disposeVariable(this),this.isDisposedInternal=!0},t}(qe);Object.defineProperty(Va,Symbol.hasInstance,{value:function(e){return e instanceof qe&&e.assign!=null&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(J1||(J1={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(lm||(lm={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(cm||(cm={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(dm||(dm={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(fm||(fm={}));var f3={float32:dm,int32:lm,bool:cm,complex64:fm};function At(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error("Can not upcast "+e+" with "+t)}return f3[e][t]}function gh(e){return At(e,"int32")}function Ze(e,t){if(e.dtype===t.dtype)return[e,t];var n=At(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function h3(e,t){A(e.dtype===t.dtype,function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"})}function DS(e){var t=[];return function n(r,o,i){if(r!=null){if(r instanceof qe)return void o.push(r);if(a=r,!(!Array.isArray(a)&&typeof a!="object")){var a,s=r;for(var u in s){var l=s[u];i.has(l)||(i.add(l),n(l,o,i))}}}}(e,t,new Set),t}var yh,Z1=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},e}(),p3=function(){function e(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Z1}return e.prototype.ready=function(){return Z(this,void 0,void 0,function(){var t,n,r;return ee(this,function(o){switch(o.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];t=this.getSortedBackends(),n=0,o.label=1;case 1:return n<t.length?(r=t[n],[4,this.initializeBackend(r).success]):[3,5];case 2:return o.sent()?[4,this.setBackend(r)]:[3,4];case 3:return o.sent(),[2];case 4:return n++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(e.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var t=this.initializeBackendsAndReturnBest(),n=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+n+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(n)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(t){return!(t in this.registry)&&(!(t in this.registryFactory)||this.initializeBackend(t).asyncInit)?null:this.registry[t]},e.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},e.prototype.registerBackend=function(t,n,r){return r===void 0&&(r=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:n,priority:r},!0)},e.prototype.setBackend=function(t){return Z(this,void 0,void 0,function(){var n,r,o;return ee(this,function(i){switch(i.label){case 0:if(this.registryFactory[t]==null)throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,this.registry[t]!=null?[3,4]:(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,n.asyncInit?[4,r]:[3,2]);case 1:return o=i.sent(),[3,3];case 2:o=r,i.label=3;case 3:if(!o)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new l3(this.backendInstance),[2,!0]}})})},e.prototype.setupRegisteredKernels=function(){var t=this;K1(this.backendName).forEach(function(n){n.setupFunc!=null&&n.setupFunc(t.backendInstance)})},e.prototype.disposeRegisteredKernels=function(t){var n=this;K1(t).forEach(function(r){r.disposeFunc!=null&&r.disposeFunc(n.registry[t])})},e.prototype.initializeBackend=function(t){var n=this,r=this.registryFactory[t];if(r==null)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var o=r.factory();if(Promise.resolve(o)===o){var i=++this.pendingBackendInitId,a=o.then(function(s){return!(i<n.pendingBackendInitId)&&(n.registry[t]=s,n.pendingBackendInit=null,!0)}).catch(function(s){return!(i<n.pendingBackendInitId)&&(n.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),!1)});return this.pendingBackendInit=a,{success:a,asyncInit:!0}}return this.registry[t]=o,{success:!0,asyncInit:!1}}catch(s){return console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var t=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(n,r){return t.registryFactory[r].priority-t.registryFactory[n].priority})},e.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),n=0;n<t.length;n++){var r=t[n],o=this.initializeBackend(r),i=o.success,a=o.asyncInit;if(a||i)return{name:r,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(t,n){var r=this.state.tensorInfo.get(n),o=r.backend,i=this.readSync(n);o.disposeData(n),r.backend=t,t.move(n,i,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},e.prototype.tidy=function(t,n){var r,o=this,i=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun(function(){return o.startScope(i)},function(){return o.endScope(r)},function(){return(r=n())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},e.prototype.scopedRun=function(t,n,r){t();try{var o=r();return n(),o}catch(i){throw n(),i}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(t){var n=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),r={x:t};return this.addTapeNode(this.state.activeScope.name,r,[n],function(o){return{x:function(){return o.toFloat()}}},[]),n},e.prototype.runKernel=function(t,n,r,o,i){return this.runKernelFunc(null,n,null,t,r,o,i)},e.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},e.prototype.checkKernelForMemLeak=function(t,n,r){var o=this.backend.numDataIds(),i=0;r.forEach(function(u){i+=u.dtype==="complex64"?3:1});var a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=o-n-i-a;if(s>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+s+" data ids) after running '"+t+"'")},e.prototype.runKernelFunc=function(t,n,r,o,i,a,s){var u,l=this;a===void 0&&(a=[]),s===void 0&&(s=[]);var c=[],d=this.isTapeOn();o==null&&(o=this.state.activeScope!=null?this.state.activeScope.name:"");var f,h=function(y){d&&(c=y.map(function(b){return l.keep(l.clone(b))}))},p=this.state.numBytes,m=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var g,v=SS(o,this.backendName);return f=v!=null?function(){var y=l.backend.numDataIds();g=v.kernelFunc({inputs:n,attrs:i,backend:l.backend});var b=Array.isArray(g)?g:[g];l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(o,y,b);var w=b.map(function(S){var E=S.dataId,k=S.shape,R=S.dtype;return l.makeTensorFromDataId(E,k,R)}),C=w.filter(function(S,E){return s[E]});return h((a||[]).slice().concat(C)),w}:function(){var y=l.backend.numDataIds();g=l.tidy(function(){return t(l.backend,h)});var b=Array.isArray(g)?g:[g];return l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(o,y,b),b},this.scopedRun(function(){return l.state.kernelDepth++},function(){return l.state.kernelDepth--},function(){u=l.ENV.getBool("DEBUG")?l.profiler.profileKernel(o,n,function(){return f()}):f()}),d&&this.addTapeNode(o,n,u,r,c),this.state.profiling&&this.state.activeProfile.kernels.push({name:o,bytesAdded:this.state.numBytes-p,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-m,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(n).map(function(y){return n[y].shape}),outputShapes:u.map(function(y){return y.shape})}),Array.isArray(g)?u:u[0]},e.prototype.makeTensor=function(t,n,r,o){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",o=o||this.backend;var i=t;r==="string"&&og(t[0])&&(i=t.map(function(c){return s3(c)}));var a=o.write(i,n,r),s=new qe(n,r,a,this.nextTensorId());if(this.incRef(s,o),r==="string"){var u=this.state.tensorInfo.get(a),l=o3(i);this.state.numBytes+=l-u.bytes,u.bytes=l}return s},e.prototype.makeTensorFromDataId=function(t,n,r,o){var i=new qe(n,r=r||"float32",t,this.nextTensorId());return this.incRef(i,o),i},e.prototype.makeVariable=function(t,n,r,o){n===void 0&&(n=!0),r=r||this.nextVariableId().toString(),o!=null&&o!==t.dtype&&(t=t.asType(o));var i=new Va(t,n,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},e.prototype.incRef=function(t,n){var r=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var o=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(o=t.size*RS(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:o,refCount:0}),this.state.numBytes+=o}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof Va||this.track(t)},e.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;var n=this.state.tensorInfo.get(t.dataId);n.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=n.bytes),this.state.numDataBuffers--,n.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var n=this.state.registeredVariables[t];this.disposeVariable(n)}},e.prototype.disposeVariable=function(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]},e.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},e.prototype.profile=function(t){return Z(this,void 0,void 0,function(){var n,r;return ee(this,function(o){return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(i){return i.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},e.prototype.addTapeNode=function(t,n,r,o,i){var a=this,s={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:r,saved:i},u=YP(t);u!=null&&(o=u.gradFunc),o!=null&&(s.gradient=function(l){return l=l.map(function(c,d){if(c==null){var f=r[d],h=Iu(f.size,f.dtype);return a.makeTensor(h,f.shape,f.dtype)}return c}),o(l.length>1?l:l[0],i)}),this.state.activeTape.push(s)},e.prototype.keep=function(t){return t.kept=!0,t},e.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(t){var n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n},e.prototype.endScope=function(t){for(var n=this,r=DS(t),o=new Set(r.map(function(u){return u.id})),i=0;i<this.state.activeScope.track.length;i++){var a=this.state.activeScope.track[i];a.kept||o.has(a.id)||a.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(u){u.kept||u.scopeId!==s.id||n.track(u)})},e.prototype.gradients=function(t,n,r,o){var i=this;if(o===void 0&&(o=!1),A(n.length>0,function(){return"gradients() received an empty list of xs."}),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var a=this.scopedRun(function(){return i.startTape()},function(){return i.endTape()},function(){return i.tidy("forward",t)});A(a instanceof qe,function(){return"The result y returned by f() must be a tensor."});var s=function(u,l,c){for(var d={},f={},h=0;h<l.length;h++)d[l[h].id]=!0;for(h=0;h<u.length;h++){var p=(S=u[h]).inputs;for(var m in p){for(var g=p[m],v=!1,y=0;y<l.length;y++)if(d[g.id]){S.outputs.forEach(function(_){return d[_.id]=!0}),v=!0,f[S.id]=!0;break}if(v)break}}var b={};b[c.id]=!0;var w={};for(h=u.length-1;h>=0;h--)for(p=(S=u[h]).inputs,y=0;y<S.outputs.length;y++)if(b[S.outputs[y].id]){for(var m in p)b[p[m].id]=!0,w[S.id]=!0;break}var C=[];for(h=0;h<u.length;h++){var S;if(f[(S=u[h]).id]&&w[S.id]){var E={};for(var m in S.inputs){var k=S.inputs[m];d[k.id]&&(E[m]=k)}var R=Object.assign({},S);R.inputs=E,R.outputs=S.outputs,C.push(R)}}return C}(this.state.activeTape,n,a);if(!o&&s.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var u,l,c={};c[a.id]=r??(u=a.shape,l=AS(ne(u),"float32"),F.makeTensor(l,u,"float32")),function(f,h,p){for(var m=function(v){var y=h[v],b=[];if(y.outputs.forEach(function(E){var k=f[E.id];k!=null?b.push(k):b.push(null)}),y.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+y.kernelName+".");var w=y.gradient(b),C=function(E){if(!(E in w))throw new Error("Cannot backprop through input "+E+". Available gradients found: "+Object.keys(w)+".");var k=p(function(){return w[E]()});if(k.dtype!=="float32")throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input "+E+" must have 'float32' dtype, but has '"+k.dtype+"'");var R=y.inputs[E];if(!Et(k.shape,R.shape))throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input '"+E+"' has shape '"+k.shape+"', which does not match the shape of the input '"+R.shape+"'");if(f[R.id]==null)f[R.id]=k;else{var _=f[R.id];f[R.id]=_.add(k),_.dispose()}};for(var S in y.inputs)C(S)},g=h.length-1;g>=0;g--)m(g)}(c,s,function(f){return i.tidy(f)});var d=n.map(function(f){return c[f.id]});return i.state.gradientDepth===0&&(i.state.activeTape.forEach(function(f){for(var h=0,p=f.saved;h<p.length;h++)p[h].dispose()}),i.state.activeTape=null),{value:a,grads:d}})},e.prototype.customGrad=function(t){var n=this;return A(sm(t),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];A(o.every(function(s){return s instanceof qe}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var a={};return o.forEach(function(s,u){a[u]=s}),n.runKernelFunc(function(s,u){return A((r=t.apply(void 0,o.concat([u]))).value instanceof qe,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),A(sm(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},a,function(s,u){var l=r.gradFunc(s,u),c=Array.isArray(l)?l:[l];A(c.length===o.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),A(c.every(function(f){return f instanceof qe}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var d={};return c.forEach(function(f,h){d[h]=function(){return f}}),d})}},e.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},e.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},e.prototype.time=function(t){return Z(this,void 0,void 0,function(){var n,r;return ee(this,function(o){switch(o.label){case 0:return n=Cr(),[4,this.backend.time(t)];case 1:return(r=o.sent()).wallMs=Cr()-n,[2,r]}})})},e.prototype.track=function(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Z1,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),F=function(){var e=function(){if(yh==null){var n=void 0;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else{if(typeof self>"u")throw new Error("Could not find a global object");n=self}yh=n}return yh}();if(e._tfengine==null){var t=new qP(e);e._tfengine=new p3(t)}return function(n){CS=n}(e._tfengine.ENV),_r=function(){return e._tfengine},e._tfengine}();function MS(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var Wr=H();Wr.registerFlag("DEBUG",function(){return!1},function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Wr.registerFlag("IS_BROWSER",function(){return MS()}),Wr.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),Wr.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),Wr.registerFlag("PROD",function(){return!1}),Wr.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return Wr.getBool("DEBUG")}),Wr.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),Wr.registerFlag("IS_TEST",function(){return!1});var cu,bn,gn,ui={},xh={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function m3(e,t){ui[e]=t}function Lr(e){e in ui||(ui[e]=function(n){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=function(o){if(typeof OffscreenCanvas<"u"&&o===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(n);return r.addEventListener("webglcontextlost",function(o){o.preventDefault(),delete ui[n]},!1),n===1?r.getContext("webgl",xh)||r.getContext("experimental-webgl",xh):r.getContext("webgl2",xh)}(e));var t=ui[e];return t.isContextLost()?(delete ui[e],Lr(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),ui[e])}function Nd(e,t){return[t,e]}function Os(e){var t=ne(e);return am(Math.ceil(t/4))}function Nu(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function ig(e,t){var n,r,o,i,a,s,u,l,c,d=e;return H().getNumber("WEBGL_VERSION")===2?(n=d.R32F,r=d.R16F,o=d.RGBA16F,i=d.RGBA32F,a=d.RED,s=4,u=1,l=d.HALF_FLOAT,c=d.FLOAT):(n=e.RGBA,r=e.RGBA,o=e.RGBA,i=d.RGBA,a=e.RGBA,s=4,u=4,l=t!=null?t.HALF_FLOAT_OES:null,c=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:l,textureTypeFloat:c}}function re(e,t,n){var r=n();return t&&function(o){var i=o.getError();if(i!==o.NO_ERROR)throw new Error("WebGL Error: "+x3(o,i))}(e),r}(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(cu||(cu={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(bn||(bn={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(gn||(gn={}));var v3=596e-10,g3=65504;function y3(e){return!!(H().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||v3<Math.abs(e)&&Math.abs(e)<g3)}function x3(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function pl(e,t,n){return so(e,t,function(){return e.getExtension(n)},'Extension "'+n+'" not supported on this browser.')}function b3(e,t,n){var r=so(e,t,function(){return e.createShader(e.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(re(e,t,function(){return e.shaderSource(r,n)}),re(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function w3(e,t,n){var r=so(e,t,function(){return e.createShader(e.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(re(e,t,function(){return e.shaderSource(r,n)}),re(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw function(o,i){var a=C3.exec(i);if(a==null)return console.log("Couldn't parse line number in error: "+i),void console.log(o);for(var s=+a[1],u=o.split(`
`),l=u.length.toString().length+2,c=u.map(function(g,v){return wa((v+1).toString(),l)+g}),d=0,f=0;f<c.length;f++)d=Math.max(c[f].length,d);var h=c.slice(0,s-1),p=c.slice(s-1,s),m=c.slice(s);console.log(h.join(`
`)),console.log(i.split(`
`)[0]),console.log("%c "+wa(p[0],d),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(m.join(`
`))}(n,e.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var bh,wh,C3=/ERROR: [0-9]+:([0-9]+):/g;function S3(e,t){return so(e,t,function(){return e.createProgram()},"Unable to create WebGLProgram.")}function E3(e,t,n){if(re(e,t,function(){return e.linkProgram(n)}),e.getProgramParameter(n,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function Ch(e,t,n){if(re(e,t,function(){return e.validateProgram(n)}),e.getProgramParameter(n,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function k3(e,t,n){var r=so(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return re(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),re(e,t,function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function _3(e,t,n){var r=so(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return re(e,t,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r)}),re(e,t,function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function R3(e,t){return so(e,t,function(){return e.createTexture()},"Unable to create WebGLTexture.")}function T3(e,t){var n=H().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="["+e+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n)throw r="["+e+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+n+"x"+n+"]")+".")}function A3(e,t){return so(e,t,function(){return e.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function ex(e,t,n,r,o,i,a,s){var u=e.getAttribLocation(n,r);return u!==-1&&(re(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,o)}),re(e,t,function(){return e.vertexAttribPointer(u,i,e.FLOAT,!1,a,s)}),re(e,t,function(){return e.enableVertexAttribArray(u)}),!0)}function I3(e,t,n,r){F3(e,r),re(e,t,function(){return e.activeTexture(e.TEXTURE0+r)}),re(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)})}function N3(e,t,n,r){return so(e,t,function(){return e.getUniformLocation(n,r)},'uniform "'+r+'" not present in program.')}function P3(e,t,n){return e.getUniformLocation(t,n)}function D3(e,t,n,r,o,i){re(e,t,function(){return I3(e,t,r,i)}),re(e,t,function(){return e.uniform1i(o,i)})}function Sh(e,t,n,r){re(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,r)}),re(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)})}function tx(e,t,n){re(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)}),re(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)})}function ml(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+M3(e,t))}function M3(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function so(e,t,n,r){var o=re(e,t,function(){return n()});if(o==null)throw new Error(r);return o}function F3(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+n+"]")+".")}function Fc(e,t){return t===void 0&&(t=2),ne(e.slice(0,e.length-t))}function Oc(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function Eh(e){var t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[Fc(e)].concat(Oc(e))),t}function O3(e,t){var n;t===void 0&&(t=!1);var r=H().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,(e=e.map(function(l,c){return c>=e.length-2?_S(e[c]):e[c]})).length===1&&(e=[2,e[0]])),e.length!==2){var o=ci(e);e=o.newShape}var i=ne(e);if(e.length<=1&&i<=r)return[1,i];if(e.length===2&&e[0]<=r&&e[1]<=r)return e;if(e.length===3&&e[0]*e[1]<=r&&e[2]<=r)return[e[0]*e[1],e[2]];if(e.length===3&&e[0]<=r&&e[1]*e[2]<=r)return[e[0],e[1]*e[2]];if(e.length===4&&e[0]*e[1]*e[2]<=r&&e[3]<=r)return[e[0]*e[1]*e[2],e[3]];if(e.length===4&&e[0]<=r&&e[1]*e[2]*e[3]<=r)return[e[0],e[1]*e[2]*e[3]];if(t){var a=Fc(e),s=2,u=2;return e.length&&(s=(n=Oc(e))[0],u=n[1]),am(i=a*(s/2)*(u/2)).map(function(l){return 2*l})}return am(i)}function vl(e){return e%2==0}function gl(e,t){if(Et(e=e.slice(-2),t=t.slice(-2))||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r||vl(n)&&vl(r)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&vl(e[0])&&vl(t[0])}function B3(e){if(bh==null){var t=Lr(e);bh=t.getParameter(t.MAX_TEXTURE_SIZE)}return bh}function L3(e){if(wh==null){var t=Lr(e);wh=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,wh)}function j3(e){if(e===0)return 0;var t=Lr(e);return Kn(t,"EXT_disjoint_timer_query_webgl2")&&e===2?2:Kn(t,"EXT_disjoint_timer_query")?1:0}function Kn(e,t){return e.getExtension(t)!=null}function nx(e){try{if(Lr(e)!=null)return!0}catch{return!1}return!1}function z3(e){if(e===0)return!1;var t=Lr(e);if(e===1){if(!Kn(t,"OES_texture_float"))return!1}else if(!Kn(t,"EXT_color_buffer_float"))return!1;return hm(t)}function V3(e){if(e===0)return!1;var t=Lr(e);if(e!==1){if(Kn(t,"EXT_color_buffer_float"))return hm(t);if(Kn(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(r,o){var i=ig(r,o),a=r.createTexture();r.bindTexture(r.TEXTURE_2D,a),r.texImage2D(r.TEXTURE_2D,0,i.internalFormatHalfFloat,1,1,0,i.textureFormatFloat,i.textureTypeHalfFloat,null);var s=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,s),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,a,0);var u=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(a),r.deleteFramebuffer(s),u}(t,n)}return!1}return!!Kn(t,"OES_texture_float")&&!!Kn(t,"WEBGL_color_buffer_float")&&hm(t)}function hm(e){var t=ig(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),o}function $3(e){return e===2&&Lr(e).fenceSync!=null}var fe=H();function FS(e){H().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Q(e,t){return F.tidy(e,t)}function ln(e){DS(e).forEach(function(t){return t.dispose()})}function W3(e){return F.keep(e)}function Bc(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];H().getBool("IS_TEST")||console.warn.apply(console,e)}function Jo(e,t){var n=e;if(Pr(e))return t==="string"?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||Pr(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&H().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function o(i,a,s){if(s=s||[],!Array.isArray(i)&&!Pr(i))return void A(a.length===0,function(){return"Element arr["+s.join("][")+"] is a primitive, but should be an array/TypedArray of "+a[0]+" elements"});A(a.length>0,function(){return"Element arr["+s.join("][")+"] should be a primitive, but is an array of "+i.length+" elements"}),A(i.length===a[0],function(){return"Element arr["+s.join("][")+"] should have "+a[0]+" elements, but has "+i.length+" elements"});for(var u=a.slice(1),l=0;l<i.length;++l)o(i[l],u,s.concat(l))}(e,r,[]),r}function rx(e,t,n,r){if(e!=null&&(e!=="numeric"&&e!==t||e==="numeric"&&t==="string"))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+e+" tensor, but got "+t+" tensor")}function T(e,t,n,r){if(r===void 0&&(r="numeric"),e instanceof qe)return rx(r,e.dtype,t,n),e;var o=Au(e);if(o!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(o=r),rx(r,o,t,n),e==null||!Pr(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){var i=e==null?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+i+"'")}var a=Jo(e,o);Pr(e)||Array.isArray(e)||(e=[e]);var s=o!=="string"?TS(e,o,H().getBool("DEBUG")):za(e,[],!0);return F.makeTensor(s,a,o)}function Lc(e,t,n,r){if(r===void 0&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map(function(o,i){return T(o,t+"["+i+"]",n)},r)}function OS(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function U3(e,t,n){for(var r=e.length+t.length,o=[],i=0,a=0,s=0;s<r;s++)n.indexOf(s)===-1?o.push(e[i++]):o.push(t[a++]);return o}function Lt(e,t){for(var n=[],r=e.length,o=0;o<r;o++)t.indexOf(o)===-1&&n.push(e[o]);return[n,t.map(function(i){return e[i]})]}function dn(e,t){return U3(e,t.map(function(n){return 1}),t)}function vn(e,t,n){A(OS(t,n),function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input."})}function jr(e,t){if(OS(e,t))return null;for(var n=[],r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(function(o){return n.push(o)}),n}function ag(e){return e.map(function(t,n){return[n,t]}).sort(function(t,n){return t[1]-n[1]}).map(function(t){return t[0]})}function zr(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}function H3(e,t){var n=e[0].length;e.forEach(function(o,i){A(o.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+i+"] must be the same as the rank of the rest ("+n+")"})}),A(t>=0&&t<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=e[0];e.forEach(function(o,i){for(var a=0;a<n;a++)A(a===t||o[a]===r[a],function(){return"Error in concat"+n+"D: Shape of tensors["+i+"] ("+o+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+i+"."})})}function $a(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function D(e){var t=Object.keys(e);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var o=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];F.startScope(n);try{var s=r.apply(void 0,i);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),F.endScope(s),s}catch(u){throw F.endScope(null),u}};return Object.defineProperty(o,"name",{value:n,configurable:!0}),o}fe.registerFlag("HAS_WEBGL",function(){return fe.getNumber("WEBGL_VERSION")>0}),fe.registerFlag("WEBGL_VERSION",function(){return nx(2)?2:nx(1)?1:0}),fe.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return fe.get("WEBGL_VERSION")===2}),fe.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),fe.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),fe.registerFlag("WEBGL_PACK",function(){return fe.getBool("HAS_WEBGL")}),fe.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return fe.getBool("WEBGL_PACK")}),fe.registerFlag("WEBGL_PACK_CLIP",function(){return fe.getBool("WEBGL_PACK")}),fe.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),fe.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return fe.getBool("WEBGL_PACK")}),fe.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return fe.getBool("WEBGL_PACK")}),fe.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return fe.getBool("WEBGL_PACK")}),fe.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return fe.getBool("WEBGL_PACK")}),fe.registerFlag("WEBGL_PACK_REDUCE",function(){return fe.getBool("WEBGL_PACK")}),fe.registerFlag("WEBGL_LAZILY_UNPACK",function(){return fe.getBool("WEBGL_PACK")}),fe.registerFlag("WEBGL_CONV_IM2COL",function(){return fe.getBool("WEBGL_PACK")}),fe.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return B3(fe.getNumber("WEBGL_VERSION"))}),fe.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return L3(fe.getNumber("WEBGL_VERSION"))}),fe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var e=fe.getNumber("WEBGL_VERSION");return e===0?0:j3(e)}),fe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return fe.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e}),fe.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return z3(fe.getNumber("WEBGL_VERSION"))}),fe.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!fe.getBool("WEBGL_FORCE_F16_TEXTURES")&&fe.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),fe.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return V3(fe.getNumber("WEBGL_VERSION"))}),fe.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return $3(fe.getNumber("WEBGL_VERSION"))}),fe.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return fe.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),PS=FS;var Tt=D({complex_:function(e,t){var n=T(e,"real","complex"),r=T(t,"imag","complex");return Ne(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),F.runKernelFunc(function(o){return o.complex(n,r)},{$real:n,$imag:r})}}),Un=D({real_:function(e){var t=T(e,"input","real");return F.runKernelFunc(function(n){return n.real(t)},{$input:t})}}),Rr=D({imag_:function(e){var t=T(e,"input","imag");return F.runKernelFunc(function(n){return n.imag(t)},{$input:t})}});function It(e,t,n){return Zo(e,t,Jo(e,n),n)}function Zo(e,t,n,r){if(r==null&&(r=Au(e)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Pr(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){IS(t);var o=ne(t),i=ne(n);A(o===i,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+o+" values but has "+i});for(var a=0;a<n.length;++a){var s=n[a],u=a!==n.length-1||s!==ne(t.slice(a));A(n[a]===t[a]||!u,function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+t+"). "})}}return Pr(e)||Array.isArray(e)||(e=[e]),t=t||n,e=r!=="string"?TS(e,r,H().getBool("DEBUG")):za(e,[],!0),F.makeTensor(e,t,r)}function Y(e,t){if((Pr(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Pr(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Zo(e,[],[],t)}function ft(e,t){qa(e);var n=Jo(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Zo(e,null,n,t)}function Lo(e,t,n){if(qa(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=Jo(e,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Zo(e,t,r,n)}function sg(e,t,n){if(qa(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=Jo(e,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Zo(e,t,r,n)}function en(e,t,n){if(qa(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=Jo(e,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Zo(e,t,r,n)}function G3(e,t,n){if(qa(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=Jo(e,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Zo(e,t,r,n)}function K3(e,t,n){if(qa(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=Jo(e,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Zo(e,t=t||r,r,n)}function q3(e,t,n,r){return t===void 0&&(t=!0),F.makeVariable(e,t,n,r)}function Xa(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=Xa(e,"float32"),r=$e(e,"float32");return Tt(n,r)}var o=AS(ne(e),t);return F.makeTensor(o,e,t)}function $e(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=$e(e,"float32"),r=$e(e,"float32");return Tt(n,r)}var o=Iu(ne(e),t);return F.makeTensor(o,e,t)}function Mr(e,t,n){return F.runKernelFunc(function(r){return r.fill(e,t,n)},{})}function X3(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return F.runKernelFunc(function(r){return r.linspace(e,t,n)},{})}function jc(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n===0)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return $e([0],r);var o=Iu(Math.abs(Math.ceil((t-e)/n)),r);t<e&&n===1&&(n=-1),o[0]=e;for(var i=1;i<o.length;i++)o[i]=o[i-1]+n;return ft(o,r)}var BS=D({onesLike_:function(e){var t=T(e,"x","onesLike");if(t.dtype==="complex64"){var n=BS(Un(t)),r=Se(Rr(t));return Tt(n,r)}return F.runKernelFunc(function(o){return o.onesLike(t)},{$x:t},function(o,i){return{$x:function(){return Se(o)}}})}}),Se=D({zerosLike_:function(e){var t=T(e,"x","zerosLike");return F.runKernelFunc(function(n){return n.zerosLike(t)},{$x:t},function(n,r){return{$x:function(){return Se(n)}}})}}),vt=D({concat_:function(e,t){t===void 0&&(t=0),A(e.length>=1,function(){return"Pass at least one tensor to concat"});var n=Lc(e,"tensors","concat");n[0].dtype==="complex64"&&n.forEach(function(s){if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+s.dtype+". ")}),t=bt(t,n[0].shape)[0];var r=$a(n.map(function(s){return s.shape}),t);if(ne(r)===0)return It([],r);if((n=n.filter(function(s){return s.size>0})).length===1)return n[0];var o=n.map(function(s){return s.shape});H3(o,t);var i=n,a={axis:t};return F.runKernelFunc(function(s){return s.concat(n,t)},i,function(s){var u=o.map(function(l){return l[t]});return ug(s,u,t).map(function(l){return function(){return l}})},"Concat",a)}}),Y3=D({concat1d_:function(e){return vt(e,0)}}),Q3=D({concat2d_:function(e,t){return vt(e,t)}}),J3=D({concat3d_:function(e,t){return vt(e,t)}}),Z3=D({concat4d_:function(e,t){return vt(e,t)}}),ug=D({split_:function(e,t,n){n===void 0&&(n=0);var r,o=T(e,"x","split");return n=bt(n,o.shape)[0],typeof t=="number"?(A(o.shape[n]%t==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(t).fill(o.shape[n]/t)):(A(o.shape[n]===t.reduce(function(i,a){return i+a}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=t),F.runKernelFunc(function(i){return i.split(o,r,n)},{$x:o},function(i){return{$x:function(){return vt(i,n)}}})}});function Pi(e,t){return e(t={exports:{}},t.exports),t.exports}var eD=Pi(function(e){(function(t,n,r){function o(s){var u,l=this,c=(u=4022871197,function(d){d=d.toString();for(var f=0;f<d.length;f++){var h=.02519603282416938*(u+=d.charCodeAt(f));h-=u=h>>>0,u=(h*=u)>>>0,u+=4294967296*(h-=u)}return 23283064365386963e-26*(u>>>0)});l.next=function(){var d=2091639*l.s0+23283064365386963e-26*l.c;return l.s0=l.s1,l.s1=l.s2,l.s2=d-(l.c=0|d)},l.c=1,l.s0=c(" "),l.s1=c(" "),l.s2=c(" "),l.s0-=c(s),l.s0<0&&(l.s0+=1),l.s1-=c(s),l.s1<0&&(l.s1+=1),l.s2-=c(s),l.s2<0&&(l.s2+=1),c=null}function i(s,u){return u.c=s.c,u.s0=s.s0,u.s1=s.s1,u.s2=s.s2,u}function a(s,u){var l=new o(s),c=u&&u.state,d=l.next;return d.int32=function(){return 4294967296*l.next()|0},d.double=function(){return d()+11102230246251565e-32*(2097152*d()|0)},d.quick=d,c&&(typeof c=="object"&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.alea=a})(0,e,!1)}),tD=Pi(function(e){(function(t,n,r){function o(s){var u=this,l="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var d=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^d^d>>>8},s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),u.next()}function i(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u}function a(s,u){var l=new o(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(typeof c=="object"&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xor128=a})(0,e,!1)}),nD=Pi(function(e){(function(t,n,r){function o(s){var u=this,l="";u.next=function(){var d=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^d^d<<1)|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),c==l.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function i(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u.v=s.v,u.d=s.d,u}function a(s,u){var l=new o(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(typeof c=="object"&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xorwow=a})(0,e,!1)}),rD=Pi(function(e){(function(t,n,r){function o(s){var u=this;u.next=function(){var l,c,d=u.x,f=u.i;return l=d[f],c=(l^=l>>>7)^l<<24,c^=(l=d[f+1&7])^l>>>10,c^=(l=d[f+3&7])^l>>>3,c^=(l=d[f+4&7])^l<<7,l=d[f+7&7],c^=(l^=l<<13)^l<<9,d[f]=c,u.i=f+1&7,c},function(l,c){var d,f=[];if(c===(0|c))f[0]=c;else for(c=""+c,d=0;d<c.length;++d)f[7&d]=f[7&d]<<15^c.charCodeAt(d)+f[d+1&7]<<13;for(;f.length<8;)f.push(0);for(d=0;d<8&&f[d]===0;++d);for(d==8?f[7]=-1:f[d],l.x=f,l.i=0,d=256;d>0;--d)l.next()}(u,s)}function i(s,u){return u.x=s.x.slice(),u.i=s.i,u}function a(s,u){s==null&&(s=+new Date);var l=new o(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(c.x&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xorshift7=a})(0,e,!1)}),oD=Pi(function(e){(function(t,n,r){function o(s){var u=this;u.next=function(){var l,c,d=u.w,f=u.X,h=u.i;return u.w=d=d+1640531527|0,c=f[h+34&127],l=f[h=h+1&127],c^=c<<13,l^=l<<17,c^=c>>>15,l^=l>>>12,c=f[h]=c^l,u.i=h,c+(d^d>>>16)|0},function(l,c){var d,f,h,p,m,g=[],v=128;for(c===(0|c)?(f=c,c=null):(c+="\0",f=0,v=Math.max(v,c.length)),h=0,p=-32;p<v;++p)c&&(f^=c.charCodeAt((p+32)%c.length)),p===0&&(m=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,p>=0&&(m=m+1640531527|0,h=(d=g[127&p]^=f+m)==0?h+1:0);for(h>=128&&(g[127&(c&&c.length||0)]=-1),h=127,p=512;p>0;--p)f=g[h+34&127],d=g[h=h+1&127],f^=f<<13,d^=d<<17,f^=f>>>15,d^=d>>>12,g[h]=f^d;l.w=m,l.X=g,l.i=h}(u,s)}function i(s,u){return u.i=s.i,u.w=s.w,u.X=s.X.slice(),u}function a(s,u){s==null&&(s=+new Date);var l=new o(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(c.X&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xor4096=a})(0,e,!1)}),iD=Pi(function(e){(function(t,n,r){function o(s){var u=this,l="";u.next=function(){var d=u.b,f=u.c,h=u.d,p=u.a;return d=d<<25^d>>>7^f,f=f-h|0,h=h<<24^h>>>8^p,p=p-d|0,u.b=d=d<<20^d>>>12^f,u.c=f=f-h|0,u.d=h<<16^f>>>16^p,u.a=p-d|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,s===Math.floor(s)?(u.a=s/4294967296|0,u.b=0|s):l+=s;for(var c=0;c<l.length+20;c++)u.b^=0|l.charCodeAt(c),u.next()}function i(s,u){return u.a=s.a,u.b=s.b,u.c=s.c,u.d=s.d,u}function a(s,u){var l=new o(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(typeof c=="object"&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.tychei=a})(0,e,!1)}),li=Pi(function(e){(function(t,n){var r,o=this,i=256,a=6,s="random",u=n.pow(i,a),l=n.pow(2,52),c=2*l,d=i-1;function f(v,y,b){var w=[],C=m(function k(R,_){var N,I=[],L=typeof R;if(_&&L=="object")for(N in R)try{I.push(k(R[N],_-1))}catch{}return I.length?I:L=="string"?R:R+"\0"}((y=y==1?{entropy:!0}:y||{}).entropy?[v,g(t)]:v??function(){try{var k;return r&&(k=r.randomBytes)?k=k(i):(k=new Uint8Array(i),(o.crypto||o.msCrypto).getRandomValues(k)),g(k)}catch{var R=o.navigator,_=R&&R.plugins;return[+new Date,o,_,o.screen,g(t)]}}(),3),w),S=new h(w),E=function(){for(var k=S.g(a),R=u,_=0;k<l;)k=(k+_)*i,R*=i,_=S.g(1);for(;k>=c;)k/=2,R/=2,_>>>=1;return(k+_)/R};return E.int32=function(){return 0|S.g(4)},E.quick=function(){return S.g(4)/4294967296},E.double=E,m(g(S.S),t),(y.pass||b||function(k,R,_,N){return N&&(N.S&&p(N,S),k.state=function(){return p(S,{})}),_?(n[s]=k,R):k})(E,C,"global"in y?y.global:this==n,y.state)}function h(v){var y,b=v.length,w=this,C=0,S=w.i=w.j=0,E=w.S=[];for(b||(v=[b++]);C<i;)E[C]=C++;for(C=0;C<i;C++)E[C]=E[S=d&S+v[C%b]+(y=E[C])],E[S]=y;(w.g=function(k){for(var R,_=0,N=w.i,I=w.j,L=w.S;k--;)R=L[N=d&N+1],_=_*i+L[d&(L[N]=L[I=d&I+R])+(L[I]=R)];return w.i=N,w.j=I,_})(i)}function p(v,y){return y.i=v.i,y.j=v.j,y.S=v.S.slice(),y}function m(v,y){for(var b,w=v+"",C=0;C<w.length;)y[d&C]=d&(b^=19*y[d&C])+w.charCodeAt(C++);return g(y)}function g(v){return String.fromCharCode.apply(0,v)}if(n["seed"+s]=f,m(n.random(),t),e.exports){e.exports=f;try{r=require("crypto")}catch{}}})([],Math)});li.alea=eD,li.xor128=tD,li.xorwow=nD,li.xorshift7=rD,li.xor4096=oD,li.tychei=iD;var Pd=li.alea,lg=function(){function e(t,n,r,o,i){this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var a=i||Math.random();this.random=Pd(a.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var n,r,o=!1;!o;){var i=void 0,a=void 0,s=void 0;do s=(i=2*this.random()-1)*i+(a=2*this.random()-1)*a;while(s>=1||s===0);var u=Math.sqrt(-2*Math.log(s)/s);n=this.mean+this.stdDev*i*u,r=this.mean+this.stdDev*a*u,this.truncated&&!this.isValidTruncated(n)||(o=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(n)},e.prototype.convertValue=function(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)},e.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},e}(),aD=function(){function e(t,n,r,o){this.alpha=t,this.beta=1/n,this.dtype=r;var i=o||Math.random();this.randu=Pd(i.toString()),this.randn=new lg(0,1,r,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var t,n,r,o,i,a;;){do o=this.randn.nextValue(),a=1+this.c*o;while(a<=0);if(a*=a*a,n=1-.331*(t=o*o)*t,r=.5*t+this.d*(1-a+Math.log(a)),(i=this.randu())<n||Math.log(i)<r)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)},e.prototype.convertValue=function(t){return this.dtype==="float32"?t:Math.round(t)},e}(),sD=function(){function e(t,n,r,o){var i=this;if(t===void 0&&(t=0),n===void 0&&(n=1),this.canReturnFloat=function(){return i.dtype==null||i.dtype==="float32"},this.min=t,this.range=n-t,this.dtype=r,o==null&&(o=Math.random()),typeof o=="number"&&(o=o.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+n+" <= 1 and dtype is not float");this.random=Pd(o)}return e.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}();function ge(e,t,n){return t===void 0&&(t="float32"),t=t||"float32",IS(e),new lu(e,t,n)}function uD(e,t){t===void 0&&(t=!1),console.log(e.toString(t))}var LS=D({batchToSpaceND_:function(e,t,n){var r=T(e,"x","batchToSpaceND"),o=t.reduce(function(i,a){return i*a});return A(r.rank>=1+t.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length}),A(n.length===t.length,function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length}),A(r.shape[0]%o==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+o}),F.runKernelFunc(function(i){return i.batchToSpaceND(r,t,n)},{$x:r},function(i){return{$x:function(){return i.spaceToBatchND(t,n)}}})}}),lD=D({broadcastTo_:function(e,t){var n=T(e,"broadcastTo","x"),r=n.shape;if(t.some(function(u){return!(u>0)||u%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var o=n.shape.slice();o.length<t.length;)o.unshift(1);n=n.reshape(o)}for(var i=Array.from(t),a=t.length-1;a>=0;a--)if(n.shape[a]===t[a])i[a]=1;else if(n.shape[a]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var s=i.map(function(u,l){return u>1?l:-1}).filter(function(u){return u>=0});return s.length===0?n.clone():F.runKernelFunc(function(u){return u.tile(n,i)},{input:n},function(u){return{input:function(){return u.sum(s,!0)}}})}}),cD=D({cast_:function(e,t){var n=T(e,"x","cast");if(!n3(t))throw new Error("Failed to cast to unknown dtype "+t);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:t};return F.runKernelFunc(function(o){return o.cast(n,t)},{x:n},function(o){return{x:function(){return o.clone()}}},"Cast",r)}}),dD=D({clone_:function(e){var t=T(e,"x","clone",null);return F.runKernelFunc(function(){return F.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{$x:t},function(n){return{$x:function(){return n.toFloat()}}})}}),fD=D({cumsum_:function(e,t,n,r){t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1);var o=T(e,"x","cumsum"),i=jr([t|=0],o.rank),a=o;i!=null&&(a=o.transpose(i));var s=zr(1,o.rank)[0],u=F.runKernelFunc(function(l){return l.cumsum(a,s,n,r)},{permutedX:a},function(l){return{permutedX:function(){return l.cumsum(t,n,!r)}}});return i!=null&&(u=u.transpose(i)),u}}),hD=D({depthToSpace_:function(e,t,n){n===void 0&&(n="NHWC");var r=T(e,"x","depthToSpace"),o=n==="NHWC"?r.shape[1]:r.shape[2],i=n==="NHWC"?r.shape[2]:r.shape[3],a=n==="NHWC"?r.shape[3]:r.shape[1];return A(o*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+o+" and "+t+`  for depthToSpace with input shape
      `+r.shape}),A(i*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+t+` for depthToSpace with input shape
          `+r.shape}),A(a%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+a+" for depthToSpace with input shape "+r.shape}),F.runKernelFunc(function(s){return s.depthToSpace(r,t,n)},{$x:r})}}),$n=D({expandDims_:function(e,t){t===void 0&&(t=0);var n=T(e,"x","expandDims",null);A(t<=n.rank,function(){return"Axis must be <= rank of the tensor"});var r=n.shape.slice();return t<0&&(A(-(n.rank+1)<=t,function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"}),t=n.rank+t+1),r.splice(t,0,1),ur(n,r)}}),jS=D({eye_:function(e,t,n,r){r===void 0&&(r="float32"),t==null&&(t=e);for(var o=ge([e,t],r),i=e<=t?e:t,a=0;a<i;++a)o.set(1,a,a);var s=o.toTensor().as2D(e,t);if(n==null)return s;if(n.length===1)return Ca($n(s,0),[n[0],1,1]);if(n.length===2)return Ca($n($n(s,0),0),[n[0],n[1],1,1]);if(n.length===3)return Ca($n($n($n(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),pD=D({multinomial_:function(e,t,n,r){r===void 0&&(r=!1);var o=T(e,"logits","multinomial"),i=o.size,a=o.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(a>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+a);n=n||Math.random();var s=a===1?o.as2D(1,-1):o,u=F.runKernelFunc(function(l){return l.multinomial(s,r,t,n)},{logits2D:s});return a===1?u.as1D():u}}),pm=D({oneHot_:function(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var o=T(e,"indices","oneHot","int32"),i=o.shape.concat([t]);return o=o.flatten(),F.runKernelFunc(function(a){return a.oneHot(o,t,n,r)},{$indices:o},function(a){return{$indices:function(){return $e(o.shape,"float32")}}}).reshape(i)}}),Di=D({pad_:function(e,t,n){n===void 0&&(n=0);var r=T(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var o={paddings:t,constantValue:n};return F.runKernelFunc(function(i){return i.pad(r,t,n)},{x:r},function(i){var a=t.map(function(s){return s[0]});return{x:function(){return i.slice(a,r.shape)}}},"PadV2",o)}}),mD=D({pad1d_:function(e,t,n){return n===void 0&&(n=0),A(t.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),Di(e,[t],n)}}),vD=D({pad2d_:function(e,t,n){return n===void 0&&(n=0),A(t.length===2&&t[0].length===2&&t[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Di(e,t,n)}}),gD=D({pad3d_:function(e,t,n){return n===void 0&&(n=0),A(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Di(e,t,n)}}),yD=D({pad4d_:function(e,t,n){return n===void 0&&(n=0),A(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Di(e,t,n)}}),xD=D({rand_:function(e,t,n){var r=ne(e),o=null;if(n==null||n==="float32")o=new Float32Array(r);else if(n==="int32")o=new Int32Array(r);else{if(n!=="bool")throw new Error("Unknown data type "+n);o=new Uint8Array(r)}for(var i=0;i<r;i++)o[i]=t();return F.makeTensor(o,e,n)}}),bD=D({randomNormal_:function(e,t,n,r,o){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var i=new lg(t,n,r,!1,o),a=ge(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),wD=D({randomGamma_:function(e,t,n,r,o){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var i=new aD(t,n,r,o),a=ge(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),zS=D({randomUniform_:function(e,t,n,r,o){t===void 0&&(t=0),n===void 0&&(n=1),r===void 0&&(r="float32");for(var i=ge(e,r),a=new sD(t,n,null,o),s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}}),ur=D({reshape_:function(e,t){var n=T(e,"x","reshape",null);t=e3(t,n.size),A(n.size===ne(t),function(){return"new shape and old shape must have the same number of elements."});var r={shape:t};return F.runKernelFunc(function(o){return o.reshape(n,t)},{x:n},function(o){return{x:function(){return o.reshape(n.shape)}}},"Reshape",r)}}),VS=D({spaceToBatchND_:function(e,t,n){var r=T(e,"x","spaceToBatchND");return A(r.rank>=1+t.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length}),A(n.length===t.length,function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length}),A(r.shape.reduce(function(o,i,a){return a>0&&a<=t.length?o&&(i+n[a-1][0]+n[a-1][1])%t[a-1]==0:o},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()}),F.runKernelFunc(function(o){return o.spaceToBatchND(r,t,n)},{$x:r},function(o){return{$x:function(){return o.batchToSpaceND(t,n)}}})}}),$S=D({squeeze_:function(e,t){var n=T(e,"x","squeeze");return ur(n,ci(n.shape,t).newShape)}}),En=D({stack_:function(e,t){t===void 0&&(t=0);var n=Lc(e,"tensors","stack");if(A(n.length>=1,function(){return"Pass at least one tensor to tf.stack"}),n.length===1)return n[0].expandDims(t);var r=n[0].rank,o=n[0].shape,i=n[0].dtype;A(t<=r,function(){return"Axis must be <= rank of the tensor"}),n.forEach(function(s){Ne(o,s.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(function(s){A(i===s.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var a=n.map(function(s){return s.expandDims(t)});return vt(a,t)}}),Ca=D({tile_:function(e,t){var n=T(e,"x","tile",null);A(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."});var r=[n],o={reps:t};return F.runKernelFunc(function(i,a){var s=i.tile(n,t);return a([n]),s},{x:n},function(i,a){var s=a[0];return{x:function(){var u=Se(s);if(s.rank===1)for(var l=0;l<t[0];++l)u=u.add(i.slice([l*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(l=0;l<t[0];++l)for(var c=0;c<t[1];++c)u=u.add(i.slice([l*s.shape[0],c*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(l=0;l<t[0];++l)for(c=0;c<t[1];++c)for(var d=0;d<t[2];++d)u=u.add(i.slice([l*s.shape[0],c*s.shape[1],d*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else{if(s.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+s.rank+" tensors yet.");for(l=0;l<t[0];++l)for(c=0;c<t[1];++c)for(d=0;d<t[2];++d)for(var f=0;f<t[3];++f)u=u.add(i.slice([l*s.shape[0],c*s.shape[1],d*s.shape[2],f*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]))}return u}}},"Tile",o,r)}}),CD=D({truncatedNormal_:function(e,t,n,r,o){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var i=new lg(t,n,r,!0,o),a=ge(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),gt=D({unstack_:function(e,t){t===void 0&&(t=0),t=t||0;var n=T(e,"x","unstack");A(t>=-n.shape.length&&t<n.shape.length,function(){return"Axis = "+t+" is not in [-"+n.shape.length+", "+n.shape.length+")"}),t<0&&(t+=n.shape.length);var r={axis:t};return F.runKernelFunc(function(o){return o.unstack(n,t)},{x:n},function(o){return{x:function(){return En(o,t)}}},"Unpack",r)}}),SD=function(e,t){return Z(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,d;return ee(this,function(f){switch(f.label){case 0:return n=T(e,"x","setdiff1d"),r=T(t,"y","setdiff1d"),A(n.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."}),A(n.rank===1,function(){return"x should be 1D tensor, but got x ("+n.shape+")."}),A(r.rank===1,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,n.data()];case 1:return o=f.sent(),[4,r.data()];case 2:for(i=f.sent(),a=new Set(i),s=0,c=0;c<o.length;c++)a.has(o[c])||s++;for(u=new lu([s],n.dtype),l=new lu([s],"int32"),c=0,d=0;c<o.length;c++)a.has(o[c])||(u.values[d]=o[c],l.values[d]=c,d++);return[2,[u.toTensor(),l.toTensor()]]}})})};function zc(e,t,n,r){r===void 0&&(r=!0);var o=[];if(r)(o=o.concat(t.slice(0))).push(e[0]/n),o=o.concat(e.slice(1));else{o=o.concat(e[0]);for(var i=t.length,a=0;a<i;++a)o=o.concat([e[a+1]/t[a],t[a]]);o=o.concat(e.slice(i+1))}return o}function Vc(e,t,n){n===void 0&&(n=!0);var r=[];if(n){r.push(t);for(var o=t+1;o<e;++o)o<=2*t?(r.push(o),r.push(o-(t+1))):r.push(o)}else{var i=[],a=[];for(o=1;o<e;++o)o>=2*t+1||o%2==1?a.push(o):i.push(o);r.push.apply(r,i),r.push(0),r.push.apply(r,a)}return r}function $c(e,t,n,r){r===void 0&&(r=!0);var o=[];r?o.push(e[0]/n):o.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?r?o.push(t[i-1]*e[i]):o.push(e[i]/t[i-1]):o.push(e[i]);return o}function WS(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function US(e,t,n){for(var r=e.slice(0,1),o=0;o<n;++o)r.push(e[o+1]-t[o][0]-t[o][1]);return r}function HS(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(t.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(e.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,r=n[n.length-1],o=1,i=0;i<n.length-1;++i)o*=n[i];var a=e.shape,s=n.slice();s.pop();var u=1;for(i=r;i<e.rank;++i)u*=a[i],s.push(a[i]);var l=Dr(e.shape).map(function(c){return c/u}).concat([1]).slice(0,r);return[s,o,u,l]}var GS=30;function kh(e){return e<=GS?e:um(e,Math.floor(Math.sqrt(e)))}function ED(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,o=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+r+", and batchDim: "+o+".";if(n.rank<o)throw new Error(i+" update.rank < "+o+". ");if(e.length<r+(n.rank-o))throw new Error(i+" Output shape length < "+(r+(n.rank-o)));if(n.rank!==o+e.length-r)throw new Error(i+" update.rank != "+(o+e.length-r));for(var a=0;a<o;++a)if(n.shape[a]!==t.shape[a])throw new Error(i+" updates.shape["+a+"] ("+n.shape[a]+") != indices.shape["+a+"] ("+t.shape[a]+").");for(a=0;a<n.rank-o;++a)if(n.shape[a+o]!==e[a+r])throw new Error(i+" updates.shape["+(a+o)+"] ("+n.shape[a+o]+") != shape["+(a+o)+"] ("+e[a+o]+")")}function kD(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if(t.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(n.length===0){if(t.size===0)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(e.size===0)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}ED(n,t,e)}function Wc(e,t,n){for(var r=t.shape.length,o=r>1?t.shape[r-1]:1,i=n.length,a=1,s=o;s<i;++s)a*=n[s];var u=o<1?1:o;return{sliceRank:o,numUpdates:ne(t.shape)/u,sliceSize:a,strides:Dr(n.slice(0,o)).concat([1]),outputSize:ne(n)}}function _D(e,t,n){A(e.rank===t.length,function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."}),A(e.rank===n.length,function(){return"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+")."});for(var r=function(i){A(t[i]+n[i]<=e.shape[i],function(){return"Error in slice"+e.rank+"D: begin["+i+"] + size["+i+"] ("+(t[i]+n[i])+") would overflow input.shape["+i+"] ("+e.shape[i]+")"})},o=0;o<e.rank;++o)r(o)}function ox(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function cg(e,t,n){for(var r=[],o=0;o<e.length;o++)r[o]=Math.ceil((t[o]-e[o])/n[o]);return r}function RD(e,t,n,r,o){var i=t[o],a=n[o]||1;(e&1<<o||i==null)&&(i=a>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),i=im(0,i,s-1)}function TD(e,t,n,r,o){var i=t[o],a=n[o]||1;(e&1<<o||i==null)&&(i=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),i=a>0?im(0,i,s):im(-1,i,s-1)}function KS(e,t,n){for(var r=n.length,o=0;o<n.length;o++)if(n[o]>1){r=o;break}for(o=r+1;o<n.length;o++)if(t[o]>0||n[o]!==e[o])return!1;return!0}function qS(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function AD(e,t){A(sm(e),function(){return"The f passed in variableGrads(f) must be a function"}),A(t==null||Array.isArray(t)&&t.every(function(c){return c instanceof Va}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var n=t!=null;if(!n)for(var r in t=[],F.registeredVariables)t.push(F.registeredVariables[r]);var o=n?t.filter(function(c){return!c.trainable}):null,i=t.length;A((t=t.filter(function(c){return c.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."});var a=F.gradients(e,t,null,!0),s=a.value,u=a.grads;A(u.some(function(c){return c!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),A(s.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"});var l={};return t.forEach(function(c,d){u[d]!=null&&(l[c.name]=u[d])}),o!=null&&o.forEach(function(c){return l[c.name]=null}),{value:s,grads:l}}function Dd(e){return F.customGrad(e)}var uo=D({softmax_:function(e,t){t===void 0&&(t=-1);var n=T(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return F.runKernelFunc(function(r,o){var i=r.softmax(n,t);return o([i]),i},{logits:n},function(r,o){var i=o[0],a=r.mul(i);return{logits:function(){return a.sub(a.sum([t],!0).mul(i))}}},"Softmax",{dim:t},[],[!0])}}),ID=D({logSoftmax_:function(e,t){t===void 0&&(t=-1);var n=T(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return Dd(function(r,o){var i=r.max(t,!0),a=r.sub(i),s=a.toFloat().sub(a.exp().sum(t,!0).log());return o([s]),{value:s,gradFunc:function(u,l){var c=l[0].exp();return u.sub(u.sum(t,!0).mul(c))}}})(n)}}),XS=function(){function e(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return e.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},e.prototype.set=function(t,n){this.dataIdsCount++,this.data.set(t,n)},e.prototype.has=function(t){return this.data.has(t)},e.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},e.prototype.numDataIds=function(){return this.dataIdsCount},e}(),YS=function(){function e(){}return e.prototype.time=function(t){return j("time")},e.prototype.read=function(t){return j("read")},e.prototype.readSync=function(t){return j("readSync")},e.prototype.numDataIds=function(){return j("numDataIds")},e.prototype.disposeData=function(t){return j("disposeData")},e.prototype.write=function(t,n,r){return j("write")},e.prototype.move=function(t,n,r,o){return j("move")},e.prototype.memory=function(){return j("memory")},e.prototype.floatPrecision=function(){return j("floatPrecision")},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.batchMatMul=function(t,n,r,o){return j("batchMatMul")},e.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,j("fusedBatchMatMul")},e.prototype.slice=function(t,n,r){return j("slice")},e.prototype.stridedSlice=function(t,n,r,o){return j("stridedSlice")},e.prototype.unstack=function(t,n){return j("unstack")},e.prototype.reverse=function(t,n){return j("reverse")},e.prototype.concat=function(t,n){return j("concat")},e.prototype.neg=function(t){return j("neg")},e.prototype.add=function(t,n){return j("add")},e.prototype.addN=function(t){return j("addN")},e.prototype.subtract=function(t,n){return j("subtract")},e.prototype.multiply=function(t,n){return j("multiply")},e.prototype.realDivide=function(t,n){return j("realDivide")},e.prototype.floorDiv=function(t,n){return j("floorDiv")},e.prototype.sum=function(t,n){return j("sum")},e.prototype.prod=function(t,n){return j("prod")},e.prototype.unsortedSegmentSum=function(t,n,r){return j("unsortedSegmentSum")},e.prototype.argMin=function(t,n){return j("argMin")},e.prototype.argMax=function(t,n){return j("argMax")},e.prototype.equal=function(t,n){return j("equal")},e.prototype.notEqual=function(t,n){return j("notEqual")},e.prototype.less=function(t,n){return j("less")},e.prototype.lessEqual=function(t,n){return j("lessEqual")},e.prototype.greater=function(t,n){return j("greater")},e.prototype.greaterEqual=function(t,n){return j("greaterEqual")},e.prototype.logicalNot=function(t){return j("logicalNot")},e.prototype.logicalAnd=function(t,n){return j("logicalAnd")},e.prototype.logicalOr=function(t,n){return j("logicalOr")},e.prototype.where=function(t){return j("where")},e.prototype.select=function(t,n,r){return j("select")},e.prototype.topk=function(t,n,r){return j("topk")},e.prototype.min=function(t,n){return j("min")},e.prototype.minimum=function(t,n){return j("minimum")},e.prototype.mod=function(t,n){return j("mod")},e.prototype.max=function(t,n){return j("max")},e.prototype.maximum=function(t,n){return j("maximum")},e.prototype.all=function(t,n){return j("all")},e.prototype.any=function(t,n){return j("any")},e.prototype.squaredDifference=function(t,n){return j("squaredDifference")},e.prototype.ceil=function(t){return j("ceil")},e.prototype.floor=function(t){return j("floor")},e.prototype.round=function(t){return j("round")},e.prototype.sign=function(t){return j("sign")},e.prototype.isNaN=function(t){return j("isNaN")},e.prototype.isInf=function(t){return j("isInf")},e.prototype.isFinite=function(t){return j("isFinite")},e.prototype.pow=function(t,n){return j("pow")},e.prototype.exp=function(t){return j("exp")},e.prototype.expm1=function(t){return j("expm1")},e.prototype.softmax=function(t,n){return j("softmax")},e.prototype.log=function(t){return j("log")},e.prototype.log1p=function(t){return j("log1p")},e.prototype.sqrt=function(t){return j("sqrt")},e.prototype.rsqrt=function(t){return j("rsqrt")},e.prototype.square=function(t){return j("square")},e.prototype.reciprocal=function(t){return j("reciprocal")},e.prototype.relu=function(t){return j("relu")},e.prototype.relu6=function(t){return j("relu6")},e.prototype.prelu=function(t,n){return j("prelu")},e.prototype.elu=function(t){return j("elu")},e.prototype.eluDer=function(t,n){return j("eluDer")},e.prototype.selu=function(t){return j("selu")},e.prototype.int=function(t){return j("int")},e.prototype.clip=function(t,n,r){return j("clip")},e.prototype.abs=function(t){return j("abs")},e.prototype.complexAbs=function(t){return j("complexAbs")},e.prototype.sigmoid=function(t){return j("sigmoid")},e.prototype.softplus=function(t){return j("softplus")},e.prototype.sin=function(t){return j("sin")},e.prototype.cos=function(t){return j("cos")},e.prototype.tan=function(t){return j("tan")},e.prototype.asin=function(t){return j("asin")},e.prototype.acos=function(t){return j("acos")},e.prototype.atan=function(t){return j("atan")},e.prototype.atan2=function(t,n){return j("atan2")},e.prototype.sinh=function(t){return j("sinh")},e.prototype.cosh=function(t){return j("cosh")},e.prototype.tanh=function(t){return j("tanh")},e.prototype.asinh=function(t){return j("asinh")},e.prototype.acosh=function(t){return j("acosh")},e.prototype.atanh=function(t){return j("atanh")},e.prototype.erf=function(t){return j("erf")},e.prototype.step=function(t,n){return j("step")},e.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,j("fusedConv2d")},e.prototype.conv2d=function(t,n,r){return j("conv2d")},e.prototype.conv2dDerInput=function(t,n,r){return j("conv2dDerInput")},e.prototype.conv2dDerFilter=function(t,n,r){return j("conv2dDerFilter")},e.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,j("fusedDepthwiseConv2D")},e.prototype.depthwiseConv2D=function(t,n,r){return j("depthwiseConv2D")},e.prototype.depthwiseConv2DDerInput=function(t,n,r){return j("depthwiseConv2DDerInput")},e.prototype.depthwiseConv2DDerFilter=function(t,n,r){return j("depthwiseConv2DDerFilter")},e.prototype.conv3d=function(t,n,r){return j("conv3d")},e.prototype.conv3dDerInput=function(t,n,r){return j("conv3dDerInput")},e.prototype.conv3dDerFilter=function(t,n,r){return j("conv3dDerFilter")},e.prototype.maxPool=function(t,n){return j("maxPool")},e.prototype.maxPoolBackprop=function(t,n,r,o){return j("maxPoolBackprop")},e.prototype.avgPool=function(t,n){return j("avgPool")},e.prototype.avgPoolBackprop=function(t,n,r){return j("avgPoolBackprop")},e.prototype.avgPool3d=function(t,n){return j("avgPool3d")},e.prototype.avgPool3dBackprop=function(t,n,r){return j("avgPool3dBackprop")},e.prototype.maxPool3d=function(t,n){return j("maxPool3d")},e.prototype.maxPool3dBackprop=function(t,n,r,o){return j("maxPool3dBackprop")},e.prototype.reshape=function(t,n){return j("reshape")},e.prototype.cast=function(t,n){return j("cast")},e.prototype.tile=function(t,n){return j("tile")},e.prototype.pad=function(t,n,r){return j("pad")},e.prototype.transpose=function(t,n){return j("transpose")},e.prototype.gather=function(t,n,r){return j("gather")},e.prototype.gatherND=function(t,n){return j("gatherND")},e.prototype.scatterND=function(t,n,r){return j("scatterND")},e.prototype.batchToSpaceND=function(t,n,r){return j("batchToSpaceND")},e.prototype.spaceToBatchND=function(t,n,r){return j("spaceToBatchND")},e.prototype.resizeBilinear=function(t,n,r,o){return j("resizeBilinear")},e.prototype.resizeBilinearBackprop=function(t,n,r){return j("resizeBilinearBackprop")},e.prototype.resizeNearestNeighbor=function(t,n,r,o){return j("resizeNearestNeighbor")},e.prototype.resizeNearestNeighborBackprop=function(t,n,r){return j("resizeNearestNeighborBackprop")},e.prototype.batchNormalization=function(t,n,r,o,i,a){return j("batchNormalization")},e.prototype.localResponseNormalization4D=function(t,n,r,o,i){return j("localResponseNormalization4D")},e.prototype.LRNGrad=function(t,n,r,o,i,a,s){return j("LRNGrad")},e.prototype.multinomial=function(t,n,r,o){return j("multinomial")},e.prototype.oneHot=function(t,n,r,o){return j("oneHot")},e.prototype.cumsum=function(t,n,r,o){return j("cumsum")},e.prototype.nonMaxSuppression=function(t,n,r,o,i){return j("nonMaxSuppression")},e.prototype.fft=function(t){return j("fft")},e.prototype.ifft=function(t){return j("ifft")},e.prototype.complex=function(t,n){return j("complex")},e.prototype.real=function(t){return j("real")},e.prototype.imag=function(t){return j("imag")},e.prototype.cropAndResize=function(t,n,r,o,i,a){return j("cropAndResize")},e.prototype.depthToSpace=function(t,n,r){return j("depthToSpace")},e.prototype.split=function(t,n,r){return j("split")},e.prototype.sparseToDense=function(t,n,r,o){return j("sparseToDense")},e.prototype.diag=function(t){return j("diag")},e.prototype.fill=function(t,n,r){return j("fill")},e.prototype.onesLike=function(t){return j("onesLike")},e.prototype.zerosLike=function(t){return j("zerosLike")},e.prototype.linspace=function(t,n,r){return j("linspace")},e.prototype.dispose=function(){return j("dispose")},e}();function j(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function _o(e,t){for(var n=e.length,r=[],o=0;o<n;o++){var i=n-1-o,a=e[i]||1;(t[t.length-1-o]||1)>1&&a===1&&r.unshift(i)}return r}function yt(e,t){for(var n=[],r=0;r<t.length;r++){var o=e[e.length-r-1],i=t.length-r-1,a=t[i];(o==null||o===1&&a>1)&&n.unshift(i)}return n}function we(e,t){for(var n=[],r=Math.max(e.length,t.length),o=0;o<r;o++){var i=e[e.length-o-1];i==null&&(i=1);var a=t[t.length-o-1];if(a==null&&(a=1),i===1)n.unshift(a);else if(a===1)n.unshift(i);else{if(i!==a)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(i)}}return n}function du(e,t,n,r,o,i,a){a===void 0&&(a="channelsLast");var s,u=Gc(t),l=u[0],c=u[1];if(a==="channelsLast")s=[l,c,e[3],e[3]];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);s=[l,c,e[1],e[1]]}return Mi(e,s,n,r,o,i,!1,a)}function Uc(e,t,n,r,o,i,a){a===void 0&&(a="NDHWC");var s,u,l=mm(t),c=l[0],d=l[1],f=l[2];if(a==="NDHWC")u="channelsLast",s=[c,d,f,e[4],e[4]];else{if(a!=="NCDHW")throw new Error("Unknown dataFormat "+a);u="channelsFirst",s=[c,d,f,e[1],e[1]]}return Hc(e,s,n,r,o,!1,u,i)}function Mi(e,t,n,r,o,i,a,s){a===void 0&&(a=!1),s===void 0&&(s="channelsLast");var u=[-1,-1,-1,-1],l=u[0],c=u[1],d=u[2],f=u[3];if(s==="channelsLast")l=e[0],c=e[1],d=e[2],f=e[3];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);l=e[0],f=e[1],c=e[2],d=e[3]}var h,p=t[0],m=t[1],g=t[3],v=Gc(n),y=v[0],b=v[1],w=Gc(r),C=w[0],S=w[1],E=Sa(p,C),k=Sa(m,S),R=function(O,V,$,U,M,B,z,G){var X,te,ae;if(typeof O=="number"){X={top:O,bottom:O,left:O,right:O,type:O===0?"VALID":"NUMBER"};var ue=function(he,_e,Ee,Ue,je){Ue==null&&(Ue=QS(he,_e,Ee));var ze=he[0],Pn=he[1],Dn=Bs((ze-_e+2*Ue)/Ee+1,je);A(it(Dn),function(){return"The output # of rows ("+Dn+") must be an integer. Change the stride and/or zero pad parameters"});var Gt=Bs((Pn-_e+2*Ue)/Ee+1,je);return A(it(Gt),function(){return"The output # of columns ("+Gt+") must be an integer. Change the stride and/or zero pad parameters"}),[Dn,Gt]}([V,$],B,U,O,G);te=ue[0],ae=ue[1]}else if(O==="same"){te=Math.ceil(V/U),ae=Math.ceil($/M);var se=Math.max(0,(te-1)*U+B-V),me=Math.max(0,(ae-1)*M+z-$),xe=Math.floor(se/2),ce=se-xe,Me=Math.floor(me/2);X={top:xe,bottom:ce,left:Me,right:me-Me,type:"SAME"}}else{if(O!=="valid")throw Error("Unknown padding parameter: "+O);X={top:0,bottom:0,left:0,right:0,type:"VALID"},te=Math.ceil((V-B+1)/U),ae=Math.ceil(($-z+1)/M)}return{padInfo:X,outHeight:te,outWidth:ae}}(o,c,d,y,b,E,k,i),_=R.padInfo,N=R.outHeight,I=R.outWidth,L=a?g*f:g;return s==="channelsFirst"?h=[l,L,N,I]:s==="channelsLast"&&(h=[l,N,I,L]),{batchSize:l,dataFormat:s,inHeight:c,inWidth:d,inChannels:f,outHeight:N,outWidth:I,outChannels:L,padInfo:_,strideHeight:y,strideWidth:b,filterHeight:p,filterWidth:m,effectiveFilterHeight:E,effectiveFilterWidth:k,dilationHeight:C,dilationWidth:S,inShape:e,outShape:h,filterShape:t}}function Hc(e,t,n,r,o,i,a,s){i===void 0&&(i=!1),a===void 0&&(a="channelsLast");var u=[-1,-1,-1,-1,-1],l=u[0],c=u[1],d=u[2],f=u[3],h=u[4];if(a==="channelsLast")l=e[0],c=e[1],d=e[2],f=e[3],h=e[4];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);l=e[0],h=e[1],c=e[2],d=e[3],f=e[4]}var p,m=t[0],g=t[1],v=t[2],y=t[4],b=mm(n),w=b[0],C=b[1],S=b[2],E=mm(r),k=E[0],R=E[1],_=E[2],N=Sa(m,k),I=Sa(g,R),L=Sa(v,_),O=function(z,G,X,te,ae,ue,se,me,xe,ce,Me){var he,_e,Ee,Ue;if(typeof z=="number"){he={top:z,bottom:z,left:z,right:z,front:z,back:z,type:z===0?"VALID":"NUMBER"};var je=function(nr,Kt,ts,$r,Mn,ve){Mn==null&&(Mn=QS(nr,Kt,$r));var Uu=nr[0],Tf=nr[1],Hu=nr[2],Gu=Bs((Uu-Kt+2*Mn)/$r+1,ve);A(it(Gu),function(){return"The output # of depths ("+Gu+") must be an integer. Change the stride and/or zero pad parameters"});var Af=Bs((Tf-Kt+2*Mn)/$r+1,ve);A(it(Af),function(){return"The output # of rows ("+Af+") must be an integer. Change the stride and/or zero pad parameters"});var If=Bs((Hu-Kt+2*Mn)/$r+1,ve);return A(it(If),function(){return"The output # of columns ("+If+") must be an integer. Change the stride and/or zero pad parameters"}),[Gu,Af,If,ts]}([G,X,te,1],me,1,ae,z,Me);_e=je[0],Ee=je[1],Ue=je[2]}else if(z==="same"){_e=Math.ceil(G/ae),Ee=Math.ceil(X/ue),Ue=Math.ceil(te/se);var ze=(_e-1)*ae+me-G,Pn=(Ee-1)*ue+xe-X,Dn=(Ue-1)*se+ce-te,Gt=Math.floor(ze/2),vr=ze-Gt,pn=Math.floor(Pn/2),gr=Pn-pn,tr=Math.floor(Dn/2);he={top:pn,bottom:gr,left:tr,right:Dn-tr,front:Gt,back:vr,type:"SAME"}}else{if(z!=="valid")throw Error("Unknown padding parameter: "+z);he={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},_e=Math.ceil((G-me+1)/ae),Ee=Math.ceil((X-xe+1)/ue),Ue=Math.ceil((te-ce+1)/se)}return{padInfo:he,outDepth:_e,outHeight:Ee,outWidth:Ue}}(o,c,d,f,w,C,S,N,I,L,s),V=O.padInfo,$=O.outDepth,U=O.outHeight,M=O.outWidth,B=i?y*h:y;return a==="channelsFirst"?p=[l,B,$,U,M]:a==="channelsLast"&&(p=[l,$,U,M,B]),{batchSize:l,dataFormat:a,inDepth:c,inHeight:d,inWidth:f,inChannels:h,outDepth:$,outHeight:U,outWidth:M,outChannels:B,padInfo:V,strideDepth:w,strideHeight:C,strideWidth:S,filterDepth:m,filterHeight:g,filterWidth:v,effectiveFilterDepth:N,effectiveFilterHeight:I,effectiveFilterWidth:L,dilationDepth:k,dilationHeight:R,dilationWidth:_,inShape:e,outShape:p,filterShape:t}}function QS(e,t,n,r){r===void 0&&(r=1);var o=Sa(t,r);return Math.floor((e[0]*(n-1)-n+o)/2)}function Gc(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function mm(e){return typeof e=="number"?[e,e,e]:e}function Sa(e,t){return t<=1?e:e+(e-1)*(t-1)}function Bs(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function Wa(e){var t=Gc(e),n=t[0],r=t[1],o=t[2];return n===1&&r===1&&o===1}function fn(e,t){return Wa(e)||Wa(t)}function dg(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function JS(e,t,n){if(t==="complex64"){if(e.dtype==="complex64")return e.clone();var r=$e(e.shape),o=e.toFloat(),i=n.complex(o,r);return r.dispose(),o.dispose(),i}if(!r3(e.dtype,t))return F.makeTensorFromDataId(e.dataId,e.shape,t);if(e.dtype==="complex64"){var a=n.real(e);return i=a.cast(t),a.dispose(),i}if(t==="int32")return n.int(e);if(t==="bool"){var s=Y(0,e.dtype);return i=n.notEqual(e,s),s.dispose(),i}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t)}function vm(e,t){return F.makeTensorFromDataId(e.dataId,t,e.dtype)}function ZS(e,t,n){var r=(t-e)/(n-1),o=Iu(n,"float32");o[0]=e;for(var i=1;i<o.length;i++)o[i]=o[i-1]+r;return ft(o,"float32")}function gm(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function ix(e,t){return{real:e[2*t],imag:e[2*t+1]}}function ND(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function PD(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function DD(e,t,n){var r=function(i,a,s){return function(u,l,c){for(var d=0,f=u.length,h=0,p=!1;d<f;){var m=c(l,u[h=d+(f-d>>>1)]);m>0?d=h+1:(f=h,p=!m)}return p?d:-d-1}(i,a,s||MD)}(e,t,n),o=r<0?-(r+1):r;e.splice(o,0,t)}function MD(e,t){return e>t?1:e<t?-1:0}function fg(e,t,n,r,o){return eE(e,t,n,r,o,0).selectedIndices}function hg(e,t,n,r,o,i){var a=eE(e,t,n,r,o,i);return a.numValidOutputs.dispose(),{selectedIndices:a.selectedIndices,selectedScores:a.selectedScores}}function eE(e,t,n,r,o,i,a,s){s===void 0&&(s=!1);for(var u=Array.from(t).map(function(w,C){return{score:w,boxIndex:C,suppressBeginIndex:0}}).filter(function(w){return w.score>o}).sort(ax),l=i>0?-.5/i:0,c=[],d=[];c.length<n&&u.length>0;){var f=u.pop(),h=f.score,p=f.boxIndex,m=f.suppressBeginIndex;if(h<o)break;for(var g=!1,v=c.length-1;v>=m;--v){var y=FD(e,p,c[v]);if(y>=r){g=!0;break}if(f.score=f.score*OD(r,l,y),f.score<=o)break}f.suppressBeginIndex=c.length,g||(f.score===h?(c.push(p),d.push(f.score)):f.score>o&&DD(u,f,ax))}var b=c.length;return s&&(c.fill(0,b),d.fill(0,b)),{selectedIndices:ft(c,"int32"),selectedScores:ft(d,"float32"),numValidOutputs:Y(b,"int32")}}function FD(e,t,n){var r=e.subarray(4*t,4*t+4),o=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(o[0],o[2]),c=Math.min(o[1],o[3]),d=Math.max(o[0],o[2]),f=Math.max(o[1],o[3]),h=(s-i)*(u-a),p=(d-l)*(f-c);if(h<=0||p<=0)return 0;var m=Math.max(i,l),g=Math.max(a,c),v=Math.min(s,d),y=Math.min(u,f),b=Math.max(v-m,0)*Math.max(y-g,0);return b/(h+p-b)}function OD(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function ax(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function tE(e,t,n){var r=new Array(e.rank).fill(0),o=e.shape.slice();return t.map(function(i){o[n]=i;var a=e.slice(r,o);return r[n]+=i,a})}function nE(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];var o=ge(n,e.dtype);for(r=0;r<o.values.length;++r){for(var i=o.indexToLoc(r),a=new Array(e.rank),s=0;s<a.length;s++)a[s]=i[s]%e.shape[s];var u=e.locToIndex(a);o.values[r]=e.values[u]}return o.toTensor()}function rE(e,t,n,r,o){for(var i=t[t.length-1],a=[e.length/i,i],s=a[0],u=a[1],l=uu(n,s*r),c=uu("int32",s*r),d=0;d<s;d++){for(var f=d*u,h=e.subarray(f,f+u),p=[],m=0;m<h.length;m++)p.push({value:h[m],index:m});p.sort(function(w,C){return C.value-w.value});var g=d*r,v=l.subarray(g,g+r),y=c.subarray(g,g+r);for(m=0;m<r;m++)v[m]=p[m].value,y[m]=p[m].index}var b=t.slice();return b[b.length-1]=r,[It(l,b,n),It(c,b,"int32")]}function pg(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);var o=ge(e,"int32"),i=ge([n.length,e.length],"int32");for(r=0;r<n.length;r++){var a=o.indexToLoc(n[r]),s=r*e.length;i.values.set(a,s)}return i.toTensor()}var BD=function(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(function(o,i){return"T"+i});var n=[];this.variableNames.forEach(function(o){n.push("float v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `},LD=function(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(function(o,i){return"T"+i});var n=[];this.variableNames.forEach(function(o){n.push("vec4 v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `},jD=function(e,t,n){this.variableNames=["A"];var r=e.windowSize,o=e.batchSize,i=e.inSize,a=Math.ceil(i/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[o,a];var s=t==="max"?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+u+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+s+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function oE(e,t){return["x","y","z","w","u","v"].slice(0,t).map(function(n){return e+"."+n})}function nn(e,t){return t===1?[e]:oE(e,t)}function Vt(){var e,t,n,r,o,i,a,s,u,l;return H().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",r="in",o="texture",i="outputColor",a="out vec4 outputColor;",s=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,u="",l=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",r="varying",o="texture2D",i="gl_FragColor",a="",s=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,l=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:o,output:i,defineOutput:a,defineSpecialNaN:s,defineSpecialInf:u,defineRound:l}}function mi(e,t,n){n===void 0&&(n="index");var r=Dr(t);return r.map(function(o,i){return"int "+e[i]+" = "+n+" / "+o+"; "+(i===r.length-1?"int "+e[i+1]+" = "+n+" - "+e[i]+" * "+o:"index -= "+e[i]+" * "+o)+";"}).join("")}function mg(e){var t=Dr(e).map(function(n){return n.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+t[0]+" + coords.y * "+t[1]+` + coords.z;
  }
`}var iE=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function zD(e,t,n,r){var o=[];e.forEach(function(h){var p=ne(h.shapeInfo.logicalShape);h.shapeInfo.isUniform?o.push("uniform float "+h.name+(p>1?"["+p+"]":"")+";"):(o.push("uniform sampler2D "+h.name+";"),o.push("uniform int offset"+h.name+";"))});var i,a,s=o.join(`
`),u=e.map(function(h){return function(p,m,g){g===void 0&&(g=!1);var v="";v+=g?aE(p):qi(p);var y=p.shapeInfo.logicalShape,b=m.logicalShape;return y.length<=b.length&&(v+=g?function(w,C){var S,E=w.name,k=E.charAt(0).toUpperCase()+E.slice(1),R="get"+k+"AtOutCoords",_=w.shapeInfo.logicalShape.length,N=C.logicalShape.length,I=_o(w.shapeInfo.logicalShape,C.logicalShape),L=Le(N),O=N-_,V=["x","y","z","w","u","v"];S=_===0?"":N<2&&I.length>=1?"coords = 0;":I.map(function(X){return"coords."+V[X+O]+" = 0;"}).join(`
`);var $="";$=N<2&&_>0?"coords":w.shapeInfo.logicalShape.map(function(X,te){return"coords."+V[te+O]}).join(", ");var U="return outputValue;",M=ne(w.shapeInfo.logicalShape)===1,B=ne(C.logicalShape)===1;if(_!==1||M||B){if(M&&!B)U=N===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(I.length){var z=_-2,G=_-1;I.indexOf(z)>-1&&I.indexOf(G)>-1?U="return vec4(outputValue.x);":I.indexOf(z)>-1?U="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":I.indexOf(G)>-1&&(U="return vec4(outputValue.xx, outputValue.zz);")}}else U=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+R+`() {
      `+L+` coords = getOutputCoords();
      `+S+`
      vec4 outputValue = get`+k+"("+$+`);
      `+U+`
    }
  `}(p,m):function(w,C){var S=w.name,E=S.charAt(0).toUpperCase()+S.slice(1),k="get"+E+"AtOutCoords",R=C.texShape,_=w.shapeInfo.texShape,N=w.shapeInfo.logicalShape.length,I=C.logicalShape.length;if(!w.shapeInfo.isUniform&&N===I&&w.shapeInfo.flatOffset==null&&Et(_,R))return`
      float `+k+`() {
        return sampleTexture(`+S+`, resultUV);
      }
    `;var L,O=Le(I),V=_o(w.shapeInfo.logicalShape,C.logicalShape),$=I-N,U=["x","y","z","w","u","v"];L=N===0?"":I<2&&V.length>=1?"coords = 0;":V.map(function(B){return"coords."+U[B+$]+" = 0;"}).join(`
`);var M="";return M=I<2&&N>0?"coords":w.shapeInfo.logicalShape.map(function(B,z){return"coords."+U[z+$]}).join(", "),`
    float `+k+`() {
      `+O+` coords = getOutputCoords();
      `+L+`
      return get`+E+"("+M+`);
    }
  `}(p,m)),v}(h,t,r)}).join(`
`),l=t.texShape,c=Vt(),d=function(h){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+h.texture2D+`(textureSampler, uv).r;
    }
  `}(c),f=function(h){return h.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+h.varyingFs+` vec2 resultUV;
    `+h.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+h.defineSpecialNaN+`
    `+h.defineSpecialInf+`
    `+h.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+VD+`
    `+$D+`
    `+WD+`
  `}(c);return t.isPacked?(i=function(h,p){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(w,C){var S=[Math.ceil(C[0]/2),Math.ceil(C[1]/2)];return S[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+S[1]+`.0);
      }
    `:S[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+S[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+S[0]+", "+S[1]+`));
      return 2 * (resTexRC.x * `+S[1]+` + resTexRC.y);
    }
  `}(0,p);case 2:return function(w,C){var S=[Math.ceil(C[0]/2),Math.ceil(C[1]/2)];if(Et(w,C))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+S[0]+", "+S[1]+`));
      }
    `;var E=Math.ceil(w[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+S[0]+", "+S[1]+`));

      int index = resTexRC.x * `+S[1]+` + resTexRC.y;
      int r = 2 * (index / `+E+`);
      int c = imod(index, `+E+`) * 2;

      return ivec2(r, c);
    }
  `}(h,p);case 3:return m=h,g=p,v=[Math.ceil(g[0]/2),Math.ceil(g[1]/2)],y=Math.ceil(m[2]/2),b=y*Math.ceil(m[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+v[0]+", "+v[1]+`));
      int index = resTexRC.x * `+v[1]+` + resTexRC.y;

      int b = index / `+b+`;
      index -= b * `+b+`;

      int r = 2 * (index / `+y+`);
      int c = imod(index, `+y+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(w,C){for(var S=[Math.ceil(C[0]/2),Math.ceil(C[1]/2)],E=Math.ceil(w[w.length-1]/2),k=E*Math.ceil(w[w.length-2]/2),R=k,_="",N="b, r, c",I=2;I<w.length-1;I++)R*=w[w.length-I-1],_=`
      int b`+I+" = index / "+R+`;
      index -= b`+I+" * "+R+`;
    `+_,N="b"+I+", "+N;return`
    ivec`+w.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+S[0]+", "+S[1]+`));
      int index = resTexRC.x * `+S[1]+` + resTexRC.y;

      `+_+`

      int b = index / `+k+`;
      index -= b * `+k+`;

      int r = 2 * (index / `+E+`);
      int c = imod(index, `+E+`) * 2;

      return ivec`+w.length+"("+N+`);
    }
  `}(h,p)}var m,g,v,y,b}(t.logicalShape,l),a=function(h){return`
    void setOutput(vec4 val) {
      `+h.output+` = val;
    }
  `}(c)):(i=function(h,p){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(v,y){return y[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+y[1]+`.0);
      }
    `:y[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+y[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      return resTexRC.x * `+y[1]+` + resTexRC.y;
    }
  `}(0,p);case 2:return function(v,y){return Et(v,y)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+y[0]+", "+y[1]+`));
      }
    `:v[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:v[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      int r = index / `+v[1]+`;
      int c = index - r * `+v[1]+`;
      return ivec2(r, c);
    }
  `}(h,p);case 3:return m=p,g=mi(["r","c","d"],h),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+m[0]+", "+m[1]+`));
      int index = resTexRC.x * `+m[1]+` + resTexRC.y;
      `+g+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(v,y){var b=mi(["r","c","d","d2"],v);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      `+b+`
      return ivec4(r, c, d, d2);
    }
  `}(h,p);case 5:return function(v,y){var b=mi(["r","c","d","d2","d3"],v);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+y[0]+`,
                             `+y[1]+`));

      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+b+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(h,p);case 6:return function(v,y){var b=mi(["r","c","d","d2","d3","d4"],v);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+b+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(h,p);default:throw new Error(h.length+"-D output sampling is not yet supported")}var m,g}(t.logicalShape,l),a=function(h){return`
    void setOutput(float val) {
      `+h.output+` = vec4(val, 0, 0, 0);
    }
  `}(c)),r&&(f+=UD),[f,d,a,s,i,u,n].join(`
`)}function qi(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(n){var r=n.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return"float "+o+"() {return "+r+";}";var i=n.shapeInfo.texShape,a=i[0],s=i[1];if(a===1&&s===1)return`
      float `+o+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=n.shapeInfo.texShape,l=u[0],c=u[1],d=ni(r);return`
    float `+o+`() {
      vec2 uv = uvFromFlat(`+l+", "+c+", "+d+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 1:return function(n){var r=n.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return`
      float `+o+`(int index) {
        `+Li(n)+`
      }
    `;var i=n.shapeInfo.texShape,a=i[0],s=i[1];if(s===1&&a===1)return`
      float `+o+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=ni(r);return s===1?`
      float `+o+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+u+") + 0.5) / "+a+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:a===1?`
      float `+o+`(int index) {
        vec2 uv = vec2((float(index + `+u+") + 0.5) / "+s+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+o+`(int index) {
      vec2 uv = uvFromFlat(`+a+", "+s+", index + "+u+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 2:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=n.shapeInfo.texShape;if(a!=null&&Et(r,a)){var s=a[0],u=a[1];return`
    float `+i+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+u+".0, "+s+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `}var l=ci(r),c=l.newShape,d=l.keptDims,f=c;if(f.length<r.length){var h=Xi(n,f);return`
      `+qi(h)+`
      float `+i+`(int row, int col) {
        return `+i+"("+Yi(["row","col"],d)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+Li(n)+`
      }
    `;var p=a[0],m=a[1],g=ni(o);return m===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+g+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+p+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `:p===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+g+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+m+`.0, 0.5);
      return sampleTexture(`+o+`, uv);
    }
  `:`
  float `+i+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+g+`;
    vec2 uv = uvFromFlat(`+p+", "+m+`, index);
    return sampleTexture(`+o+`, uv);
  }
`}(e);case 3:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[1]*r[2],s=r[2],u=ci(r),l=u.newShape,c=u.keptDims,d=l;if(d.length<r.length){var f=Xi(n,d);return`
        `+qi(f)+`
        float `+i+`(int row, int col, int depth) {
          return `+i+"("+Yi(["row","col","depth"],c)+`);
        }
      `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+a+", "+s+`, 1)));
        `+Li(n)+`
      }
    `;var h=n.shapeInfo.texShape,p=h[0],m=h[1],g=n.shapeInfo.flatOffset;if(m===a&&g==null)return`
        float `+i+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+s+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+m+".0, "+p+`.0);
          return sampleTexture(`+o+`, uv);
        }
      `;if(m===s&&g==null)return`
    float `+i+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+m+".0, "+p+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `;var v=ni(o);return`
      float `+i+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+a+" + col * "+s+" + depth + "+v+`;
        vec2 uv = uvFromFlat(`+p+", "+m+`, index);
        return sampleTexture(`+o+`, uv);
      }
  `}(e);case 4:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[3],s=r[2]*a,u=r[1]*s,l=ci(r),c=l.newShape,d=l.keptDims;if(c.length<r.length){var f=Xi(n,c);return`
      `+qi(f)+`
      float `+i+`(int row, int col, int depth, int depth2) {
        return `+i+"("+Yi(["row","col","depth","depth2"],d)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+u+", "+s+", "+a+`, 1)));
        `+Li(n)+`
      }
    `;var h=n.shapeInfo.flatOffset,p=n.shapeInfo.texShape,m=p[0],g=p[1];if(g===u&&h==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+s+", "+a+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+g+".0, "+m+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(g===a&&h==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+g+".0, "+m+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var v=ni(o);return`
    float `+i+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+s+` +
          depth * `+a+` + depth2;
      vec2 uv = uvFromFlat(`+m+", "+g+", index + "+v+`);
      return sampleTexture(`+o+`, uv);
    }
  `}(e);case 5:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[4],s=r[3]*a,u=r[2]*s,l=r[1]*u,c=ci(r),d=c.newShape,f=c.keptDims;if(d.length<r.length){var h=Xi(n,d);return`
      `+qi(h)+`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        return `+i+"("+Yi(["row","col","depth","depth2","depth3"],f)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+l+", "+u+", "+s+", "+a+`)) +
          depth3;
        `+Li(n)+`
      }
    `;var p=n.shapeInfo.flatOffset,m=n.shapeInfo.texShape,g=m[0],v=m[1];if(v===l&&p==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+u+", "+s+", "+a+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+v+".0, "+g+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(v===a&&p==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+v+".0, "+g+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var y=ni(o);return`
    float `+i+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+l+" + col * "+u+" + depth * "+s+` +
          depth2 * `+a+" + depth3 + "+y+`;
      vec2 uv = uvFromFlat(`+g+", "+v+`, index);
      return sampleTexture(`+o+`, uv);
    }
  `}(e);case 6:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=ci(r),s=a.newShape,u=a.keptDims;if(s.length<r.length){var l=Xi(n,s);return`
      `+qi(l)+`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+i+"("+Yi(["row","col","depth","depth2","depth3","depth4"],u)+`);
      }
    `}var c=r[5],d=r[4]*c,f=r[3]*d,h=r[2]*f,p=r[1]*h;if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+p+", "+h+", "+f+", "+d+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+c+`, 1)));
        `+Li(n)+`
      }
    `;var m=n.shapeInfo.flatOffset,g=n.shapeInfo.texShape,v=g[0],y=g[1];if(y===p&&m==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+h+", "+f+", "+d+", "+c+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+y+".0, "+v+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(y===c&&m==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+y+".0, "+v+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var b=ni(o);return`
    float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+p+" + col * "+h+" + depth * "+f+` +
          depth2 * `+d+" + depth3 * "+c+" + depth4 + "+b+`;
      vec2 uv = uvFromFlat(`+v+", "+y+`, index);
      return sampleTexture(`+o+`, uv);
    }
  `}(e);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function aE(e){var t,n,r;switch(e.shapeInfo.logicalShape.length){case 0:return t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=Vt(),`
    vec4 `+n+`() {
      return `+r.texture2D+"("+t+`, halfCR);
    }
  `;case 1:return function(o){var i=o.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),s=o.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],l=Vt();return`
    vec4 `+a+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+u[0]+", "+u[1]+`, index);
      return `+l.texture2D+"("+i+`, uv);
    }
  `}(e);case 2:return function(o){var i=o.shapeInfo.logicalShape,a=o.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=o.shapeInfo.texShape,l=u[0],c=u[1],d=Vt();if(u!=null&&Et(i,u))return`
      vec4 `+s+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+c+".0, "+l+`.0);

        return `+d.texture2D+"("+a+`, uv);
      }
    `;var f=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],h=Math.ceil(i[1]/2);return`
    vec4 `+s+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+h+", "+f[0]+", "+f[1]+`, row, col);
      return `+d.texture2D+"("+a+`, uv);
    }
  `}(e);case 3:return function(o){var i=o.shapeInfo.logicalShape,a=o.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=o.shapeInfo.texShape,l=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(i[0]===1){var c=i.slice(1),d=Xi(o,c);return`
        `+aE(d)+`
        vec4 `+s+`(int b, int row, int col) {
          return `+s+"("+Yi(["b","row","col"],[1,2])+`);
        }
      `}var f=l[0],h=l[1],p=Math.ceil(i[2]/2),m=p*Math.ceil(i[1]/2),g=Vt();return`
    vec4 `+s+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+f+", "+h+", "+m+", "+p+`, b, row, col);
      return `+g.texture2D+"("+a+`, uv);
    }
  `}(e);default:return function(o){for(var i=o.shapeInfo.logicalShape,a=i.length,s=o.name,u="get"+s.charAt(0).toUpperCase()+s.slice(1),l=o.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],d=c[0],f=c[1],h=Math.ceil(i[a-1]/2),p=h*Math.ceil(i[a-2]/2),m="int b, int row, int col",g="b * "+p+" + (row / 2) * "+h+" + (col / 2)",v=2;v<a-1;v++)m="int b"+v+", "+m,p*=i[a-v-1],g="b"+v+" * "+p+" + "+g;var y=Vt();return`
    vec4 `+u+"("+m+`) {
      int index = `+g+`;
      int texR = index / `+f+`;
      int texC = index - texR * `+f+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+f+", "+d+`);
      return `+y.texture2D+"("+s+`, uv);
    }
  `}(e)}}var VD=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,$D=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,WD=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,UD=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function ni(e){return"offset"+e}function Li(e){var t=e.name,n=ne(e.shapeInfo.logicalShape);return n<2?"return "+t+";":`
    for (int i = 0; i < `+n+`; i++) {
      if (i == index) {
        return `+t+`[i];
      }
    }
  `}function Le(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function Xi(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function Yi(e,t){return t.map(function(n){return e[n]}).join(", ")}var HD=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,A(e.length>2,function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."});var o=e[e.length-1],i=Math.ceil(o/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var a,s,u=this.outputShape,l=u.length,c=Le(l),d=nn("coords",l);if(i===1){var f=Le(s=l+1);a=`
        `+f+" sourceLocR = "+f+"("+d.join()+`, 0);
        ++`+d[l-1]+`;
        `+f+" sourceLocG = "+f+"("+d.join()+`, 0);
        ++`+d[l-2]+`;
        `+f+" sourceLocA = "+f+"("+d.join()+`, 0);
        --`+d[l-1]+`;
        `+f+" sourceLocB = "+f+"("+d.join()+`, 0);
        --`+d[l-2]+";"}else s=l,a=`
        `+c+` sourceLocR = coords;
        ++`+d[l-1]+`;
        `+c+` sourceLocG = coords;
        ++`+d[l-2]+`;
        `+c+` sourceLocA = coords;
        --`+d[l-1]+`;
        `+c+` sourceLocB = coords;
        --`+d[l-2]+";";var h=["x","y","z","w","u","v"].slice(0,s),p="."+h[s-1],m=h.map(function(k){return"int "+k}),g=nn("sourceLocR",s-1).concat("inIdx.r"),v=nn("sourceLocG",s-1).concat("inIdx.g"),y=nn("sourceLocB",s-1).concat("inIdx.b"),b=nn("sourceLocA",s-1).concat("inIdx.a"),w=n==="max"?"greaterThan":"lessThan",C=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+g.join()+`),
                             getBestIndicesAChannel(`+v.join()+`),
                             getBestIndicesAChannel(`+y.join()+`),
                             getBestIndicesAChannel(`+b.join()+")));",S=`vec4(
            getAChannel(`+g.join()+`),
            hasNextCol ? getAChannel(`+v.join()+`) : 0.,
            hasNextRow ? getAChannel(`+y.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+b.join()+") : 0.)",E=r?"":`
      float getBestIndicesAChannel(`+m.join()+`) {
        return getChannel(getBestIndicesA(`+h.join()+`),
                                          vec2(`+h.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+m.join()+`) {
        return getChannel(getA(`+h.join()+`),
                               vec2(`+h.slice(-2).join()+`));
      }
      `+E+`
      void main() {
        `+c+` coords = getOutputCoords();
        bool hasNextCol = `+d[l-1]+" < "+(u[l-1]-1)+`;
        bool hasNextRow = `+d[l-2]+" < "+(u[l-2]-1)+`;
        `+a+`
        ivec4 srcIdx = ivec4(sourceLocR`+p+", sourceLocG"+p+`,
          sourceLocB`+p+", sourceLocA"+p+") * "+t+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+S+`;

        for (int i = 0; i < `+t+`; i++) {
          inIdx = srcIdx;
          `+C+`
          vec4 candidate = `+S+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+w+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},GD=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,l=s-1-e.padInfo.top,c=u-1-e.padInfo.left,d=1/(t*n);this.userCode=`
      const ivec2 pads = ivec2(`+l+", "+c+`);
      const float avgMultiplier = float(`+d+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+s+`;
            wR += `+i+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+u+`;
            wC+= `+a+`) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},KD=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,h=c-1-e.padInfo.front,p=d-1-e.padInfo.top,m=f-1-e.padInfo.left,g=1/(t*n*r);this.userCode=`
      const ivec3 pads = ivec3(`+h+", "+p+", "+m+`);
      const float avgMultiplier = float(`+g+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+s+`) {
          float dyD = float(dyDCorner + wD) / `+o+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+d+`;
              wR += `+u+`) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+f+`;
                wC += `+l+`) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},qD=function(e,t,n,r,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],we(e,t),we(e,n);var a="0.0";r!=null&&(we(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="1.0";o!=null&&(we(e,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+a+`;
        float scale = `+s+`;
        float inv = scale * inversesqrt(variance + float(`+i+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},XD=function(e,t,n,r,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],we(e,t),we(e,n);var a="vec4(0.0)";r!=null&&(we(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="vec4(1.0)";o!=null&&(we(e,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = `+a+`;
        vec4 scale = `+s+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+i+`));

        setOutput((x - mean) * inv + offset);
      }
    `},YD="return areal * breal - aimag * bimag;",QD="return areal * bimag + aimag * breal;",sx=function(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=we(t,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+e+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},_h="return a + b;",Rh="return a - b;",ux="return a * b;",sE="return (a < 0.) ? b * a : a;",et=function(e,t,n){this.variableNames=["A","B"],this.outputShape=we(t,n),this.userCode=`
      float binaryOperation(float a, float b) {
        `+e+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},uE=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,Ur=function(e,t,n,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=we(t,n);var o=this.outputShape.length,i="";if(r)if(o===0||ne(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          `+Le(o)+` coords = getOutputCoords();
        `,o===1)i+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var a=nn("coords",o);i+=`
            bool nextRowOutOfBounds =
              (`+a[o-2]+" + 1) >= "+this.outputShape[o-2]+`;
            bool nextColOutOfBounds =
              (`+a[o-1]+" + 1) >= "+this.outputShape[o-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+e+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+i+`

        setOutput(result);
      }
    `},JD=function(){function e(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(o,i){r.minLoc==null&&(r.minLoc=o.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(i,"maxVal")),o.gl.uniform1f(r.minLoc,t),o.gl.uniform1f(r.maxLoc,n)}},e}(),ZD=function(){function e(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(o,i){r.minLoc==null&&(r.minLoc=o.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(i,"maxVal")),o.gl.uniform1f(r.minLoc,t),o.gl.uniform1f(r.maxLoc,n)}},e}(),eM=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},tM=function(e){this.outputShape=[],this.outputShape=$a(e,1),this.variableNames=e.map(function(s,u){return"T"+u});var t=new Array(e.length-1);t[0]=e[0][1];for(var n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<t.length;n++){var o=t[n-1];r.push("else if (yC < "+t[n]+") setOutput(getT"+n+"(yR, yC-"+o+"));")}var i=t.length,a=t[t.length-1];r.push("else setOutput(getT"+i+"(yR, yC-"+a+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `},nM=function(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=$a(e,t);var n=this.outputShape,r=n.length,o=Le(r),i=nn("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map(function(g,v){return"T"+v});var s=new Array(e.length-1);s[0]=e[0][t];for(var u=1;u<s.length;u++)s[u]=s[u-1]+e[u][t];var l=a[t],c=a.slice(-2),d=a.join(),f="if ("+l+" < "+s[0]+`) {
        return getChannel(
            getT0(`+d+"), vec2("+c.join()+`));
        }`;for(u=1;u<s.length;u++){var h=s[u-1];f+=`
        if (`+l+" < "+s[u]+"  && "+l+" >= "+s[u-1]+`) {
          return getChannel(
            getT`+u+"("+yl(a,l,h)+`),
            vec2(`+yl(c,l,h)+`));
        }`}var p=s.length,m=s[s.length-1];f+=`
        return getChannel(
          getT`+p+"("+yl(a,l,m)+`),
          vec2(`+yl(c,l,m)+"));",this.userCode=`
      float getValue(`+a.map(function(g){return"int "+g})+`) {
        `+f+`
      }

      void main() {
        `+o+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+i+`), 0., 0., 0.);

        `+i[r-1]+" = "+i[r-1]+` + 1;
        if (`+i[r-1]+" < "+n[r-1]+`) {
          result.g = getValue(`+i+`);
        }

        `+i[r-2]+" = "+i[r-2]+` + 1;
        if (`+i[r-2]+" < "+n[r-2]+`) {
          result.a = getValue(`+i+`);
        }

        `+i[r-1]+" = "+i[r-1]+` - 1;
        if (`+i[r-2]+" < "+n[r-2]+` &&
            `+i[r-1]+" < "+n[r-1]+`) {
          result.b = getValue(`+i+`);
        }
        setOutput(result);
      }
    `};function yl(e,t,n){var r=e.indexOf(t);return e.map(function(o,i){return i===r?o+" - "+n:o}).join()}var rM=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+o+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              if (`+i+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},oM=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=e.dataFormat==="channelsLast",a=t-1-e.padInfo.top,s=n-1-e.padInfo.left,u=i?1:2,l=i?2:3,c=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+c+`];

        ivec2 dyCorner = ivec2(coords[`+u+"], coords["+l+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {

              if (`+i+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},iM=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,o=e.padInfo.front,i=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yF = 0; yF < `+e.outDepth+`; yF++) {
            int xF = wF + yF * `+t+" - "+o+`;

            if (xF < 0 || xF >= `+e.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+e.outHeight+`; yR++) {
              int xR = wR + yR * `+n+" - "+i+`;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+e.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+a+`;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},aM=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=t-1-e.padInfo.front,u=n-1-e.padInfo.top,l=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+s+", "+u+", "+l+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+t+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+o+`.0;

          if (dyF < 0.0 || dyF >= `+e.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+t+` - 1 - wF;

          for (int wR = 0; wR < `+n+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+n+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},sM=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+i+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+o+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},uM=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=t-1-e.padInfo.top,a=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+i+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+s+`; dm++) {
              int d2 = d1 * `+s+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},lx=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var o=e.padInfo.top,i=e.padInfo.left,a=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterHeight,d=e.filterWidth,f=4*Math.floor(e.inChannels/4),h=e.inChannels%4,p=e.dataFormat==="channelsLast",m=p?1:2,g=p?2:3,v=p?3:1,y="",b="";n&&(y=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,b="result = activation(result);");var w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+y+`

      const ivec2 strides = ivec2(`+a+", "+s+`);
      const ivec2 pads = ivec2(`+o+", "+i+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+v+`];

        ivec2 xRCCorner =
            ivec2(coords[`+m+"], coords["+g+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+c+`; wR++) {
          int xR = xRCorner + wR * `+u+`;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+d+`; wC++) {
            int xC = xCCorner + wC * `+l+`;

            if (xC < 0 || xC >= `+e.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+f+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+p+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(h===1)+`) {

              if (`+p+`) {
                dotProd +=
                    getX(batch, xR, xC, `+f+`) *
                    getW(wR, wC, `+f+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+f+`, xR, xC) *
                    getW(wR, wC, `+f+`, d2);
              }

            } else if (`+(h===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+f+`, d2),
                getW(wR, wC, `+f+` + 1, d2)
              );

              if (`+p+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+f+`),
                  getX(batch, xR, xC, `+f+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+f+`, xR, xC),
                  getX(batch, `+f+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(h===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+f+`, d2),
                getW(wR, wC, `+f+` + 1, d2),
                getW(wR, wC, `+f+` + 2, d2)
              );

              if (`+p+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+f+`),
                  getX(batch, xR, xC, `+f+` + 1),
                  getX(batch, xR, xC, `+f+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+f+`, xR, xC),
                  getX(batch, `+f+` + 1, xR, xC),
                  getX(batch, `+f+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+w+`
        `+b+`
        setOutput(result);
      }
    `},lM=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterDepth,d=e.filterHeight,f=e.filterWidth,h=4*Math.floor(e.inChannels/4),p=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+o+", "+i+", "+a+`);
      const ivec3 pads = ivec3(`+t+", "+n+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+c+`; wF++) {
          int xF = xFCorner + wF * `+s+`;

          if (xF < 0 || xF >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`; wR++) {
            int xR = xRCorner + wR * `+u+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+f+`; wC++) {
              int xC = xCCorner + wC * `+l+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+h+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(p===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+h+`) *
                  getW(wF, wR, wC, `+h+`, d2);
              } else if (`+(p===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(p===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1),
                  getX(batch, xF, xR, xC, `+h+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2),
                  getW(wF, wR, wC, `+h+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},cx=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var o=e.inHeight,i=e.inWidth,a=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,d=e.dilationWidth,f=e.filterHeight,h=e.filterWidth,p=e.outChannels/e.inChannels,m="",g="";n&&(m=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,g="result = activation(result);");var v=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+m+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+p+`;
        int q = d2 - d1 * `+p+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+f+`; wR++) {
          int xR = xRCorner + wR * `+c+`;

          if (xR < 0 || xR >= `+o+`) {
            continue;
          }

          for (int wC = 0; wC < `+h+`; wC++) {
            int xC = xCCorner + wC * `+d+`;

            if (xC < 0 || xC >= `+i+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+v+`
        `+g+`
        setOutput(result);
      }
    `},dx=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var o=e.inHeight,i=e.inWidth,a=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,d=e.dilationWidth,f=e.filterHeight,h=e.filterWidth,p=h,m="int xR; int xC; int xCOffset;",g=0;g<f;g++)for(var v=0;v<h;v++)m+=`
          vec4 xTexelR`+g+"C"+2*v+` = vec4(0.);
          vec4 wR`+g+"C"+v+` = vec4(0.);
          vec4 xR`+g+"C"+v+" = vec4(0.);";for(g=0;g<f;g++)for(var y=0;y<p;y++){if(m+=`
          xR = xRCorner + `+g*c+`;
          xC = xCCorner + `+(v=2*y)*d+`;
        `,l===1){if(v<h&&(m+=s%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+o+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  xTexelR`+g+"C"+v+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    xTexelR`+g+"C"+v+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+g+"C"+v+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+o+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+g+"C"+v+" = vec4(previous.zw, xTexelR"+g+"C"+v+`.xy);
                } else {
                  xR`+g+"C"+v+" = vec4(0, 0, xTexelR"+g+"C"+v+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+o+" && xC >= 0 && xC < "+i+`) {
                  xTexelR`+g+"C"+v+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+g+"C"+v+` = vec4(0.);
                }

                xR`+g+"C"+v+" = xTexelR"+g+"C"+v+`;
              `,v+1<h)){var b=s%2==0?_S(d):d;d%2==0&&s%2==1||d%2!=0&&s%2!=1?(m+=`
                  xCOffset = xC + `+s%2+" + "+b+`;

                  if(xR >= 0 && xR < `+o+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+g+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,d>1&&(m+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+o+` &&
                      xCOffset >= 0 && xCOffset < `+i+`) {
                      xTexelR`+g+"C"+v+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+g+"C"+v+` = vec4(0.);
                    }
                  `),m+=`
                  xR`+g+"C"+(v+1)+` = vec4(
                    xTexelR`+g+"C"+v+".zw, xTexelR"+g+"C"+(v+2)+`.xy);
                `):m+=`
                  xCOffset = xC + `+b+`;

                  if(xR >= 0 && xR < `+o+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+g+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+g+"C"+(v+1)+" = xTexelR"+g+"C"+(v+2)+`;
                `}}else v<h&&(m+=`
              if(xR >= 0 && xR < `+o+`) {
            `,s%2==1?(m+=`
                xCOffset = xC + 1 - `+l+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+g+"C"+v+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+g+"C"+v+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+i+`) {
                  xTexelR`+g+"C"+(v+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+g+"C"+(v+2)+` = vec4(0.);
                }

                xR`+g+"C"+v+` = vec4(
                  xTexelR`+g+"C"+v+".zw, xTexelR"+g+"C"+(v+2)+`.zw);
              `,v+1<h&&(m+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+l+`;
                  if(xCOffset >= 0 && xCOffset < `+i+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+g+"C"+(v+1)+" = vec4(xTexelR"+g+"C"+(v+2)+`.xy, final.xy);
                `)):(m+=`
                if(xC >= 0 && xC < `+i+`) {
                  xTexelR`+g+"C"+v+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+g+"C"+v+` = vec4(0.);
                }

                xCOffset = xC + `+l+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+g+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+g+"C"+(v+2)+` = vec4(0.);
                }

                xR`+g+"C"+v+` = vec4(
                  xTexelR`+g+"C"+v+".xy, xTexelR"+g+"C"+(v+2)+`.xy);
              `,v+1<h&&(m+=`
                  xR`+g+"C"+(v+1)+` = vec4(
                    xTexelR`+g+"C"+v+".zw, xTexelR"+g+"C"+(v+2)+`.zw);
                `)),m+="}");v<h&&(m+=`
            vec4 wTexelR`+g+"C"+v+" = getW("+g+", "+v+`, d1, q);
            wR`+g+"C"+v+" = vec4(wTexelR"+g+"C"+v+".xz, wTexelR"+g+"C"+v+`.xz);
          `,v+1<h&&(m+=`
              vec4 wTexelR`+g+"C"+(v+1)+" = getW("+g+", "+(v+1)+`, d1, q);
              wR`+g+"C"+(v+1)+` =
                vec4(wTexelR`+g+"C"+(v+1)+".xz, wTexelR"+g+"C"+(v+1)+".xz);"))}for(g=0;g<f;g++)for(v=0;v<h;v++)m+="dotProd += xR"+g+"C"+v+" * wR"+g+"C"+v+";";var w="",C="";n&&(w=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`vec4 activation(vec4 x) {
          `+n+`
        }`,C="result = activation(result);");var S=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+w+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+m+`

        vec4 result = dotProd;
        `+S+`
        `+C+`
        setOutput(result);
      }
    `},cM=function(e,t,n,r,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=e[0],a=e[1],s=e[2],u=e[3],l=t[0],c=n[0],d=n[1];this.outputShape=[l,c,d,u];var f=r==="bilinear"?1:0,h=[a-1+".0",s-1+".0"],p=h[0],m=h[1],g=c>1?[""+(a-1)/(c-1),"(y2-y1) * height_ratio","y1*"+p+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+p],v=g[0],y=g[1],b=g[2],w=d>1?[""+(s-1)/(d-1),"(x2-x1) * width_ratio","x1*"+m+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+m],C=w[0],S=w[1],E=w[2];this.userCode=`
      const float height_ratio = float(`+v+`);
      const float width_ratio = float(`+C+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+i+`) {
          return;
        }

        float height_scale = `+y+`;
        float width_scale = `+S+`;

        float in_y = `+b+`;
        if( in_y < 0.0 || in_y > `+p+` ) {
          setOutput(float(`+o+`));
          return;
        }
        float in_x = `+E+`;
        if( in_x < 0.0 || in_x > `+m+` ) {
          setOutput(float(`+o+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+f+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},dM=function(e,t,n){this.variableNames=["x"],this.outputShape=e;var r=e.length,o=e[e.length-1],i=n?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(n?"return "+o+" -i - 1;":"return i;")+`
      }

      void main() {
        `+Le(r)+` coords = getOutputCoords();
        int end = `+fx(r,"coords")+`;
        float val = 0.0;
        for (int i = `+o+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+i+` end) {
            continue;
          }
          if (idx == end && `+t+`) {
            continue;
          }
          `+fx(r,"coords")+` = idx;
          val += getX(`+function(a,s){if(a===1)return""+s;if(a===2)return s+".x, "+s+".y";if(a===3)return s+".x, "+s+".y, "+s+".z";if(a===4)return s+".x, "+s+".y, "+s+".z, "+s+".w";throw Error("Cumulative sum for rank "+a+" is not yet supported")}(r,"coords")+`);
        }
        setOutput(val);
      }
    `};function fx(e,t){if(e===1)return""+t;if(e===2)return t+".y";if(e===3)return t+".z";if(e===4)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var fM=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=cu.DENSE;var t=Os(e),n=Vt();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+mi(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+n.output+` = result;
      }
    `},hM=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=cu.DENSE;var t=Os(e),n=Vt();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+mi(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+n.output+` = result;
      }
    `},pM=function(){function e(t,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+n+`;
      int offset_h = imod(h, `+n+`);
      int in_w = w / `+n+`;
      int offset_w = imod(w, `+n+`);
      int offset_d = (offset_h * `+n+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return e.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),mM=function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},vM=function(e){this.variableNames=["A"],this.outTexUsage=bn.DOWNLOAD;var t=Vt();this.outputShape=e,this.userCode=`
      `+iE+`

      void main() {
        float x = getAAtOutCoords();
        `+t.output+` = encode_float(x);
      }
    `},gM=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=bn.DOWNLOAD;var t=Vt();this.outputShape=e,this.userCode=`
      `+iE+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+t.output+` = encode_float(x);
      }
    `},yM=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"];var r=Vt(),o=t[0],i=t[1];this.outputShape=e;var a="result";n&&(a="floor(result * 255. + 0.5)"),this.userCode=`
      `+mg(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+i+`;
        int c = imod(flatIndex, `+i+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+o+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+a+`, 0., 0., 0.);
      }
    `},xM=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=Vt(),o=t[0],i=t[1];this.outputShape=e;var a="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var l=0;l<=1;l++){var c=2*u+l;a+=`
          localCoords = coords;
          if(localCoords[2] + `+l+" < "+e[2]+`) {
            localCoords[2] += `+l+`;
            if(localCoords[1] + `+u+" < "+e[1]+`) {
              localCoords[1] += `+u+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+i+`;
              c = imod(flatIndex, `+i+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+o+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+c+`] = values[0];
              } else if(offset == 1) {
                result[`+c+`] = values[1];
              } else if(offset == 2) {
                result[`+c+`] = values[2];
              } else {
                result[`+c+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+mg(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+a+`

        `+r.output+" = "+s+`;
      }
    `},bM="return real * expR - imag * expI;",wM="return real * expI + imag * expR;",hx=function(e,t,n){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var o=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=n?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+o+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+e+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+i+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},CM=function(){function e(t,n){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,o){n.valueLoc==null&&(n.valueLoc=r.getUniformLocationNoThrow(o,"value")),r.gl.uniform1f(n.valueLoc,t)}},e}(),SM=function(e,t,n){this.variableNames=["A","indices"];var r=e.slice();r[n]=t,this.outputShape=r,this.rank=r.length;var o=Le(this.rank),i=function(a,s){var u=a.length;if(u>4)throw Error("Gather for rank "+u+" is not yet supported");if(u===1)return"int(getIndices(resRC))";for(var l=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],d=0;d<a.length;d++)d===s?c.push("int(getIndices("+l[d]+"))"):c.push(""+l[d]);return c.join()}(e,n);this.userCode=`
      void main() {
        `+o+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},EM=function(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var r=Le(t.length),o=Le(n.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+o+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+i+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function kM(e,t){var n=Vt();return b3(e,t,n.version+`
    precision highp float;
    `+n.attribute+` vec3 clipSpacePos;
    `+n.attribute+` vec2 uv;
    `+n.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function _M(e,t){return k3(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function RM(e,t){return _3(e,t,new Uint16Array([0,1,2,2,1,3]))}function Pu(e,t,n,r,o,i,a){T3(n,r);var s=R3(e,t),u=e.TEXTURE_2D;return re(e,t,function(){return e.bindTexture(u,s)}),re(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)}),re(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}),re(e,t,function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)}),re(e,t,function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)}),re(e,t,function(){return e.texImage2D(u,0,o,n,r,0,i,a,null)}),re(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)}),s}function TM(e,t,n,r,o){var i=Nd(n,r);return Pu(e,t,i[0],i[1],o.internalFormatFloat,o.textureFormatFloat,e.FLOAT)}function AM(e,t,n,r,o){var i=Nd(n,r);return Pu(e,t,i[0],i[1],o.internalFormatHalfFloat,o.textureFormatFloat,o.textureTypeHalfFloat)}function IM(e,t,n,r,o){var i=Nd(n,r);return Pu(e,t,i[0],i[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function NM(e,t,n,r,o){var i=Nu(n,r);return Pu(e,t,i[0],i[1],o.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function PM(e,t,n,r,o){var i=Nu(n,r);return Pu(e,t,i[0],i[1],o.internalFormatPackedHalfFloat,e.RGBA,o.textureTypeHalfFloat)}function DM(e,t,n,r){return re(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),ex(e,t,n,"clipSpacePos",r,3,20,0)&&ex(e,t,n,"uv",r,2,20,12)}function MM(e,t,n,r,o,i,a){var s,u,l;re(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),i instanceof Uint8Array?(s=new Uint8Array(r*o*4),u=e.UNSIGNED_BYTE,l=e.RGBA):(s=new Float32Array(r*o*4),u=e.FLOAT,l=a.internalFormatPackedFloat),s.set(i),re(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,l,r,o,0,e.RGBA,u,s)}),re(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function FM(e,t,n,r){re(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),r.data instanceof Uint8Array?re(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data)}):re(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)}),re(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function OM(e,t,n,r,o){var i=e.createBuffer();re(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,i)});var a=16*n*r;return re(e,t,function(){return e.bufferData(e.PIXEL_PACK_BUFFER,a,e.STREAM_READ)}),re(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,0)}),re(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}),i}function BM(e,t,n){var r=e,o=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,o),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),o}function LM(e,t,n,r,o){var i=Nd(n,r),a=i[0],s=i[1],u=new Uint8Array(n*r*4);return re(e,t,function(){return e.readPixels(0,0,a,s,o.downloadTextureFormat,e.UNSIGNED_BYTE,u)}),new Float32Array(u.buffer)}function jM(e,t,n,r,o,i,a,s){var u=e,l=new Float32Array(function(c,d){var f=Nu(c,d);return f[0]*f[1]*4}(i,a));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function zM(e,t,n,r){var o=new Float32Array(n*r*4);return re(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,o)}),o}var VM=function(){function e(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=H().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,m3(n,t)):this.gl=Lr(n);var r="WEBGL_color_buffer_float";if(H().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=pl(this.gl,this.debug,"OES_texture_float"),Kn(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=pl(this.gl,this.debug,"OES_texture_half_float");else if(H().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Kn(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=pl(this.gl,this.debug,"EXT_color_buffer_half_float");else if(H().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Kn(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!Kn(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=_M(this.gl,this.debug),this.indexBuffer=RM(this.gl,this.debug),this.framebuffer=A3(this.gl,this.debug),this.textureConfig=ig(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return H().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var t=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var n=this.gl;re(n,this.debug,function(){return n.finish()}),re(n,this.debug,function(){return n.bindFramebuffer(n.FRAMEBUFFER,null)}),re(n,this.debug,function(){return n.deleteFramebuffer(t.framebuffer)}),re(n,this.debug,function(){return n.bindBuffer(n.ARRAY_BUFFER,null)}),re(n,this.debug,function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}),re(n,this.debug,function(){return n.deleteBuffer(t.indexBuffer)}),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(t,n){return this.throwIfDisposed(),TM(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(t,n){return this.throwIfDisposed(),AM(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(t,n){return this.throwIfDisposed(),IM(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.uploadPixelDataToTexture=function(t,n){this.throwIfDisposed(),FM(this.gl,this.debug,t,n)},e.prototype.uploadDenseMatrixToTexture=function(t,n,r,o){this.throwIfDisposed(),MM(this.gl,this.debug,t,n,r,o,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(t,n){return this.throwIfDisposed(),PM(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(t,n){return this.throwIfDisposed(),NM(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.deleteMatrixTexture=function(t){var n=this;this.throwIfDisposed(),this.outputTexture===t&&(tx(this.gl,this.debug,this.framebuffer),this.outputTexture=null),re(this.gl,this.debug,function(){return n.gl.deleteTexture(t)})},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,n,r){var o=this;return this.downloadMatrixDriver(t,function(){return LM(o.gl,o.debug,n,r,o.textureConfig)})},e.prototype.downloadPackedMatrixFromBuffer=function(t,n,r,o,i,a){return jM(this.gl,t,0,0,0,i,a,this.textureConfig)},e.prototype.downloadFloat32MatrixFromBuffer=function(t,n){return BM(this.gl,t,n)},e.prototype.createBufferFromTexture=function(t,n,r){this.bindTextureToFrameBuffer(t);var o=OM(this.gl,this.debug,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),o},e.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},e.prototype.createFence=function(t){var n,r,o=this;if(H().getBool("WEBGL_FENCE_API_ENABLED")){var i=t,a=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=function(){var s=i.clientWaitSync(a,0,0);return s===i.ALREADY_SIGNALED||s===i.CONDITION_SATISFIED},n=a}else H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=function(){return o.isQueryAvailable(n,H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:n,isFencePassed:r}},e.prototype.downloadMatrixFromPackedTexture=function(t,n,r){var o=this;return this.downloadMatrixDriver(t,function(){return zM(o.gl,o.debug,n,r)})},e.prototype.createProgram=function(t){this.throwIfDisposed();var n=this.gl,r=w3(n,this.debug,t),o=kM(n,this.debug),i=S3(n,this.debug);return re(n,this.debug,function(){return n.attachShader(i,o)}),re(n,this.debug,function(){return n.attachShader(i,r)}),E3(n,this.debug,i),this.debug&&Ch(n,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=DM(n,this.debug,this.program,this.vertexBuffer)),i},e.prototype.deleteProgram=function(t){var n=this;this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&re(this.gl,this.debug,function(){return n.gl.deleteProgram(t)})},e.prototype.setProgram=function(t){var n=this;this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&Ch(this.gl,this.debug,this.program),re(this.gl,this.debug,function(){return n.gl.useProgram(t)})},e.prototype.getUniformLocation=function(t,n,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?N3(this.gl,this.debug,t,n):P3(this.gl,t,n)},e.prototype.getAttributeLocation=function(t,n){var r=this;return this.throwIfDisposed(),re(this.gl,this.debug,function(){return r.gl.getAttribLocation(t,n)})},e.prototype.getUniformLocationNoThrow=function(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)},e.prototype.setInputMatrixTexture=function(t,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),D3(this.gl,this.debug,this.program,t,n,r)},e.prototype.setOutputMatrixTexture=function(t,n,r){this.setOutputMatrixTextureDriver(t,r,n)},e.prototype.setOutputPackedMatrixTexture=function(t,n,r){this.throwIfDisposed();var o=Nu(n,r),i=o[0],a=o[1];this.setOutputMatrixTextureDriver(t,i,a)},e.prototype.setOutputMatrixWriteRegion=function(t,n,r,o){this.setOutputMatrixWriteRegionDriver(r,t,o,n)},e.prototype.setOutputPackedMatrixWriteRegion=function(t,n,r,o){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){this.program!=null&&Ch(this.gl,this.debug,this.program),ml(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),re(t,this.debug,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},e.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),re(this.gl,this.debug,function(){return t.gl.finish()})},e.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=pl(this.gl,this.debug,H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var t=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=t.createQuery();return t.beginQuery(n.TIME_ELAPSED_EXT,r),r}var o=this.getQueryTimerExtensionWebGL1(),i=o.createQueryEXT();return o.beginQueryEXT(o.TIME_ELAPSED_EXT,i),i},e.prototype.endQuery=function(){if(H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(t){return Z(this,void 0,void 0,function(){var n=this;return ee(this,function(r){switch(r.label){case 0:return[4,q1(function(){return n.disposed||n.isQueryAvailable(t,H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(t,H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},e.prototype.getQueryTime=function(t,n){if(n===0)return null;if(n===2){var r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}var o=this.getQueryTimerExtensionWebGL1();return o.getQueryObjectEXT(t,o.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(t,n){if(n===0)return!0;if(n===2){var r=this.gl,o=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(o=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,o.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint},e.prototype.pollFence=function(t){var n=this;return new Promise(function(r){n.addItemToPoll(function(){return t.isFencePassed()},function(){return r()})})},e.prototype.pollItems=function(){for(var t=function(r){for(var o=0;o<r.length&&r[o]();++o);return o-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),n=0;n<=t;++n)(0,this.itemsToPoll[n].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},e.prototype.addItemToPoll=function(t,n){var r=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),this.itemsToPoll.length>1||q1(function(){return r.pollItems(),r.itemsToPoll.length===0})},e.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),Sh(this.gl,this.debug,t,this.framebuffer),this.debug&&ml(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(Sh(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&ml(this.gl)):tx(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(t,n){this.bindTextureToFrameBuffer(t);var r=n();return this.unbindTextureToFrameBuffer(),r},e.prototype.setOutputMatrixTextureDriver=function(t,n,r){this.throwIfDisposed();var o=this.gl;Sh(o,this.debug,t,this.framebuffer),this.debug&&ml(o),this.outputTexture=t,re(o,this.debug,function(){return o.viewport(0,0,n,r)}),re(o,this.debug,function(){return o.scissor(0,0,n,r)})},e.prototype.setOutputMatrixWriteRegionDriver=function(t,n,r,o){var i=this;this.throwIfDisposed(),re(this.gl,this.debug,function(){return i.gl.scissor(t,n,r,o)})},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},e}();function px(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach(function(n,r){var o=n.logicalShape,i=t[r],a=i.shape;if(!Et(o,a))throw Error("Binary was compiled with different shapes than the current args. Shapes "+o+" and "+a+" must match");if(!n.isUniform||!i.isUniform){var s=n.texShape,u=i.isUniform?null:i.texData.texShape;if(!Et(s,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+s+" and "+u+" must match")}})}var $M=function(e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var r=n.filterWidth,o=n.inChannels,i=n.strideWidth,a=n.strideHeight,s=n.padInfo,u=n.outWidth,l=n.dilationWidth,c=n.dilationHeight,d=n.dataFormat,f=s.left,h=s.top,p=o*r,m=Vt(),g=d==="channelsLast",v=g?0:1,y=g?1:2,b="",w=0;w<=1;w++)for(var C=0;C<=1;C++)b+=`
          blockIndex = rc.y + `+C+`;
          pos = rc.x + `+w+`;

          if(blockIndex < `+e[1]+" && pos < "+e[0]+`) {
            offsetY = int(blockIndex / (`+u+")) * "+a+" - "+h+`;
            d0 = offsetY + `+c+" * (pos / "+p+`);

            if(d0 < `+t[v]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+u+".) * "+i+". - "+f+`.);
              d1 = offsetX + `+l+" * (int(mod(float(pos), "+p+".) / "+o+`.));

              if(d1 < `+t[y]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+o+`.));

                if (`+g+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*w+C)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*w+C)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+b+`

        `+m.output+` = result;
      }
    `},WM=function(e,t,n,r,o){this.variableNames=["x"],this.outputShape=[];var i,a=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";i=o===.5?"inversesqrt("+u+")":o===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+a+"; j <= "+a+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+s+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+i+`;
        setOutput(val);
      }
    `},UM=function(e,t,n,r,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+t+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+t+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+n+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+o+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+o+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},HM=function(e,t,n,r,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,a=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";i=o===.5?"inversesqrt("+u+")":o===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+a+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+a+"; j <= "+a+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+s+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+i+`;
        setOutput(result);
      }
    `},GM=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,o=e.effectiveFilterHeight,i=e.effectiveFilterWidth,a=o-1-e.padInfo.top,s=i-1-e.padInfo.left,u=o*i-1;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+o+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+t+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+i+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+n+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+u+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+i+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},KM=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,o=e.dilationDepth,i=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterDepth,u=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=s-1-e.padInfo.front,d=u-1-e.padInfo.top,f=l-1-e.padInfo.left,h=s*u*l-1;this.userCode=`
      const ivec3 pads = ivec3(`+c+", "+d+", "+f+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+s+`;
           wD += `+o+`) {
          float dyD = float(dyDCorner + wD) / `+t+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+u+`;
              wR += `+i+`) {
            float dyR = float(dyRCorner + wR) / `+n+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+l+`;
                wC += `+a+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+h+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+u+" * "+l+` +
                  wR * `+l+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},Th=function(e,t,n,r,o,i,a){n===void 0&&(n=!1),r===void 0&&(r=!1),o===void 0&&(o=!1),i===void 0&&(i=null),a===void 0&&(a=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var s=n?e[1]:e[2],u=Math.ceil(s/2),l=n?"i * 2, rc.y":"rc.y, i * 2",c=r?"rc.z, i * 2":"i * 2, rc.z",d=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],h="",p="";i&&(h=a?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+i+`
        }`:`vec4 activation(vec4 x) {
          `+i+`
        }`,p="result = activation(result);");var m=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+h+`

      const float sharedDimension = `+u+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+u+`; i++) {
          vec4 a = getMatrixA(rc.x, `+l+`);
          vec4 b = getMatrixB(rc.x, `+c+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+d[0]+" * "+f[0]+`);
          result += (`+d[1]+" * "+f[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+m+`

        `+p+`

        setOutput(result);
      }
    `},qM=function(){function e(t,n,r){this.variableNames=["probs"],this.outputShape=[t,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(n-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(n-1)+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,o){n.seedLoc==null&&(n.seedLoc=r.getUniformLocation(o,"seed")),r.gl.uniform1f(n.seedLoc,t)}},e}(),XM=function(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+n+`),
                      float(index == coords.y)));
      }
    `},YM=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var t=e.length;if(t===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var n=nn("rc",t),r=Le(t),o=function(s,u,l){if(s===1)return"rc > "+u[0];for(var c="",d=s-2;d<s;d++)c+=l[d]+" >= "+u[d],d<s-1&&(c+="||");return c}(t,e,n),i=function(s,u,l,c){if(s===1)return"";var d=c.slice(-2);return`
    int r = `+d[0]+`;
    int c = `+d[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+u+`;
    bool rEdge = rp1 >= `+l+`;
  `}(t,e[e.length-1],e[e.length-2],n),a=function(s,u){var l=s.length,c=function(d,f){for(var h=[],p=0;p<=1;p++)for(var m=0;m<=1;m++){for(var g=(p===0?"r":"rp1")+", "+(m===0?"c":"cp1"),v=2;v<d;v++)g=f[f.length-1-v]+","+g;h.push(g)}return h}(l,u);return l===1?`getA(rc),
            rc + 1 >= `+s[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+c[0]+`),
          cEdge ? 0. : getA(`+c[1]+`),
          rEdge ? 0. : getA(`+c[2]+`),
          rEdge || cEdge ? 0. : getA(`+c[3]+")"}(e,n);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+o+`) {
            setOutput(vec4(0));
          } else {
            `+i+`

            setOutput(vec4(`+a+`));
          }
        }
      `}},QM=function(e,t,n){this.variableNames=["x"],this.outputShape=t.map(function(u,l){return u[0]+e[l]+u[1]});var r=e.length,o=Le(r),i=t.map(function(u){return u[0]}).join(","),a=t.map(function(u,l){return u[0]+e[l]}).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+o+" start = "+o+"("+i+`);
      `+o+" end = "+o+"("+a+`);

      void main() {
        `+o+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+n+`));
        } else {
          `+o+` coords = outC - start;
          setOutput(getX(`+s+`));
        }
      }
    `:`
        int start = `+i+`;
        int end = `+a+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+n+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},JM=function(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(g,v){return g[0]+e[v]+g[1]});for(var r=e.length,o=Le(r),i=t.map(function(g){return g[0]}).join(","),a=t.map(function(g,v){return g[0]+e[v]}).join(","),s=nn("rc",r),u=nn("source",r),l=s[r-1]+" < "+this.outputShape[r-1],c=r===1?"source":"vec2("+u.slice(-2).join()+")",d=[o+" rc = outputLoc;",s[r-1]+` += 1;
       if(`+l+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+s[r-2]+` += 1;
       if(`+s[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+s[r-1]+` += 1;
         if(`+l+") {"],f=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="",p=0,m=r===1?2:4;p<m;p++)h+=`
        `+d[p]+`
        if (`+f+`) {
          result[`+p+"] = float("+n+`);
        } else {
          `+o+` source = rc - start;
          result[`+p+"] = getChannel(getX("+u.join()+"), "+c+`);
        }
      `;h+=r===1?"} ":"}}",this.userCode=`
      const `+o+" start = "+o+"("+i+`);
      const `+o+" end = "+o+"("+a+`);

      void main() {
        `+o+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+h+`
        setOutput(result);
      }
    `},Ah=function(e,t,n){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,o=e.strideHeight,i=e.strideWidth,a=e.dilationHeight,s=e.dilationWidth,u=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=e.padInfo.top,d=e.padInfo.left;this.outputShape=e.outShape;var f=t==="avg",h="0.0";if(f||(h="-1.0 / 1e-20"),n)this.userCode=`
        const ivec2 strides = ivec2(`+o+", "+i+`);
        const ivec2 pads = ivec2(`+c+", "+d+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+u+`;
              wR += `+a+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+l+`;
                wC += `+s+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+l+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var p=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(p="avgValue / count");var m=4*Math.floor(r/4),g=r%4,v=`
      if (`+f+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+o+", "+i+`);
      const ivec2 pads = ivec2(`+c+", "+d+`);
      const float initializationValue = `+h+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+h+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+u+`;
            wR += `+a+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+m+`; wC += 4) {
            int xC = xCCorner + wC * `+s+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              getValue(batch, xR, xC + 3 * `+s+`, d)
            );

            `+v+`
          }

          int xC = xCCorner + `+m+`;
          if (`+(g===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+v+`
          } else if (`+(g===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              initializationValue,
              initializationValue
            );

            `+v+`
          } else if (`+(g===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              initializationValue
            );

            `+v+`
          }
        }
        setOutput(`+p+`);
      }
    `}},Ih=function(e,t,n){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,h=e.padInfo.front,p=e.padInfo.top,m=e.padInfo.left;this.outputShape=e.outShape;var g=t==="avg",v="0.0";if(g||(v="-1.0 / 1e-20"),n)this.userCode=`
        const ivec3 strides =
            ivec3(`+o+", "+i+", "+a+`);
        const ivec3 pads = ivec3(`+h+", "+p+", "+m+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+c+`;
              wD += `+s+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+e.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+d+`;
                wR += `+u+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+f+`;
                  wC += `+l+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+d+" * "+f+` +
                      wR * `+f+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var y=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(y="avgValue / count");var b=4*Math.floor(r/4),w=r%4,C=`
      if (`+g+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+o+", "+i+", "+a+`);
      const ivec3 pads = ivec3(`+h+", "+p+", "+m+`);
      const float initializationValue = `+v+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+v+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+s+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`;
            wR += `+u+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+b+`; wC += 4) {
              int xC = xCCorner + wC * `+l+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+l+`, ch)
              );

              `+C+`
            }

            int xC = xCCorner + `+b+`;
            if (`+(w===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+C+`
            } else if (`+(w===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                initializationValue,
                initializationValue
              );

              `+C+`
            } else if (`+(w===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                initializationValue
              );

              `+C+`
            }
          }
          setOutput(`+y+`);
        }
      }
    `}},ZM=function(e,t){this.variableNames=["x"];var n=e.windowSize,r=e.batchSize,o=e.inSize,i=Math.ceil(o/n);this.outputShape=[r,i];var a="0.0",s="";t==="prod"?a="1.0":t==="min"?(a="1.0 / 1e-20",s="min"):t==="max"&&(a="-1.0 / 1e-20",s="max");var u=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?u="sumValue":t==="prod"?u="prodValue":t==="all"?u="allValue":t==="any"&&(u="anyValue");var l=4*Math.floor(n/4),c=n%4,d=`
      if (`+(t==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(t==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+s+`(values, minMaxValue);
      }
    `,f="vec4";t==="all"?(a="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):t==="any"&&(a="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");var h="";o%n>0&&(h=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+a+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+h+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        vec4 minMaxValue = vec4(`+a+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+d+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(c===1)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(c===2)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(c===3)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+d+`
        }
        setOutput(`+u+`);
      }
    `},eF=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var n="",r=0;r<4;r++){var o="thisRC = rc;";r%2==1&&(o+="thisRC.z += 1;"),r>1&&(o+="thisRC.y += 1;"),n+=`
        `+o+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+mi(["r","c","d"],t)+`
      return ivec3(r, c, d);
    }
  
      `+mg(e)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+e[1]+`;
        int cols = `+e[2]+`;

        `+n+`

        setOutput(result);
      }
    `},tF=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,o=r[1],i=r[2],a=e.shape,s=a[1],u=a[2],l=[n&&s>1?o-1:o,n&&u>1?i-1:i],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],d=l[0]/c[0],f=l[1]/c[1],h=1/d,p=1/f,m=2*Math.ceil(h)+2,g=2*Math.ceil(p)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+f+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+p+`);

        const int winHeight = int(`+m+`);
        const int winWidth = int(`+g+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(o-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(i-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},nF=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var o=e[0],i=e[1],a=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?a-1:a],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+a+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},rF=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=e[0],i=e[1],a=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?a-1:a],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`,
          `+u[1]/l[1]+`);
      const vec3 inputShapeRC = vec3(`+i+".0, "+a+`.0,
                                     `+a+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(s-1)+`;
        bool hasNextRow = coords.z < `+(n-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},oF=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,o=r[1],i=r[2],a=e.shape,s=a[1],u=a[2],l=[n&&s>1?o-1:o,n&&u>1?i-1:i],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],d=l[0]/c[0],f=l[1]/c[1],h=1/d,p=1/f,m=2*Math.ceil(h)+2,g=2*Math.ceil(p)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+f+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+p+`);

        const int winHeight = int(`+m+`);
        const int winWidth = int(`+g+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float sourceFracRow =
              float(`+l[0]+`) *
                (float(dyR) / float(`+c[0]+`));

            float sourceFracCol =
                float(`+l[1]+`) *
                  (float(dyC) / float(`+c[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+o+`) - 1),
                `+n+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+i+`) - 1),
                `+n+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},iF=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var o=e[0],i=e[1],a=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?a-1:a],l=[r&&t>1?t-1:t,r&&n>1?n-1:n],c=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+a+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+c+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},aF=function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,n!==1){var r=e.map(function(i,a){return function(s){return t.indexOf(s)!==-1&&e[s]!==1?e[s]+" - coords["+s+"] - 1":"coords["+s+"]"}(a)}).join(","),o=Le(n);this.userCode=`
      void main() {
        `+o+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+e[0]+` - coord - 1));
        }
      `},sF=function(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=e;var r=nn("rc",n),o=r[n-1]+" + 1 < "+this.outputShape[n-1],i=r[n-2]+" + 1 < "+this.outputShape[n-2],a=Le(n);function s(u){var l=e.map(function(c,d){return function(f,h){return t.indexOf(f)!==-1&&e[f]!==1?e[f]+" - "+h[f]+" - 1":""+h[f]}(d,u)});return"getChannel(getX("+l.join(",")+"), vec2("+l.slice(-2).join(",")+"))"}this.userCode=n===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+e[0]+` - rc - 1),
            `+e[0]+` - rc - 1);
          if(`+o+`){
              result.g = getChannel(getX(`+e[0]+` - (rc  + 1) - 1),
                `+e[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+a+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(u){return s(u)}(r.slice())+`;
          if(`+o+`){
            result.g = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",s(u)}(r.slice())+`;
          }
          if(`+i+`) {
            result.b = `+function(u){return u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            if(`+o+`) {
              result.a = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `},mx=function(e,t,n,r,o,i,a){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var s=Le(o.length),u=Le(i.length),l="";n===1?l="i":n===2&&(l="i, j");var c="getIndices("+l+")",d="";r===1?d="i":r===2&&(d="i, coords[1]");var f="getUpdates("+d+")",h=t>1?"strides[j]":"strides";this.userCode=`
        `+s+" strides = "+s+"("+o+`);

        void main() {
          `+u+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+e+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+t+`; j++) {
              int index = round(`+c+`);
              flattenedIndex += index * `+h+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+f+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},uF=function(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,r=e.batchSize,o=e.inSize,i=e.numSegments,a=i*Math.ceil(o/n);this.outputShape=[r,a];var s=4*Math.floor(n/4),u=n%4,l=`
        sumValue += dot(values, segFilter);
    `,c="";o%n>0&&(c=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return initializationValue;
        }
      `);var d="";o%n>0&&(d=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+c+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+d+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+i+")) * float("+n+`));
        int currentSeg = int(mod(float(outIdx), float(`+i+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+s+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+l+`
        }

        int inIdx = inOffset + `+s+`;
        if (`+(u===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+l+`
        } else if (`+(u===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+l+`
        } else if (`+(u===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+l+`
        }
        setOutput(sumValue);
      }
    `},lF=function(e,t,n){var r,o;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(n===1)o="resRC",r="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],s=[],u=0;u<t.length;u++)s.push(""+i[u]),u<e&&a.push(""+i[u]);r=a.join(),o=s.join()}var l=Le(n);this.userCode=`
      void main() {
        `+l+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+o+`));
        } else {
          setOutput(getB(`+o+`));
        }
      }
    `},cF=function(){function e(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n,r=Le(this.rank),o="uniform int start["+this.rank+"];",i=function(a){if(a===1)return"sourceLoc";if(a<=6)return Nh.slice(0,a).map(function(s){return"sourceLoc."+s}).join(",");throw Error("Slicing for rank "+a+" is not yet supported")}(this.rank);n=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+t.map(function(a,s){return"sourceLoc."+Nh[s]+" = start["+s+"] + coords."+Nh[s]+";"}).join(`
`)+`
      `,this.userCode=`
      `+o+`
      void main() {
        `+n+`
        setOutput(getSource(`+i+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,o){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(o,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),Nh=["x","y","z","w","u","v"],dF=function(){function e(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var n=Le(this.rank),r=nn("coords",this.rank),o=nn("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":"vec2("+o.slice(-2).join()+")",a="getChannel(getSource("+o.join()+"), "+i+")",s=`
      result.x = `+a+`;
      if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
        ++`+o[this.rank-1]+`;
        result.y = `+a+`;
        --`+o[this.rank-1]+`;
      }
    `,u=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+t[this.rank-2]+`) {
        ++`+o[this.rank-2]+`;
        result.z = `+a+`;
        if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
          ++`+o[this.rank-1]+`;
          result.w = `+a+`;
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            `+n+"("+t.map(function(c,d){return"start["+d+"]"}).join()+");":t.map(function(c,d){return o[d]+" = "+r[d]+" + start["+d+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+n+` coords = getOutputCoords();
        `+n+` sourceLoc;
        `+l+`
        vec4 result = vec4(0.);
        `+s+`
        `+u+`
        setOutput(result);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,o){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(o,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),fF=function(e,t,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,o=Le(n.length),i=Le(n.length),a="";if(r===1)a="coords * strides + begin";else{var s=0;a=n.map(function(u,l){return s++,n.length===1?"coords * strides["+l+"] + begin["+l+"]":"coords["+(s-1)+"] * strides["+l+"] + begin["+l+"]"}).join(",")}this.userCode=`
      `+o+" begin = "+o+"("+e+`);
      `+o+" strides = "+o+"("+t+`);

      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+a+`));
      }
    `},hF=function(){function e(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(t,n,r){var o,i=vx(n,r),a=gx(t,i,r);if(a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]),this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var s=this.freeTextures[a].shift();return this.usedTextures[a].push(s),s}return this.numUsedTextures++,this.log(),i===gn.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===gn.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===gn.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===gn.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===gn.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[a].push(o),o},e.prototype.releaseTexture=function(t,n,r,o){if(this.freeTextures!=null){var i=gx(n,vx(r,o),o);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var a=this.usedTextures[i],s=a.indexOf(t);if(s<0)throw new Error("Cannot release a texture that was never provided by this texture manager");a.splice(s,1),this.log()}},e.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var t=this;if(this.freeTextures!=null){for(var n in this.freeTextures)this.freeTextures[n].forEach(function(r){t.gpgpu.deleteMatrixTexture(r)});for(var n in this.usedTextures)this.usedTextures[n].forEach(function(o){t.gpgpu.deleteMatrixTexture(o)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function vx(e,t){if(e===bn.UPLOAD)return gn.PACKED_2X2_FLOAT32;if(e===bn.RENDER||e==null)return function(n){return H().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?gn.PACKED_2X2_FLOAT32:gn.UNPACKED_FLOAT32:n?gn.PACKED_2X2_FLOAT16:gn.UNPACKED_FLOAT16}(t);if(e===bn.DOWNLOAD||e===bn.PIXELS)return gn.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function gx(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}var pF=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;var o=Le(this.rank),i=function(a){var s=a.length;if(s>5)throw Error("Tile for rank "+s+" is not yet supported");if(s===1)return"imod(resRC, "+a[0]+")";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],l=[],c=0;c<a.length;c++)l.push("imod("+u[c]+", "+a[c]+")");return l.join()}(e);this.userCode=`
      void main() {
        `+o+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},mF=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;var o=Le(this.rank),i=function(a){var s=a.length;if(s>6)throw Error("Transpose for rank "+s+" is not yet supported");for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],l=new Array(s),c=0;c<a.length;c++)l[a[c]]=u[c];return l.join()}(t);this.userCode=`
    void main() {
      `+o+` resRC = getOutputCoords();
      setOutput(getA(`+i+`));
    }
    `},vF=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var o=Le(this.rank),i=oE("rc",this.rank),a=new Array(this.rank);for(r=0;r<t.length;r++)a[t[r]]=i[r];var s="vec2("+a.slice(-2).join()+")",u="++"+i[this.rank-1]+" < "+n[this.rank-1],l="getChannel(getA("+a.join()+"), "+s+")";this.userCode=`
    void main() {
      `+o+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+l+`;
      if(`+u+`) {
        result[1] = `+l+`;
      }
      --`+i[this.rank-1]+`;
      if(++`+i[this.rank-2]+" < "+n[this.rank-2]+`) {
        result[2] = `+l+`;
        if(`+u+`) {
          result[3] = `+l+`;
        }
      }
      setOutput(result);
    }
    `},vg=1.7580993408473768,gg=1.0507009873554805,ye=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      float unaryOperation(float x) {
        `+t+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},mr="if (isnan(x)) return x;",gF="return x;",yx="return abs(x);",lE=mr+`
  return (x < 0.0) ? 0.0 : x;
`,cE=mr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,dE="return (x >= 0.0) ? x : (exp(x) - 1.0);",yF=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+vg+`;
  float scale = `+gg+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,xx="return -x;",bx="return ceil(x);",wx="return floor(x);",Cx="return exp(x);",Sx="return exp(x) - 1.0;",xF=mr+`
  return sin(x);
`,bF=mr+`
  return cos(x);
`,wF=mr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,CF=mr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,SF=mr+`
  return atan(x);
`,EF=mr+"return log(x + sqrt(x * x + 1.0));",kF=mr+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,_F=mr+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,xl="return x;",RF="return x;",fE=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,hE=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,pE=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,ms=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+t+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},TF=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var t=e.length,n=nn("rc",t),r=Le(t),o=function(s,u){if(s===1)return"rc";for(var l="",c=0;c<s;c++)l+=u[c],c<s-1&&(l+=",");return l}(t,n),i=n.slice(-2),a=t<=1?"rc":"vec2("+i.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+o+`);

        setOutput(getChannel(packedInput, `+a+`));
      }
    `},bl={};function wl(e,t){if(t===void 0&&(t=!1),e==="linear")return t?RF:gF;if(e==="relu")return t?fE:lE;if(e==="elu")return t?pE:dE;if(e==="relu6")return t?hE:cE;if(e==="prelu")return t?uE:sE;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var AF=600,IF=function(e){function t(n){var r,o=e.call(this)||this;if(o.pendingRead=new WeakMap,o.pendingDisposal=new WeakSet,o.dataRefCount=new WeakMap,o.numBytesInGPU=0,o.uploadWaitMs=0,o.downloadWaitMs=0,o.warnedAboutMemory=!1,o.pendingDeletes=0,o.disposed=!1,!H().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(n==null){var i=Lr(H().getNumber("WEBGL_VERSION"));o.binaryCache=((r=H().getNumber("WEBGL_VERSION"))in bl||(bl[r]={}),bl[r]),o.gpgpu=new VM(i),o.canvas=i.canvas,o.gpgpuCreatedLocally=!0}else o.gpgpu=n,o.binaryCache={},o.gpgpuCreatedLocally=!1,o.canvas=n.gl.canvas;return o.textureManager=new hF(o.gpgpu),o.numMBBeforeWarning=H().global.screen==null?1024:H().global.screen.height*H().global.screen.width*window.devicePixelRatio*AF/1024/1024,o.texData=new XS(o,F),o}return pr(t,e),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(n,r,o){if(H().getBool("DEBUG")&&this.checkNumericalProblems(n),o==="complex64"&&n!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var i={};return this.texData.set(i,{shape:r,dtype:o,values:n,usage:bn.UPLOAD}),i},t.prototype.move=function(n,r,o,i){if(H().getBool("DEBUG")&&this.checkNumericalProblems(r),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(n,{shape:o,dtype:i,values:r,usage:bn.UPLOAD})},t.prototype.readSync=function(n){var r=this.texData.get(n),o=r.values,i=r.dtype,a=r.complexTensors,s=r.slice,u=r.shape,l=r.isPacked;if(s!=null){var c=void 0;c=l?new ms(u,xl):new ye(u,xl);var d=this.runWebGLProgram(c,[{dataId:n,shape:u,dtype:i}],i),f=this.readSync(d.dataId);return this.disposeData(d.dataId),f}if(o!=null)return this.convertAndCacheOnCPU(n);if(i==="string")return o;var h,p,m=this.activeTimers!=null;return m&&(h=Cr()),i==="complex64"?p=gm(a.real.dataSync(),a.imag.dataSync()):p=this.getValuesFromTexture(n),m&&(this.downloadWaitMs+=Cr()-h),this.convertAndCacheOnCPU(n,p)},t.prototype.read=function(n){return Z(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,d,f,h,p,m,g,v,y,b,w,C,S,E,k;return ee(this,function(R){switch(R.label){case 0:if(this.pendingRead.has(n))return r=this.pendingRead.get(n),[2,new Promise(function(_){return r.push(_)})];if(o=this.texData.get(n),i=o.values,a=o.shape,s=o.slice,u=o.dtype,l=o.complexTensors,c=o.isPacked,s!=null)return d=void 0,d=c?new ms(a,xl):new ye(a,xl),f=this.runWebGLProgram(d,[{dataId:n,shape:a,dtype:u}],u),h=this.read(f.dataId),this.disposeData(f.dataId),[2,h];if(i!=null)return[2,this.convertAndCacheOnCPU(n)];if(!H().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&H().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return p=null,u!=="complex64"&&H().get("WEBGL_BUFFER_SUPPORTED")&&(m=this.decode(n),g=this.texData.get(m.dataId),p=(k=this.gpgpu).createBufferFromTexture.apply(k,[g.texture].concat(Os(a)))),this.pendingRead.set(n,[]),u==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:R.sent(),R.label=2;case 2:return u!=="complex64"?[3,4]:[4,Promise.all([l.real.data(),l.imag.data()])];case 3:return y=R.sent(),b=y[0],w=y[1],v=gm(b,w),[3,5];case 4:p==null?v=this.getValuesFromTexture(n):(C=ne(a),v=this.gpgpu.downloadFloat32MatrixFromBuffer(p,C)),R.label=5;case 5:return m!=null&&this.disposeData(m.dataId),S=this.convertAndCacheOnCPU(n,v),E=this.pendingRead.get(n),this.pendingRead.delete(n),E.forEach(function(_){return _(S)}),this.pendingDisposal.has(n)&&(this.pendingDisposal.delete(n),this.disposeData(n),this.pendingDeletes--),[2,S]}})})},t.prototype.checkNumericalProblems=function(n){if(n!=null)for(var r=0;r<n.length;r++){var o=n[r];if(!y3(o))throw H().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+o+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+o+" cannot be represented on this device.")}},t.prototype.getValuesFromTexture=function(n){var r,o=this.texData.get(n),i=o.shape,a=o.dtype,s=o.isPacked,u=ne(i);if(H().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var l=this.decode(n),c=this.texData.get(l.dataId),d=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[c.texture].concat(Os(i))).subarray(0,u);return this.disposeData(l.dataId),d}var f=H().getBool("WEBGL_PACK")&&s===!0,h=f?Eh(i):i,p=f?new gM(h):new vM(h),m=this.runWebGLProgram(p,[{shape:h,dtype:a,dataId:n}],"float32"),g=this.texData.get(m.dataId),v=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(g.texture,g.texShape[0],g.texShape[1]).subarray(0,u);return this.disposeData(m.dataId),v},t.prototype.time=function(n){return Z(this,void 0,void 0,function(){var r,o,i,a,s,u,l;return ee(this,function(c){switch(c.label){case 0:return r=this.activeTimers,o=[],i=!1,this.programTimersStack==null?(this.programTimersStack=o,i=!0):this.activeTimers.push(o),this.activeTimers=o,n(),a=za(this.activeTimers.map(function(d){return d.query})).filter(function(d){return d!=null}),s=za(this.activeTimers.map(function(d){return d.name})).filter(function(d){return d!=null}),this.activeTimers=r,i&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(a)]:[3,2];case 1:return l=c.sent(),u.kernelMs=JP(l),u.getExtraProfileInfo=function(){return l.map(function(d,f){return{name:s[f],ms:d}}).map(function(d){return d.name+": "+d.ms}).join(", ")},[3,3];case 2:u.kernelMs={error:"WebGL query timers are not supported in this environment."},c.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Cr(),endMs:null}},t.prototype.endTimer=function(n){return H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),n):(n.endMs=Cr(),n)},t.prototype.getQueryTime=function(n){return Z(this,void 0,void 0,function(){var r;return ee(this,function(o){return H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(n)]:[2,(r=n).endMs-r.startMs]})})},t.prototype.disposeData=function(n){if(!this.pendingDisposal.has(n)){if(this.pendingRead.has(n))return this.pendingDisposal.add(n),void this.pendingDeletes++;if(this.texData.has(n)){this.releaseGPUData(n);var r=this.texData.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(n)}}},t.prototype.releaseGPUData=function(n){var r=this.texData.get(n),o=r.texture,i=r.dtype,a=r.texShape,s=r.usage,u=r.isPacked,l=r.slice,c=l&&l.origDataId||n,d=this.dataRefCount.get(c);d>1?this.dataRefCount.set(c,d-1):(this.dataRefCount.delete(c),o!=null&&(this.numBytesInGPU-=this.computeBytes(a,i),this.textureManager.releaseTexture(o,a,s,u)));var f=this.texData.get(n);f.texture=null,f.texShape=null,f.isPacked=!1,f.slice=null},t.prototype.getTexture=function(n){return this.uploadToGPU(n),this.texData.get(n).texture},t.prototype.getDataInfo=function(n){return this.texData.get(n)},t.prototype.getCPUBackend=function(){return H().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=F.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(n,r){var o=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&n.every(function(i){return o.texData.get(i.dataId).texture==null&&i.size<r})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(n,r){var o=this.makeOutput(n.shape,"complex64");return this.texData.get(o.dataId).complexTensors={real:F.keep(n.clone()),imag:F.keep(r.clone())},o},t.prototype.real=function(n){return this.texData.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.texData.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,o){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.slice(n,r,o);if(ne(o)===0)return It([],o,n.dtype);var i=this.texData.get(n.dataId).isPacked,a=KS(n.shape,r,o);if(i||!a){var s=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new dF(o):new cF(o),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[n],null,u)}return this.uploadToGPU(n.dataId),this.shallowSlice(n,r,o)},t.prototype.shallowSlice=function(n,r,o){var i=this.texData.get(n.dataId),a=this.makeOutput(o,n.dtype),s=this.texData.get(a.dataId);Object.assign(s,i),s.shape=o,s.dtype=n.dtype;var u=qS(r,n.strides);i.slice&&(u+=i.slice.flatOffset),s.slice={flatOffset:u,origDataId:i.slice&&i.slice.origDataId||n.dataId};var l=this.dataRefCount.get(s.slice.origDataId)||1;return this.dataRefCount.set(s.slice.origDataId,l+1),a},t.prototype.stridedSlice=function(n,r,o,i){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.stridedSlice(n,r,o,i);var a=cg(r,o,i);if(a.some(function(u){return u===0}))return It([],a);var s=new fF(r,i,a);return this.compileAndRun(s,[n])},t.prototype.reverse=function(n,r){var o=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new sF(n.shape,r):new aF(n.shape,r);return this.compileAndRun(o,[n])},t.prototype.concat=function(n,r){if(n[0].dtype==="complex64"){var o=n.map(function(h){return Un(h)}),i=n.map(function(h){return Rr(h)});return Tt(this.concat(o,r),this.concat(i,r))}if(this.shouldExecuteOnCPU(n))return this.cpuBackend.concat(n,r);if(n.length===1)return n[0];if(n.length>H().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var a=Math.floor(n.length/2),s=this.concat(n.slice(0,a),r),u=this.concat(n.slice(a),r);return this.concat([s,u],r)}if(H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&n[0].rank>1){var l=new nM(n.map(function(h){return h.shape}),r);return this.compileAndRun(l,n)}var c=$a(n.map(function(h){return h.shape}),r),d=n.map(function(h){return h.as2D(-1,ne(h.shape.slice(r)))}),f=new tM(d.map(function(h){return h.shape}));return this.compileAndRun(f,d).reshape(c)},t.prototype.neg=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.neg(n);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,xx,n.dtype);var r=new ye(n.shape,xx);return this.compileAndRun(r,[n])},t.prototype.batchMatMul=function(n,r,o,i){var a=o?n.shape[2]:n.shape[1],s=i?r.shape[1]:r.shape[2],u=o?n.shape[1]:n.shape[2],l=n.shape[0];if((a===1||s===1)&&u>1e3){o&&(n=n.transpose([0,2,1])),i&&(r=r.transpose([0,2,1]));var c=s===1?n:n.as3D(l,u,1),d=s===1?2:1,f=s===1?r.as3D(l,1,u):r;return this.multiply(c,f).sum(d,!0)}var h=At(n.dtype,r.dtype),p=new Th(n.shape,[l,a,s],o,i);return this.compileAndRun(p,[n,r],h)},t.prototype.fusedBatchMatMul=function(n){var r=n.a,o=n.b,i=n.transposeA,a=n.transposeB,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=i?r.shape[2]:r.shape[1],d=a?o.shape[1]:o.shape[2],f=r.shape[0],h=At(r.dtype,o.dtype),p=s!=null,m=l!=null,g=u?wl(u,!0):null,v=new Th(r.shape,[f,c,d],i,a,p,g,m),y=[r,o];return s&&y.push(s),l&&y.push(l),this.compileAndRun(v,y,h)},t.prototype.multiply=function(n,r){if(n.dtype==="complex64"){var o=this.texData.get(n.dataId),i=this.texData.get(r.dataId),a=new sx(YD,n.shape,r.shape),s=new sx(QD,n.shape,r.shape),u=[this.makeComplexComponentTensorInfo(n,o.complexTensors.real),this.makeComplexComponentTensorInfo(n,o.complexTensors.imag),this.makeComplexComponentTensorInfo(r,i.complexTensors.real),this.makeComplexComponentTensorInfo(r,i.complexTensors.imag)],l=this.compileAndRun(a,u),c=this.compileAndRun(s,u),d=this.complex(l,c);return l.dispose(),c.dispose(),d}if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.multiply(n,r);if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,ux,n.dtype);var f=new et(ux,n.shape,r.shape);return this.compileAndRun(f,[n,r],n.dtype)},t.prototype.batchNormalization=function(n,r,o,i,a,s){var u=[n,r,o],l=null;s!=null&&(l=s.shape,u.push(s));var c=null;if(a!=null&&(c=a.shape,u.push(a)),H().getBool("WEBGL_PACK_NORMALIZATION")){var d=new XD(n.shape,r.shape,o.shape,l,c,i);return this.compileAndRun(d,u)}var f=new qD(n.shape,r.shape,o.shape,l,c,i);return this.compileAndRun(f,u)},t.prototype.localResponseNormalization4D=function(n,r,o,i,a){var s=H().getBool("WEBGL_PACK_NORMALIZATION")?new HM(n.shape,r,o,i,a):new WM(n.shape,r,o,i,a);return this.compileAndRun(s,[n])},t.prototype.LRNGrad=function(n,r,o,i,a,s,u){var l=new UM(r.shape,i,a,s,u);return this.compileAndRun(l,[r,o,n])},t.prototype.tile=function(n,r){if(n.dtype==="string"){var o=this.readSync(n.dataId).map(function(a){return Mc(a)});return nE(ge(n.shape,n.dtype,o),r)}var i=new pF(n.shape,r);return this.compileAndRun(i,[n])},t.prototype.pad=function(n,r,o){var i=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new JM(n.shape,r,o):new QM(n.shape,r,o);return this.compileAndRun(i,[n])},t.prototype.transpose=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.transpose(n,r);var o=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new vF(n.shape,r):new mF(n.shape,r);return this.compileAndRun(o,[n])},t.prototype.gather=function(n,r,o){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.gather(n,r,o);var i=new SM(n.shape,r.size,o);return this.compileAndRun(i,[n,r])},t.prototype.batchToSpaceND=function(n,r,o){A(n.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(d,f){return d*f}),a=zc(n.shape,r,i),s=Vc(a.length,r.length),u=$c(n.shape,r,i),l=WS(o,r.length),c=US(u,o,r.length);return n.reshape(a).transpose(s).reshape(u).slice(l,c)},t.prototype.spaceToBatchND=function(n,r,o){A(n.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(f,h){return f*h}),a=[[0,0]];a.push.apply(a,o);for(var s=1+r.length;s<n.shape.length;++s)a.push([0,0]);var u=n.pad(a),l=zc(u.shape,r,i,!1),c=Vc(l.length,r.length,!1),d=$c(u.shape,r,i,!1);return u.reshape(l).transpose(c).reshape(d)},t.prototype.reduce=function(n,r,o){var i=n.shape[0],a=n.shape[1],s=kh(a),u=new ZM({windowSize:s,inSize:a,batchSize:i},r),l=this.compileAndRun(u,[n],o);return l.shape[1]===1?l:this.reduce(l,r,o)},t.prototype.argReduce=function(n,r,o){o===void 0&&(o=null);var i=n.shape[0],a=n.shape[1];o!=null&&(i=o.shape[0],a=o.shape[1]);var s=kh(a),u=new jD({windowSize:s,inSize:a,batchSize:i},r,o==null),l=[n];o!=null&&l.push(o);var c=this.compileAndRun(u,l,"int32");return c.shape[1]===1?c:this.argReduce(n,r,c)},t.prototype.argReducePacked=function(n,r,o){o===void 0&&(o=null);var i=o!=null?o.shape:n.shape,a=kh(i[i.length-1]),s=new HD(i,a,r,o==null),u=o==null?[n]:[n,o],l=this.compileAndRun(s,u,"int32");return l.rank===n.rank?this.argReducePacked(n,r,l):l},t.prototype.sum=function(n,r){vn("sum",r,n.rank);var o=Lt(n.shape,r),i=o[0],a=ne(o[1]),s=n.as2D(-1,a),u=gh(n.dtype);return this.reduce(s,"sum",u).reshape(i)},t.prototype.prod=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.prod(n,r);var o=Lt(n.shape,r),i=o[0],a=ne(o[1]),s=n.as2D(-1,a),u=gh(n.dtype);return this.reduce(s,"prod",u).reshape(i)},t.prototype.unsortedSegmentSum=function(n,r,o){var i=0,a=jr([i],n.rank),s=n;a!=null&&(s=n.transpose(a),i=zr(1,n.rank)[0]);var u=function(h,p,m){for(var g=[],v=h.length,y=0;y<v;y++)y!==p?g.push(h[y]):g.push(m);return g}(s.shape,i,o),l=ne([s.shape[i]]),c=s.as2D(-1,l),d=gh(n.dtype),f=this.segOpCompute(c,"unsortedSegmentSum",r,d,o).reshape(u);return a!=null&&(f=f.transpose(ag(a))),f},t.prototype.segOpCompute=function(n,r,o,i,a){var s=n.shape[0],u=n.shape[1],l=function(f,h){var p,m=!1;for(f<=GS?(p=f,m=!0):p=um(f,Math.floor(Math.sqrt(f)));!m;)p>h||p===f?m=!0:p=um(f,p+1);return p}(u,a),c=new uF({windowSize:l,inSize:u,batchSize:s,numSegments:a}),d=this.compileAndRun(c,[n,o],i);return d.shape[1]===a?d:(o=jc(0,a).tile([u/l]),this.segOpCompute(d,r,o,i,a))},t.prototype.argMinMaxReduce=function(n,r,o){var i=[r];if(vn("arg"+o.charAt(0).toUpperCase()+o.slice(1),i,n.rank),!H().getBool("WEBGL_PACK_REDUCE")||n.rank<=2){var a=Lt(n.shape,i),s=a[0],u=ne(a[1]),l=n.as2D(-1,u);return this.argReduce(l,o).reshape(s)}return this.argReducePacked(n,o)},t.prototype.argMin=function(n,r){return this.argMinMaxReduce(n,r,"min")},t.prototype.argMax=function(n,r){return this.argMinMaxReduce(n,r,"max")},t.prototype.cumsum=function(n,r,o,i){if(r!==n.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(n.rank-1)+" but got axis="+r);var a=new dM(n.shape,o,i);return this.compileAndRun(a,[n])},t.prototype.equal=function(n,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(equal(a, b));
`,"bool");var o=new et("return float(a == b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.notEqual=function(n,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(notEqual(a, b));
`,"bool");var o=new et("return float(a != b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.less=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.less(n,r);if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThan(a, b));
`,"bool");var o=new et("return float(a < b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.lessEqual=function(n,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var o=new et("return float(a <= b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.greater=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.greater(n,r);if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThan(a, b));
`,"bool");var o=new et("return float(a > b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.greaterEqual=function(n,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var o=new et("return float(a >= b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.logicalNot=function(n){var r=new ye(n.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[n])},t.prototype.logicalAnd=function(n,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var o=new et("return float(a >= 1.0 && b >= 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.logicalOr=function(n,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var o=new et("return float(a >= 1.0 || b >= 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.select=function(n,r,o){var i=new lF(n.rank,r.shape,r.rank);return this.compileAndRun(i,[n,r,o],At(r.dtype,o.dtype))},t.prototype.where=function(n){Bc("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=n.dataSync();return pg(n.shape,r)},t.prototype.topk=function(n,r,o){return rE(n.dataSync(),n.shape,n.dtype,r)},t.prototype.min=function(n,r){vn("min",r,n.rank);var o=Lt(n.shape,r),i=o[0],a=ne(o[1]),s=n.as2D(-1,a);return this.reduce(s,"min",s.dtype).reshape(i)},t.prototype.minimum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.minimum(n,r);var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ur(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new et(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.mod=function(n,r){var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ur(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new et(`if (b == 0.0) return NAN;
  return mod(a, b);`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.max=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.max(n,r);vn("max",r,n.rank);var o=Lt(n.shape,r),i=o[0],a=ne(o[1]),s=n.as2D(-1,a);return this.reduce(s,"max",s.dtype).reshape(i)},t.prototype.maximum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.maximum(n,r);var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ur(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new et(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.all=function(n,r){vn("all",r,n.rank);var o=Lt(n.shape,r),i=o[0],a=ne(o[1]),s=n.as2D(-1,a);return this.reduce(s,"all",s.dtype).reshape(i)},t.prototype.any=function(n,r){vn("any",r,n.rank);var o=Lt(n.shape,r),i=o[0],a=ne(o[1]),s=n.as2D(-1,a);return this.reduce(s,"any",s.dtype).reshape(i)},t.prototype.realDivide=function(n,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var o=new et(`
if (a == b) {
  return 1.0;
};
return a / b;`,n.shape,r.shape);return this.compileAndRun(o,[n,r],"float32")},t.prototype.floorDiv=function(n,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var o=new et(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,n.shape,r.shape);return this.compileAndRun(o,[n,r],"int32")},t.prototype.add=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,_h);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.add(n,r);var o=At(n.dtype,r.dtype);if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,_h,o);var i=new et(_h,n.shape,r.shape);return this.compileAndRun(i,[n,r],o)},t.prototype.packedUnaryOp=function(n,r,o){var i=new ms(n.shape,r);return this.compileAndRun(i,[n],o)},t.prototype.packedBinaryOp=function(n,r,o,i,a){a===void 0&&(a=!1);var s=new Ur(o,n.shape,r.shape,a);return this.compileAndRun(s,[n,r],i)},t.prototype.complexSeparableBinaryOp=function(n,r,o){var i=this,a=this.texData.get(n.dataId),s=this.texData.get(r.dataId),u=[[a.complexTensors.real,s.complexTensors.real],[a.complexTensors.imag,s.complexTensors.imag]].map(function(f){var h=f[0],p=f[1],m=i.makeComplexComponentTensorInfo(n,h),g=i.makeComplexComponentTensorInfo(r,p),v=new et(o,n.shape,r.shape);return i.compileAndRun(v,[m,g],At(h.dtype,p.dtype))}),l=u[0],c=u[1],d=this.complex(l,c);return l.dispose(),c.dispose(),d},t.prototype.makeComplexComponentTensorInfo=function(n,r){return{dataId:r.dataId,dtype:r.dtype,shape:n.shape}},t.prototype.addN=function(n){if(n.length===1)return n[0];if(n.length>H().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(n.length/2),o=this.addN(n.slice(0,r)),i=this.addN(n.slice(r));return this.addN([o,i])}var a=n.map(function(l){return l.dtype}).reduce(function(l,c){return At(l,c)}),s=n.map(function(l){return l.shape}),u=H().getBool("WEBGL_PACK")?new LD(n[0].shape,s):new BD(n[0].shape,s);return this.compileAndRun(u,n,a)},t.prototype.subtract=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,Rh);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.subtract(n,r);var o=At(n.dtype,r.dtype);if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,Rh,n.dtype);var i=new et(Rh,n.shape,r.shape);return this.compileAndRun(i,[n,r],o)},t.prototype.pow=function(n,r){var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ur(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new et(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,n.shape,r.shape),i=At(n.dtype,r.dtype);return this.compileAndRun(o,[n,r],i)},t.prototype.ceil=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.ceil(n);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,bx,n.dtype);var r=new ye(n.shape,bx);return this.compileAndRun(r,[n])},t.prototype.floor=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.floor(n);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,wx,n.dtype);var r=new ye(n.shape,wx);return this.compileAndRun(r,[n])},t.prototype.sign=function(n){var r=new ye(n.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[n])},t.prototype.isNaN=function(n){var r=new ye(n.shape,"return float(isnan(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isInf=function(n){var r=new ye(n.shape,"return float(isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isFinite=function(n){var r=new ye(n.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.round=function(n){var r=new ye(n.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[n])},t.prototype.exp=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.exp(n);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,Cx,n.dtype);var r=new ye(n.shape,Cx);return this.compileAndRun(r,[n])},t.prototype.expm1=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.expm1(n);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,Sx,n.dtype);var r=new ye(n.shape,Sx);return this.compileAndRun(r,[n])},t.prototype.softmax=function(n,r){var o=bt([r],n.shape),i=this.max(n,o),a=dn(i.shape,o),s=this.subtract(n,i.reshape(a)),u=this.exp(s),l=this.sum(u,o).reshape(a);return this.realDivide(u,l)},t.prototype.log=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.log(n);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,n.dtype);var r=new ye(n.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[n])},t.prototype.log1p=function(n){var r=new ye(n.shape,"return log(1.0 + x);");return this.compileAndRun(r,[n])},t.prototype.sqrt=function(n){var r=new ye(n.shape,"return sqrt(x);");return this.compileAndRun(r,[n])},t.prototype.rsqrt=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.rsqrt(n);var r=new ye(n.shape,"return inversesqrt(x);");return this.compileAndRun(r,[n])},t.prototype.reciprocal=function(n){var r=new ye(n.shape,"return 1.0 / x;");return this.compileAndRun(r,[n])},t.prototype.relu=function(n){var r;return r=H().getBool("WEBGL_PACK")?new ms(n.shape,fE):new ye(n.shape,lE),this.compileAndRun(r,[n])},t.prototype.relu6=function(n){var r;return r=H().getBool("WEBGL_PACK")?new ms(n.shape,hE):new ye(n.shape,cE),this.compileAndRun(r,[n])},t.prototype.prelu=function(n,r){var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ur(uE,n.shape,r.shape):new et(sE,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.elu=function(n){if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,pE,n.dtype);var r=new ye(n.shape,dE);return this.compileAndRun(r,[n])},t.prototype.eluDer=function(n,r){var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ur(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,n.shape,r.shape):new et("return (b >= 1.0) ? a : a * (b + 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.selu=function(n){var r=new ye(n.shape,yF);return this.compileAndRun(r,[n])},t.prototype.int=function(n){var r=new ye(n.shape,"return float(int(x));");return this.compileAndRun(r,[n],"int32")},t.prototype.clip=function(n,r,o){var i,a=(i=H().getBool("WEBGL_PACK_CLIP")?new ZD(n.shape):new JD(n.shape)).getCustomSetupFunc(r,o);return this.compileAndRun(i,[n],null,a)},t.prototype.abs=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.abs(n);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,yx,n.dtype);var r=new ye(n.shape,yx);return this.compileAndRun(r,[n])},t.prototype.complexAbs=function(n){var r=this.texData.get(n.dataId),o=new eM(n.shape),i=[this.makeComplexComponentTensorInfo(n,r.complexTensors.real),this.makeComplexComponentTensorInfo(n,r.complexTensors.imag)];return this.compileAndRun(o,i)},t.prototype.sigmoid=function(n){var r=new ye(n.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[n])},t.prototype.softplus=function(n){var r=new ye(n.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[n])},t.prototype.sin=function(n){var r=new ye(n.shape,xF);return this.compileAndRun(r,[n])},t.prototype.cos=function(n){var r=new ye(n.shape,bF);return this.compileAndRun(r,[n])},t.prototype.tan=function(n){var r=new ye(n.shape,"return tan(x);");return this.compileAndRun(r,[n])},t.prototype.asin=function(n){var r=new ye(n.shape,wF);return this.compileAndRun(r,[n])},t.prototype.acos=function(n){var r=new ye(n.shape,CF);return this.compileAndRun(r,[n])},t.prototype.atan=function(n){var r=new ye(n.shape,SF);return this.compileAndRun(r,[n])},t.prototype.atan2=function(n,r){var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ur(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new et(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.sinh=function(n){var r=new ye(n.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.cosh=function(n){var r=new ye(n.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.tanh=function(n){var r=new ye(n.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[n])},t.prototype.asinh=function(n){var r=new ye(n.shape,EF);return this.compileAndRun(r,[n])},t.prototype.acosh=function(n){var r=new ye(n.shape,kF);return this.compileAndRun(r,[n])},t.prototype.atanh=function(n){var r=new ye(n.shape,_F);return this.compileAndRun(r,[n])},t.prototype.erf=function(n){var r=new ye(n.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[n])},t.prototype.step=function(n,r){var o=new ye(n.shape,function(i){return i===void 0&&(i=0),mr+`
    return x > 0.0 ? 1.0 : float(`+i+`);
  `}(r));return this.compileAndRun(o,[n])},t.prototype.conv2dByMatMul=function(n,r,o,i,a,s){var u=n.shape,l=this.texData.get(n.dataId),c=o.inChannels,d=u[0]*u[1]*u[2],f=o.outChannels,h=o.dataFormat==="channelsLast",p=(d===1||f===1)&&c>1e3,m=u[2]%2!=0&&!!l.isPacked;if(p||!H().getBool("WEBGL_LAZILY_UNPACK")||!H().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!m){var g=h?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],v=this.reshape(n,[1,g,o.inChannels]),y=this.reshape(r,[1,o.inChannels,o.outChannels]);return this.reshape(this.fusedBatchMatMul({a:v,b:y,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:s}),o.outShape)}var b=h?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),w={dataId:n.dataId,shape:[1,b,o.inChannels],dtype:n.dtype},C=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,A(gl(l.shape,w.shape),function(){return"packed reshape "+l.shape+" to "+w.shape+" isn't free"});var S=this.reshape(r,[1,o.inChannels,o.outChannels]),E=this.fusedBatchMatMul({a:w,b:S,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:s}),k=this.texData.get(E.dataId);return A(k.isPacked,function(){return"batchMatMul result is expected to be packed"}),l.shape=C,k.shape=o.outShape,F.makeTensorFromDataId(E.dataId,o.outShape,E.dtype)},t.prototype.conv2dWithIm2Row=function(n,r,o,i,a,s){var u=o.filterWidth,l=o.filterHeight,c=o.inChannels,d=o.outWidth,f=o.outHeight,h=o.dataFormat==="channelsLast",p=u*l*c,m=f*d,g=[p,m],v=n.squeeze([0]),y=r.reshape([1,p,-1]),b=new $M(g,v.shape,o),w=this.compileAndRun(b,[v]).reshape([1,g[0],g[1]]),C=i!=null,S=s!=null,E=a?wl(a,!0):null,k=new Th(w.shape,[1,m,o.outChannels],!0,!1,C,E,S),R=[w,y];i&&R.push(i),S&&R.push(s);var _=this.compileAndRun(k,R);return h?_.reshape([1,f,d,o.outChannels]):_.reshape([1,o.outChannels,f,d])},t.prototype.fusedConv2d=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights;if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(r,o,i,a,s,u);if(H().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,o,i,a,s,u);var l=a!=null,c=u!=null,d=s?wl(s,!1):null,f=new lx(i,l,d,c),h=[r,o];return a&&h.push(a),u&&h.push(u),this.compileAndRun(f,h)},t.prototype.conv2d=function(n,r,o){if(o.filterHeight===1&&o.filterWidth===1&&o.dilationHeight===1&&o.dilationWidth===1&&o.strideHeight===1&&o.strideWidth===1&&(o.padInfo.type==="SAME"||o.padInfo.type==="VALID"))return this.conv2dByMatMul(n,r,o);if(H().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,r,o);var i=new lx(o);return this.compileAndRun(i,[n,r])},t.prototype.conv2dDerInput=function(n,r,o){var i=new oM(o);return this.compileAndRun(i,[n,r])},t.prototype.conv2dDerFilter=function(n,r,o){var i=new rM(o);return this.compileAndRun(i,[n,r])},t.prototype.fusedDepthwiseConv2D=function(n){var r,o=n.input,i=n.filter,a=n.convInfo,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=H().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1,d=u?wl(u,c):null,f=[o,i],h=s!=null,p=l!=null;return h&&f.push(s),p&&f.push(l),c?(r=new dx(a,h,d,p),this.compileAndRun(r,f)):(r=new cx(a,h,d,p),this.compileAndRun(r,f))},t.prototype.depthwiseConv2D=function(n,r,o){var i;return H().getBool("WEBGL_PACK_DEPTHWISECONV")&&o.strideWidth<=2&&o.outChannels/o.inChannels==1?(i=new dx(o),this.compileAndRun(i,[n,r])):(i=new cx(o),this.compileAndRun(i,[n,r]))},t.prototype.depthwiseConv2DDerInput=function(n,r,o){var i=new uM(o);return this.compileAndRun(i,[n,r])},t.prototype.depthwiseConv2DDerFilter=function(n,r,o){var i=new sM(o);return this.compileAndRun(i,[n,r])},t.prototype.conv3d=function(n,r,o){var i=new lM(o);return this.compileAndRun(i,[n,r])},t.prototype.conv3dDerInput=function(n,r,o){var i=new aM(o);return this.compileAndRun(i,[n,r])},t.prototype.conv3dDerFilter=function(n,r,o){var i=new iM(o);return this.compileAndRun(i,[n,r])},t.prototype.maxPool=function(n,r){var o=new Ah(r,"max",!1);return this.compileAndRun(o,[n])},t.prototype.avgPool=function(n,r){var o=new Ah(r,"avg",!1);return this.compileAndRun(o,[n],"float32")},t.prototype.maxPoolBackprop=function(n,r,o,i){var a=new Ah(i,"max",!0),s=this.compileAndRun(a,[r]),u=new GM(i),l=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),l},t.prototype.avgPoolBackprop=function(n,r,o){var i=new GD(o);return this.compileAndRun(i,[n],r.dtype)},t.prototype.cast=function(n,r){return JS(n,r,this)},t.prototype.unstack=function(n,r){for(var o=n.shape[r],i=new Array(n.rank-1),a=0,s=0;s<n.rank;s++)s!==r&&(i[a++]=n.shape[s]);var u=new Array(n.rank).fill(0),l=n.shape.slice();l[r]=1;var c=new Array(o);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(n,u,l).reshape(i);return c},t.prototype.avgPool3d=function(n,r){var o=new Ih(r,"avg",!1);return this.compileAndRun(o,[n],"float32")},t.prototype.avgPool3dBackprop=function(n,r,o){var i=new KD(o);return this.compileAndRun(i,[n],r.dtype)},t.prototype.maxPool3d=function(n,r){var o=new Ih(r,"max",!1);return this.compileAndRun(o,[n],"float32")},t.prototype.maxPool3dBackprop=function(n,r,o,i){var a=new Ih(i,"max",!0),s=this.compileAndRun(a,[r]),u=new KM(i),l=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),l},t.prototype.reshape=function(n,r){var o=this.texData.get(n.dataId);if(o.isPacked&&!gl(n.shape,r)&&(o.texture===null||!gl(o.shape,r))){var i=this.packedReshape(n,r);return F.makeTensorFromDataId(i.dataId,i.shape,i.dtype)}return vm(n,r)},t.prototype.resizeBilinear=function(n,r,o,i){var a=H().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new rF(n.shape,r,o,i):new nF(n.shape,r,o,i);return this.compileAndRun(a,[n],"float32")},t.prototype.resizeBilinearBackprop=function(n,r,o){var i=new tF(n,r,o);return this.compileAndRun(i,[n])},t.prototype.resizeNearestNeighbor=function(n,r,o,i){var a=new iF(n.shape,r,o,i);return this.compileAndRun(a,[n])},t.prototype.resizeNearestNeighborBackprop=function(n,r,o){var i=new oF(n,r,o);return this.compileAndRun(i,[n])},t.prototype.multinomial=function(n,r,o,i){var a=r?n:uo(n),s=a.shape[0],u=a.shape[1],l=new qM(s,u,o),c=l.getCustomSetupFunc(i);return this.compileAndRun(l,[a],"int32",c)},t.prototype.oneHot=function(n,r,o,i){var a=new XM(n.size,r,o,i);return this.compileAndRun(a,[n])},t.prototype.diag=function(n){var r=new mM(n.size);return this.compileAndRun(r,[n])},t.prototype.nonMaxSuppression=function(n,r,o,i,a){return Bc("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),fg(n.dataSync(),r.dataSync(),o,i,a)},t.prototype.cropAndResize=function(n,r,o,i,a,s){var u=new cM(n.shape,r.shape,i,a,s);return this.compileAndRun(u,[n,r,o],"float32")},t.prototype.depthToSpace=function(n,r,o){A(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var i=n.shape[0],a=o==="NHWC"?n.shape[1]:n.shape[2],s=o==="NHWC"?n.shape[2]:n.shape[3],u=o==="NHWC"?n.shape[3]:n.shape[1],l=a*r,c=s*r,d=u/(r*r),f=new pM(o==="NHWC"?[i,l,c,d]:[i,d,l,c],r,o);return this.compileAndRun(f,[n])},t.prototype.split=function(n,r,o){return tE(n,r,o)},t.prototype.scatterND=function(n,r,o){var i=Wc(0,n,o),a=i.sliceRank,s=i.numUpdates,u=i.sliceSize,l=i.strides,c=i.outputSize,d=[c/u,u],f=n.reshape([s,a]),h=r.reshape([s,u]);if(c===0)return vm(It([]),o);var p=Y(0),m=new mx(s,a,f.rank,h.rank,l,d);return this.compileAndRun(m,[h,f,p]).reshape(o)},t.prototype.sparseToDense=function(n,r,o,i){var a=Wc(0,n,o),s=a.sliceRank,u=a.numUpdates,l=a.strides,c=a.outputSize,d=new mx(u,s,n.rank,r.rank,l,[c,1]);return this.compileAndRun(d,[r,n,i]).reshape(o)},t.prototype.fft=function(n){return this.fftImpl(n,!1)},t.prototype.ifft=function(n){return this.fftImpl(n,!0)},t.prototype.fftImpl=function(n,r){var o=this.texData.get(n.dataId),i=new hx(bM,n.shape,r),a=new hx(wM,n.shape,r),s=[this.makeComplexComponentTensorInfo(n,o.complexTensors.real),this.makeComplexComponentTensorInfo(n,o.complexTensors.imag)],u=this.compileAndRun(i,s),l=this.compileAndRun(a,s),c=this.complex(u,l).as2D(n.shape[0],n.shape[1]);return u.dispose(),l.dispose(),c},t.prototype.gatherND=function(n,r){var o=r.shape,i=o[o.length-1],a=HS(n,r),s=a[0],u=a[1],l=a[2],c=a[3],d=r.reshape([u,i]),f=n.reshape([n.size/l,l]),h=new EM(i,c,[u,l]);return this.compileAndRun(h,[f,d]).reshape(s)},t.prototype.fill=function(n,r,o){if((o=o||Au(r))==="string"){var i=Dc(o,ne(n));return i.fill(r),F.makeTensor(i,n,o,this)}var a=new CM(n,r),s=a.getCustomSetupFunc(r);return this.compileAndRun(a,[],o,s)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){return this.fill(n.shape,n.dtype==="string"?"":0,n.dtype)},t.prototype.linspace=function(n,r,o){return ZS(n,r,o)},t.prototype.makeTensorInfo=function(n,r){var o=this.write(null,n,r);return this.texData.get(o).usage=null,{dataId:o,shape:n,dtype:r}},t.prototype.makeOutput=function(n,r){var o=this.makeTensorInfo(n,r).dataId;return F.makeTensorFromDataId(o,n,r,this)},t.prototype.unpackTensor=function(n){var r=new TF(n.shape);return this.runWebGLProgram(r,[n],n.dtype)},t.prototype.packTensor=function(n){var r=new YM(n.shape);return this.runWebGLProgram(r,[n],n.dtype,null,!0)},t.prototype.packedReshape=function(n,r){var o=[Fc(n.shape)].concat(Oc(n.shape)),i={dtype:n.dtype,shape:o,dataId:n.dataId},a=[Fc(r)].concat(Oc(r)),s=new eF(a,o),u=this.runWebGLProgram(s,[i],n.dtype,null,!0);return{dataId:u.dataId,shape:r,dtype:u.dtype}},t.prototype.decode=function(n){var r,o=this.texData.get(n),i=o.isPacked,a=o.shape,s=o.dtype,u=Eh(a);return r=i?new hM(u):new fM(u),{dtype:s,shape:a,dataId:this.runWebGLProgram(r,[{shape:u,dtype:s,dataId:n}],s,null,!0).dataId}},t.prototype.runWebGLProgram=function(n,r,o,i,a){var s=this;a===void 0&&(a=!1);var u=this.makeTensorInfo(n.outputShape,o),l=this.texData.get(u.dataId);if(n.packedOutput&&(l.isPacked=!0),n.outPackingScheme===cu.DENSE){var c=Os(n.outputShape);l.texShape=c.map(function(b){return 2*b})}if(n.outTexUsage!=null&&(l.usage=n.outTexUsage),ne(u.shape)===0)return l.values=uu(u.dtype,0),u;var d=[],f=r.map(function(b){if(b.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var w=s.texData.get(b.dataId);if(w.texture==null){if(!n.packedInputs&&ne(b.shape)<=H().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:b.shape,texData:null,isUniform:!0,uniformValues:w.values};n.packedInputs&&(w.isPacked=!0,w.shape=b.shape)}else if(!!w.isPacked!=!!n.packedInputs)b=w.isPacked?s.unpackTensor(b):s.packTensor(b),d.push(b),w=s.texData.get(b.dataId);else if(w.isPacked&&!gl(w.shape,b.shape)){var C=b,S=b.shape;b.shape=w.shape,b=s.packedReshape(b,S),d.push(b),w=s.texData.get(b.dataId),C.shape=S}return s.uploadToGPU(b.dataId),{shape:b.shape,texData:w,isUniform:!1}});this.uploadToGPU(u.dataId);var h,p={shape:u.shape,texData:l,isUniform:!1},m=function(b,w,C){var S="";w.concat(C).forEach(function(R){var _=R.texData!=null&&R.texData.slice!=null&&R.texData.slice.flatOffset>0,N=R.isUniform?"uniform":R.texData.texShape;S+=R.shape+"_"+N+"_"+_});var E=b.userCode,k=b.constructor.name;return k+="_"+S+"_"+E}(n,f,p),g=this.getAndSaveBinary(m,function(){return function(b,w,C,S){var E=w.userCode,k=C.map(function(M,B){var z={logicalShape:M.shape,texShape:M.isUniform?null:M.texData.texShape,isUniform:M.isUniform,isPacked:!M.isUniform&&M.texData.isPacked,flatOffset:null};return M.texData!=null&&M.texData.slice!=null&&M.texData.slice.flatOffset>0&&(z.flatOffset=M.texData.slice.flatOffset),{name:w.variableNames[B],shapeInfo:z}}),R=k.map(function(M){return M.shapeInfo}),_={logicalShape:S.shape,texShape:S.texData.texShape,isUniform:!1,isPacked:S.texData.isPacked,flatOffset:null},N=zD(k,_,E,w.packedInputs),I=b.createProgram(N),L=null,O=b.getUniformLocation(I,"NAN",!1);H().getNumber("WEBGL_VERSION")===1&&(L=b.getUniformLocation(I,"INFINITY",!1));for(var V={},$=0;$<w.variableNames.length;$++){var U=w.variableNames[$];V[U]=b.getUniformLocation(I,U,!1),V["offset"+U]=b.getUniformLocation(I,"offset"+U,!1)}return{program:w,source:N,webGLProgram:I,uniformLocations:V,inShapeInfos:R,outShapeInfo:_,infLoc:L,nanLoc:O}}(s.gpgpu,n,f,p)}),v=this.activeTimers!=null;if(v&&(h=this.startTimer()),function(b,w,C,S,E){px(w.inShapeInfos,C),px([w.outShapeInfo],[S]);var k=S.texData.texture,R=S.texData.texShape;S.texData.isPacked?b.setOutputPackedMatrixTexture(k,R[0],R[1]):b.setOutputMatrixTexture(k,R[0],R[1]),b.setProgram(w.webGLProgram),H().getNumber("WEBGL_VERSION")===1&&w.infLoc!==null&&b.gl.uniform1f(w.infLoc,1/0),w.nanLoc!==null&&b.gl.uniform1f(w.nanLoc,NaN),C.forEach(function(_,N){var I=w.program.variableNames[N],L=w.uniformLocations[I],O=w.uniformLocations["offset"+I];if(L!=null)if(_.isUniform)if(ne(_.shape)<2)b.gl.uniform1f(L,_.uniformValues[0]);else{var V=_.uniformValues;V instanceof Float32Array||(V=new Float32Array(V)),b.gl.uniform1fv(L,V)}else _.texData.slice!=null&&O!=null&&b.gl.uniform1i(O,_.texData.slice.flatOffset),b.setInputMatrixTexture(_.texData.texture,L,N)}),E!=null&&E(b,w.webGLProgram),b.executeProgram()}(this.gpgpu,g,f,p,i),d.forEach(function(b){return s.disposeData(b.dataId)}),v&&(h=this.endTimer(h),this.activeTimers.push({name:n.constructor.name,query:this.getQueryTime(h)})),!H().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&a===!1){var y=this.unpackTensor(u);return this.disposeData(u.dataId),y}return u},t.prototype.compileAndRun=function(n,r,o,i,a){a===void 0&&(a=!1),o=o||r[0].dtype;var s=this.runWebGLProgram(n,r,o,i,a);return F.makeTensorFromDataId(s.dataId,s.shape,s.dtype)},t.prototype.getAndSaveBinary=function(n,r){return n in this.binaryCache||(this.binaryCache[n]=r()),this.binaryCache[n]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var n=this;this.disposed||(H().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(r){n.gpgpu.deleteProgram(n.binaryCache[r].webGLProgram),delete n.binaryCache[r]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var n=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=Q(function(){if(!H().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=H().getBool("DEBUG");H().set("DEBUG",!1);var o=n.abs(Y(1e-8)).dataSync()[0];if(H().set("DEBUG",r),o>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.uploadToGPU=function(n){var r,o=this.texData.get(n),i=o.shape,a=o.dtype,s=o.values,u=o.texture,l=o.usage,c=o.isPacked;if(u==null){var d,f=this.activeTimers!=null;f&&(d=Cr());var h=o.texShape;if(h==null&&(h=O3(i,c),o.texShape=h),s!=null){var p=Eh(i),m=void 0,g=h[1],v=h[0],y=s instanceof Uint8Array;c?(g=(r=Nu(h[0],h[1]))[0],v=r[1],m=new xM(p,[v,g],y)):m=new yM(p,[v,g],y);var b=this.makeTensorInfo([v,g],a);this.texData.get(b.dataId).usage=y?bn.PIXELS:bn.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),g,v,s);var w=this.runWebGLProgram(m,[b],a,null,!0),C=this.texData.get(w.dataId);o.texture=C.texture,o.texShape=C.texShape,o.isPacked=C.isPacked,o.usage=C.usage,this.disposeData(b.dataId),this.texData.delete(w.dataId),o.values=null,f&&(this.uploadWaitMs+=Cr()-d)}else{var S=this.acquireTexture(h,l,a,c);o.texture=S}}},t.prototype.convertAndCacheOnCPU=function(n,r){var o=this.texData.get(n),i=o.dtype;return this.releaseGPUData(n),r!=null&&(o.values=function(a,s){if(s==="float32"||s==="complex64")return a;if(s==="int32"||s==="bool"){for(var u=s==="int32"?new Int32Array(a.length):new Uint8Array(a.length),l=0;l<u.length;++l)u[l]=Math.round(a[l]);return u}throw new Error("Unknown dtype "+s)}(r,i)),o.values},t.prototype.acquireTexture=function(n,r,o,i){if(this.numBytesInGPU+=this.computeBytes(n,o),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+a+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(n,r,i)},t.prototype.computeBytes=function(n,r){return n[0]*n[1]*RS(r)},t}(YS);MS()&&F.registerBackend("webgl",function(){return new IF},2);var NF=D({square_:function(e){var t=T(e,"x","square"),n=[t];return F.runKernelFunc(function(r,o){return o([t]),r.square(t)},{x:t},null,"Square",{},n,[])}}),fu="SquaredDifference",mE=D({squaredDifference_:function(e,t){var n,r=T(e,"a","squaredDifference"),o=T(t,"b","squaredDifference");n=Ze(r,o),r=n[0],o=n[1],we(r.shape,o.shape);var i={a:r,b:o},a=[r,o];return F.runKernelFunc(function(s,u){var l=s.squaredDifference(r,o);return u([r,o]),l},i,function(s,u){var l=u[0],c=u[1],d=Y(2);return{a:function(){return s.mul(l.sub(c).mul(d))},b:function(){return s.mul(c.sub(l).mul(d))}}},fu,{},a,[])}}),PF=D({abs_:function(e){var t=T(e,"x","abs");return t.dtype==="complex64"?F.runKernelFunc(function(n){return n.complexAbs(t)},{$x:t}):F.runKernelFunc(function(n,r){var o=n.abs(t);return r([t]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return n.mul(o.toFloat().step(-1))}}},"Abs")}}),DF=D({acos_:function(e){var t=T(e,"x","acos");return F.runKernelFunc(function(n,r){var o=n.acos(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(Y(1).sub(o.toFloat().square()).sqrt()).neg()}}})}}),MF=D({acosh_:function(e){var t=T(e,"x","acosh");return F.runKernelFunc(function(n,r){var o=n.acosh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(o.toFloat().square().sub(1).sqrt())}}})}}),FF=D({asin_:function(e){var t=T(e,"x","asin");return F.runKernelFunc(function(n,r){var o=n.asin(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(Y(1).sub(o.toFloat().square()).sqrt())}}})}}),OF=D({asinh_:function(e){var t=T(e,"x","asinh");return F.runKernelFunc(function(n,r){var o=n.asinh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(Y(1).add(o.toFloat().square()).sqrt())}}})}}),BF=D({atan_:function(e){var t=T(e,"x","atan");return F.runKernelFunc(function(n,r){var o=n.atan(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.toFloat().square().add(1))}}})}}),LF=D({atanh_:function(e){var t=T(e,"x","atanh");return F.runKernelFunc(function(n,r){var o=n.atanh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(Y(1).sub(o.toFloat().square()))}}})}}),jF=D({ceil_:function(e){var t=T(e,"x","ceil");return F.runKernelFunc(function(n){return n.ceil(t)},{$x:t},function(n){return{$x:function(){return Se(n)}}})}}),yg=D({clipByValue_:function(e,t,n){var r=T(e,"x","clipByValue");A(t<=n,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."});var o=[r],i={min:t,max:n};return F.runKernelFunc(function(a,s){var u=a.clip(r,t,n);return s([r]),u},{x:r},function(a,s){var u=s[0];return{x:function(){return a.where(u.greaterEqual(t).logicalAnd(u.lessEqual(n)),Se(a))}}},"ClipByValue",i,o)}}),zF=D({cos_:function(e){var t=T(e,"x","cos"),n=[t];return F.runKernelFunc(function(r,o){var i=r.cos(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return i.toFloat().sin().neg().mul(r)}}},"Cos",{},n)}}),VF=D({cosh_:function(e){var t=T(e,"x","cosh");return F.runKernelFunc(function(n,r){var o=n.cosh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return o.toFloat().sinh().mulStrict(n)}}})}}),$F=D({erf_:function(e){var t=T(e,"x","erf");return A(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat()),F.runKernelFunc(function(n,r){var o=n.erf(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),ym=D({exp_:function(e){var t=T(e,"x","exp");return F.runKernelFunc(function(n,r){var o=n.exp(t);return r([o]),o},{x:t},function(n,r){return{x:function(){return n.mulStrict(r[0])}}},"Exp",{},[],[!0])}}),WF=D({expm1_:function(e){var t=T(e,"x","expm1");return F.runKernelFunc(function(n,r){var o=n.expm1(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.exp())}}})}}),UF=D({floor_:function(e){var t=T(e,"x","floor");return F.runKernelFunc(function(n){return n.floor(t)},{$x:t},function(n){return{$x:function(){return Se(n)}}})}}),HF=D({log_:function(e){var t=T(e,"x","log"),n=[t];return F.runKernelFunc(function(r,o){var i=r.log(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return r.div(i.toFloat())}}},"Log",{},n)}}),GF=D({log1p_:function(e){var t=T(e,"x","log1p");return F.runKernelFunc(function(n,r){var o=n.log1p(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.add(1))}}})}}),KF=D({logSigmoid_:function(e){var t=T(e,"x","logSigmoid");return F.runKernelFunc(function(n,r){var o=n.softplus(t.neg()).neg();return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.neg().sigmoid())}}})}}),Kc=D({neg_:function(e){var t=T(e,"x","neg"),n=[t];return F.runKernelFunc(function(r){return r.neg(t)},{x:t},function(r){return{x:function(){return r.neg()}}},"Neg",{},n)}}),qF=D({reciprocal_:function(e){var t=T(e,"x","reciprocal");return F.runKernelFunc(function(n,r){var o=n.reciprocal(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.square().neg())}}})}}),XF=D({round_:function(e){var t=T(e,"x","round");return F.runKernelFunc(function(n){return n.round(t)},{$x:t},function(n){return{$x:function(){return Se(n)}}})}}),vE=D({rsqrt_:function(e){var t=T(e,"x","rsqrt"),n=[t];return F.runKernelFunc(function(r,o){var i=r.rsqrt(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return r.div(i.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},n)}}),gE=D({sigmoid_:function(e){var t=T(e,"x","sigmoid");return F.runKernelFunc(function(n,r){var o=n.sigmoid(t);return r([o]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return n.mul(o.mul(Y(1).sub(o)))}}},"Sigmoid")}}),YF=D({sign_:function(e){var t=T(e,"x","sign");return F.runKernelFunc(function(n){return n.sign(t)},{$x:t},function(n){return{$x:function(){return Se(n)}}})}}),QF=D({isNaN_:function(e){var t=T(e,"x","isNaN");return F.runKernelFunc(function(n){return n.isNaN(t)},{$x:t},function(n){return{$x:function(){return Se(n)}}})}}),JF=D({isInf_:function(e){var t=T(e,"x","isInf");return F.runKernelFunc(function(n){return n.isInf(t)},{$x:t},function(n){return{$x:function(){return Se(n)}}})}}),ZF=D({isFinite_:function(e){var t=T(e,"x","isFinite");return F.runKernelFunc(function(n){return n.isFinite(t)},{$x:t},function(n){return{$x:function(){return Se(n)}}})}}),eO=D({sin_:function(e){var t=T(e,"x","sin"),n=[t];return F.runKernelFunc(function(r,o){var i=r.sin(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return i.toFloat().cos().mul(r)}}},"Sin",{},n)}}),tO=D({sinh_:function(e){var t=T(e,"x","sinh");return F.runKernelFunc(function(n,r){var o=n.sinh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return o.toFloat().cosh().mulStrict(n)}}})}}),nO=D({softplus_:function(e){var t=T(e,"x","softplus");return F.runKernelFunc(function(n,r){var o=n.softplus(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.sigmoid())}}})}}),rO=D({sqrt_:function(e){var t=T(e,"x","sqrt");return F.runKernelFunc(function(n,r){var o=n.sqrt(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.toFloat().sqrt().mul(2))}}})}}),oO=D({step_:function(e,t){t===void 0&&(t=0);var n=T(e,"x","step");return F.runKernelFunc(function(r){return r.step(n,t)},{$x:n},function(r){return{$x:function(){return Se(r)}}})}}),iO=D({tan_:function(e){var t=T(e,"x","tan");return F.runKernelFunc(function(n,r){var o=n.tan(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.cos().square())}}})}}),aO=D({tanh_:function(e){var t=T(e,"x","tanh");return F.runKernelFunc(function(n,r){var o=n.tanh(t);return r([o]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return Y(1).sub(o.square()).mulStrict(n)}}},"Tanh",{},null,[!0])}});function yE(e,t,n,r,o,i){var a,s,u=T(e,"x","batchNorm"),l=T(t,"mean","batchNorm"),c=T(n,"variance","batchNorm");return o!=null&&(a=T(o,"scale","batchNorm")),r!=null&&(s=T(r,"offset","batchNorm")),A(u.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),A(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+l.rank+"."}),A(c.rank===2||c.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+c.rank+"."}),a!=null&&A(a.rank===2||a.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+a.rank+"."}),s!=null&&A(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."}),Du(u,l,c,s,a,i)}function xE(e,t,n,r,o,i){var a,s,u=T(e,"x","batchNorm"),l=T(t,"mean","batchNorm"),c=T(n,"variance","batchNorm");return o!=null&&(a=T(o,"scale","batchNorm")),r!=null&&(s=T(r,"offset","batchNorm")),A(u.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),A(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+l.rank+"."}),A(c.rank===3||c.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+c.rank+"."}),a!=null&&A(a.rank===3||a.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+a.rank+"."}),s!=null&&A(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."}),Du(u,l,c,s,a,i)}function bE(e,t,n,r,o,i){var a,s,u=T(e,"x","batchNorm"),l=T(t,"mean","batchNorm"),c=T(n,"variance","batchNorm");return o!=null&&(a=T(o,"scale","batchNorm")),r!=null&&(s=T(r,"offset","batchNorm")),A(u.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."}),A(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+l.rank+"."}),A(c.rank===4||c.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+c.rank+"."}),a!=null&&A(a.rank===4||a.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+a.rank+"."}),s!=null&&A(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."}),Du(u,l,c,s,a,i)}function Du(e,t,n,r,o,i){i==null&&(i=.001);var a,s,u,l=T(e,"x","batchNorm"),c=T(t,"mean","batchNorm"),d=T(n,"variance","batchNorm");o!=null&&(a=T(o,"scale","batchNorm")),r!=null&&(s=T(r,"offset","batchNorm")),A(c.rank===d.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),A(s==null||c.rank===s.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),A(a==null||c.rank===a.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),u=l.rank===0||l.rank===1?l.as4D(1,1,1,l.size):l.rank===2?l.as4D(1,1,l.shape[0],l.shape[1]):l.rank===3?l.as4D(1,l.shape[0],l.shape[1],l.shape[2]):l;var f=[l,c,d,a];return F.runKernelFunc(function(h,p){var m=h.batchNormalization(u,Cl(c),Cl(d),i,Cl(a),Cl(s));return p([l,c,d,a]),m},{x:l,mean:c,variance:d,scale:a,offset:s},function(h,p){var m=p,g=m[0],v=m[1],y=m[2],b=m[3],w=b??Y(1),C=yt(v.shape,u.shape),S=[];if(v.rank===1){for(var E=0;E<u.shape.length-1;++E)S.push(u.shape[E]);S.push(1)}var k=g.sub(v),R=h.mul(w),_=vE(y.add(Y(i))),N=_.mul(_).mul(_).mul(Y(-.5));return{x:function(){return v.rank===1?h.mul(Ca(_.as4D(1,1,1,v.shape[0]),S)).mul(w).reshape(g.shape):h.mul(_).mul(w).reshape(g.shape)},mean:function(){var I=_.mul(Y(-1)).mul(R);return v.rank===1&&(I=I.sum(C)),I.reshape(v.shape)},variance:function(){var I=N.mul(k).mul(R);return v.rank===1&&(I=I.sum(C)),I.reshape(v.shape)},scale:function(){var I=k.mul(_),L=h.mul(I);return v.rank===1&&(L=L.sum(C)),L.reshape(v.shape)},offset:function(){var I=h;return v.rank===1&&(I=I.sum(C)),I.reshape(v.shape)}}},"BatchNormalization",{varianceEpsilon:i},f).reshape(l.shape)}function Cl(e){return e==null?null:e.rank===0?e.as1D():e.rank===1?e:e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function Md(){FS("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var sO=D({batchNormalization2d_:function(e,t,n,r,o,i){return r===void 0&&(r=.001),Md(),yE(e,t,n,i,o,r)}}),uO=D({batchNormalization3d_:function(e,t,n,r,o,i){return r===void 0&&(r=.001),Md(),xE(e,t,n,i,o,r)}}),lO=D({batchNormalization4d_:function(e,t,n,r,o,i){return r===void 0&&(r=.001),Md(),bE(e,t,n,i,o,r)}}),cO=D({batchNormalization_:function(e,t,n,r,o,i){return r===void 0&&(r=.001),Md(),Du(e,t,n,i,o,r)}}),wE=D({batchNorm_:Du}),dO=D({batchNorm2d_:yE}),fO=D({batchNorm3d_:xE}),hO=D({batchNorm4d_:bE}),Fd=D({logicalAnd_:function(e,t){var n=T(e,"a","logicalAnd","bool"),r=T(t,"b","logicalAnd","bool");return we(n.shape,r.shape),F.runKernelFunc(function(o){return o.logicalAnd(n,r)},{a:n,b:r},null,"LogicalAnd")}}),pO=D({logicalNot_:function(e){var t=T(e,"x","logicalNot","bool");return F.runKernelFunc(function(n){return n.logicalNot(t)},{$x:t})}}),CE=D({logicalOr_:function(e,t){var n=T(e,"a","logicalOr","bool"),r=T(t,"b","logicalOr","bool");return we(n.shape,r.shape),F.runKernelFunc(function(o){return o.logicalOr(n,r)},{$a:n,$b:r})}}),mO=D({logicalXor_:function(e,t){var n=T(e,"a","logicalXor","bool"),r=T(t,"b","logicalXor","bool");return we(n.shape,r.shape),CE(e,t).logicalAnd(Fd(e,t).logicalNot())}}),_i=D({where_:function(e,t,n){var r=T(t,"a","where"),o=T(n,"b","where"),i=T(e,"condition","where","bool");return Ne(r.shape,o.shape,"Error in where: "),i.rank===1?A(i.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):Ne(i.shape,o.shape,"Error in where: "),F.runKernelFunc(function(a,s){var u=a.select(i,r,o);return s([i]),u},{$condition:i,$a:r,$b:o},function(a,s){var u=s[0];return{$condition:function(){return Se(u).toFloat()},$a:function(){return a.mul(u.cast(a.dtype))},$b:function(){return a.mul(u.logicalNot().cast(a.dtype))}}})}}),SE=function(e){return Z(this,void 0,void 0,function(){var t,n,r;return ee(this,function(o){switch(o.label){case 0:return[4,(t=T(e,"condition","whereAsync","bool")).data()];case 1:return n=o.sent(),r=pg(t.shape,n),e!==t&&t.dispose(),[2,r]}})})},be=D({add_:function(e,t){var n,r=T(e,"a","add"),o=T(t,"b","add");n=Ze(r,o),r=n[0],o=n[1];var i=we(r.shape,o.shape);return F.runKernelFunc(function(a){return a.add(r,o)},{a:r,b:o},function(a){return{a:function(){var s=a,u=yt(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=yt(o.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(o.shape)}}},"Add")}}),vO=D({addN_:function(e){A(Array.isArray(e),function(){return"The argument passed to tf.addN() must be a list of tensors"}),A(e.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length});var t=e.map(function(o,i){return T(o,"tensors"+i,"addN")}),n=t[0];t.forEach(function(o){if(o.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(o){if(!Et(o.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=t;return F.runKernelFunc(function(o){return o.addN(t)},r,function(o){var i={};return t.forEach(function(a,s){i[s]=function(){return o.clone()}}),i},"AddN")}}),gO=D({addStrict_:function(e,t){var n=T(e,"a","addStrict"),r=T(t,"b","addStrict");return Ne(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),yO=D({atan2_:function(e,t){var n,r=T(e,"a","atan2"),o=T(t,"b","atan2");n=Ze(r,o),r=n[0],o=n[1];var i=we(r.shape,o.shape);return F.runKernelFunc(function(a,s){var u=a.atan2(r,o);return s([r,o]),u},{$a:r,$b:o},function(a,s){var u=s[0],l=s[1];return{$a:function(){var c=be(u.square(),l.square()),d=a.mul(l.div(c)),f=yt(u.shape,i);return f.length>0&&(d=d.sum(f)),d.reshape(u.shape)},$b:function(){var c=be(u.square(),l.square()),d=Kc(a.mul(u.div(c))),f=yt(l.shape,i);return f.length>0&&(d=d.sum(f)),d.reshape(l.shape)}}})}}),sr=D({div_:function(e,t){var n,r=T(e,"a","div"),o=T(t,"b","div");if(n=Ze(r,o),r=n[0],o=n[1],r.dtype==="int32"&&o.dtype==="int32")return EE(r,o);var i=we(r.shape,o.shape);return F.runKernelFunc(function(a,s){var u=a.realDivide(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],l=s[1];return{a:function(){var c=a.div(l.toFloat()),d=yt(u.shape,i);return d.length>0?c.sum(d).reshape(u.shape):c},b:function(){var c=a.mul(u.toFloat()),d=yt(l.shape,i);d.length>0&&(c=c.sum(d).reshape(l.shape));var f=l.square();return c.div(f.toFloat()).neg()}}},"Div")}}),xO=D({divNoNan_:function(e,t){var n,r=T(e,"a","div"),o=T(t,"b","div");r=(n=Ze(r,o))[0],o=n[1];var i=sr(r,o),a=Se(i),s=o.equal(a);return _i(s,a,i)}}),bO=D({divStrict_:function(e,t){var n=T(e,"a","div"),r=T(t,"b","div");return Ne(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),EE=D({floorDiv_:function(e,t){var n,r=T(e,"a","floorDiv"),o=T(t,"b","floorDiv");n=Ze(r,o),r=n[0],o=n[1];var i=we(r.shape,o.shape);return F.runKernelFunc(function(a,s){var u=a.floorDiv(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],l=s[1];return{a:function(){var c=a.div(l.toFloat()),d=yt(u.shape,i);return d.length>0?c.sum(d).reshape(u.shape):c},b:function(){var c=a.mul(u.toFloat()),d=yt(l.shape,i);d.length>0&&(c=c.sum(d).reshape(l.shape));var f=l.square();return c.div(f.toFloat()).neg()}}},"FloorDiv")}}),xg=D({maximum_:function(e,t){var n,r=T(e,"a","maximum"),o=T(t,"b","maximum");return n=Ze(r,o),r=n[0],o=n[1],r.dtype==="bool"&&(r=r.toInt(),o=o.toInt()),we(r.shape,o.shape),F.runKernelFunc(function(i,a){var s=i.maximum(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return i.mul(s.greaterEqual(u).toFloat())},b:function(){return i.mul(s.less(u).toFloat())}}},"Maximum")}}),wO=D({maximumStrict_:function(e,t){var n=T(e,"a","maximumStrict"),r=T(t,"b","maximumStrict");return Ne(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),kE=D({minimum_:function(e,t){var n,r=T(e,"a","minimum"),o=T(t,"b","minimum");return n=Ze(r,o),r=n[0],o=n[1],r.dtype==="bool"&&(r=r.toInt(),o=o.toInt()),we(r.shape,o.shape),F.runKernelFunc(function(i,a){var s=i.minimum(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return i.mul(s.lessEqual(u).toFloat())},b:function(){return i.mul(s.greater(u).toFloat())}}},"Minimum")}}),CO=D({minimumStrict_:function(e,t){var n=T(e,"a","minimumStrict"),r=T(t,"b","minimumStrict");return Ne(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),SO=D({mod_:function(e,t){var n,r=T(e,"a","mod"),o=T(t,"b","mod");n=Ze(r,o),r=n[0],o=n[1];var i=we(r.shape,o.shape);return F.runKernelFunc(function(a,s){var u=a.mod(r,o);return s([r,o]),u},{$a:r,$b:o},function(a,s){var u=s[0],l=s[1];return{$a:function(){var c=yt(u.shape,i);return c.length>0?a.sum(c).reshape(u.shape):a},$b:function(){var c=a.mul(u.div(l).floor().neg()),d=yt(l.shape,i);return d.length>0?c.sum(d).reshape(l.shape):c}}})}}),EO=D({modStrict_:function(e,t){var n=T(e,"a","modStrict"),r=T(t,"b","modStrict");return Ne(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),Wt=D({mul_:function(e,t){var n,r=T(e,"a","mul"),o=T(t,"b","mul");n=Ze(r,o),r=n[0],o=n[1];var i=we(r.shape,o.shape);return F.runKernelFunc(function(a,s){var u=a.multiply(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],l=s[1];return{a:function(){var c=a.mul(l.toFloat()),d=yt(u.shape,i);return d.length>0?c.sum(d).reshape(u.shape):c},b:function(){var c=a.mul(u.toFloat()),d=yt(l.shape,i);return d.length>0?c.sum(d).reshape(l.shape):c}}},"Mul")}}),kO=D({mulStrict_:function(e,t){var n=T(e,"a","mul"),r=T(t,"b","mul");return Ne(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),qc=D({pow_:function(e,t){var n,r=T(e,"base","pow"),o=T(t,"exp","pow");n=Ze(r,o),r=n[0],o=n[1];var i=we(r.shape,o.shape),a=[r,o];return F.runKernelFunc(function(s,u){var l=s.pow(r,o);return u([r,o,l]),l},{a:r,b:o},function(s,u){var l=u[0],c=u[1],d=u[2];return{a:function(){var f=c.toFloat(),h=s.mul(f.mul(l.pow(f.sub(Y(1))))),p=yt(l.shape,i);return p.length>0&&(h=h.sum(p)),h.reshape(l.shape)},b:function(){var f=l.greater(0),h=l.log().where(f,Se(l)),p=s.mul(d.mul(h)),m=yt(c.shape,i);return m.length>0&&(p=p.sum(m)),p.reshape(c.shape)}}},"Pow",{},a,[!0])}}),_O=D({powStrict_:function(e,t){return Ne(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),RO=D({squaredDifferenceStrict_:function(e,t){var n=T(e,"a","squaredDifferenceStrict"),r=T(t,"b","squaredDifferenceStrict");return Ne(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),xt=D({sub_:function(e,t){var n,r=T(e,"a","sub"),o=T(t,"b","sub");n=Ze(r,o),r=n[0],o=n[1];var i=we(r.shape,o.shape);return F.runKernelFunc(function(a){return a.subtract(r,o)},{a:r,b:o},function(a){return{a:function(){var s=a,u=yt(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=yt(o.shape,i);return u.length>0&&(s=s.sum(u)),s.neg().reshape(o.shape)}}},"Sub")}}),TO=D({subStrict_:function(e,t){var n=T(e,"a","subStrict"),r=T(t,"b","subStrict");return Ne(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),_E=D({equal_:function(e,t){var n,r=T(e,"a","equal"),o=T(t,"b","equal");return n=Ze(r,o),r=n[0],o=n[1],we(r.shape,o.shape),F.runKernelFunc(function(i){return i.equal(r,o)},{$a:r,$b:o})}}),AO=D({equalStrict_:function(e,t){var n=T(e,"a","equalStrict"),r=T(t,"b","equalStrict");return Ne(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),IO=D({greater_:function(e,t){var n,r=T(e,"a","greater"),o=T(t,"b","greater");return n=Ze(r,o),r=n[0],o=n[1],we(r.shape,o.shape),F.runKernelFunc(function(i){return i.greater(r,o)},{a:r,b:o},null,"Greater")}}),RE=D({greaterEqual_:function(e,t){var n,r=T(e,"a","greaterEqual"),o=T(t,"b","greaterEqual");return n=Ze(r,o),r=n[0],o=n[1],we(r.shape,o.shape),F.runKernelFunc(function(i,a){var s=i.greaterEqual(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return Se(s)},b:function(){return Se(u)}}},"GreaterEqual")}}),NO=D({greaterEqualStrict_:function(e,t){var n=T(e,"a","greaterEqualStrict"),r=T(t,"b","greaterEqualStrict");return Ne(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),PO=D({greaterStrict_:function(e,t){var n=T(e,"a","greaterStrict"),r=T(t,"b","greaterStrict");return Ne(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),DO=D({less_:function(e,t){var n,r=T(e,"a","less"),o=T(t,"b","less");return n=Ze(r,o),r=n[0],o=n[1],we(r.shape,o.shape),F.runKernelFunc(function(i){return i.less(r,o)},{a:r,b:o},null,"Less")}}),MO=D({lessEqual_:function(e,t){var n,r=T(e,"a","lessEqual"),o=T(t,"b","lessEqual");return n=Ze(r,o),r=n[0],o=n[1],we(r.shape,o.shape),F.runKernelFunc(function(i,a){var s=i.lessEqual(r,o);return a([r,o]),s},{a:r,b:o},null,"LessEqual")}}),FO=D({lessEqualStrict_:function(e,t){var n=T(e,"a","lessEqualStrict"),r=T(t,"b","lessEqualStrict");return Ne(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),OO=D({lessStrict_:function(e,t){var n=T(e,"a","lessStrict"),r=T(t,"b","lessStrict");return Ne(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),BO=D({notEqual_:function(e,t){var n,r=T(e,"a","notEqual"),o=T(t,"b","notEqual");return n=Ze(r,o),r=n[0],o=n[1],we(r.shape,o.shape),F.runKernelFunc(function(i){return i.notEqual(r,o)},{a:r,b:o},null,"NotEqual")}}),LO=D({notEqualStrict_:function(e,t){var n=T(e,"a","notEqualStrict"),r=T(t,"b","notEqualStrict");return Ne(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function Ex(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function kx(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var bg=D({gather_:function(e,t,n){n===void 0&&(n=0);var r=T(e,"x","gather"),o=T(t,"indices","gather","int32");n=bt(n,r.shape)[0];var i=function(a,s,u){for(var l=a.shape[u],c=[],d=1,f=1,h=0;h<u;h++)c.push(a.shape[h]),d*=a.shape[h];for(h=0;h<s.rank;h++)c.push(s.shape[h]);for(h=u+1;h<a.rank;h++)c.push(a.shape[h]),f*=a.shape[h];return{batchSize:d,sliceSize:f,dimSize:l,outputShape:c}}(r,o,n);return F.runKernelFunc(function(a,s){var u=a.gather(r,o.flatten(),n);return s([o]),u},{x:r,indices:o},function(a,s){var u=s[0];return{x:function(){var l=r.shape,c=u.size,d=l.slice(0,n),f=d.length,h=l.slice(n,l.length).slice(1),p=h.length,m=Ex(0,f),g=Ex(f+1,f+1+p),v=kx([d,[c],h]),y=a.reshape(v),b=u.reshape([c]),w=kx([[f],m,g]),C=y.transpose(w),S=TE(C,b,r.shape[n]),E=ag(w);return S=S.transpose(E)},indices:function(){return u}}},"Gather",{axis:n}).reshape(i.outputShape)}}),TE=D({unsortedSegmentSum_:function(e,t,n){var r=T(e,"x","unsortedSegmentSum"),o=T(t,"segmentIds","unsortedSegmentSum","int32");return A(it(n),function(){return"numSegments must be of dtype int"}),F.runKernelFunc(function(i,a){var s=i.unsortedSegmentSum(r,o,n);return a([o]),s},{$x:r},function(i,a){var s=a[0];return{$x:function(){return function(u,l){for(var c=xg(l,Se(l)),d=bg(u,c),f=RE(l,Y(0,"int32")),h=d.rank-f.rank,p=0;p<h;++p)f=$n(f,p+1);f=Fd(f,Xa(d.shape,"bool"));var m=Se(d);return _i(f,d,m)}(i,s)}}})}}),jO=function(e,t,n){return Z(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,d,f,h,p,m;return ee(this,function(g){switch(g.label){case 0:for(r=T(e,"tensor","boolMask"),o=T(t,"mask","boolMask","bool"),i=n??0,a=o.rank,s=r.shape,A(a>0,function(){return"mask cannot be scalar"}),Ne(s.slice(i,i+a),o.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,l=i;l<i+a;l++)u*=s[l];return c=s.slice(0,i).concat([u],s.slice(i+a)),d=r.reshape(c),f=o.reshape([-1]),[4,SE(f)];case 1:return h=g.sent(),p=h.squeeze([1]),m=bg(d,p,i),e!==r&&r.dispose(),t!==o&&o.dispose(),p.dispose(),d.dispose(),f.dispose(),h.dispose(),[2,m]}})})};function AE(e,t,n,r,o,i,a){i===void 0&&(i="NHWC"),A(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var s=e,u=t,l=!1;t.rank===3&&(l=!0,u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),s=[1,e[0],e[1],e[2]]),A(s.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."}),A(u.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank}),A(n.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank});var c=i==="NHWC"?s[3]:s[1],d=i==="NHWC"?u.shape[3]:u.shape[1];A(c===n.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+c+") must match input depth for filter "+n.shape[2]+"."}),A(d===n.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+d+") must match output depth for filter "+n.shape[3]+"."}),a!=null&&A(it(o),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."});var f=dg(i),h=Mi(s,n.shape,r,1,o,a,!1,f),p=F.runKernelFunc(function(m,g){var v=m.conv2dDerInput(u,n,h);return g([n,u]),v},{dy4D:u,filter:n},function(m,g){var v=g[0],y=g[1];return{dy4D:function(){return Jn(m,v,r,o,i,1,a)},filter:function(){return wg(m,y,v.shape,r,o,i,a)}}});return l?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}function Ph(e){var t=function(i){return typeof i=="number"?[i,i,i]:i.length===2?[i[0],i[1],1]:i}(e),n=t[0],r=t[1],o=t[2];return n===1&&r===1&&o===1}function IE(e,t,n,r,o){A(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var i=e,a=t,s=!1;t.rank===4&&(s=!0,a=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),i=[1,e[0],e[1],e[2],e[3]]);var u=i[4],l=a.shape[4];A(i.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."}),A(a.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+a.rank}),A(n.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank}),A(u===n.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."}),A(l===n.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+l+") must match output depth for filter "+n.shape[4]+"."});var c=Hc(i,n.shape,r,1,o),d=F.runKernelFunc(function(f){return f.conv3dDerInput(a,n,c)},{dy5D:a});return s?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}var zO=D({conv1d_:function(e,t,n,r,o,i,a){o===void 0&&(o="NWC"),i===void 0&&(i=1);var s=T(e,"x","conv1d"),u=T(t,"filter","conv1d"),l=s,c=!1;s.rank===2&&(c=!0,l=s.as3D(1,s.shape[0],s.shape[1])),A(l.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+l.rank+"."}),A(u.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."}),a!=null&&A(it(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}),A(l.shape[2]===u.shape[1],function(){return"Error in conv1d: depth of input ("+l.shape[2]+") must match input depth for filter "+u.shape[1]+"."}),A(fn(n,i),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+i+"'"}),A(o==="NWC",function(){return"Error in conv1d: got dataFormat of "+o+" but only NWC is currently supported."});var d=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),f=l.as4D(l.shape[0],1,l.shape[1],l.shape[2]),h=Jn(f,d,[1,n],r,"NHWC",[1,i],a);return c?h.as2D(h.shape[2],h.shape[3]):h.as3D(h.shape[0],h.shape[2],h.shape[3])}}),Jn=D({conv2d_:function(e,t,n,r,o,i,a){o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]);var s=T(e,"x","conv2d"),u=T(t,"filter","conv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),A(l.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+l.rank+"."}),A(u.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."}),a!=null&&A(it(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d=o==="NHWC"?l.shape[3]:l.shape[1];A(d===u.shape[2],function(){return"Error in conv2d: depth of input ("+d+") must match input depth for filter "+u.shape[2]+"."}),A(fn(n,i),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"});var f=dg(o),h=Mi(l.shape,u.shape,n,i,r,a,!1,f),p=[u,l],m=F.runKernelFunc(function(g,v){var y=g.conv2d(l,u,h);return v([u,l]),y},{x:l,filter:u},function(g,v){var y=v,b=y[0],w=y[1];return A(Wa(i),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}),{x:function(){return NE(w.shape,g,b,n,r,o)},filter:function(){return wg(w,g,b.shape,n,r,o)}}},"Conv2D",h,p);return c?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),VO=D({conv3d_:function(e,t,n,r,o,i){o===void 0&&(o="NDHWC"),i===void 0&&(i=[1,1,1]);var a=T(e,"x","conv3d"),s=T(t,"filter","conv3d"),u=a,l=!1;a.rank===4&&(l=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),A(u.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."}),A(s.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."}),A(u.shape[4]===s.shape[3],function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."}),A(function(f,h){return Ph(f)||Ph(h)}(n,i),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),A(o==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+o+" but only NDHWC is currently supported."});var c=Hc(u.shape,s.shape,n,i,r),d=F.runKernelFunc(function(f,h){var p=f.conv3d(u,s,c);return h([u,s]),p},{x:u,$filter:s},function(f,h){A(Ph(i),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"});var p=h[0],m=h[1];return{x:function(){return IE(p.shape,f,m,n,r)},$filter:function(){return function(g,v,y,b,w){var C=g;g.rank===4&&(C=g.as5D(1,g.shape[0],g.shape[1],g.shape[2],g.shape[3]));var S=v;S.rank===4&&(S=v.as5D(1,v.shape[0],v.shape[1],v.shape[2],v.shape[3])),A(C.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+C.shape+"."}),A(S.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+S.shape+"."}),A(y.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+y+"."}),A(C.shape[4]===y[3],function(){return"Error in conv3dDerFilter: depth of input "+C.shape[4]+") must match input depth in filter ("+y[3]+"."}),A(S.shape[4]===y[4],function(){return"Error in conv3dDerFilter: depth of dy ("+S.shape[4]+") must match output depth for filter ("+y[4]+")."});var E=Hc(C.shape,y,b,1,w);return F.runKernelFunc(function(k){return k.conv3dDerFilter(C,S,E)},{x5D:C,dy5D:S})}(p,f,m.shape,n,r)}}});return l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),wg=D({conv2dDerFilter_:function(e,t,n,r,o,i,a){i===void 0&&(i="NHWC");var s=e;e.rank===3&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var u=t;u.rank===3&&(u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),A(s.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."}),A(u.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."}),A(n.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."});var l=i==="NHWC"?s.shape[3]:s.shape[1],c=i==="NHWC"?u.shape[3]:u.shape[1];A(l===n[2],function(){return"Error in conv2dDerFilter: depth of input "+l+") must match input depth in filter ("+n[2]+"."}),A(c===n[3],function(){return"Error in conv2dDerFilter: depth of dy ("+c+") must match output depth for filter ("+n[3]+")."}),a!=null&&A(it(o),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."});var d=dg(i),f=Mi(s.shape,n,r,1,o,a,!1,d);return F.runKernelFunc(function(h){return h.conv2dDerFilter(s,u,f)},{x4D:s,dy4D:u})}}),NE=D({conv2dDerInput_:AE}),Od=D({depthwiseConv2d_:function(e,t,n,r,o,i,a){i===void 0&&(i=[1,1]);var s=T(e,"x","depthwiseConv2d"),u=T(t,"filter","depthwiseConv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),A(l.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+l.rank+"."}),A(u.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."}),A(l.shape[3]===u.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+l.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."}),i==null&&(i=[1,1]),A(fn(n,i),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),a!=null&&A(it(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d=Mi(l.shape,u.shape,n,i,r,a,!0),f=[l,u],h=F.runKernelFunc(function(p,m){var g=p.depthwiseConv2D(l,u,d);return m([l,u]),g},{x:l,filter:u},function(p,m){A(Wa(i),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"});var g=m[0],v=m[1];return{x:function(){return PE(g.shape,p,v,d)},filter:function(){return DE(g,p,v.shape,d)}}},"DepthwiseConv2dNative",d,f);return c?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}}),PE=D({depthwiseConv2dDerInput_:function(e,t,n,r){var o=t,i=!1;t.rank===3&&(i=!0,o=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var a=F.runKernelFunc(function(s){return s.depthwiseConv2DDerInput(o,n,r)},{dy4D:o});return i?a.as3D(a.shape[1],a.shape[2],a.shape[3]):a}}),DE=D({depthwiseConv2dDerFilter_:function(e,t,n,r){var o=e;e.rank===3&&(o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var i=t;return i.rank===3&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),F.runKernelFunc(function(a){return a.depthwiseConv2DDerFilter(o,i,r)},{x4D:o,dy4D:i})}}),Cg=D({separableConv2d_:function(e,t,n,r,o,i,a){i===void 0&&(i=[1,1]),a===void 0&&(a="NHWC");var s=T(e,"x","separableConv2d"),u=T(t,"depthwiseFilter","separableConv2d"),l=T(n,"pointwiseFilter","separableConv2d"),c=s,d=!1;if(s.rank===3&&(d=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),a==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");A(c.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+c.rank+"."}),A(u.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."}),A(l.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."}),A(l.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+l.shape[0]+"."}),A(l.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+l.shape[1]+"."});var f=u.shape[2],h=u.shape[3];A(l.shape[2]===f*h,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+f*h+", but got "+l.shape[2]+"."});var p=Od(c,u,r,o,a,i),m=Jn(p,l,1,"valid",a);return d?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),$O=D({conv2dTranspose_:function(e,t,n,r,o,i){return AE(n,T(e,"x","conv2dTranspose"),T(t,"filter","conv2dTranspose"),r,o,"NHWC",i)}}),WO=D({conv3dTranspose_:function(e,t,n,r,o){return IE(n,T(e,"x","conv3dTranspose"),T(t,"filter","conv3dTranspose"),r,o)}}),Bd=D({matMul_:function(e,t,n,r){var o;n===void 0&&(n=!1),r===void 0&&(r=!1);var i=T(e,"a","matMul"),a=T(t,"b","matMul");o=Ze(i,a),i=o[0],a=o[1];var s=n?i.shape[i.rank-2]:i.shape[i.rank-1],u=r?a.shape[a.rank-1]:a.shape[a.rank-2],l=n?i.shape[i.rank-1]:i.shape[i.rank-2],c=r?a.shape[a.rank-2]:a.shape[a.rank-1],d=i.shape.slice(0,-2),f=a.shape.slice(0,-2),h=ne(d),p=ne(f);A(i.rank>=2&&a.rank>=2&&i.rank===a.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+a.rank+"."}),A(Et(d,f),function(){return"Error in matMul: outer dimensions ("+d+") and ("+f+") of Tensors with shapes "+i.shape+" and "+a.shape+" must match."}),A(s===u,function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+i.shape+" and "+a.shape+" and transposeA="+n+" and transposeB="+r+" must match."});var m=i.shape.slice(0,-2).concat([l,c]),g=n?i.as3D(h,s,l):i.as3D(h,l,s),v=r?a.as3D(p,c,u):a.as3D(p,u,c),y={transposeA:n,transposeB:r};return F.runKernelFunc(function(b,w){var C=b.batchMatMul(g,v,n,r);return w([g,v]),C},{a:g,b:v},function(b,w){var C=w,S=C[0],E=C[1];return n||r?!n&&r?{a:function(){return b.matMul(E,!1,!1)},b:function(){return b.matMul(S,!0,!1)}}:n&&!r?{a:function(){return E.matMul(b,!1,!0)},b:function(){return S.matMul(b,!1,!1)}}:{a:function(){return E.matMul(b,!0,!0)},b:function(){return b.matMul(S,!0,!0)}}:{a:function(){return b.matMul(E,!1,!0)},b:function(){return S.matMul(b,!0,!1)}}},"BatchMatMul",y).reshape(m)}}),UO=D({dot_:function(e,t){var n=T(e,"t1","dot"),r=T(t,"t2","dot");A(!(n.rank!==1&&n.rank!==2||r.rank!==1&&r.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."});var o=n.rank===1?n.size:n.shape[1],i=r.rank===1?r.size:r.shape[0];return A(o===i,function(){return"Error in dot: inner dimensions of inputs must match, but got "+o+" and "+i+"."}),n.rank===1&&r.rank===1?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():n.rank===1&&r.rank===2?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():n.rank===2&&r.rank===1?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),HO=D({outerProduct_:function(e,t){var n=T(e,"v1","outerProduct"),r=T(t,"v2","outerProduct");return A(n.rank===1&&r.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."}),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),Mu=D({reverse_:function(e,t){var n=T(e,"x","reverse");if(n.rank===0)return n.clone();var r=bt(t,n.shape);return F.runKernelFunc(function(o){return o.reverse(n,r)},{$x:n},function(o){return{$x:function(){return o.reverse(r)}}}).reshapeAs(n)}}),GO=D({reverse1d_:function(e){var t=T(e,"x","reverse");return A(t.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),Mu(t,0)}}),KO=D({reverse2d_:function(e,t){var n=T(e,"x","reverse");return A(n.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."}),Mu(n,t)}}),qO=D({reverse3d_:function(e,t){var n=T(e,"x","reverse");return A(n.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."}),Mu(n,t)}}),XO=D({reverse4d_:function(e,t){var n=T(e,"x","reverse");return A(n.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."}),Mu(n,t)}});function ME(e,t,n,r,o,i){var a=T(e,"x","maxPool"),s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),r==null&&(r=[1,1]),A(s.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."}),A(fn(n,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}),i!=null&&A(it(o),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var l=du(s.shape,t,n,r,o,i);if(l.filterWidth===1&&l.filterHeight===1&&Et(l.inShape,l.outShape))return a.clone();var c=[s],d=F.runKernelFunc(function(f,h){var p=f.maxPool(s,l);return h([s,p]),p},{x:s},function(f,h){var p=h[0],m=h[1];return{x:function(){return function(g,v,y,b,w,C,S,E){var k=T(g,"dy","maxPoolBackprop"),R=T(v,"input","maxPoolBackprop"),_=T(y,"output","maxPoolBackprop");A(R.rank===k.rank,function(){return"Rank of input ("+R.rank+") does not match rank of dy ("+k.rank+")"}),C==null&&(C=[1,1]),A(fn(w,C),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+C+"'"}),A(k.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+k.rank+"."}),A(R.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+R.rank+"."}),E!=null&&A(it(S),function(){return"Error in maxPoolBackprop: pad must be an integer when using, dimRoundingMode "+E+" but got pad "+S+"."});var N=du(R.shape,b,w,C,S,E);return F.runKernelFunc(function(I){return I.maxPoolBackprop(k,R,_,N)},{$dy:k,$input:R})}(f,p,m,t,n,r,o)}}},"MaxPool",l,c);return u?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}function FE(e,t,n,r,o,i){var a=T(e,"x","avgPool","float32");r==null&&(r=[1,1]),A(fn(n,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"});var s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),A(s.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."}),i!=null&&A(it(o),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var l=du(s.shape,t,n,r,o,i);if(l.filterWidth===1&&l.filterHeight===1&&Et(l.inShape,l.outShape))return a.clone();var c=F.runKernelFunc(function(d){return d.avgPool(s,l)},{x:s},function(d){return{x:function(){return function(f,h,p,m,g,v){var y=T(f,"dy","avgPoolBackprop"),b=T(h,"input","avgPoolBackprop");A(b.rank===y.rank,function(){return"Rank of input ("+b.rank+") does not match rank of dy ("+y.rank+")"}),g==null&&(g=[1,1]),A(fn(m,g),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+m+" and dilations '"+g+"'"});var w=b,C=y,S=!1;b.rank===3&&(S=!0,w=b.as4D(1,b.shape[0],b.shape[1],b.shape[2]),C=y.as4D(1,y.shape[0],y.shape[1],y.shape[2])),A(C.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+C.rank+"."}),A(w.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+w.rank+"."});var E=du(w.shape,p,m,g,v),k=F.runKernelFunc(function(R){return R.avgPoolBackprop(C,w,E)},{dy4D:C,input4D:w});return S?k.as3D(k.shape[1],k.shape[2],k.shape[3]):k}(d,s,t,n,r,o)}}},"AvgPool",l);return c=c.cast(a.dtype),u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}var wt=D({maxPool_:function(e,t,n,r,o){return ME(e,t,n,1,r,o)}}),Fu=D({avgPool_:function(e,t,n,r,o){return FE(e,t,n,1,r,o)}}),YO=D({pool_:function(e,t,n,r,o,i){o==null&&(o=[1,1]),i==null&&(i=1),r===0&&(r="valid");var a=T(e,"x","maxPool"),s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),A(fn(i,o),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"});var l,c=du(s.shape,t,i,o,r),d=[c.dilationHeight,c.dilationWidth];l=r==="same"?function(w,C){var S=w.map(function(R,_){return R+(R-1)*(C[_]-1)}).map(function(R){return R-1}),E=S.map(function(R){return Math.floor(R/2)}),k=S.map(function(R,_){return R-E[_]});return S.map(function(R,_){return[E[_],k[_]]})}([c.filterHeight,c.filterWidth],d):[[0,0],[0,0]];var f=d[0]===1&&d[1]===1,h=function(w,C,S){var E=S.map(function(O){return O[0]}),k=S.map(function(O){return O[1]}),R=w.concat(E,k),_=C.map(function(O,V){return(O-R[V]%O)%O}),N=k.map(function(O,V){return O+_[V]}),I=C.map(function(O,V){return[E[V],N[V]]}),L=C.map(function(O,V){return[0,_[V]]});return[I,L]}([c.inHeight,c.inWidth],d,l),p=h[0],m=h[1],g=f?r:"valid",v=f?s:VS(s,d,p),y=(n==="avg"?function(){return FE(v,t,i,1,g)}:function(){return ME(v,t,i,1,g)})(),b=f?y:LS(y,d,m);return u?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),QO=D({maxPool3d_:function(e,t,n,r,o,i,a){i===void 0&&(i="NDHWC");var s=T(e,"x","maxPool3d"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),a==null&&(a=[1,1,1]),A(u.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."}),A(i==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),A(fn(n,a),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),o!=null&&A(it(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var c=Uc(u.shape,t,n,a,r,o,i),d=F.runKernelFunc(function(f,h){var p=f.maxPool3d(u,c);return h([u,p]),p},{x:u},function(f,h){var p=h[0],m=h[1];return{x:function(){return function(g,v,y,b,w,C,S,E){var k=T(g,"dy","maxPool3dBackprop"),R=T(v,"input","maxPool3dBackprop"),_=T(y,"output","maxPool3dBackprop"),N=k,I=R,L=_,O=!1;R.rank===4&&(O=!0,N=k.as5D(1,k.shape[0],k.shape[1],k.shape[2],k.shape[3]),I=R.as5D(1,R.shape[0],R.shape[1],R.shape[2],R.shape[3]),L=_.as5D(1,_.shape[0],_.shape[1],_.shape[2],_.shape[3])),A(N.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+N.rank+"."}),A(I.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+I.rank+"."}),A(L.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+L.rank+"."}),C==null&&(C=[1,1,1]),A(fn(w,C),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+C+"'"}),E!=null&&A(it(S),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+E+" but got pad "+S+"."});var V=Uc(I.shape,b,w,C,S,E),$=F.runKernelFunc(function(U){return U.maxPool3dBackprop(N,I,L,V)},{dy5D:N,input5D:I});return O?$.as4D($.shape[1],$.shape[2],$.shape[3],$.shape[4]):$}(f,p,m,t,n,a,r,o)}}});return l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),JO=D({avgPool3d_:function(e,t,n,r,o,i,a){i===void 0&&(i="NDHWC");var s=T(e,"x","avgPool3d","float32"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),a==null&&(a=[1,1,1]),A(u.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."}),A(i==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),A(fn(n,a),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),o!=null&&A(it(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var c=Uc(u.shape,t,n,a,r,o,i),d=F.runKernelFunc(function(f){return f.avgPool3d(u,c)},{x:u},function(f){return{x:function(){return function(h,p,m,g,v,y,b){var w=T(h,"dy","avgPool3dBackprop"),C=T(p,"input","avgPool3dBackprop"),S=w,E=C,k=!1;C.rank===4&&(k=!0,S=w.as5D(1,w.shape[0],w.shape[1],w.shape[2],w.shape[3]),E=C.as5D(1,C.shape[0],C.shape[1],C.shape[2],C.shape[3])),A(S.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+S.rank+"."}),A(E.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+E.rank+"."}),v==null&&(v=[1,1,1]),A(fn(g,v),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+g+" and dilations '"+v+"'"}),b!=null&&A(it(y),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+b+" but got pad "+y+"."});var R=Uc(E.shape,m,g,v,y,b),_=F.runKernelFunc(function(N){return N.avgPool3dBackprop(S,E,R)},{dy5D:S,input5D:E});return k?_.as4D(_.shape[1],_.shape[2],_.shape[3],_.shape[4]):_}(f,u,t,n,a,r,o)}}});return d=d.cast(u.dtype),l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),Br=D({slice_:function(e,t,n){var r,o,i=T(e,"x","slice");if(i.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof t=="number"?[t].concat(new Array(i.rank-1).fill(0)):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(0)):t.slice()).forEach(function(u){A(u!==-1,function(){return"slice() does not support negative begin indexing."})}),o=(o=n==null?new Array(i.rank).fill(-1):typeof n=="number"?[n].concat(new Array(i.rank-1).fill(-1)):n.length<i.rank?n.concat(new Array(i.rank-n.length).fill(-1)):n).map(function(u,l){return u>=0?u:(A(u===-1,function(){return"Negative size values should be exactly -1 but got "+u+" for the slice() size at index "+l+"."}),i.shape[l]-r[l])}),_D(i,r,o);var a=i.shape,s={begin:r,size:o};return F.runKernelFunc(function(u){return u.slice(i,r,o)},{x:i},function(u){for(var l=[],c=0;c<u.rank;c++)l.push([r[c],a[c]-r[c]-o[c]]);return{x:function(){return u.pad(l)}}},"Slice",s)}}),ZO=D({slice1d_:function(e,t,n){var r=T(e,"x","slice1d");return A(r.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),Br(r,[t],[n])}}),e5=D({slice2d_:function(e,t,n){var r=T(e,"x","slice2d");return A(r.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),Br(r,t,n)}}),OE=D({slice3d_:function(e,t,n){var r=T(e,"x","slice3d");return A(r.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),Br(r,t,n)}}),t5=D({slice4d_:function(e,t,n){var r=T(e,"x","slice4d");return A(r.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),Br(r,t,n)}});function BE(e,t,n,r,o){return t.rank<n.rank&&(t=t.reshape(dn(t.shape,r))),e.rank<n.rank&&(e=e.reshape(dn(e.shape,r))),{x:function(){var i=e.mul(n.equal(t).cast(e.dtype));return o==null?i:i.transpose(o)}}}var n5=D({all_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=T(e,"x","all","bool"),o=bt(t,r.shape),i=o,a=jr(i,r.rank);a!=null&&(r=r.transpose(a),i=zr(i.length,r.rank));var s=F.runKernelFunc(function(l){return l.all(r,i)},{$x:r});if(n){var u=dn(s.shape,o);return s.reshape(u)}return s}}),r5=D({any_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=T(e,"x","any","bool"),o=bt(t,r.shape),i=o,a=jr(i,r.rank);a!=null&&(r=r.transpose(a),i=zr(i.length,r.rank));var s=F.runKernelFunc(function(l){return l.any(r,i)},{$x:r});if(n){var u=dn(s.shape,o);return s.reshape(u)}return s}}),o5=D({argMax_:function(e,t){t===void 0&&(t=0);var n=T(e,"x","argMax");t==null&&(t=0);var r=bt(t,n.shape),o=jr(r,n.rank);o!=null&&(n=n.transpose(o),r=zr(r.length,n.rank));var i={axis:r[0]},a=[n];return F.runKernelFunc(function(s,u){var l=s.argMax(n,r[0]);return u([n]),l},{x:n},function(s,u){var l=u[0];return{x:function(){return Se(l)}}},"ArgMax",i,a)}}),i5=D({argMin_:function(e,t){t===void 0&&(t=0);var n=T(e,"x","argMin");t==null&&(t=0);var r=bt(t,n.shape),o=jr(r,n.rank);return o!=null&&(n=n.transpose(o),r=zr(r.length,n.rank)),F.runKernelFunc(function(i,a){var s=i.argMin(n,r[0]);return a([n]),s},{$x:n},function(i,a){var s=a[0];return{$x:function(){return Se(s)}}})}}),a5=D({logSumExp_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=T(e,"x","logSumExp"),o=bt(t,r.shape),i=r.max(o,!0),a=r.sub(i).exp().sum(o).log(),s=i.reshape(a.shape).add(a);if(n){var u=dn(s.shape,o);return s.reshape(u)}return s}}),Ld=D({max_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=T(e,"x","max"),o=r,i=bt(t,r.shape),a=i,s=jr(a,r.rank);s!=null&&(r=r.transpose(s),a=zr(a.length,r.rank));var u=[r],l=F.runKernelFunc(function(d,f){var h=d.max(r,a);return f([o,h]),h},{x:r},function(d,f){return BE(d,f[1],f[0],i,s)},"Max",{axes:a},u,[!0]);if(n){var c=dn(l.shape,i);l=l.reshape(c)}return l}}),s5=D({mean_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=T(e,"x","mean"),o=bt(t,r.shape),i=ne(Lt(r.shape,o)[1]);return Dd(function(a){var s=Y(i);return{value:(s.dtype===a.dtype?a:a.cast(s.dtype)).div(s).sum(t,n),gradFunc:function(u){var l=a.shape.slice();return o.forEach(function(c){l[c]=1}),u.reshape(l).mul(Xa(a.shape,"float32")).div(i)}}})(r)}}),u5=D({min_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=T(e,"x","min"),o=r,i=bt(t,r.shape),a=i,s=jr(a,r.rank);s!=null&&(r=r.transpose(s),a=zr(a.length,r.rank));var u=[r],l=F.runKernelFunc(function(d,f){var h=d.min(r,a);return f([o,h]),h},{x:r},function(d,f){return BE(d,f[1],f[0],i,s)},"Min",{axes:a},u,[!0]);if(n){var c=dn(l.shape,i);l=l.reshape(c)}return l}}),l5=D({moments_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=bt(t,(e=T(e,"x","moments")).shape),o=e.mean(r,n),i=o.shape;n||(i=dn(o.shape,r));var a=e.toFloat().sub(o.reshape(i)).square();return{mean:o,variance:a.mean(r,n)}}}),LE=D({sum_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=T(e,"x","sum");r.dtype==="bool"&&(r=r.toInt());var o=bt(t,r.shape);return Dd(function(i){var a=jr(o,i.rank),s=o,u=i;a!=null&&(u=i.transpose(a),s=zr(s.length,i.rank));var l=function(h){var p=i.shape.slice();return o.forEach(function(m){p[m]=1}),h.reshape(p).mul(Xa(i.shape,"float32"))},c={axes:s},d=F.runKernelFunc(function(h){return h.sum(u,s)},{x:u},function(h){return{x:function(){return l(h)}}},"Sum",c);if(n){var f=dn(d.shape,o);d=d.reshape(f)}return{value:d,gradFunc:l}})(r)}}),c5=D({prod_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=T(e,"x","prod");r.dtype==="bool"&&(r=r.toInt());var o=bt(t,r.shape),i=jr(o,r.rank),a=o,s=r;i!=null&&(s=r.transpose(i),a=zr(a.length,r.rank));var u=F.runKernelFunc(function(c){return c.prod(s,a)},{permutedX:s});if(n){var l=dn(u.shape,o);u=u.reshape(l)}return u}}),jE=D({elu_:function(e){var t=T(e,"x","elu");return F.runKernelFunc(function(n,r){var o=n.elu(t);return r([o]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return F.runKernelFunc(function(i){return i.eluDer(n,o)},{dy:n,y:o})}}})}}),d5=D({leakyRelu_:function(e,t){t===void 0&&(t=.2);var n=T(e,"x","leakyRelu");return xg(Y(t).mul(n),n)}}),zE=D({prelu_:function(e,t){var n=T(e,"x","prelu"),r=T(t,"alpha","prelu");return F.runKernelFunc(function(o,i){var a=o.prelu(n,r);return i([n,r]),a},{x:n,alpha:r},function(o,i){var a=i[0],s=i[1],u=a.greater(0);return{x:function(){return _i(u,o,o.mul(s))},alpha:function(){var l=_i(u,Se(o),o.mul(a)),c=yt(s.shape,o.shape);return c.length>0&&(l=l.sum(c)),l.reshape(s.shape)}}},"Prelu")}}),Ye=D({relu_:function(e){var t=T(e,"x","relu");return t.dtype==="bool"?t.toInt():F.runKernelFunc(function(n,r){var o=n.relu(t);return r([t]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return n.mulStrict(o.step().toFloat())}}},"Relu")}}),VE=D({relu6_:function(e){var t=T(e,"x","relu6");return t.dtype==="bool"?t.toInt():F.runKernelFunc(function(n,r){var o=n.relu6(t);return r([t]),o},{x:t},function(n,r){var o=r[0],i=o.lessEqual(6).mul(o.step());return{x:function(){return n.mulStrict(i.toFloat())}}},"Relu6")}}),f5=D({selu_:function(e){var t=T(e,"x","selu");return F.runKernelFunc(function(n,r){var o=n.selu(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){var i=o.greater(Y(0)),a=Y(vg),s=Y(gg),u=n.mul(s),l=n.mul(a).mul(o.toFloat().exp());return _i(i,u,l)}}})}}),Ho=D({transpose_:function(e,t){var n=T(e,"x","transpose");if(t==null&&(t=n.shape.map(function(o,i){return i}).reverse()),A(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."}),t.forEach(function(o){A(o>=0&&o<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t})}),n.rank<=1)return n.clone();var r={perm:t};return F.runKernelFunc(function(o){return o.transpose(n,t)},{x:n},function(o){var i=ag(t);return{x:function(){return o.transpose(i)}}},"Transpose",r)}}),h5=D({localResponseNormalization_:function(e,t,n,r,o){t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),o===void 0&&(o=.5);var i=T(e,"x","localResponseNormalization");A(i.rank===4||i.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+i.rank+"."}),A(it(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var a=i,s=!1;i.rank===3&&(s=!0,a=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var u=F.runKernelFunc(function(l,c){var d=l.localResponseNormalization4D(a,t,n,r,o);return c([a,d]),d},{x4D:a},function(l,c){var d=c[0],f=c[1];return{x4D:function(){return F.runKernelFunc(function(h){return h.LRNGrad(l,d,f,t,n,r,o)},{})}}});return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),$E=D({norm_:function(e,t,n,r){t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1);var o=function s(u,l,c){if(c===void 0&&(c=null),u.rank===0)return u.abs();if(u.rank!==1&&c===null)return s(u.reshape([-1]),l,c);if(u.rank===1||typeof c=="number"||Array.isArray(c)&&c.length===1){if(l===1)return u.abs().sum(c);if(l===1/0)return u.abs().max(c);if(l===-1/0)return u.abs().min(c);if(l==="euclidean"||l===2)return u.abs().pow(Y(2,"int32")).sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}if(Array.isArray(c)&&c.length===2){if(l===1)return u.abs().sum(c[0]).max(c[1]-1);if(l===1/0)return u.abs().sum(c[1]).max(c[0]);if(l===-1/0)return u.abs().sum(c[1]).min(c[0]);if(l==="fro"||l==="euclidean")return u.square().sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}throw new Error("Error in norm: invalid axis: "+c)}(e=T(e,"x","norm"),t,n),i=o.shape;if(r){var a=bt(n,e.shape);i=dn(o.shape,a)}return o.reshape(i)}}),p5=D({basicLSTMCell_:function(e,t,n,r,o,i){var a=T(e,"forgetBias","basicLSTMCell"),s=T(t,"lstmKernel","basicLSTMCell"),u=T(n,"lstmBias","basicLSTMCell"),l=T(r,"data","basicLSTMCell"),c=T(o,"c","basicLSTMCell"),d=T(i,"h","basicLSTMCell"),f=l.concat(d,1).matMul(s).add(u),h=f.shape[0],p=f.shape[1]/4,m=[h,p],g=f.slice([0,0],m),v=f.slice([0,p],m),y=f.slice([0,2*p],m),b=f.slice([0,3*p],m),w=g.sigmoid().mulStrict(v.tanh()).addStrict(c.mulStrict(a.add(y).sigmoid())),C=w.tanh().mulStrict(b.sigmoid());return[w,C]}}),m5=D({multiRNNCell_:function(e,t,n,r){for(var o=T(t,"data","multiRNNCell"),i=Lc(n,"c","multiRNNCell"),a=Lc(r,"h","multiRNNCell"),s=o,u=[],l=0;l<e.length;l++){var c=e[l](s,i[l],a[l]);u.push(c[0]),u.push(c[1]),s=c[1]}var d=[],f=[];for(l=0;l<u.length;l+=2)d.push(u[l]),f.push(u[l+1]);return[d,f]}}),v5=D({movingAverage_:function(e,t,n,r,o){o===void 0&&(o=!0);var i=T(e,"v","movingAverage"),a=T(t,"x","movingAverage"),s=T(n,"decay","movingAverage");h3(i,a),A(Et(i.shape,a.shape),function(){return"Shape mismatch in v and x"});var u=Y(1),l=u.sub(s),c=a.sub(i).mul(l);if(o){A(r!=null,function(){return"When using zeroDebias: true, step is required."});var d=T(r,"step","movingAverage");c=c.div(u.sub(qc(s,d)))}return i.add(c)}}),g5=D({stridedSlice_:function(e,t,n,r,o,i,a,s,u){if(o===void 0&&(o=0),i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=0),u===void 0&&(u=0),r==null&&(r=new Array(t.length)),a!==0)throw new Error("ellipsis mask is not yet supported");var l=T(e,"x","stridedSlice"),c=ox(s),d=l.shape.slice();c.forEach(function(g){t[g]=0,n[g]=1,d.splice(g,0,1)}),l=l.reshape(d);for(var f=0;f<l.rank;f++)t[f]=RD(o,t,r,l.shape,f),n[f]=TD(i,n,r,l.shape,f),r[f]=r[f]||1;var h=ox(u);h.forEach(function(g){n[g]=t[g]+1,r[g]=1});var p=cg(t,n,r),m=p.filter(function(g,v){return h.indexOf(v)===-1});return r.every(function(g){return g===1})?Br(l,t,p).reshape(m):F.runKernelFunc(function(g){return g.stridedSlice(l,t,n,r)},{$x:l}).reshape(m)}}),y5=D({topk_:function(e,t,n){t===void 0&&(t=1),n===void 0&&(n=!0);var r=T(e,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var o=r.shape[r.shape.length-1];if(t>o)throw new Error("'k' passed to topk() must be <= the last dimension ("+o+") but got "+t);var i=F.runKernelFunc(function(a){return a.topk(r,t,n)},{$x:r});return{values:i[0],indices:i[1]}}}),x5=D({scatterND_:function(e,t,n){var r=T(e,"indices","scatterND","int32"),o=T(t,"updates","scatterND");return kD(o,r,n),F.runKernelFunc(function(i){return i.scatterND(r,o,n)},{indices:r,updates:o},null,"ScatterNd",{shape:n})}}),Sg=D({fft_:function(e){A(e.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return F.runKernelFunc(function(o){return o.fft(r)},{input:e}).reshape(e.shape)}}),Xc=D({ifft_:function(e){A(e.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return F.runKernelFunc(function(o){return o.ifft(r)},{input:e}).reshape(e.shape)}}),Eg=D({rfft_:function(e,t){A(e.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+e.dtype});var n,r=e.shape[e.shape.length-1],o=e.size/r;if(t!=null&&t<r){var i=e.shape.map(function(v){return 0}),a=e.shape.map(function(v){return v});a[e.shape.length-1]=t,n=e.slice(i,a),r=t}else if(t!=null&&t>r){var s=e.shape.map(function(v){return v});s[e.shape.length-1]=t-r,n=e.concat($e(s),e.shape.length-1),r=t}else n=e;var u=n.zerosLike(),l=Tt(n,u).as2D(o,r),c=Sg(l),d=Math.floor(r/2)+1,f=Un(c),h=Rr(c),p=f.split([d,r-d],f.shape.length-1),m=h.split([d,r-d],h.shape.length-1),g=n.shape.slice();return g[n.shape.length-1]=d,Tt(p[0],m[0]).reshape(g)}}),WE=D({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var r=e.as2D(n,t),o=Xc(r);return Un(o)}var i=[n,2*(t-1)],a=Un(e).as2D(n,t),s=Rr(e).as2D(n,t),u=a.slice([0,1],[n,t-2]).reverse(1),l=s.slice([0,1],[n,t-2]).reverse(1).mul(Y(-1)),c=a.concat(u,1),d=s.concat(l,1);return r=Tt(c,d).as2D(i[0],i[1]),o=Xc(r),Un(o)}}),b5=Object.freeze({fft:Sg,ifft:Xc,rfft:Eg,irfft:WE}),w5=D({sparseToDense_:function(e,t,n,r){r===void 0&&(r=0);var o=T(e,"sparseIndices","sparseToDense","int32"),i=T(t,"sparseValues","sparseToDense"),a=T(r,"defaultValue","sparseToDense",i.dtype);return function(s,u,l,c){if(s.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+s.dtype+".");if(s.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+s.shape+".");var d=s.rank>0?s.shape[0]:1,f=s.rank>1?s.shape[1]:1;if(l.length!==f)throw new Error("outputShape has incorrect number of elements:, "+l.length+", should be: "+f+".");var h=u.size;if(u.rank!==0&&(u.rank!==1||h!==d))throw new Error("sparseValues has incorrect shape "+u.shape+", should be [] or ["+d+"]");if(u.dtype!==c.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(o,i,n,a),F.runKernelFunc(function(s){return s.sparseToDense(o,i,n,a)},{$sparseIndices:o,$sparseValues:i,$defaultValue:a})}}),C5=D({gatherND_:function(e,t){var n=T(t,"indices","gatherND","int32"),r=T(e,"x","gatherND");return F.runKernelFunc(function(o){return o.gatherND(r,n)},{x:r,indices:n},null,"GatherNd")}}),S5=D({diag_:function(e){var t=T(e,"x","diag").flatten(),n=e.shape.concat(e.shape);return F.runKernelFunc(function(r){return r.diag(t)},{$x:t}).reshape(n)}}),E5=D({dropout_:function(e,t,n,r){var o=T(e,"x","dropout");if(A(o.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+o.dtype+" tensor instead."}),A(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),t===0)return e instanceof qe?o.clone():o;var i=function(u,l){if(l==null)return u.shape.slice();if(Et(u.shape,l))return l;if(u.shape.length===l.length){for(var c=[],d=0;d<u.shape.length;d++)l[d]==null&&u.shape[d]!=null?c.push(u.shape[d]):c.push(l[d]);return c}return l}(o,n),a=1-t,s=zS(i,0,1,"float32",r).add(a).floor().div(a);return o.mul(s)}});function UE(e,t,n){for(var r=1-e%2,o=new Float32Array(e),i=0;i<e;++i){var a=2*Math.PI*i/(e+r-1);o[i]=t-n*Math.cos(a)}return ft(o,"float32")}var kg=D({hannWindow_:function(e){return UE(e,.5,.5)}}),HE=D({hammingWindow_:function(e){return UE(e,.54,.46)}}),_g=D({frame_:function(e,t,n,r,o){r===void 0&&(r=!1),o===void 0&&(o=0);for(var i=0,a=[];i+t<=e.size;)a.push(Br(e,i,t)),i+=n;if(r)for(;i<e.size;){var s=i+t-e.size,u=vt([Br(e,i,t-s),Mr([s],o)]);a.push(u),i+=n}return a.length===0?Lo([],[0,t]):vt(a).as2D(a.length,t)}}),GE=D({stft_:function(e,t,n,r,o){var i;o===void 0&&(o=kg),r==null&&(i=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var a=_g(e,t,n),s=Wt(a,o(t)),u=[],l=0;l<a.shape[0];l++)u.push(Eg(s.slice([l,0],[1,t]),r));return vt(u)}}),k5=Object.freeze({hannWindow:kg,hammingWindow:HE,frame:_g,stft:GE}),$t,_5=function(e,t,n){return n===void 0&&(n=1),Z(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,d,f,h,p,m,g;return ee(this,function(v){switch(v.label){case 0:return r=T(e,"predictions","inTopK"),o=T(t,"targets","inTopK"),A(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),A(r.rank-1===o.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+o.rank}),Ne(r.shape.slice(0,r.shape.length-1),o.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=r.shape[r.shape.length-1],A(n>0&&n<=i,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+n}),[4,r.data()];case 1:return a=v.sent(),[4,o.data()];case 2:for(s=v.sent(),u=[a.length/i,i],c=u[1],d=uu("bool",l=u[0]),f=0;f<l;f++){for(h=f*c,p=a.subarray(h,h+c),m=[],g=0;g<p.length;g++)m.push({value:p[g],index:g});for(m.sort(function(y,b){return b.value-y.value}),d[f]=0,g=0;g<n;g++)if(m[g].index===s[f]){d[f]=1;break}}return e!==r&&r.dispose(),t!==o&&o.dispose(),[2,It(d,o.shape,"bool")]}})})};(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})($t||($t={}));var R5=D({absoluteDifference_:function(e,t,n,r){r===void 0&&(r=$t.SUM_BY_NONZERO_WEIGHTS);var o=T(e,"labels","absoluteDifference"),i=T(t,"predictions","absoluteDifference"),a=null;n!=null&&(a=T(n,"weights","absoluteDifference")),Ne(o.shape,i.shape,"Error in absoluteDifference: ");var s=o.sub(i).abs();return lo(s,a,r)}}),lo=D({computeWeightedLoss_:function(e,t,n){n===void 0&&(n=$t.SUM_BY_NONZERO_WEIGHTS);var r=T(e,"losses","computeWeightedLoss"),o=null;t!=null&&(o=T(t,"weights","computeWeightedLoss"));var i=o==null?r:r.mul(o);if(n===$t.NONE)return i;if(n===$t.SUM)return i.sum();if(n===$t.MEAN){if(o==null)return i.mean();var a=r.size/o.size,s=i.sum().div(o.sum());return a>1?s.div(Y(a)):s}if(n===$t.SUM_BY_NONZERO_WEIGHTS){if(o==null)return i.sum().div(Y(r.size));var u=o.mul(Xa(r.shape)).notEqual(Y(0)).sum().toFloat();return i.sum().div(u)}throw Error("Unknown reduction: "+n)}}),T5=D({cosineDistance_:function(e,t,n,r,o){o===void 0&&(o=$t.SUM_BY_NONZERO_WEIGHTS);var i=T(e,"labels","cosineDistance"),a=T(t,"predictions","cosineDistance"),s=null;r!=null&&(s=T(r,"weights","cosineDistance")),Ne(i.shape,a.shape,"Error in cosineDistance: ");var u=Y(1).sub(i.mul(a).sum(n,!0));return lo(u,s,o)}}),A5=D({hingeLoss_:function(e,t,n,r){r===void 0&&(r=$t.SUM_BY_NONZERO_WEIGHTS);var o=T(e,"labels","hingeLoss"),i=T(t,"predictions","hingeLoss"),a=null;n!=null&&(a=T(n,"weights","hingeLoss")),Ne(o.shape,i.shape,"Error in hingeLoss: ");var s=Y(1);o=Y(2).mul(o).sub(s);var u=s.sub(o.mul(i)).relu();return lo(u,a,r)}}),I5=D({huberLoss_:function(e,t,n,r,o){r===void 0&&(r=1),o===void 0&&(o=$t.SUM_BY_NONZERO_WEIGHTS);var i=T(e,"labels","huberLoss"),a=T(t,"predictions","huberLoss"),s=null;n!=null&&(s=T(n,"weights","huberLoss")),Ne(i.shape,a.shape,"Error in huberLoss: ");var u=Y(r),l=a.sub(i).abs(),c=kE(l,u),d=l.sub(c),f=Y(.5).mul(c.square()).add(u.mul(d));return lo(f,s,o)}}),N5=D({logLoss_:function(e,t,n,r,o){r===void 0&&(r=1e-7),o===void 0&&(o=$t.SUM_BY_NONZERO_WEIGHTS);var i=T(e,"labels","logLoss"),a=T(t,"predictions","logLoss"),s=null;n!=null&&(s=T(n,"weights","logLoss")),Ne(i.shape,a.shape,"Error in logLoss: ");var u=Y(1),l=Y(r),c=i.mul(a.add(l).log()).neg().sub(u.sub(i).mul(u.sub(a).add(l).log()));return lo(c,s,o)}}),P5=D({meanSquaredError_:function(e,t,n,r){r===void 0&&(r=$t.SUM_BY_NONZERO_WEIGHTS);var o=T(e,"labels","meanSquaredError"),i=T(t,"predictions","meanSquaredError"),a=null;n!=null&&(a=T(n,"weights","meanSquaredError")),Ne(o.shape,i.shape,"Error in meanSquaredError: ");var s=o.squaredDifference(i);return lo(s,a,r)}}),D5=D({sigmoidCrossEntropy_:function(e,t,n,r,o){r===void 0&&(r=0),o===void 0&&(o=$t.SUM_BY_NONZERO_WEIGHTS);var i=T(e,"multiClassLabels","sigmoidCrossEntropy"),a=T(t,"logits","sigmoidCrossEntropy"),s=null;if(n!=null&&(s=T(n,"weights","sigmoidCrossEntropy")),Ne(i.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=Y(r),l=Y(1),c=Y(.5);i=i.mul(l.sub(u)).add(c.mul(u))}var d=function(f,h){var p=T(f,"labels","sigmoidCrossEntropyWithLogits"),m=T(h,"logits","sigmoidCrossEntropyWithLogits");Ne(p.shape,m.shape,"Error in sigmoidCrossEntropyWithLogits: ");var g=m.relu(),v=m.mul(p),y=m.abs().neg().exp().log1p();return g.sub(v).add(y)}(i,a);return lo(d,s,o)}}),M5=D({softmaxCrossEntropy_:function(e,t,n,r,o){r===void 0&&(r=0),o===void 0&&(o=$t.SUM_BY_NONZERO_WEIGHTS);var i=T(e,"onehotLabels","softmaxCrossEntropy"),a=T(t,"logits","softmaxCrossEntropy"),s=null;if(n!=null&&(s=T(n,"weights","softmaxCrossEntropy")),Ne(i.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){var u=Y(r),l=Y(1),c=Y(i.shape[1]);i=i.mul(l.sub(u)).add(u.div(c))}var d=function(f,h,p){if(p===void 0&&(p=-1),p===-1&&(p=h.rank-1),p!==h.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+h.rank+" and dim was "+p);return Dd(function(m,g,v){var y=g.logSumExp([p],!0),b=g.toFloat().sub(y);return v([m,b]),{value:b.mul(m).neg().sum([p]),gradFunc:function(w,C){var S=C[0],E=C[1],k=dn(w.shape,[p]);return[w.reshape(k).mul(S.toFloat().sub(E.exp())),w.reshape(k).mul(E.exp().sub(S.toFloat()))]}}})(f,h)}(i,a);return lo(d,s,o)}}),F5=Object.freeze({get Reduction(){return $t},absoluteDifference:R5,computeWeightedLoss:lo,cosineDistance:T5,hingeLoss:A5,huberLoss:I5,logLoss:N5,meanSquaredError:P5,sigmoidCrossEntropy:D5,softmaxCrossEntropy:M5});function _x(e,t){return t===void 0&&(t=!1),F.tidy(function(){if(e.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],r=e.shape[1],o=jS(n),i=e.clone(),a=Lo([[1]],[1,1]),s=a.clone(),u=n>=r?r:n,l=function(d){var f,h=i,p=s,m=o;f=F.tidy(function(){var g=i.slice([d,d],[n-d,1]),v=g.norm(),y=i.slice([d,d],[1,1]),b=Lo([[-1]]).where(y.greater(0),Lo([[1]])),w=y.sub(b.mul(v)),C=g.div(w);s=C.shape[0]===1?a.clone():a.concat(C.slice([1,0],[C.shape[0]-1,C.shape[1]]),0);var S=b.matMul(w).div(v).neg(),E=i.slice([d,0],[n-d,r]),k=S.mul(s);if(d===0)i=E.sub(k.matMul(s.transpose().matMul(E)));else{var R=E.sub(k.matMul(s.transpose().matMul(E)));i=i.slice([0,0],[d,r]).concat(R,0)}var _=o.slice([0,d],[n,o.shape[1]-d]);if(d===0)o=_.sub(_.matMul(s).matMul(k.transpose()));else{var N=_.sub(_.matMul(s).matMul(k.transpose()));o=o.slice([0,0],[n,d]).concat(N,1)}return[s,i,o]}),s=f[0],i=f[1],o=f[2],ln([h,p,m])},c=0;c<u;++c)l(c);return!t&&n>r&&(o=o.slice([0,0],[n,r]),i=i.slice([0,0],[r,r])),[o,i]})}var O5=D({bandPart_:function(e,t,n){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=T(e,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var o=r.shape,i=r.shape.slice(-2),a=i[0],s=i[1];if(!(t<=a))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+a+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");t<0&&(t=a),n<0&&(n=s);var u=jc(0,a,1,"int32").reshape([-1,1]),l=jc(0,s,1,"int32"),c=xt(u,l),d=Fd(c.lessEqual(Y(+t,"int32")),c.greaterEqual(Y(-n,"int32"))),f=$e([a,s],r.dtype);return En(gt(r.reshape([-1,a,s])).map(function(h){return _i(d,h,f)})).reshape(o)}}),B5=D({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,A(e!=null&&e.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var n=e[0].shape[0],r=function(u){A(e[u].shape[0]===n,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[u].shape[0]+" vs. "+n+")"})},o=1;o<e.length;++o)r(o)}else t=!0,e=ug(e,e.shape[0],0).map(function(u){return $S(u,[0])});A(e.length<=e[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."});var i=[],a=e,s=function(u){i.push(F.tidy(function(){var l=a[u];if(u>0)for(var c=0;c<u;++c){var d=LE(i[c].mulStrict(l)).mul(i[c]);l=l.sub(d)}return l.div($E(l,"euclidean"))}))};for(o=0;o<e.length;++o)s(o);return t?En(i,0):i}}),L5=D({qr_:function(e,t){if(t===void 0&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(e.rank===2)return _x(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce(function(a,s){return a*s}),r=gt(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),o=[],i=[];return r.forEach(function(a){var s=_x(a,t),u=s[0],l=s[1];o.push(u),i.push(l)}),[En(o,0).reshape(e.shape),En(i,0).reshape(e.shape)]}}),j5=Object.freeze({bandPart:O5,gramSchmidt:B5,qr:L5});function jd(e,t,n,r,o,i){r==null&&(r=.5),o==null&&(o=Number.NEGATIVE_INFINITY),i==null&&(i=0);var a=e.shape[0];return n=Math.min(n,a),A(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),A(e.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"}),A(e.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]}),A(t.rank===1,function(){return"scores must be a 1D tensor"}),A(t.shape[0]===a,function(){return"scores has incompatible shape with boxes. Expected "+a+", but was "+t.shape[0]}),A(0<=i&&i<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"}),{maxOutputSize:n,iouThreshold:r,scoreThreshold:o,softNmsSigma:i}}var z5=D({resizeBilinear_:function(e,t,n){n===void 0&&(n=!1);var r=T(e,"images","resizeBilinear");A(r.rank===3||r.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),A(t.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var o=r,i=!1;r.rank===3&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=t[0],s=t[1],u=F.runKernelFunc(function(l,c){return c([o]),l.resizeBilinear(o,a,s,n)},{x:o},function(l,c){return{x:function(){return F.runKernelFunc(function(d){return d.resizeBilinearBackprop(l,c[0],n)},{})}}},"ResizeBilinear",{alignCorners:n,newHeight:a,newWidth:s});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),V5=D({resizeNearestNeighbor_:function(e,t,n){n===void 0&&(n=!1);var r=T(e,"images","resizeNearestNeighbor");A(r.rank===3||r.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),A(t.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),A(r.dtype==="float32"||r.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var o=r,i=!1;r.rank===3&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=t[0],s=t[1],u=F.runKernelFunc(function(l,c){return c([o]),l.resizeNearestNeighbor(o,a,s,n)},{batchImages:o},function(l,c){return{batchImages:function(){return F.runKernelFunc(function(d){return d.resizeNearestNeighborBackprop(l,c[0],n)},{})}}});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),$5=D({nonMaxSuppression_:function(e,t,n,r,o){r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY);var i=T(e,"boxes","nonMaxSuppression"),a=T(t,"scores","nonMaxSuppression"),s=jd(i,a,n,r,o);n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold;var u={maxOutputSize:n,iouThreshold:r,scoreThreshold:o};return F.runKernelFunc(function(l){return l.nonMaxSuppression(i,a,n,r,o)},{boxes:i,scores:a},null,"NonMaxSuppressionV3",u)}}),W5=function(e,t,n,r,o){return r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),Z(this,void 0,void 0,function(){var i,a,s,u,l,c,d;return ee(this,function(f){switch(f.label){case 0:return i=T(e,"boxes","nonMaxSuppressionAsync"),a=T(t,"scores","nonMaxSuppressionAsync"),s=jd(i,a,n,r,o),n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold,[4,Promise.all([i.data(),a.data()])];case 1:return u=f.sent(),l=u[0],c=u[1],d=fg(l,c,n,r,o),i!==e&&i.dispose(),a!==t&&a.dispose(),[2,d]}})})},U5=D({nonMaxSuppressionWithScore_:function(e,t,n,r,o,i){r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),i===void 0&&(i=0);var a=T(e,"boxes","nonMaxSuppression"),s=T(t,"scores","nonMaxSuppression"),u=jd(a,s,n,r,o,i),l={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:o=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},c=F.runKernel("NonMaxSuppressionV5",{boxes:a,scores:s},l);return{selectedIndices:c[0],selectedScores:c[1]}}}),H5=function(e,t,n,r,o,i){return r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),i===void 0&&(i=0),Z(this,void 0,void 0,function(){var a,s,u,l,c,d,f;return ee(this,function(h){switch(h.label){case 0:return a=T(e,"boxes","nonMaxSuppressionAsync"),s=T(t,"scores","nonMaxSuppressionAsync"),u=jd(a,s,n,r,o,i),n=u.maxOutputSize,r=u.iouThreshold,o=u.scoreThreshold,i=u.softNmsSigma,[4,Promise.all([a.data(),s.data()])];case 1:return l=h.sent(),c=l[0],d=l[1],f=hg(c,d,n,r,o,i),a!==e&&a.dispose(),s!==t&&s.dispose(),[2,f]}})})},G5=D({cropAndResize_:function(e,t,n,r,o,i){var a=T(e,"image","cropAndResize"),s=T(t,"boxes","cropAndResize","float32"),u=T(n,"boxInd","cropAndResize","int32");o=o||"bilinear",i=i||0;var l=s.shape[0];return A(a.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+a.rank+"."}),A(s.rank===2&&s.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+l+",4] but had shape "+s.shape+"."}),A(u.rank===1&&u.shape[0]===l,function(){return"Error in cropAndResize: boxInd must be have size ["+l+"] but had shape "+s.shape+"."}),A(r.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),A(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),A(o==="bilinear"||o==="nearest",function(){return"method must be bilinear or nearest, but was "+o}),F.runKernelFunc(function(c,d){return c.cropAndResize(a,s,u,r,o,i)},{images:a,boxes:s,boxInd:u},null,"CropAndResize",{method:o,extrapolationValue:i,cropSize:r})}}),Rg=Object.freeze({resizeBilinear:z5,resizeNearestNeighbor:V5,nonMaxSuppression:$5,nonMaxSuppressionAsync:W5,nonMaxSuppressionWithScore:U5,nonMaxSuppressionWithScoreAsync:H5,cropAndResize:G5}),Tg=function(e,t){return!(e>0)||t==="linear"},Ag=function(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return e.mul(t.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},Ig=function(e,t){var n=t,r=yt(e.shape,t.shape);return r.length>0&&(n=n.sum(r)),n.reshape(e.shape)},Ng=function(e,t,n){if(t==="linear")return e;if(t==="relu")return Ye(e);if(t==="elu")return jE(e);if(t==="relu6")return VE(e);if(t==="prelu")return zE(e,n);throw new Error("Unknown fused activation "+t+".")},K5=D({fusedMatMul_:function(e){var t,n=e.a,r=e.b,o=e.transposeA,i=o!==void 0&&o,a=e.transposeB,s=a!==void 0&&a,u=e.bias,l=e.activation,c=l===void 0?"linear":l,d=e.preluActivationWeights;if(Tg(F.state.gradientDepth,c)===!1){var f=Bd(n,r,i,s);return u!=null&&(f=be(f,u)),Ng(f,c,d)}var h=T(n,"a","fused matMul"),p=T(r,"b","fused matMul");t=Ze(h,p),h=t[0],p=t[1];var m=i?h.shape[h.rank-2]:h.shape[h.rank-1],g=s?p.shape[p.rank-1]:p.shape[p.rank-2],v=i?h.shape[h.rank-1]:h.shape[h.rank-2],y=s?p.shape[p.rank-2]:p.shape[p.rank-1],b=h.shape.slice(0,-2),w=p.shape.slice(0,-2),C=ne(b),S=ne(w);A(h.rank>=2&&p.rank>=2&&h.rank===p.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+h.rank+" and "+p.rank+"."}),A(Et(b,w),function(){return"Error in fused matMul: outer dimensions ("+b+") and ("+w+") of Tensors with shapes "+h.shape+" and "+p.shape+" must match."}),A(m===g,function(){return"Error in fused matMul: inner shapes ("+m+") and ("+g+") of Tensors with shapes "+h.shape+" and "+p.shape+" and transposeA="+i+" and transposeB="+s+" must match."});var E,k,R=h.shape.slice(0,-2).concat([v,y]),_=i?h.as3D(C,m,v):h.as3D(C,v,m),N=s?p.as3D(S,y,g):p.as3D(S,g,y);u!=null&&we(R,(E=Ze(E=T(u,"bias","fused matMul"),h)[0]).shape),d!=null&&(k=T(d,"prelu weights","fused matMul"));var I={a:_,b:N};u!=null&&(I.bias=E),d!=null&&(I.preluActivationWeights=k);var L=[_,N];return F.runKernelFunc(function(O,V){var $=O.fusedBatchMatMul({a:_,b:N,transposeA:i,transposeB:s,bias:E,activation:c,preluActivationWeights:k});return V([_,N,$]),$},I,function(O,V){var $=V[0],U=V[1],M=V[2],B=Ag(O,M,c),z={};return u!=null&&(z={bias:function(){return Ig(E,B)}}),Object.assign(i||s?!i&&s?{a:function(){return B.matMul(U,!1,!1)},b:function(){return B.matMul($,!0,!1)}}:i&&!s?{a:function(){return U.matMul(B,!1,!0)},b:function(){return $.matMul(B,!1,!1)}}:{a:function(){return U.matMul(B,!0,!0)},b:function(){return B.matMul($,!0,!0)}}:{a:function(){return B.matMul(U,!1,!0)},b:function(){return $.matMul(B,!0,!1)}},z)},"_FusedMatMul",{transposeA:i,transposeB:s,activation:c},L,[!0]).reshape(R)}}),q5=D({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,o=e.pad,i=e.dataFormat,a=i===void 0?"NHWC":i,s=e.dilations,u=s===void 0?[1,1]:s,l=e.dimRoundingMode,c=e.bias,d=e.activation,f=d===void 0?"linear":d,h=e.preluActivationWeights;if(f=f||"linear",Tg(F.state.gradientDepth,f)===!1){var p=Jn(t,n,r,o,a,u,l);return c!=null&&(p=be(p,c)),Ng(p,f,h)}var m=T(t,"x","conv2d"),g=T(n,"filter","conv2d"),v=m,y=!1;m.rank===3&&(y=!0,v=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),A(v.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+v.rank+"."}),A(g.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+g.rank+"."}),l!=null&&A(it(o),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+l+" but got pad "+o+"."}),A(v.shape[3]===g.shape[2],function(){return"Error in conv2d: depth of input ("+v.shape[3]+") must match input depth for filter "+g.shape[2]+"."}),A(fn(r,u),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),A(a==="NHWC",function(){return"Error in conv2d: got dataFormat of "+a+" but only NHWC is currently supported."});var b,w,C=Mi(v.shape,g.shape,r,u,o,l);c!=null&&(b=Ze(b=T(c,"bias","fused conv2d"),m)[0],we(C.outShape,b.shape)),h!=null&&(w=T(h,"prelu weights","fused conv2d"));var S={x:v,filter:g};c!=null&&(S.bias=b),h!=null&&(S.preluActivationWeights=w);var E=[g,v],k=F.runKernelFunc(function(R,_){var N=R.fusedConv2d({input:v,filter:g,convInfo:C,bias:b,activation:f,preluActivationWeights:w});return _([g,v,N]),N},S,function(R,_){var N=_,I=N[0],L=N[1],O=N[2],V=Ag(R,O,f);A(Wa(u),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"});var $={};return c!=null&&($={bias:function(){return Ig(b,V)}}),Object.assign({x:function(){return NE(L.shape,V,I,r,o)},filter:function(){return wg(L,V,I.shape,r,o)}},$)},"FusedConv2D",{convInfo:C,activation:f},E,[!0]);return y?k.as3D(k.shape[1],k.shape[2],k.shape[3]):k}}),X5=D({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,o=e.pad,i=e.dataFormat,a=i===void 0?"NHWC":i,s=e.dilations,u=s===void 0?[1,1]:s,l=e.dimRoundingMode,c=e.bias,d=e.activation,f=d===void 0?"linear":d,h=e.preluActivationWeights;if(Tg(F.state.gradientDepth,f)===!1){var p=Od(t,n,r,o,a,u,l);return c!=null&&(p=be(p,c)),Ng(p,f,h)}var m=T(t,"x","depthwiseConv2d"),g=T(n,"filter","depthwiseConv2d"),v=m,y=!1;m.rank===3&&(y=!0,v=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),A(v.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+v.rank+"."}),A(g.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+g.rank+"."}),A(v.shape[3]===g.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+v.shape[3]+") must match the inChannels dimension in filter "+g.shape[2]+"."}),u==null&&(u=[1,1]),A(fn(r,u),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),l!=null&&A(it(o),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+l+" but got pad "+o+"."});var b,w,C=Mi(v.shape,g.shape,r,u,o,l,!0);c!=null&&(b=Ze(b=T(c,"bias","fused conv2d"),m)[0],we(C.outShape,b.shape)),h!=null&&(w=T(h,"prelu weights","fused depthwiseConv2d"));var S={x:v,filter:g};c!=null&&(S.bias=b),h!=null&&(S.preluActivationWeights=w);var E=[g,v],k=F.runKernelFunc(function(R,_){var N=R.fusedDepthwiseConv2D({input:v,filter:g,convInfo:C,bias:b,activation:f,preluActivationWeights:w});return _([g,v,N]),N},S,function(R,_){A(Wa(u),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"});var N=_[0],I=_[1],L=_[2],O=Ag(R,L,f),V={};return c!=null&&(V={bias:function(){return Ig(b,O)}}),Object.assign({x:function(){return PE(I.shape,O,N,C)},filter:function(){return DE(I,O,N.shape,C)}},V)},"FusedDepthwiseConv2D",{convInfo:C,activation:f},E,[!0]);return y?k.as3D(k.shape[1],k.shape[2],k.shape[3]):k}}),Y5=Object.freeze({matMul:K5,conv2d:q5,depthwiseConv2d:X5}),Q5=Object.freeze({image:Rg,linalg:j5,losses:F5,spectral:b5,fused:Y5,signal:k5,square:NF,squaredDifference:mE,conv1d:zO,conv2d:Jn,conv3d:VO,depthwiseConv2d:Od,separableConv2d:Cg,conv2dTranspose:$O,conv3dTranspose:WO,op:D,batchNormalization2d:sO,batchNormalization3d:uO,batchNormalization4d:lO,batchNormalization:cO,batchNorm:wE,batchNorm2d:dO,batchNorm3d:fO,batchNorm4d:hO,booleanMaskAsync:jO,complex:Tt,real:Un,imag:Rr,concat:vt,concat1d:Y3,concat2d:Q3,concat3d:J3,concat4d:Z3,split:ug,matMul:Bd,dot:UO,outerProduct:HO,reverse:Mu,reverse1d:GO,reverse2d:KO,reverse3d:qO,reverse4d:XO,maxPool:wt,avgPool:Fu,pool:YO,maxPool3d:QO,avgPool3d:JO,slice:Br,slice1d:ZO,slice2d:e5,slice3d:OE,slice4d:t5,abs:PF,acos:DF,acosh:MF,asin:FF,asinh:OF,atan:BF,atanh:LF,ceil:jF,clipByValue:yg,cos:zF,cosh:VF,erf:$F,exp:ym,expm1:WF,floor:UF,log:HF,log1p:GF,logSigmoid:KF,neg:Kc,reciprocal:qF,round:XF,rsqrt:vE,sigmoid:gE,sign:YF,isNaN:QF,isInf:JF,isFinite:ZF,sin:eO,sinh:tO,softplus:nO,sqrt:rO,step:oO,tan:iO,tanh:aO,all:n5,any:r5,argMax:o5,argMin:i5,logSumExp:a5,max:Ld,mean:s5,min:u5,moments:l5,sum:LE,prod:c5,equal:_E,equalStrict:AO,greater:IO,greaterEqual:RE,greaterEqualStrict:NO,greaterStrict:PO,less:DO,lessEqual:MO,lessEqualStrict:FO,lessStrict:OO,notEqual:BO,notEqualStrict:LO,add:be,addN:vO,addStrict:gO,atan2:yO,div:sr,divNoNan:xO,divStrict:bO,floorDiv:EE,maximum:xg,maximumStrict:wO,minimum:kE,minimumStrict:CO,mod:SO,modStrict:EO,mul:Wt,mulStrict:kO,pow:qc,powStrict:_O,squaredDifferenceStrict:RO,sub:xt,subStrict:TO,elu:jE,leakyRelu:d5,prelu:zE,relu:Ye,relu6:VE,selu:f5,logicalAnd:Fd,logicalNot:pO,logicalOr:CE,logicalXor:mO,where:_i,whereAsync:SE,buffer:ge,print:uD,batchToSpaceND:LS,broadcastTo:lD,cast:cD,clone:dD,cumsum:fD,depthToSpace:hD,expandDims:$n,eye:jS,multinomial:pD,oneHot:pm,pad:Di,pad1d:mD,pad2d:vD,pad3d:gD,pad4d:yD,rand:xD,randomNormal:bD,randomGamma:wD,randomUniform:zS,reshape:ur,spaceToBatchND:VS,squeeze:$S,stack:En,tile:Ca,truncatedNormal:CD,unstack:gt,setdiff1dAsync:SD,fill:Mr,linspace:X3,ones:Xa,range:jc,scalar:Y,tensor:It,tensor1d:ft,tensor2d:Lo,tensor3d:sg,tensor4d:en,tensor5d:G3,tensor6d:K3,variable:q3,zeros:$e,onesLike:BS,zerosLike:Se,transpose:Ho,softmax:uo,logSoftmax:ID,localResponseNormalization:h5,norm:$E,gather:bg,unsortedSegmentSum:TE,basicLSTMCell:p5,multiRNNCell:m5,movingAverage:v5,stridedSlice:g5,topk:y5,scatterND:x5,fft:Sg,ifft:Xc,rfft:Eg,irfft:WE,sparseToDense:w5,gatherND:C5,diag:S5,dropout:E5,hannWindow:kg,hammingWindow:HE,frame:_g,stft:GE,inTopKAsync:_5});function K(e,t){Array.isArray(e)||(e=[e]),e.forEach(function(n){n!=null&&A(n.dtype!=="complex64",function(){return t+" does not support complex64 tensors."})})}function Dh(e,t,n,r){if(n==="linear")return e.linear(t);if(n==="relu")return e.relu(t);if(n==="elu")return e.elu(t);if(n==="relu6")return e.relu6(t);if(n==="prelu")return e.prelu(t,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var J5=function(e){function t(){var n=e.call(this)||this;return n.blockSize=48,n.firstUse=!0,n.data=new XS(n,F),n}return pr(t,e),t.prototype.write=function(n,r,o){this.firstUse&&(this.firstUse=!1,H().get("IS_NODE")&&Bc(`
============================
Hi there . Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var i={};return this.data.set(i,{values:n,dtype:o}),i},t.prototype.move=function(n,r,o,i){this.data.set(n,{values:r,dtype:i})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(n){return Z(this,void 0,void 0,function(){return ee(this,function(r){return[2,this.readSync(n)]})})},t.prototype.readSync=function(n){var r=this.data.get(n),o=r.dtype,i=r.complexTensors;return o==="complex64"?gm(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):this.data.get(n).values},t.prototype.bufferSync=function(n){var r=this.readSync(n.dataId),o=r;if(n.dtype==="string")try{o=r.map(function(i){return Mc(i)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return ge(n.shape,n.dtype,o)},t.prototype.makeOutput=function(n,r,o){var i=this.write(n,r,o);return F.makeTensorFromDataId(i,r,o,this)},t.prototype.disposeData=function(n){if(this.data.has(n)){var r=this.data.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(n)}},t.prototype.time=function(n){return Z(this,void 0,void 0,function(){var r;return ee(this,function(o){return r=Cr(),n(),[2,{kernelMs:Cr()-r}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(n,r){var o=this.makeOutput(null,n.shape,"complex64");return this.data.get(o.dataId).complexTensors={real:F.keep(n.clone()),imag:F.keep(r.clone())},o},t.prototype.real=function(n){return this.data.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.data.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,o){if(K(n,"slice"),KS(n.shape,r,o)){var i=qS(r,n.strides),a=ne(o);return It(this.readSync(n.dataId).subarray(i,i+a),o,n.dtype)}for(var s=ge(o,n.dtype),u=this.bufferSync(n),l=0;l<s.size;++l){var c=s.indexToLoc(l).map(function(d,f){return d+r[f]});s.values[l]=u.get.apply(u,c)}return s.toTensor()},t.prototype.stridedSlice=function(n,r,o,i){K(n,"stridedSlice");var a=cg(r,o,i);if(a.some(function(h){return h===0}))return It([],a);for(var s=ge(a,n.dtype),u=this.bufferSync(n),l=0;l<s.size;l++){for(var c=s.indexToLoc(l),d=new Array(c.length),f=0;f<d.length;f++)d[f]=c[f]*i[f]+r[f];s.set.apply(s,[u.get.apply(u,d)].concat(c))}return s.toTensor()},t.prototype.diag=function(n){for(var r=this.readSync(n.dataId),o=ge([n.size,n.size],n.dtype),i=o.values,a=0;a<r.length;a++)i[a*n.size+a]=r[a];return o.toTensor()},t.prototype.unstack=function(n,r){for(var o=n.shape[r],i=new Array(n.rank-1),a=0,s=0;s<n.rank;s++)s!==r&&(i[a++]=n.shape[s]);var u=new Array(n.rank).fill(0),l=n.shape.slice();l[r]=1;var c=new Array(o);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(n,u,l).reshape(i);return c},t.prototype.reverse=function(n,r){K(n,"reverse");for(var o=ge(n.shape,n.dtype),i=this.bufferSync(n),a=function(u){var l=o.indexToLoc(u),c=l.slice();r.forEach(function(d){return c[d]=n.shape[d]-1-c[d]}),o.set.apply(o,[i.get.apply(i,c)].concat(l))},s=0;s<o.size;s++)a(s);return o.toTensor()},t.prototype.concat=function(n,r){var o=this;if(n[0].dtype==="complex64"){var i=n.map(function(h){return Un(h)}),a=n.map(function(h){return Rr(h)});return Tt(this.concat(i,r),this.concat(a,r))}var s=n.map(function(h){var p=ne(h.shape.slice(r));return h.as2D(-1,p)}),u=$a(s.map(function(h){return h.shape}),1),l=ge(u,n[0].dtype).values;if(s[0].shape[0]===1){var c=0;s.forEach(function(h){l.set(o.readSync(h.dataId),c),c+=h.size})}else{var d=0;s.forEach(function(h){for(var p=o.readSync(h.dataId),m=0,g=0;g<h.shape[0];++g)for(var v=g*u[1]+d,y=0;y<h.shape[1];++y)l[v+y]=p[m++];d+=h.shape[1]})}var f=$a(n.map(function(h){return h.shape}),r);return It(l,f,n[0].dtype)},t.prototype.neg=function(n){return K(n,"neg"),this.multiply(Y(-1),n)},t.prototype.add=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o+a,imag:i+s}}):this.broadcastedBinaryOp(n,r,At(n.dtype,r.dtype),function(o,i){return o+i})},t.prototype.addN=function(n){var r=this;K(n,"addN");for(var o=n.map(function(c){return r.readSync(c.dataId)}),i=ge(n[0].shape,n[0].dtype),a=i.values,s=0;s<n.length;s++)for(var u=o[s],l=0;l<a.length;l++)a[l]+=u[l];return i.toTensor()},t.prototype.softmax=function(n,r){var o=bt([r],n.shape),i=this.max(n,o),a=dn(i.shape,o),s=this.subtract(n,i.reshape(a)),u=this.exp(s),l=this.sum(u,o).reshape(a);return this.realDivide(u,l)},t.prototype.subtract=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o-a,imag:i-s}}):this.broadcastedBinaryOp(n,r,At(n.dtype,r.dtype),function(o,i){return o-i})},t.prototype.pow=function(n,r){return K([n,r],"pow"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.pow(o,i)})},t.prototype.batchMatMul=function(n,r,o,i){K([n,r],"matMul");for(var a=o?n.shape[1]:n.shape[2],s=o?n.shape[2]:n.shape[1],u=i?r.shape[1]:r.shape[2],l=n.shape[0],c=this.readSync(n.dataId),d=this.readSync(r.dataId),f=o?[n.strides[0],1,n.strides[1]]:[n.strides[0],n.strides[1],1],h=f[0],p=f[1],m=f[2],g=i?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],v=g[0],y=g[1],b=g[2],w=s*u,C=ge([l,s,u],n.dtype),S=C.values,E=this.blockSize,k=0;k<l;k++)for(var R=0;R<s;R+=E)for(var _=0;_<u;_+=E)for(var N=0;N<a;N+=E)for(var I=Math.min(R+E,s),L=Math.min(_+E,u),O=Math.min(N+E,a),V=R;V<I;V++)for(var $=_;$<L;$++){for(var U=0,M=N;M<O;M++)U+=c[k*h+V*p+M*m]*d[M*v+$*y+k*b];S[k*w+(V*u+$)]+=U}return C.toTensor()},t.prototype.fusedBatchMatMul=function(n){var r=n.a,o=n.b,i=n.transposeA,a=n.transposeB,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=this.batchMatMul(r,o,i,a);return s&&(c=this.add(c,s)),u&&(c=Dh(this,c,u,l)),c},t.prototype.multiply=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o*a-i*s,imag:o*s+i*a}}):this.broadcastedBinaryOp(n,r,At(n.dtype,r.dtype),function(o,i){return o*i})},t.prototype.realDivide=function(n,r){return K([n,r],"realDivide"),this.broadcastedBinaryOp(n,r,"float32",function(o,i){return o/i})},t.prototype.floorDiv=function(n,r){return K([n,r],"floorDiv"),this.broadcastedBinaryOp(n,r,"int32",function(o,i){return Math.floor(o/i)})},t.prototype.sum=function(n,r){K(n,"sum"),vn("sum",r,n.rank);for(var o=Lt(n.shape,r),i=o[0],a=o[1],s=$e(i,At(n.dtype,"int32")),u=ne(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=0,p=0;p<u;++p)h+=c[f+p];l[d]=h}return s},t.prototype.prod=function(n,r){K(n,"sum");for(var o=Lt(n.shape,r),i=o[0],a=o[1],s=$e(i,At(n.dtype,"int32")),u=ne(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=1,p=0;p<u;++p)h*=c[f+p];l[d]=h}return s},t.prototype.unsortedSegmentSum=function(n,r,o){K(n,"unsortedSegmentSum");for(var i=[],a=n.rank-r.rank,s=0;s<a;++s)r=r.expandDims(s+1);for(s=0;s<o;++s){var u=Y(s,"int32"),l=_E(u,r).asType("float32").mul(n).sum(0);i.push(l)}return En(i)},t.prototype.argMin=function(n,r){K(n,"argMin");var o=[r];vn("argMin",o,n.rank);for(var i=Lt(n.shape,o),a=i[0],s=i[1],u=$e(a,"int32"),l=ne(s),c=this.readSync(u.dataId),d=this.readSync(n.dataId),f=0;f<c.length;++f){for(var h=f*l,p=d[h],m=0,g=0;g<l;++g){var v=d[h+g];v<p&&(p=v,m=g)}c[f]=m}return u},t.prototype.argMax=function(n,r){K(n,"argMax");var o=[r];vn("argMax",o,n.rank);for(var i=Lt(n.shape,o),a=i[0],s=i[1],u=$e(a,"int32"),l=ne(s),c=this.readSync(u.dataId),d=this.readSync(n.dataId),f=0;f<c.length;++f){for(var h=f*l,p=d[h],m=0,g=0;g<l;++g){var v=d[h+g];v>p&&(p=v,m=g)}c[f]=m}return u},t.prototype.cumsum=function(n,r,o,i){if(K(n,"cumsum"),r!==n.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(n.rank-1)+" but got axis="+r);for(var a=At(n.dtype,"int32"),s=$e(n.shape,a),u=this.readSync(s.dataId),l=this.readSync(n.dataId),c=n.shape[n.rank-1],d=i?function(g,v){return g+c-v-1}:function(g,v){return g+v},f=0;f<l.length;f+=c)for(var h=0;h<c;h++){var p=d(f,h);if(h===0)u[p]=o?0:l[p];else{var m=d(f,h-1);u[p]=o?l[m]+u[m]:l[p]+u[m]}}return s},t.prototype.equal=function(n,r){return K([n,r],"equal"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o===i?1:0})},t.prototype.notEqual=function(n,r){return K([n,r],"notEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o!==i?1:0})},t.prototype.less=function(n,r){return K([n,r],"less"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o<i?1:0})},t.prototype.lessEqual=function(n,r){return K([n,r],"lessEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o<=i?1:0})},t.prototype.greater=function(n,r){return K([n,r],"greater"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o>i?1:0})},t.prototype.greaterEqual=function(n,r){return K([n,r],"greaterEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o>=i?1:0})},t.prototype.logicalNot=function(n){K(n,"logicalNot");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)o[i]=r[i]?0:1;return this.makeOutput(o,n.shape,"bool")},t.prototype.logicalAnd=function(n,r){return K([n,r],"logicalAnd"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o&&i})},t.prototype.logicalOr=function(n,r){return K([n,r],"logicalOr"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o||i})},t.prototype.select=function(n,r,o){K([n,r,o],"select");for(var i=this.readSync(n.dataId),a=this.readSync(r.dataId),s=this.readSync(o.dataId),u=$e(r.shape,At(r.dtype,o.dtype)),l=this.readSync(u.dataId),c=0,d=n.rank===0||n.rank>1||r.rank===1?1:ne(r.shape.slice(1)),f=0;f<i.length;f++)for(var h=0;h<d;h++)i[f]===1?l[c++]=a[f]:l[c++]=s[f];return u},t.prototype.where=function(n){K([n],"where");var r=this.readSync(n.dataId);return pg(n.shape,r)},t.prototype.topk=function(n,r,o){return K(n,"topk"),rE(this.readSync(n.dataId),n.shape,n.dtype,r)},t.prototype.min=function(n,r){K(n,"min"),vn("min",r,n.rank);for(var o=Lt(n.shape,r),i=o[0],a=o[1],s=$e(i,n.dtype),u=ne(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=c[f],p=0;p<u;++p){var m=c[f+p];m<h&&(h=m)}l[d]=h}return s},t.prototype.minimum=function(n,r){return K([n,r],"minimum"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.min(o,i)})},t.prototype.mod=function(n,r){return K([n,r],"mod"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){var a=o%i;return o<0&&i<0||o>=0&&i>=0?a:(a+i)%i})},t.prototype.max=function(n,r){K(n,"max"),vn("max",r,n.rank);for(var o=Lt(n.shape,r),i=o[0],a=o[1],s=$e(i,n.dtype),u=ne(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=c[f],p=0;p<u;++p){var m=c[f+p];m>h&&(h=m)}l[d]=h}return s},t.prototype.maximum=function(n,r){return K([n,r],"maximum"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.max(o,i)})},t.prototype.all=function(n,r){K(n,"all"),vn("all",r,n.rank);for(var o=Lt(n.shape,r),i=o[0],a=o[1],s=$e(i,n.dtype),u=ne(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=c[f],p=0;p<u;++p){var m=c[f+p];h=h&&m}l[d]=h}return s},t.prototype.any=function(n,r){K(n,"any"),vn("any",r,n.rank);for(var o=Lt(n.shape,r),i=o[0],a=o[1],s=$e(i,n.dtype),u=ne(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=c[f],p=0;p<u;++p){var m=c[f+p];h=h||m}l[d]=h}return s},t.prototype.squaredDifference=function(n,r){return K([n,r],"squaredDifference"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){var a=o-i;return a*a})},t.prototype.ceil=function(n){K(n,"ceil");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.ceil(r[i]);return this.makeOutput(o,n.shape,"float32")},t.prototype.floor=function(n){K(n,"floor");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.floor(r[i]);return this.makeOutput(o,n.shape,"float32")},t.prototype.sign=function(n){K(n,"x");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)r[i]<0?o[i]=-1:r[i]>0?o[i]=1:o[i]=0;return this.makeOutput(o,n.shape,"float32")},t.prototype.isNaN=function(n){K(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isNaN(r[i])&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},t.prototype.isInf=function(n){K(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Math.abs(r[i])===1/0&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},t.prototype.isFinite=function(n){K(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isFinite(r[i])&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},t.prototype.round=function(n){K(n,"round");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=Math.floor(r[i]);r[i]-a<.5?o[i]=Math.floor(r[i]):r[i]-a>.5?o[i]=Math.ceil(r[i]):o[i]=a%2==0?a:a+1}return this.makeOutput(o,n.shape,"float32")},t.prototype.exp=function(n){K(n,"exp");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.exp(r[i]);return this.makeOutput(o,n.shape,"float32")},t.prototype.expm1=function(n){K(n,"expm1");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.expm1(r[i]);return this.makeOutput(o,n.shape,"float32")},t.prototype.log=function(n){K(n,"log");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.log(a)}return this.makeOutput(o,n.shape,"float32")},t.prototype.log1p=function(n){K(n,"log1p");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.log1p(a)}return this.makeOutput(o,n.shape,"float32")},t.prototype.sqrt=function(n){K(n,"sqrt");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.sqrt(a)}return this.makeOutput(o,n.shape,"float32")},t.prototype.rsqrt=function(n){K(n,"rsqrt");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=1/Math.sqrt(a)}return this.makeOutput(o,n.shape,"float32")},t.prototype.reciprocal=function(n){K(n,"reciprocal");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=1/r[i];return this.makeOutput(o,n.shape,"float32")},t.prototype.linear=function(n){return n},t.prototype.relu=function(n){K(n,"relu");for(var r=$e(n.shape,n.dtype),o=this.readSync(r.dataId),i=this.readSync(n.dataId),a=0;a<i.length;++a)o[a]=Math.max(0,i[a]);return r},t.prototype.relu6=function(n){K(n,"relu");for(var r=$e(n.shape,n.dtype),o=this.readSync(r.dataId),i=this.readSync(n.dataId),a=0;a<i.length;++a)o[a]=Math.min(Math.max(0,i[a]),6);return r},t.prototype.prelu=function(n,r){return K([n,r],"prelu"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return o<0?i*o:o})},t.prototype.elu=function(n){K(n,"elu");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i){var a=o[i];r[i]=a>=0?a:Math.exp(a)-1}return this.makeOutput(r,n.shape,"float32")},t.prototype.eluDer=function(n,r){K([n,r],"eluDer");for(var o=new Float32Array(r.size),i=this.readSync(r.dataId),a=this.readSync(n.dataId),s=0;s<i.length;++s){var u=i[s];o[s]=u>=1?a[s]:a[s]*(u+1)}return this.makeOutput(o,r.shape,"float32")},t.prototype.selu=function(n){K(n,"selu");for(var r=vg,o=gg,i=new Float32Array(n.size),a=this.readSync(n.dataId),s=0;s<a.length;++s){var u=a[s];i[s]=u>=0?o*u:r*(Math.exp(u)-1)}return this.makeOutput(i,n.shape,"float32")},t.prototype.clip=function(n,r,o){K(n,"clip");for(var i=new Float32Array(n.size),a=this.readSync(n.dataId),s=0;s<a.length;++s){var u=a[s];i[s]=u>o?o:u<r?r:u}return this.makeOutput(i,n.shape,"float32")},t.prototype.abs=function(n){for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.abs(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.complexAbs=function(n){for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<n.size;++i){var a=o[2*i],s=o[2*i+1];r[i]=Math.hypot(a,s)}return this.makeOutput(r,n.shape,"float32")},t.prototype.int=function(n){K(n,"int");for(var r=new Int32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=o[i];return this.makeOutput(r,n.shape,"int32")},t.prototype.sigmoid=function(n){K(n,"sigmoid");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=1/(1+Math.exp(-o[i]));return this.makeOutput(r,n.shape,"float32")},t.prototype.softplus=function(n){K(n,"softplus");for(var r=Math.log(11920928955078125e-23)+2,o=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var s=i[a]>-r,u=i[a]<r,l=Math.exp(i[a]),c=void 0;c=u?l:s?i[a]:Math.log(1+l),o[a]=c}return this.makeOutput(o,n.shape,"float32")},t.prototype.sin=function(n){K(n,"sin");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.sin(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cos=function(n){K(n,"cos");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.cos(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tan=function(n){K(n,"tan");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.tan(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asin=function(n){K(n,"asin");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.asin(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acos=function(n){K(n,"acos");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.acos(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan=function(n){K(n,"atan");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.atan(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan2=function(n,r){return K([n,r],"atan2"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.atan2(o,i)})},t.prototype.sinh=function(n){K(n,"sinh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.sinh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cosh=function(n){K(n,"cosh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.cosh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tanh=function(n){K(n,"tanh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=ZP(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asinh=function(n){K(n,"asinh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.asinh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acosh=function(n){K(n,"acosh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.acosh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atanh=function(n){K(n,"atanh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.atanh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.erf=function(n){K(n,"erf");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i){var a=Math.sign(o[i]),s=Math.abs(o[i]),u=1/(1+.3275911*s);r[i]=a*(1-((((1.061405429*u-1.453152027)*u+1.421413741)*u-.284496736)*u+.254829592)*u*Math.exp(-s*s))}return this.makeOutput(r,n.shape,"float32")},t.prototype.step=function(n,r){r===void 0&&(r=0),K(n,"step");for(var o=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var s=i[a];isNaN(s)?o[a]=NaN:o[a]=s>0?1:r}return this.makeOutput(o,n.shape,"float32")},t.prototype.fusedConv2d=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights,l=this.conv2d(r,o,i);return a&&(l=this.add(l,a)),s&&(l=Dh(this,l,s,u)),l},t.prototype.conv2d=function(n,r,o){K([n,r],"conv2d");for(var i=o.filterHeight,a=o.filterWidth,s=o.dilationHeight,u=o.dilationWidth,l=o.padInfo.left,c=o.padInfo.top,d=o.dataFormat==="channelsLast",f=ge(o.outShape,n.dtype),h=n.strides[0],p=d?n.strides[1]:n.strides[2],m=d?n.strides[2]:1,g=d?1:n.strides[1],v=f.strides[0],y=d?f.strides[1]:f.strides[2],b=d?f.strides[2]:1,w=d?1:f.strides[1],C=this.readSync(n.dataId),S=this.readSync(r.dataId),E=f.values,k=0;k<o.batchSize;++k)for(var R=k*h,_=k*v,N=0;N<o.outHeight;++N)for(var I=_+N*y,L=N*o.strideHeight-c,O=0;O<i;O++){var V=L+O*s;if(!(V<0||V>=o.inHeight))for(var $=O*r.strides[0],U=R+V*p,M=0;M<o.outWidth;++M)for(var B=I+M*b,z=M*o.strideWidth-l,G=0;G<a;G++){var X=z+G*u;if(!(X<0||X>=o.inWidth))for(var te=U+X*m,ae=$+G*r.strides[1],ue=0;ue<o.inChannels;++ue){for(var se=C[te+ue*g],me=0;me<o.outChannels;++me)E[B+me*w]+=se*S[ae+me];ae+=o.outChannels}}}return f.toTensor()},t.prototype.conv3d=function(n,r,o){for(var i=o.filterDepth,a=o.filterHeight,s=o.filterWidth,u=o.dilationDepth,l=o.dilationHeight,c=o.dilationWidth,d=o.padInfo.front,f=o.padInfo.left,h=o.padInfo.top,p=ge(o.outShape,n.dtype),m=this.readSync(n.dataId),g=this.readSync(r.dataId),v=p.values,y=0;y<o.batchSize;++y)for(var b=y*n.strides[0],w=y*p.strides[0],C=0;C<o.outDepth;++C)for(var S=w+C*p.strides[1],E=C*o.strideDepth-d,k=0;k<i;k++){var R=E+k*u;if(!(R<0||R>=o.inDepth))for(var _=k*r.strides[0],N=b+R*n.strides[1],I=0;I<o.outHeight;++I)for(var L=S+I*p.strides[2],O=I*o.strideHeight-h,V=0;V<a;V++){var $=O+V*l;if(!($<0||$>=o.inHeight))for(var U=_+V*r.strides[1],M=N+$*n.strides[2],B=0;B<o.outWidth;++B)for(var z=L+B*o.outChannels,G=B*o.strideWidth-f,X=0;X<s;X++){var te=G+X*c;if(!(te<0||te>=o.inWidth))for(var ae=U+X*r.strides[2],ue=M+te*o.inChannels,se=ae,me=0;me<o.inChannels;++me){for(var xe=m[ue+me],ce=0;ce<o.outChannels;++ce)v[z+ce]+=xe*g[se+ce];se+=o.outChannels}}}}return p.toTensor()},t.prototype.conv2dDerInput=function(n,r,o){K([n,r],"conv2dDerInput");for(var i=ge(o.inShape,"float32"),a=i.values,s=this.readSync(n.dataId),u=this.readSync(r.dataId),l=r.strides,c=l[0],d=l[1],f=l[2],h=o.batchSize,p=o.filterHeight,m=o.filterWidth,g=o.inChannels,v=o.inHeight,y=o.inWidth,b=o.outChannels,w=o.outHeight,C=o.outWidth,S=o.strideHeight,E=o.strideWidth,k=o.dataFormat,R=p-1-o.padInfo.top,_=m-1-o.padInfo.left,N=k==="channelsLast",I=i.strides[0],L=N?i.strides[1]:i.strides[2],O=N?i.strides[2]:1,V=N?1:i.strides[1],$=n.strides[0],U=N?n.strides[1]:n.strides[2],M=N?n.strides[2]:1,B=N?1:n.strides[1],z=0;z<h;++z)for(var G=0;G<g;++G)for(var X=0;X<v;++X)for(var te=X-R,ae=Math.max(0,Math.ceil(te/S)),ue=Math.min(w,(p+te)/S),se=0;se<y;++se){for(var me=se-_,xe=Math.max(0,Math.ceil(me/E)),ce=Math.min(C,(m+me)/E),Me=0,he=ae;he<ue;++he)for(var _e=he*S-te,Ee=xe;Ee<ce;++Ee)for(var Ue=$*z+U*he+M*Ee,je=c*(p-1-_e)+d*(m-1-(Ee*E-me))+f*G,ze=0;ze<b;++ze)Me+=s[Ue+B*ze]*u[je+ze];a[I*z+L*X+O*se+V*G]=Me}return i.toTensor()},t.prototype.conv3dDerInput=function(n,r,o){for(var i=ge(o.inShape,"float32"),a=i.values,s=i.strides,u=s[0],l=s[1],c=s[2],d=s[3],f=this.readSync(n.dataId),h=n.strides,p=h[0],m=h[1],g=h[2],v=h[3],y=this.readSync(r.dataId),b=r.strides,w=b[0],C=b[1],S=b[2],E=b[3],k=o.batchSize,R=o.filterDepth,_=o.filterHeight,N=o.filterWidth,I=o.inChannels,L=o.inDepth,O=o.inHeight,V=o.inWidth,$=o.outChannels,U=o.outDepth,M=o.outHeight,B=o.outWidth,z=o.strideDepth,G=o.strideHeight,X=o.strideWidth,te=R-1-o.padInfo.front,ae=_-1-o.padInfo.top,ue=N-1-o.padInfo.left,se=0;se<k;++se)for(var me=0;me<I;++me)for(var xe=0;xe<L;++xe)for(var ce=xe-te,Me=Math.max(0,Math.ceil(ce/z)),he=Math.min(U,(R+ce)/z),_e=0;_e<O;++_e)for(var Ee=_e-ae,Ue=Math.max(0,Math.ceil(Ee/G)),je=Math.min(M,(_+Ee)/G),ze=0;ze<V;++ze){for(var Pn=ze-ue,Dn=Math.max(0,Math.ceil(Pn/X)),Gt=Math.min(B,(N+Pn)/X),vr=0,pn=Me;pn<he;++pn)for(var gr=pn*z-ce,tr=Ue;tr<je;++tr)for(var nr=tr*G-Ee,Kt=Dn;Kt<Gt;++Kt)for(var ts=p*se+m*pn+g*tr+v*Kt,$r=w*(R-1-gr)+C*(_-1-nr)+S*(N-1-(Kt*X-Pn))+E*me,Mn=0;Mn<$;++Mn)vr+=f[ts+Mn]*y[$r+Mn];a[u*se+l*xe+c*_e+d*ze+me]=vr}return i.toTensor()},t.prototype.conv2dDerFilter=function(n,r,o){K([n,r],"conv2dDerFilter");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,l=o.dataFormat==="channelsLast",c=ge(o.filterShape,"float32"),d=o.padInfo.left,f=o.padInfo.top,h=this.bufferSync(n),p=this.bufferSync(r),m=0;m<s;++m)for(var g=Math.max(0,Math.ceil((f-m)/i)),v=Math.min(o.outHeight,(o.inHeight+f-m)/i),y=0;y<u;++y)for(var b=Math.max(0,Math.ceil((d-y)/a)),w=Math.min(o.outWidth,(o.inWidth+d-y)/a),C=0;C<o.inChannels;++C)for(var S=0;S<o.outChannels;++S){for(var E=0,k=0;k<o.batchSize;++k)for(var R=g;R<v;++R)for(var _=m+R*i-f,N=b;N<w;++N){var I=y+N*a-d;E+=l?h.get(k,_,I,C)*p.get(k,R,N,S):h.get(k,C,_,I)*p.get(k,S,R,N)}c.set(E,m,y,C,S)}return c.toTensor()},t.prototype.conv3dDerFilter=function(n,r,o){for(var i=o.strideDepth,a=o.strideHeight,s=o.strideWidth,u=o.filterDepth,l=o.filterHeight,c=o.filterWidth,d=ge(o.filterShape,"float32"),f=d.values,h=d.strides,p=h[0],m=h[1],g=h[2],v=h[3],y=this.readSync(r.dataId),b=r.strides,w=b[0],C=b[1],S=b[2],E=b[3],k=this.readSync(n.dataId),R=n.strides,_=R[0],N=R[1],I=R[2],L=R[3],O=o.padInfo.front,V=o.padInfo.left,$=o.padInfo.top,U=0;U<u;++U)for(var M=Math.max(0,Math.ceil((O-U)/i)),B=Math.min(o.outDepth,(o.inDepth+O-U)/i),z=U*p,G=0;G<l;++G)for(var X=Math.max(0,Math.ceil(($-G)/a)),te=Math.min(o.outHeight,(o.inHeight+$-G)/a),ae=G*m+z,ue=0;ue<c;++ue)for(var se=Math.max(0,Math.ceil((V-ue)/s)),me=Math.min(o.outWidth,(o.inWidth+V-ue)/s),xe=ue*g+ae,ce=0;ce<o.inChannels;++ce)for(var Me=ce*v+xe,he=0;he<o.outChannels;++he){for(var _e=0,Ee=0;Ee<o.batchSize;++Ee)for(var Ue=Ee*_,je=Ee*w,ze=M;ze<B;++ze)for(var Pn=(U+ze*i-O)*N+Ue,Dn=ze*C+je,Gt=X;Gt<te;++Gt)for(var vr=(G+Gt*a-$)*I+Pn,pn=Gt*S+Dn,gr=se;gr<me;++gr){var tr=gr*E+pn;_e+=k[(ue+gr*s-V)*L+vr+ce]*y[tr+he]}f[Me+he]=_e}return d.toTensor()},t.prototype.fusedDepthwiseConv2D=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights,l=this.depthwiseConv2D(r,o,i);return a&&(l=this.add(l,a)),s&&(l=Dh(this,l,s,u)),l},t.prototype.depthwiseConv2D=function(n,r,o){K([n,r],"depthwiseConv2D");for(var i=o.filterHeight,a=o.filterWidth,s=o.dilationHeight,u=o.dilationWidth,l=o.padInfo.left,c=o.padInfo.top,d=o.outChannels/o.inChannels,f=ge(o.outShape,n.dtype),h=this.readSync(n.dataId),p=this.readSync(r.dataId),m=f.values,g=0;g<o.batchSize;++g)for(var v=g*n.strides[0],y=g*f.strides[0],b=0;b<o.outHeight;++b)for(var w=y+b*f.strides[1],C=b*o.strideHeight-l,S=0;S<i;++S){var E=C+S*s;if(!(E<0||E>=o.inHeight))for(var k=S*r.strides[0],R=v+E*n.strides[1],_=0;_<o.outWidth;++_)for(var N=w+_*f.strides[2],I=_*o.strideWidth-c,L=0;L<a;++L){var O=I+L*u;if(!(O<0||O>=o.inWidth))for(var V=k+L*r.strides[1],$=R+O*o.inChannels,U=N,M=V,B=0;B<o.inChannels;++B){for(var z=h[$+B],G=0;G<d;++G)m[U+G]+=z*p[M+G];U+=d,M+=d}}}return f.toTensor()},t.prototype.depthwiseConv2DDerInput=function(n,r,o){K([n,r],"depthwiseConv2DDerInput");for(var i=ge(o.inShape,"float32"),a=i.values,s=i.strides,u=s[0],l=s[1],c=s[2],d=this.readSync(n.dataId),f=n.strides,h=f[0],p=f[1],m=f[2],g=this.readSync(r.dataId),v=r.strides,y=v[0],b=v[1],w=v[2],C=o.batchSize,S=o.filterHeight,E=o.filterWidth,k=o.inChannels,R=o.inHeight,_=o.inWidth,N=o.outChannels,I=o.outHeight,L=o.outWidth,O=o.strideHeight,V=o.strideWidth,$=S-1-o.padInfo.top,U=E-1-o.padInfo.left,M=N/k,B=0;B<C;++B)for(var z=0;z<k;++z)for(var G=0;G<R;++G)for(var X=G-$,te=Math.max(0,Math.ceil(X/O)),ae=Math.min(I,(S+X)/O),ue=0;ue<_;++ue){for(var se=ue-U,me=Math.max(0,Math.ceil(se/V)),xe=Math.min(L,(E+se)/V),ce=0,Me=te;Me<ae;++Me)for(var he=Me*O-X,_e=me;_e<xe;++_e)for(var Ee=h*B+p*Me+m*_e,Ue=y*(S-1-he)+b*(E-1-(_e*V-se))+w*z,je=0;je<M;++je)ce+=d[Ee+(z*M+je)]*g[Ue+je];a[u*B+l*G+c*ue+z]=ce}return i.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(n,r,o){K([n,r],"depthwiseConv2DDerFilter");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,l=ge(o.filterShape,"float32"),c=o.padInfo.left,d=o.padInfo.top,f=o.outChannels/o.inChannels,h=this.bufferSync(n),p=this.bufferSync(r),m=0;m<s;++m)for(var g=Math.max(0,Math.ceil((d-m)/i)),v=Math.min(o.outHeight,(o.inHeight+d-m)/i),y=0;y<u;++y)for(var b=Math.max(0,Math.ceil((c-y)/a)),w=Math.min(o.outWidth,(o.inWidth+c-y)/a),C=0;C<o.outChannels;++C){for(var S=Math.trunc(C/f),E=C%f,k=0,R=0;R<o.batchSize;++R)for(var _=g;_<v;++_)for(var N=m+_*i-d,I=b;I<w;++I){var L=y+I*a-c;k+=h.get(R,N,L,S)*p.get(R,_,I,C)}l.set(k,m,y,S,E)}return l.toTensor()},t.prototype.tile=function(n,r){return K(n,"tile"),nE(this.bufferSync(n),r)},t.prototype.pad=function(n,r,o){K(n,"pad");var i=r.map(function(f,h){return f[0]+n.shape[h]+f[1]}),a=r.map(function(f){return f[0]}),s=this.bufferSync(n),u=ge(i,n.dtype);o!==0&&u.values.fill(o);for(var l=0;l<n.size;l++){var c=s.indexToLoc(l),d=c.map(function(f,h){return f+a[h]});u.set.apply(u,[s.get.apply(s,c)].concat(d))}return u.toTensor()},t.prototype.transpose=function(n,r){K(n,"transpose");for(var o=new Array(n.rank),i=0;i<o.length;i++)o[i]=n.shape[r[i]];var a=this.readSync(n.dataId),s=ge(o,n.dtype),u=this.bufferSync(n);for(i=0;i<n.size;++i){for(var l=u.indexToLoc(i),c=new Array(l.length),d=0;d<c.length;d++)c[d]=l[r[d]];var f=s.locToIndex(c);s.values[f]=a[i]}return s.toTensor()},t.prototype.gather=function(n,r,o){K([n,r],"gather");var i=n.shape.slice(),a=this.readSync(r.dataId);i[o]=a.length;for(var s=ge(i,n.dtype),u=this.bufferSync(n),l=0;l<s.size;++l){var c=s.indexToLoc(l),d=c.slice();d[o]=a[c[o]];var f=u.locToIndex(d);s.values[l]=u.values[f]}return s.toTensor()},t.prototype.batchToSpaceND=function(n,r,o){K([n],"batchToSpaceND");var i=r.reduce(function(d,f){return d*f}),a=zc(n.shape,r,i),s=Vc(a.length,r.length),u=$c(n.shape,r,i),l=WS(o,r.length),c=US(u,o,r.length);return n.reshape(a).transpose(s).reshape(u).slice(l,c)},t.prototype.spaceToBatchND=function(n,r,o){K([n],"spaceToBatchND");var i=r.reduce(function(f,h){return f*h}),a=[[0,0]];a.push.apply(a,o);for(var s=1+r.length;s<n.shape.length;++s)a.push([0,0]);var u=n.pad(a),l=zc(u.shape,r,i,!1),c=Vc(l.length,r.length,!1),d=$c(u.shape,r,i,!1);return u.reshape(l).transpose(c).reshape(d)},t.prototype.pool=function(n,r,o){K(n,"pool");for(var i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,h=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,p=this.readSync(n.dataId),m=ge(r.outShape,n.dtype),g=m.values,v=r.outShape[1]*r.outShape[2]*r.outShape[3],y=r.outShape[2]*r.outShape[3],b=r.outShape[3],w=0;w<r.batchSize;++w)for(var C=w*v,S=w*n.strides[0],E=0;E<r.inChannels;++E)for(var k=0;k<r.outHeight;++k)for(var R=k*i-d,_=Math.max(0,R),N=Math.min(r.inHeight,l+R),I=C+k*y,L=0;L<r.outWidth;++L){for(var O=L*a-f,V=Math.max(0,O),$=Math.min(r.inWidth,c+O),U=h,M=0,B=0,z=_;z<N;z+=s){for(var G=S+z*n.strides[1],X=V;X<$;X+=u){var te=p[G+X*n.strides[2]+E];o==="max"&&te>U?U=te:o==="avg"&&(M+=te,B++)}if(isNaN(U))break}g[I+L*b+E]=o==="avg"?M/B:U}return m.toTensor()},t.prototype.maxPool=function(n,r){return this.pool(n,r,"max")},t.prototype.maxPoolPositions=function(n,r){for(var o=ge(r.outShape,"int32"),i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,h=this.bufferSync(n),p=0;p<r.batchSize;++p)for(var m=0;m<r.inChannels;++m)for(var g=0;g<r.outHeight;++g){for(var v=g*i-d,y=v;y<0;)y+=s;for(var b=Math.min(r.inHeight,l+v),w=0;w<r.outWidth;++w){for(var C=w*a-f,S=C;S<0;)S+=u;for(var E=Math.min(r.inWidth,c+C),k=Number.NEGATIVE_INFINITY,R=-1,_=y;_<b;_+=s)for(var N=_-v,I=S;I<E;I+=u){var L=I-C,O=h.get(p,_,I,m);O>k&&(k=O,R=N*c+L)}o.set(R,p,g,w,m)}}return o.toTensor()},t.prototype.maxPoolBackprop=function(n,r,o,i){K([r,o],"maxPoolBackprop");for(var a=this.maxPoolPositions(r,i),s=i.strideHeight,u=i.strideWidth,l=i.dilationHeight,c=i.dilationWidth,d=i.effectiveFilterHeight,f=i.effectiveFilterWidth,h=f-1-i.padInfo.left,p=d-1-i.padInfo.top,m=ge(r.shape,"float32"),g=this.bufferSync(a),v=this.bufferSync(n),y=0;y<i.batchSize;++y)for(var b=0;b<i.inChannels;++b)for(var w=0;w<i.inHeight;++w)for(var C=0;C<i.inWidth;++C){for(var S=w-p,E=C-h,k=0,R=0;R<d;R+=l){var _=(S+R)/s;if(!(_<0||_>=i.outHeight||Math.floor(_)!==_))for(var N=0;N<f;N+=c){var I=(E+N)/u;if(!(I<0||I>=i.outWidth||Math.floor(I)!==I)){var L=d*f-1-g.get(y,_,I,b)===R*f+N?1:0;L!==0&&(k+=v.get(y,_,I,b)*L)}}}m.set(k,y,w,C,b)}return m.toTensor()},t.prototype.avgPoolBackprop=function(n,r,o){K([n,r],"avgPoolBackprop");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,l=o.dilationHeight,c=o.dilationWidth,d=o.effectiveFilterHeight,f=o.effectiveFilterWidth,h=f-1-o.padInfo.left,p=d-1-o.padInfo.top,m=ge(r.shape,"float32"),g=1/(s*u),v=this.bufferSync(n),y=0;y<o.batchSize;++y)for(var b=0;b<o.inChannels;++b)for(var w=0;w<o.inHeight;++w)for(var C=0;C<o.inWidth;++C){for(var S=w-p,E=C-h,k=0,R=0;R<d;R+=l){var _=(S+R)/i;if(!(_<0||_>=o.outHeight||Math.floor(_)!==_))for(var N=0;N<f;N+=c){var I=(E+N)/a;I<0||I>=o.outWidth||Math.floor(I)!==I||(k+=v.get(y,_,I,b))}}m.set(k*g,y,w,C,b)}return m.toTensor()},t.prototype.pool3d=function(n,r,o){K(n,"pool3d");for(var i=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.front,m=r.padInfo.top,g=r.padInfo.left,v=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=this.readSync(n.dataId),b=ge(r.outShape,n.dtype),w=b.values,C=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],S=r.outShape[2]*r.outShape[3]*r.outShape[4],E=r.outShape[3]*r.outShape[4],k=r.outShape[4],R=0;R<r.batchSize;++R)for(var _=R*C,N=R*n.strides[0],I=0;I<r.inChannels;++I)for(var L=0;L<r.outDepth;++L){for(var O=L*i-p,V=O;V<0;)V+=u;for(var $=Math.min(r.inDepth,d+O),U=_+L*S,M=0;M<r.outHeight;++M){for(var B=M*a-m,z=B;z<0;)z+=l;for(var G=Math.min(r.inHeight,f+B),X=U+M*E,te=0;te<r.outWidth;++te){for(var ae=te*s-g,ue=ae;ue<0;)ue+=c;for(var se=Math.min(r.inWidth,h+ae),me=X+te*k,xe=v,ce=0,Me=0,he=V;he<$;he+=u){for(var _e=N+he*n.strides[1],Ee=z;Ee<G;Ee+=l){for(var Ue=_e+Ee*n.strides[2],je=ue;je<se;je+=c){var ze=y[Ue+je*n.strides[3]+I];if(o==="max"&&ze>xe?xe=ze:o==="avg"&&(ce+=ze,Me++),isNaN(xe))break}if(isNaN(xe))break}if(isNaN(xe))break}w[me+I]=o==="avg"?ce/Me:xe}}}return b.toTensor()},t.prototype.avgPool3d=function(n,r){return K(n,"avgPool3d"),this.pool3d(n,r,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(n,r,o){K([n,r],"avgPool3dBackprop");for(var i=o.strideDepth,a=o.strideHeight,s=o.strideWidth,u=o.filterDepth,l=o.filterHeight,c=o.filterWidth,d=o.dilationDepth,f=o.dilationHeight,h=o.dilationWidth,p=o.effectiveFilterDepth,m=o.effectiveFilterHeight,g=o.effectiveFilterWidth,v=p-1-o.padInfo.front,y=g-1-o.padInfo.left,b=m-1-o.padInfo.top,w=ge(r.shape,"float32"),C=1/(u*l*c),S=this.bufferSync(n),E=0;E<o.batchSize;++E)for(var k=0;k<o.inChannels;++k)for(var R=0;R<o.inDepth;++R)for(var _=0;_<o.inHeight;++_)for(var N=0;N<o.inWidth;++N){for(var I=R-v,L=_-b,O=N-y,V=0,$=0;$<p;$+=d){var U=(I+$)/i;if(!(U<0||U>=o.outDepth||Math.floor(U)!==U))for(var M=0;M<m;M+=f){var B=(L+M)/a;if(!(B<0||B>=o.outHeight||Math.floor(B)!==B))for(var z=0;z<g;z+=h){var G=(O+z)/s;G<0||G>=o.outWidth||Math.floor(G)!==G||(V+=S.get(E,U,B,G,k))}}}w.set(V*C,E,R,_,N,k)}return w.toTensor()},t.prototype.maxPool3d=function(n,r){return K(n,"maxPool3d"),this.pool3d(n,r,"max").toFloat()},t.prototype.maxPool3dPositions=function(n,r){for(var o=ge(r.outShape,"int32"),i=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.front,m=r.padInfo.top,g=r.padInfo.left,v=this.bufferSync(n),y=0;y<r.batchSize;++y)for(var b=0;b<r.inChannels;++b)for(var w=0;w<r.outDepth;++w){for(var C=w*i-p,S=C;S<0;)S+=u;for(var E=Math.min(r.inDepth,d+C),k=0;k<r.outHeight;++k){for(var R=k*a-m,_=R;_<0;)_+=l;for(var N=Math.min(r.inHeight,f+R),I=0;I<r.outWidth;++I){for(var L=I*s-g,O=L;O<0;)O+=c;for(var V=Math.min(r.inWidth,h+L),$=Number.NEGATIVE_INFINITY,U=-1,M=S;M<E;M+=u)for(var B=M-C,z=_;z<N;z+=l)for(var G=z-R,X=O;X<V;X+=c){var te=X-L,ae=v.get(y,M,z,X,b);ae>=$&&($=ae,U=B*f*h+G*f+te)}o.set(U,y,w,k,I,b)}}}return o.toTensor()},t.prototype.maxPool3dBackprop=function(n,r,o,i){K([r,o],"maxPool3dBackprop");for(var a=this.maxPool3dPositions(r,i),s=i.strideDepth,u=i.strideHeight,l=i.strideWidth,c=i.dilationDepth,d=i.dilationHeight,f=i.dilationWidth,h=i.effectiveFilterDepth,p=i.effectiveFilterHeight,m=i.effectiveFilterWidth,g=h-1-i.padInfo.front,v=m-1-i.padInfo.left,y=p-1-i.padInfo.top,b=ge(r.shape,"float32"),w=this.bufferSync(a),C=this.bufferSync(n),S=0;S<i.batchSize;++S)for(var E=0;E<i.inChannels;++E)for(var k=0;k<i.inDepth;++k)for(var R=0;R<i.inHeight;++R)for(var _=0;_<i.inWidth;++_){for(var N=k-g,I=R-y,L=_-v,O=0,V=0;V<h;V+=c){var $=(N+V)/s;if(!($<0||$>=i.outDepth||Math.floor($)!==$))for(var U=0;U<p;U+=d){var M=(I+U)/u;if(!(M<0||M>=i.outHeight||Math.floor(M)!==M))for(var B=0;B<m;B+=f){var z=(L+B)/l;if(!(z<0||z>=i.outWidth||Math.floor(z)!==z)){var G=h*p*m-1-w.get(S,$,M,z,E)===V*p*m+U*m+B?1:0;G!==0&&(O+=C.get(S,$,M,z,E)*G)}}}}b.set(O,S,k,R,_,E)}return b.toTensor()},t.prototype.cast=function(n,r){return JS(n,r,this)},t.prototype.reshape=function(n,r){return vm(n,r)},t.prototype.avgPool=function(n,r){return K(n,"avgPool"),this.pool(n,r,"avg").toFloat()},t.prototype.resizeBilinear=function(n,r,o,i){K(n,"resizeBilinear");for(var a=n.shape,s=a[0],u=a[1],l=a[2],c=a[3],d=this.readSync(n.dataId),f=new Float32Array(ne([s,r,o,c])),h=[i&&r>1?u-1:u,i&&o>1?l-1:l],p=[i&&r>1?r-1:r,i&&o>1?o-1:o],m=0,g=h[0]/p[0],v=h[1]/p[1],y=0;y<s;y++)for(var b=0;b<r;b++)for(var w=g*b,C=Math.floor(w),S=w-C,E=Math.min(u-1,Math.ceil(w)),k=y*n.strides[0]+C*n.strides[1],R=y*n.strides[0]+E*n.strides[1],_=0;_<o;_++)for(var N=v*_,I=Math.floor(N),L=N-I,O=Math.min(l-1,Math.ceil(N)),V=k+I*n.strides[2],$=R+I*n.strides[2],U=k+O*n.strides[2],M=R+O*n.strides[2],B=0;B<c;B++){var z=d[V+B],G=d[$+B],X=z+(d[U+B]-z)*L,te=X+(G+(d[M+B]-G)*L-X)*S;f[m++]=te}return It(f,[s,r,o,c])},t.prototype.resizeBilinearBackprop=function(n,r,o){K([n,r],"resizeBilinearBackprop");for(var i=r.shape,a=i[0],s=i[1],u=i[2],l=i[3],c=n.shape,d=c[1],f=c[2],h=new Float32Array(a*s*u*l),p=[o&&d>1?s-1:s,o&&f>1?u-1:u],m=[o&&d>1?d-1:d,o&&f>1?f-1:f],g=p[0]/m[0],v=p[1]/m[1],y=this.readSync(n.dataId),b=0,w=0;w<a;w++)for(var C=w*r.strides[0],S=0;S<d;S++)for(var E=S*g,k=Math.floor(E),R=Math.min(Math.ceil(E),s-1),_=C+k*r.strides[1],N=C+R*r.strides[1],I=E-k,L=1-I,O=0;O<f;O++)for(var V=O*v,$=Math.floor(V),U=Math.min(Math.ceil(V),u-1),M=V-$,B=1-M,z=_+$*r.strides[2],G=_+U*r.strides[2],X=N+$*r.strides[2],te=N+U*r.strides[2],ae=L*B,ue=L*M,se=I*B,me=I*M,xe=0;xe<l;xe++){var ce=y[b++];h[z+xe]+=ce*ae,h[G+xe]+=ce*ue,h[X+xe]+=ce*se,h[te+xe]+=ce*me}return en(h,[a,u,s,l],r.dtype)},t.prototype.resizeNearestNeighbor=function(n,r,o,i){K(n,"resizeNearestNeighbor");for(var a=n.shape,s=a[0],u=a[1],l=a[2],c=a[3],d=this.readSync(n.dataId),f=new Float32Array(s*r*o*c),h=[i&&r>1?u-1:u,i&&o>1?l-1:l],p=[i&&r>1?r-1:r,i&&o>1?o-1:o],m=h[0]/p[0],g=h[1]/p[1],v=0,y=0;y<s;y++)for(var b=y*n.strides[0],w=0;w<r;w++)for(var C=m*w,S=b+Math.min(u-1,i?Math.round(C):Math.floor(C))*n.strides[1],E=0;E<o;E++)for(var k=g*E,R=S+Math.min(l-1,i?Math.round(k):Math.floor(k))*n.strides[2],_=0;_<c;_++){var N=d[R+_];f[v++]=N}return It(f,[s,r,o,c],n.dtype)},t.prototype.resizeNearestNeighborBackprop=function(n,r,o){K([n,r],"resizeNearestNeighborBackprop");for(var i=r.shape,a=i[0],s=i[1],u=i[2],l=i[3],c=n.shape,d=c[1],f=c[2],h=new Float32Array(a*s*u*l),p=this.readSync(n.dataId),m=[o&&d>1?s-1:s,o&&f>1?u-1:u],g=[o&&d>1?d-1:d,o&&f>1?f-1:f],v=m[0]/g[0],y=m[1]/g[1],b=1/v,w=1/y,C=2*Math.ceil(b)+2,S=2*Math.ceil(w)+2,E=0;E<a;E++)for(var k=E*r.strides[0],R=0;R<s;R++)for(var _=k+R*r.strides[1],N=Math.floor(R*b),I=Math.floor(N-C/2),L=0;L<u;L++)for(var O=_+L*r.strides[2],V=Math.floor(L*w),$=Math.floor(V-S/2),U=0;U<l;U++){for(var M=0,B=0;B<C;B++){var z=B+I;if(!(z<0||z>=d)){var G=k+z*n.strides[1],X=z*v;if(R===Math.min(s-1,o?Math.round(X):Math.floor(X)))for(var te=0;te<S;te++){var ae=te+$;if(!(ae<0||ae>=f)){var ue=G+ae*n.strides[2],se=ae*y;L===Math.min(u-1,o?Math.round(se):Math.floor(se))&&(M+=p[ue+U])}}}}h[O+U]=M}return en(h,r.shape,r.dtype)},t.prototype.batchNormalization=function(n,r,o,i,a,s){K([n,r,o,a,s],"batchNorm");for(var u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=this.readSync(o.dataId),d=a?this.readSync(a.dataId):new Float32Array([1]),f=s?this.readSync(s.dataId):new Float32Array([0]),h=new Float32Array(u.length),p=f.length,m=d.length,g=c.length,v=l.length,y=0,b=0,w=0,C=0,S=0;S<u.length;++S)h[S]=f[y++]+(u[S]-l[b++])*d[w++]/Math.sqrt(c[C++]+i),y>=p&&(y=0),b>=v&&(b=0),w>=m&&(w=0),C>=g&&(C=0);return en(h,n.shape)},t.prototype.localResponseNormalization4D=function(n,r,o,i,a){K(n,"localResponseNormalization4D");var s=n.shape[3],u=s-1,l=this.readSync(n.dataId),c=n.size,d=new Float32Array(c);function f(g){for(var v=g%s,y=g-v+Math.max(0,v-r),b=g-v+Math.min(v+r,u),w=0;y<=b;y++){var C=l[y];w+=C*C}return w}for(var h=0;h<c;h++){var p=f(h),m=l[h]*Math.pow(o+i*p,-a);d[h]=m}return en(d,n.shape)},t.prototype.LRNGrad=function(n,r,o,i,a,s,u){K(n,"LRNGrad");for(var l=n.shape[3],c=this.readSync(n.dataId),d=this.readSync(r.dataId),f=this.readSync(o.dataId),h=new Float32Array(n.size),p=n.size,m=0;m<p;m++){for(var g=m%l,v=m-g+Math.max(0,g-i),y=m-g+Math.min(l,g+i+1),b=0,w=v;w<y;w++)b+=Math.pow(d[w],2);for(b=s*b+a,w=v;w<y;w++){var C=-2*s*u*d[w]*f[m]/b;m===w&&(C+=Math.pow(b,-u)),C*=c[m],h[w]+=C}}return en(h,n.shape)},t.prototype.multinomial=function(n,r,o,i){K(n,"multinomial");for(var a=r?n:uo(n),s=a.shape[0],u=a.shape[1],l=$e([s,o],"int32"),c=this.readSync(l.dataId),d=this.readSync(a.dataId),f=0;f<s;++f){var h=f*u,p=new Float32Array(u-1);p[0]=d[h];for(var m=1;m<p.length;++m)p[m]=p[m-1]+d[h+m];for(var g=Pd(i.toString()),v=f*o,y=0;y<o;++y){var b=g();c[v+y]=p.length;for(var w=0;w<p.length;w++)if(b<p[w]){c[v+y]=w;break}}}return l},t.prototype.oneHot=function(n,r,o,i){K(n,"oneHot");var a=new Float32Array(n.size*r);a.fill(i);for(var s=this.readSync(n.dataId),u=0;u<n.size;++u)s[u]>=0&&s[u]<r&&(a[u*r+s[u]]=o);return Lo(a,[n.size,r],"int32")},t.prototype.nonMaxSuppression=function(n,r,o,i,a){return K(n,"nonMaxSuppression"),fg(this.readSync(n.dataId),this.readSync(r.dataId),o,i,a)},t.prototype.fft=function(n){return this.fftBatch(n,!1)},t.prototype.ifft=function(n){return this.fftBatch(n,!0)},t.prototype.fftBatch=function(n,r){for(var o=n.shape[0],i=n.shape[1],a=ge(n.shape,"float32"),s=ge(n.shape,"float32"),u=Un(n).as2D(o,i),l=Rr(n).as2D(o,i),c=0;c<o;c++)for(var d=u.slice([c,0],[1,i]),f=l.slice([c,0],[1,i]),h=Tt(d,f),p=this.readSync(this.fftImpl(h,r).dataId),m=0;m<i;m++){var g=ix(p,m);a.values[c*i+m]=g.real,s.values[c*i+m]=g.imag}return Tt(a.toTensor(),s.toTensor()).as2D(o,i)},t.prototype.fftImpl=function(n,r){var o=n.as1D(),i=o.size;if(this.isExponentOf2(i)){var a=this.fftRadix2(o,i,r).as2D(n.shape[0],n.shape[1]);return r&&(a=Tt(Un(a).div(Y(i)),Rr(a).div(Y(i)))),a}var s=this.readSync(n.dataId),u=function(l){for(var c=new Float32Array(l.length/2),d=new Float32Array(l.length/2),f=0;f<l.length;f+=2)c[f/2]=l[f],d[f/2]=l[f+1];return{real:c,imag:d}}(this.fourierTransformByMatmul(s,i,r));return Tt(u.real,u.imag).as2D(n.shape[0],n.shape[1])},t.prototype.isExponentOf2=function(n){return(n&n-1)==0},t.prototype.fftRadix2=function(n,r,o){if(r===1)return n;var i=this.readSync(n.dataId),a=r/2,s=function(v){for(var y=Math.ceil(v.length/4),b=new Float32Array(y),w=new Float32Array(y),C=0;C<v.length;C+=4)b[Math.floor(C/4)]=v[C],w[Math.floor(C/4)]=v[C+1];return{real:b,imag:w}}(i),u=Tt(s.real,s.imag).as1D(),l=function(v){for(var y=Math.floor(v.length/4),b=new Float32Array(y),w=new Float32Array(y),C=2;C<v.length;C+=4)b[Math.floor(C/4)]=v[C],w[Math.floor(C/4)]=v[C+1];return{real:b,imag:w}}(i),c=Tt(l.real,l.imag).as1D();u=this.fftRadix2(u,a,o),c=this.fftRadix2(c,a,o);var d=function(v,y){for(var b=new Float32Array(v/2),w=new Float32Array(v/2),C=0;C<Math.ceil(v/2);C++){var S=(y?2:-2)*Math.PI*(C/v);b[C]=Math.cos(S),w[C]=Math.sin(S)}return{real:b,imag:w}}(r,o),f=Tt(d.real,d.imag).mul(c),h=u.add(f),p=u.sub(f),m=Un(h).concat(Un(p)),g=Rr(h).concat(Rr(p));return Tt(m,g).as1D()},t.prototype.fourierTransformByMatmul=function(n,r,o){for(var i=new Float32Array(2*r),a=0;a<r;a++){for(var s=0,u=0,l=0;l<r;l++){var c=PD(a*l,r,o),d=ix(n,l);s+=d.real*c.real-d.imag*c.imag,u+=d.real*c.imag+d.imag*c.real}o&&(s/=r,u/=r),ND(i,s,u,a)}return i},t.prototype.depthToSpace=function(n,r,o){A(o==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+o}),A(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var i=n.shape[0],a=n.shape[1],s=n.shape[2],u=n.shape[3],l=a*r,c=s*r,d=u/(r*r),f=this.readSync(n.dataId),h=new Float32Array(i*l*c*d),p=0,m=0;m<i;++m)for(var g=0;g<l;++g)for(var v=Math.floor(g/r),y=g%r,b=0;b<c;++b)for(var w=Math.floor(b/r),C=(y*r+b%r)*d,S=0;S<d;++S){var E=S+C+u*(w+s*(v+a*m));h[p++]=f[E]}return en(h,[i,l,c,d])},t.prototype.broadcastedBinaryOp=function(n,r,o,i){var a=we(n.shape,r.shape),s=ge(a,o),u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=_o(n.shape,a),d=_o(r.shape,a),f=s.values;if(c.length+d.length===0)for(var h=0;h<f.length;++h)f[h]=i(u[h%u.length],l[h%l.length]);else{var p=this.bufferSync(n),m=this.bufferSync(r),g=function(v){var y=s.indexToLoc(v),b=y.slice(-n.rank);c.forEach(function(E){return b[E]=0});var w=p.locToIndex(b),C=y.slice(-r.rank);d.forEach(function(E){return C[E]=0});var S=m.locToIndex(C);f[v]=i(u[w],l[S])};for(h=0;h<f.length;++h)g(h)}return s.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(n,r,o){var i=we(n.shape,r.shape),a=ge(i,"float32"),s=ge(i,"float32"),u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=_o(n.shape,i),d=_o(r.shape,i),f=a.values,h=s.values;if(c.length+d.length===0)for(var p=0;p<f.length;p++){var m=p%u.length,g=p%l.length,v=o(u[2*m],u[2*m+1],l[2*g],l[2*g+1]);f[p]=v.real,h[p]=v.imag}else{var y=this.bufferSync(this.data.get(n.dataId).complexTensors.real),b=this.bufferSync(this.data.get(r.dataId).complexTensors.real),w=function(C){var S=a.indexToLoc(C),E=S.slice(-n.rank);c.forEach(function(I){return E[I]=0});var k=y.locToIndex(E),R=S.slice(-r.rank);d.forEach(function(I){return R[I]=0});var _=b.locToIndex(R),N=o(u[2*k],u[2*k+1],l[2*_],l[2*_+1]);f[C]=N.real,h[C]=N.imag};for(p=0;p<f.length;p++)w(p)}return this.complex(a.toTensor(),s.toTensor())},t.prototype.split=function(n,r,o){return tE(n,r,o)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(n,r,o,i,a,s){for(var u=n.shape,l=u[0],c=u[1],d=u[2],f=u[3],h=r.shape[0],p=i[0],m=i[1],g=ge([h,p,m,f],"float32"),v=this.readSync(r.dataId),y=this.readSync(o.dataId),b=this.readSync(n.dataId),w=n.strides,C=g.strides,S=0;S<h;S++){var E=4*S,k=v[E],R=v[E+1],_=v[E+2],N=v[E+3],I=y[S];if(!(I>=l))for(var L=p>1?(_-k)*(c-1)/(p-1):0,O=m>1?(N-R)*(d-1)/(m-1):0,V=0;V<p;V++){var $=p>1?k*(c-1)+V*L:.5*(k+_)*(c-1);if($<0||$>c-1)for(var U=0;U<m;U++)for(var M=0;M<f;M++){var B=M+U*C[2]+V*C[1]+S*C[0];g.values[B]=s}else if(a==="bilinear"){var z=Math.floor($),G=Math.ceil($),X=$-z;for(U=0;U<m;U++)if((he=m>1?R*(d-1)+U*O:.5*(R+N)*(d-1))<0||he>d-1)for(M=0;M<f;M++)B=M+U*C[2]+V*C[1]+S*C[0],g.values[B]=s;else{var te=Math.floor(he),ae=Math.ceil(he),ue=he-te;for(M=0;M<f;M++){var se=b[B=M+te*w[2]+z*w[1]+I*w[0]],me=b[B=M+ae*w[2]+z*w[1]+I*w[0]],xe=b[B=M+te*w[2]+G*w[1]+I*w[0]],ce=se+(me-se)*ue,Me=xe+(b[B=M+ae*w[2]+G*w[1]+I*w[0]]-xe)*ue;B=M+U*C[2]+V*C[1]+S*C[0],g.values[B]=ce+(Me-ce)*X}}}else for(U=0;U<m;++U){var he;if((he=m>1?R*(d-1)+U*O:.5*(R+N)*(d-1))<0||he>d-1)for(M=0;M<f;M++)B=M+U*C[2]+V*C[1]+S*C[0],g.values[B]=s;else{var _e=Math.round(he),Ee=Math.round($);for(M=0;M<f;M++){var Ue=M+_e*w[2]+Ee*w[1]+I*w[0],je=M+U*C[2]+V*C[1]+S*C[0];g.values[je]=b[Ue]}}}}}return g.toTensor()},t.prototype.sparseToDense=function(n,r,o,i){var a=Wc(0,n,o),s=a.sliceRank,u=a.numUpdates,l=a.sliceSize,c=a.strides,d=a.outputSize;return this.scatter(n,r,o,d,l,u,s,c,i,!1)},t.prototype.gatherND=function(n,r){var o=r.shape,i=o[o.length-1],a=HS(n,r),s=a[0],u=a[1],l=a[2],c=a[3];if(u===0)return It([],s,n.dtype);for(var d=new lu([u,l],n.dtype),f=this.readSync(r.dataId),h=this.readSync(n.dataId),p=0;p<u;p++){for(var m=[],g=0,v=0;v<i;v++){var y=f[p*i+v];g+=y*c[v],m.push(y)}if(g<0||g>=n.size/l)throw new Error("Invalid indices: "+m+" does not index into "+n.shape);for(var b=0;b<l;b++)d.values[p*l+b]=h[g*l+b]}return d.toTensor().reshape(s)},t.prototype.scatterND=function(n,r,o){var i=Wc(0,n,o),a=i.sliceRank,s=i.numUpdates,u=i.sliceSize,l=i.strides,c=i.outputSize,d=Y(0);return this.scatter(n,r,o,c,u,s,a,l,d,!0)},t.prototype.fill=function(n,r,o){var i=Dc(o=o||Au(r),ne(n));return i.fill(r),F.makeTensor(i,n,o,this)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){var r=Dc(n.dtype,ne(n.shape));return this.makeOutput(r,n.shape,n.dtype)},t.prototype.linspace=function(n,r,o){return ZS(n,r,o)},t.prototype.scatter=function(n,r,o,i,a,s,u,l,c,d){var f=[i/a,a],h=this.readSync(n.dataId),p=this.readSync(r.dataId);if(i===0)return It([],o,r.dtype);var m=new lu(f,r.dtype);m.values.fill(this.readSync(c.dataId)[0]);for(var g=0;g<s;g++){for(var v=[],y=0,b=0;b<u;b++){var w=h[g*u+b];v.push(w),y+=w*l[b]}if(y<0||y>=i/a)throw new Error("Invalid indices: "+v+" does not index into "+o);for(var C=0;C<a;C++)d?m.values[y*a+C]+=p[g*a+C]:m.values[y*a+C]=r.rank===0?p[0]:p[g*a+C]}return m.toTensor().reshape(o)},t}(YS);F.registerBackend("cpu",function(){return new J5},1);for(var Mh=0,Rx=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t,i=o.boxes,a=o.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,d=s.softNmsSigma,f=n;K(i,"NonMaxSuppressionWithScore");var h=hg(f.data.get(i.dataId).values,f.data.get(a.dataId).values,u,l,c,d);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,o=n;K(r,"square");for(var i=o.data.get(r.dataId).values,a=new Float32Array(i.length),s=0;s<i.length;++s){var u=i[s];a[s]=u*u}return{dataId:o.write(a,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:fu,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,o=r.a,i=r.b,a=n;K([o,i],fu);var s=a.data.get(o.dataId).values,u=a.data.get(i.dataId).values,l=function(f,h,p,m,g,v){var y=we(f,h),b=y.length,w=Dr(y),C=uu(g,ne(y)),S=f.length,E=h.length,k=Dr(f),R=Dr(h),_=_o(f,y),N=_o(h,y);if(_.length+N.length===0)for(var I=0;I<C.length;++I)C[I]=v(p[I%p.length],m[I%m.length]);else{var L=function(O){var V=u3(O,b,w),$=V.slice(-S);_.forEach(function(z){return $[z]=0});var U=Y1($,S,k),M=V.slice(-E);N.forEach(function(z){return M[z]=0});var B=Y1(M,E,R);C[O]=v(p[U],m[B])};for(I=0;I<C.length;++I)L(I)}return[C,y]}(o.shape,i.shape,s,u,o.dtype,function(f,h){var p=f-h;return p*p}),c=l[0],d=l[1];return{dataId:a.write(c,d,o.dtype),shape:d,dtype:o.dtype}}}];Mh<Rx.length;Mh++)ES(Rx[Mh]);var ji,Z5=function(e){this.variableNames=["A"];var t=Vt(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+n+`.0);

        vec4 values = `+t.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},eB=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=Vt(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+n+`.0);
            vec4 values = `+t.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+t.output+` = result;
      }
    `};for(var Fh=0,Tx=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.pixels,i=r.numChannels,a=typeof HTMLVideoElement<"u"&&o instanceof HTMLVideoElement,s=typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement,u=a?[o.videoWidth,o.videoHeight]:[o.width,o.height],l=u[0],c=u[1],d=[c,l],f=[c,l,i];(s||a)&&(ji==null&&(ji=document.createElement("canvas").getContext("2d")),ji.canvas.width=l,ji.canvas.height=c,ji.drawImage(o,0,0,l,c),o=ji.canvas);var h=n.makeTensorInfo(d,"int32");n.texData.get(h.dataId).usage=bn.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),o);var p=H().getBool("WEBGL_PACK")?new eB(f):new Z5(f),m=n.runWebGLProgram(p,[h],"int32");return n.disposeData(h.dataId),m}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;Bc("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var o=t,i=o.boxes,a=o.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,d=s.softNmsSigma,f=n,h=hg(f.readSync(i.dataId),f.readSync(a.dataId),u,l,c,d);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,o=n,i=new ye(r.shape,"return x * x;");return o.runWebGLProgram(i,[r],r.dtype)}},{kernelName:fu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,o=r.a,i=r.b,a=n,s=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ur("return (a - b) * (a - b);",o.shape,i.shape):new et("return (a - b) * (a - b);",o.shape,i.shape);return a.compileAndRun(s,[o,i])}}];Fh<Tx.length;Fh++)ES(Tx[Fh]);for(var Oh=0,Ax=[{kernelName:"Square",gradFunc:function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().mul(2))}}}},{kernelName:fu,gradFunc:function(e,t){var n=t[0],r=t[1],o=Y(2);return{a:function(){return Wt(e,Wt(o,xt(n,r)))},b:function(){return Wt(e,Wt(o,xt(r,n)))}}}}];Oh<Ax.length;Oh++)QP(Ax[Oh]);var tB=function(){function e(){}return e.prototype.fetch=function(t,n){return fetch(t,n)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+n);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return new TextDecoder(n).decode(t)},e}();H().get("IS_BROWSER")&&H().setPlatform("browser",new tB);var Bh,nB=function(){return require("node-fetch")},rB=function(){function e(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(t,n){return H().global.fetch!=null?H().global.fetch(t,n):(Bh==null&&(Bh=nB()),Bh(t,n))},e.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+n);return this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)},e}();H().get("IS_NODE")&&H().setPlatform("node",new rB);var xm={float32:4,int32:4,uint16:2,uint8:1,bool:1},Yc=4;function KE(e,t){for(var n={},r=0,o=function(s){var u=s.name,l=s.dtype,c=s.shape,d=ne(c),f=void 0;if("quantization"in s){var h=s.quantization;if(h.dtype!=="uint8"&&h.dtype!=="uint16")throw new Error("Weight "+s.name+" has unknown quantization dtype "+h.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var p=xm[h.dtype],m=e.slice(r,r+d*p),g=h.dtype==="uint8"?new Uint8Array(m):new Uint16Array(m);if(l==="float32")f=Float32Array.from(g,function(S){return S*h.scale+h.min});else{if(l!=="int32")throw new Error("Unsupported dtype in weight '"+u+"': "+l);f=Int32Array.from(g,function(S){return Math.round(S*h.scale+h.min)})}r+=d*p}else if(l==="string"){var v=ne(s.shape);f=[];for(var y=0;y<v;y++){var b=new Uint32Array(e.slice(r,r+Yc))[0];r+=Yc;var w=new Uint8Array(e.slice(r,r+b));f.push(w),r+=b}}else{var C=xm[l];if(m=e.slice(r,r+d*C),l==="float32")f=new Float32Array(m);else if(l==="int32")f=new Int32Array(m);else{if(l!=="bool")throw new Error("Unsupported dtype in weight '"+u+"': "+l);f=new Uint8Array(m)}r+=d*C}n[u]=It(f,c,l)},i=0,a=t;i<a.length;i++)o(a[i]);return n}function oB(e){if(e===null)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach(function(i){if(t+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+i.constructor.name)});var r=new Uint8Array(t),o=0;return n.forEach(function(i){r.set(new Uint8Array(i.buffer),o),o+=i.byteLength}),r.buffer}var bm=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function Ix(e){return bm?Buffer.byteLength(e):new Blob([e]).size}function Pg(e){var t=0;e.forEach(function(o){t+=o.byteLength});var n=new Uint8Array(t),r=0;return e.forEach(function(o){n.set(new Uint8Array(o),r),r+=o.byteLength}),n.buffer}function Nx(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function Ou(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:Ix(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:Ix(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:e.weightData.byteLength}}var wn=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t,n){return e.getHandlers(t,"load",n)},e.getHandlers=function(t,n,r){var o=[];return(n==="load"?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach(function(i){var a=i(t,r);a!==null&&o.push(a)}),o},e}(),Ea="://",jo=function(){function e(){this.managers={}}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerManager=function(t,n){A(t!=null,function(){return"scheme must not be undefined or null."}),t.endsWith(Ea)&&(t=t.slice(0,t.indexOf(Ea))),A(t.length>0,function(){return"scheme must not be an empty string."});var r=e.getInstance();A(r.managers[t]==null,function(){return"A model store manager is already registered for scheme '"+t+"'."}),r.managers[t]=n},e.getManager=function(t){var n=this.getInstance().managers[t];if(n==null)throw new Error("Cannot find model manager for scheme '"+t+"'");return n},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function Kl(e){if(e.indexOf(Ea)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+jo.getSchemes().join(","));return{scheme:e.split(Ea)[0],path:e.split(Ea)[1]}}function Px(e,t,n){return n===void 0&&(n=!1),Z(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,d;return ee(this,function(f){switch(f.label){case 0:return A(e!==t,function(){return"Old path and new path are the same: '"+e+"'"}),A((r=wn.getLoadHandlers(e)).length>0,function(){return"Copying failed because no load handler is found for source URL "+e+"."}),A(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+e+"."}),o=r[0],A((i=wn.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),A(i.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."}),a=i[0],s=Kl(e).scheme,u=Kl(e).path,l=s===Kl(e).scheme,[4,o.load()];case 1:return c=f.sent(),n&&l?[4,jo.getManager(s).removeModel(u)]:[3,3];case 2:f.sent(),f.label=3;case 3:return[4,a.save(c)];case 4:return d=f.sent(),!n||l?[3,6]:[4,jo.getManager(s).removeModel(u)];case 5:f.sent(),f.label=6;case 6:return[2,d.modelArtifactsInfo]}})})}var vi="models_store",Ro="model_info_store";function qE(){if(!H().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function wm(e){var t=e.result;t.createObjectStore(vi,{keyPath:"modelPath"}),t.createObjectStore(Ro,{keyPath:"modelPath"})}var ka=function(){function e(t){if(this.indexedDB=qE(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return e.prototype.save=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(n){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]})})},e.prototype.load=function(){return Z(this,void 0,void 0,function(){return ee(this,function(t){return[2,this.databaseAction(this.modelPath)]})})},e.prototype.databaseAction=function(t,n){var r=this;return new Promise(function(o,i){var a=r.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return wm(a)},a.onsuccess=function(){var s=a.result;if(n==null){var u=s.transaction(vi,"readonly"),l=u.objectStore(vi).get(r.modelPath);l.onsuccess=function(){if(l.result==null)return s.close(),i(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));o(l.result.modelArtifacts)},l.onerror=function(m){return s.close(),i(l.error)},u.oncomplete=function(){return s.close()}}else{var c,d=Ou(n),f=s.transaction(Ro,"readwrite"),h=f.objectStore(Ro),p=h.put({modelPath:r.modelPath,modelArtifactsInfo:d});p.onsuccess=function(){var m=(c=s.transaction(vi,"readwrite")).objectStore(vi).put({modelPath:r.modelPath,modelArtifacts:n,modelArtifactsInfo:d});m.onsuccess=function(){return o({modelArtifactsInfo:d})},m.onerror=function(g){var v=(h=f.objectStore(Ro)).delete(r.modelPath);v.onsuccess=function(){return s.close(),i(m.error)},v.onerror=function(y){return s.close(),i(m.error)}}},p.onerror=function(m){return s.close(),i(p.error)},f.oncomplete=function(){c==null?s.close():c.oncomplete=function(){return s.close()}}}},a.onerror=function(s){return i(a.error)}})},e.URL_SCHEME="indexeddb://",e}(),Dx=function(e){return H().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(ka.URL_SCHEME)?(t=e.slice(ka.URL_SCHEME.length),new ka(t)):null;var t};wn.registerSaveRouter(Dx),wn.registerLoadRouter(Dx);var iB=function(){function e(){this.indexedDB=qE()}return e.prototype.listModels=function(){return Z(this,void 0,void 0,function(){var t=this;return ee(this,function(n){return[2,new Promise(function(r,o){var i=t.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return wm(i)},i.onsuccess=function(){var a=i.result,s=a.transaction(Ro,"readonly"),u=s.objectStore(Ro).getAll();u.onsuccess=function(){for(var l={},c=0,d=u.result;c<d.length;c++){var f=d[c];l[f.modelPath]=f.modelArtifactsInfo}r(l)},u.onerror=function(l){return a.close(),o(u.error)},s.oncomplete=function(){return a.close()}},i.onerror=function(a){return o(i.error)}})]})})},e.prototype.removeModel=function(t){return Z(this,void 0,void 0,function(){var n=this;return ee(this,function(r){var o;return t=(o=t).startsWith(ka.URL_SCHEME)?o.slice(ka.URL_SCHEME.length):o,[2,new Promise(function(i,a){var s=n.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return wm(s)},s.onsuccess=function(){var u,l=s.result,c=l.transaction(Ro,"readwrite"),d=c.objectStore(Ro),f=d.get(t);f.onsuccess=function(){if(f.result==null)return l.close(),a(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var h=d.delete(t),p=function(){var m=(u=l.transaction(vi,"readwrite")).objectStore(vi).delete(t);m.onsuccess=function(){return i(f.result.modelArtifactsInfo)},m.onerror=function(g){return a(f.error)}};h.onsuccess=p,h.onerror=function(m){return p(),l.close(),a(f.error)}},f.onerror=function(h){return l.close(),a(f.error)},c.oncomplete=function(){u==null?l.close():u.oncomplete=function(){return l.close()}}},s.onerror=function(u){return a(s.error)}})]})})},e}();if(H().getBool("IS_BROWSER"))try{jo.registerManager(ka.URL_SCHEME,new iB)}catch{}var Kr="/",Qi="tensorflowjs_models",XE="info",aB="model_topology",sB="weight_specs",uB="weight_data",lB="model_metadata";function YE(e){return{info:[Qi,e,XE].join(Kr),topology:[Qi,e,aB].join(Kr),weightSpecs:[Qi,e,sB].join(Kr),weightData:[Qi,e,uB].join(Kr),modelMetadata:[Qi,e,lB].join(Kr)}}function cB(e){var t=e.split(Kr);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(Kr)}var _a=function(){function e(t){if(!H().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=YE(this.modelPath)}return e.prototype.save=function(t){return Z(this,void 0,void 0,function(){var n,r,o;return ee(this,function(i){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),o=Ou(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(o)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(a){if(bm)return Buffer.from(a).toString("base64");for(var s=new Uint8Array(a),u="",l=0,c=s.length;l<c;l++)u+=String.fromCharCode(s[l]);return btoa(u)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:o}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+o.modelTopologyBytes+", weightSpecsBytes="+o.weightSpecsBytes+", weightDataBytes="+o.weightDataBytes+".")}return[2]})})},e.prototype.load=function(){return Z(this,void 0,void 0,function(){var t,n,r,o,i,a,s;return ee(this,function(u){if((t=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(n={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(n.modelTopology=r,(o=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(n.weightSpecs=o,(i=this.LS.getItem(this.keys.modelMetadata))!=null&&(a=JSON.parse(i),n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,n.userDefinedMetadata=a.userDefinedMetadata),(s=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return n.weightData=function(l){if(bm){var c=Buffer.from(l,"base64");return c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)}for(var d=atob(l),f=new Uint8Array(d.length),h=0;h<d.length;++h)f.set([d.charCodeAt(h)],h);return f.buffer}(s),[2,n]})})},e.URL_SCHEME="localstorage://",e}(),Mx=function(e){return H().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(_a.URL_SCHEME)?(t=e.slice(_a.URL_SCHEME.length),new _a(t)):null;var t};wn.registerSaveRouter(Mx),wn.registerLoadRouter(Mx);var dB=function(){function e(){A(H().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),A(typeof window>"u"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return e.prototype.listModels=function(){return Z(this,void 0,void 0,function(){var t,n,r,o,i,a;return ee(this,function(s){for(t={},n=Qi+Kr,r=Kr+XE,o=0;o<this.LS.length;++o)(i=this.LS.key(o)).startsWith(n)&&i.endsWith(r)&&(a=cB(i),t[a]=JSON.parse(this.LS.getItem(i)));return[2,t]})})},e.prototype.removeModel=function(t){return Z(this,void 0,void 0,function(){var n,r;return ee(this,function(o){var i;if(t=(i=t).startsWith(_a.URL_SCHEME)?i.slice(_a.URL_SCHEME.length):i,n=YE(t),this.LS.getItem(n.info)==null)throw new Error("Cannot find model at path '"+t+"'");return r=JSON.parse(this.LS.getItem(n.info)),this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),[2,r]})})},e}();if(H().getBool("IS_BROWSER"))try{jo.registerManager(_a.URL_SCHEME,new dB)}catch{}var fB="model",hB=".json",pB=".weights.bin";function Fx(e){return new Promise(function(t){return setTimeout(t)}).then(e)}var Lh=function(){function e(t){if(!H().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),t!=null&&t.length!==0||(t=fB),this.modelTopologyFileName=t+hB,this.weightDataFileName=t+pB}return e.prototype.save=function(t){return Z(this,void 0,void 0,function(){var n,r,o,i,a,s;return ee(this,function(u){switch(u.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],o={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},i=window.URL.createObjectURL(new Blob([JSON.stringify(o)],{type:"application/json"})),(a=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,a.href=i,[4,Fx(function(){return a.dispatchEvent(new MouseEvent("click"))})];case 2:return u.sent(),t.weightData==null?[3,4]:((s=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,[4,Fx(function(){return s.dispatchEvent(new MouseEvent("click"))})]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:Ou(t)}]}})})},e.URL_SCHEME="downloads://",e}(),mB=function(){function e(t){if(t==null||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return e.prototype.load=function(){return Z(this,void 0,void 0,function(){var t,n,r=this;return ee(this,function(o){return t=this.files[0],n=this.files.slice(1),[2,new Promise(function(i,a){var s=new FileReader;s.onload=function(u){var l=JSON.parse(u.target.result),c=l.modelTopology;if(c!=null){n.length===0&&i({modelTopology:c});var d=l.weightsManifest;if(d!=null){var f;try{f=r.checkManifestAndWeightFiles(d,n)}catch(g){return void a(g)}var h=[],p=[],m=[];d.forEach(function(g){g.paths.forEach(function(v){p.push(v),m.push(null)}),h.push.apply(h,g.weights)}),d.forEach(function(g){g.paths.forEach(function(v){var y=new FileReader;y.onload=function(b){var w=b.target.result,C=p.indexOf(v);m[C]=w,m.indexOf(null)===-1&&i({modelTopology:c,weightSpecs:h,weightData:Pg(m),format:l.format,generatedBy:l.generatedBy,convertedBy:l.convertedBy,userDefinedMetadata:l.userDefinedMetadata})},y.onerror=function(b){return a("Failed to weights data from file of path '"+v+"'.")},y.readAsArrayBuffer(f[v])})})}else a(new Error("weightManifest field is missing from file "+t.name))}else a(new Error("modelTopology field is missing from file "+t.name))},s.onerror=function(u){return a("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},s.readAsText(t)})]})})},e.prototype.checkManifestAndWeightFiles=function(t,n){for(var r=[],o=n.map(function(u){return Nx(u.name)}),i={},a=0,s=t;a<s.length;a++)s[a].paths.forEach(function(u){var l=Nx(u);if(r.indexOf(l)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+l+"'");if(r.push(l),o.indexOf(l)===-1)throw new Error("Weight file with basename '"+l+"' is not provided.");i[u]=n[o.indexOf(l)]});if(r.length!==n.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+n.length+").");return i},e}();function Ox(e,t,n,r){(function(i){A(i!=null&&Array.isArray(i)&&i.length>0,function(){return"promises must be a none empty array"})})(e),function(i,a){A(i>=0&&i<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+i}),A(a>=0&&a<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+a}),A(a>=i,function(){return"startFraction must be no more than endFraction, but got startFraction "+i+" and endFraction "+a})}(n=n??0,r=r??1);var o=0;return Promise.all(e.map(function(i){return i.then(function(a){var s=n+ ++o/e.length*(r-n);return t(s),a}),i}))}function QE(e,t){return Z(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c;return ee(this,function(d){switch(d.label){case 0:return t==null&&(t={}),n=t.fetchFunc==null?H().platform.fetch:t.fetchFunc,r=e.map(function(f){return n(f,t.requestInit,{isBinary:!0})}),o=0,i=.5,t.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return a=d.sent(),[3,4];case 2:return[4,Ox(r,t.onProgress,o,i)];case 3:a=d.sent(),d.label=4;case 4:return s=a.map(function(f){return f.arrayBuffer()}),u=.5,l=1,t.onProgress!=null?[3,6]:[4,Promise.all(s)];case 5:return c=d.sent(),[3,8];case 6:return[4,Ox(s,t.onProgress,u,l)];case 7:c=d.sent(),d.label=8;case 8:return[2,c]}})})}function Bx(e){var t=this;return function(n,r,o){return r===void 0&&(r=""),Z(t,void 0,void 0,function(){var i,a,s,u,l,c,d,f,h,p;return ee(this,function(m){switch(m.label){case 0:if(i=n.map(function(){return!1}),a={},s=o!=null?o.map(function(){return!1}):[],u=[],n.forEach(function(g,v){var y=0;g.weights.forEach(function(b){var w="quantization"in b?b.quantization.dtype:b.dtype,C=xm[w]*ne(b.shape),S=function(){i[v]=!0,a[v]==null&&(a[v]=[]),a[v].push({manifestEntry:b,groupOffset:y,sizeBytes:C})};o!=null?o.forEach(function(E,k){E===b.name&&(S(),s[k]=!0)}):S(),u.push(b.name),y+=C})}),!s.every(function(g){return g}))throw l=o.filter(function(g,v){return!s[v]}),new Error("Could not find weights in manifest with names: "+l.join(", ")+`. 
Manifest JSON has weights with names: `+u.join(", ")+".");return c=i.reduce(function(g,v,y){return v&&g.push(y),g},[]),d=[],c.forEach(function(g){n[g].paths.forEach(function(v){var y=r+(r.endsWith("/")?"":"/")+v;d.push(y)})}),[4,e(d)];case 1:return f=m.sent(),h={},p=0,c.forEach(function(g){for(var v=n[g].paths.length,y=0,b=0;b<v;b++)y+=f[p+b].byteLength;for(var w=new ArrayBuffer(y),C=new Uint8Array(w),S=0,E=0;E<v;E++){var k=new Uint8Array(f[p+E]);C.set(k,S),S+=k.byteLength}a[g].forEach(function(R){var _=KE(w.slice(R.groupOffset,R.groupOffset+R.sizeBytes),[R.manifestEntry]);for(var N in _)h[N]=_[N]}),p+=v}),[2,h]}})})}}wn.registerSaveRouter(function(e){return H().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Lh.URL_SCHEME)?function(t){return t===void 0&&(t="model"),new Lh(t)}(e.slice(Lh.URL_SCHEME.length)):null});var JE=function(){function e(t,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,n.fetchFunc!=null?(A(typeof n.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=n.fetchFunc):this.fetch=H().platform.fetch,A(t!=null&&t.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(t)&&A(t.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."}),this.path=t,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return e.prototype.save=function(t){return Z(this,void 0,void 0,function(){var n,r,o,i;return ee(this,function(a){switch(a.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],o={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:r},n.body.append("model.json",new Blob([JSON.stringify(o)],{type:"application/json"}),"model.json"),t.weightData!=null&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,n)];case 1:if((i=a.sent()).ok)return[2,{modelArtifactsInfo:Ou(t),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}})})},e.prototype.load=function(){return Z(this,void 0,void 0,function(){var t,n,r,o,i,a,s,u,l,c,d,f;return ee(this,function(h){switch(h.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=h.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");h.label=2;case 2:return h.trys.push([2,4,,5]),[4,t.json()];case 3:return n=h.sent(),[3,5];case 4:throw h.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(o=n.modelTopology,i=n.weightsManifest,a=n.generatedBy,s=n.convertedBy,u=n.format,l=n.userDefinedMetadata,o==null&&i==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return i==null?[3,7]:[4,this.loadWeights(i)];case 6:f=h.sent(),c=f[0],d=f[1],h.label=7;case 7:return[2,{modelTopology:o,weightSpecs:c,weightData:d,userDefinedMetadata:l,generatedBy:a,convertedBy:s,format:u}]}})})},e.prototype.loadWeights=function(t){return Z(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,d,f;return ee(this,function(h){switch(h.label){case 0:for(n=Array.isArray(this.path)?this.path[1]:this.path,r=function(p){var m=p.lastIndexOf("/"),g=p.lastIndexOf("?"),v=p.substring(0,m),y=g>m?p.substring(g):"";return[v+"/",y]}(n),o=r[0],i=r[1],a=this.weightPathPrefix||o,s=[],u=0,l=t;u<l.length;u++)c=l[u],s.push.apply(s,c.weights);return d=[],t.forEach(function(p){p.paths.forEach(function(m){d.push(a+m+i)})}),[4,QE(d,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return f=h.sent(),[2,[s,Pg(f)]]}})})},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function Cm(e){return e.match(JE.URL_SCHEME_REGEX)!=null}var Lx=function(e,t){return typeof fetch>"u"?null:(Array.isArray(e)?e.every(function(n){return Cm(n)}):Cm(e))?Sm(e,{onProgress:t}):null};function Sm(e,t){return new JE(e,t)}wn.registerSaveRouter(Lx),wn.registerLoadRouter(Lx);var jh=function(){function e(t){this.modelArtifacts=t}return e.prototype.load=function(){return Z(this,void 0,void 0,function(){return ee(this,function(t){return[2,this.modelArtifacts]})})},e}(),vB=function(){function e(t){this.saveHandler=t}return e.prototype.save=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(n){return[2,this.saveHandler(t)]})})},e}(),ZE=Object.freeze({browserFiles:function(e){return new mB(e)},browserHTTPRequest:function(e,t){return Sm(e,t)},concatenateArrayBuffers:Pg,decodeWeights:KE,encodeWeights:function(e,t){return Z(this,void 0,void 0,function(){var n,r,o,i,a,s=this;return ee(this,function(u){switch(u.label){case 0:for(n=[],r=[],o=Array.isArray(e)?e.map(function(l){return l.name}):Object.keys(e),i=function(l){var c=o[l],d=Array.isArray(e)?e[l].tensor:e[c];if(d.dtype!=="float32"&&d.dtype!=="int32"&&d.dtype!=="bool"&&d.dtype!=="string")throw new Error("Unsupported dtype in weight '"+c+"': "+d.dtype);var f={name:c,shape:d.shape,dtype:d.dtype};if(d.dtype==="string"){var h=new Promise(function(p){return Z(s,void 0,void 0,function(){var m,g,v,y,b,w,C;return ee(this,function(S){switch(S.label){case 0:return[4,d.bytes()];case 1:for(m=S.sent(),g=m.reduce(function(E,k){return E+k.length},0)+Yc*m.length,v=new Uint8Array(g),y=0,b=0;b<m.length;b++)w=m[b],C=new Uint8Array(new Uint32Array([w.length]).buffer),v.set(C,y),y+=Yc,v.set(w,y),y+=w.length;return p(v),[2]}})})});r.push(h)}else r.push(d.data());t!=null&&(f.group=t),n.push(f)},a=0;a<o.length;++a)i(a);return[4,Promise.all(r)];case 1:return[2,{data:oB(u.sent()),specs:n}]}})})},fromMemory:function(e,t,n,r){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new jh(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new jh({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new jh({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))},getLoadHandlers:function(e,t){return wn.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:Ou,getSaveHandlers:function(e){return wn.getSaveHandlers(e)},http:Sm,isHTTPScheme:Cm,loadWeights:function(e,t,n,r){return t===void 0&&(t=""),Z(this,void 0,void 0,function(){return ee(this,function(o){return[2,Bx(function(i){return QE(i,{requestInit:r})})(e,t,n)]})})},registerLoadRouter:function(e){return wn.registerLoadRouter(e)},registerSaveRouter:function(e){return wn.registerSaveRouter(e)},weightsLoaderFactory:Bx,withSaveHandler:function(e){return new vB(e)},copyModel:function(e,t){return Z(this,void 0,void 0,function(){return ee(this,function(n){return[2,Px(e,t,!1)]})})},listModels:function(){return Z(this,void 0,void 0,function(){var e,t,n,r,o,i,a;return ee(this,function(s){switch(s.label){case 0:e=jo.getSchemes(),t={},n=0,r=e,s.label=1;case 1:return n<r.length?(o=r[n],[4,jo.getManager(o).listModels()]):[3,4];case 2:for(a in i=s.sent())t[o+Ea+a]=i[a];s.label=3;case 3:return n++,[3,1];case 4:return[2,t]}})})},moveModel:function(e,t){return Z(this,void 0,void 0,function(){return ee(this,function(n){return[2,Px(e,t,!0)]})})},removeModel:function(e){return Z(this,void 0,void 0,function(){var t;return ee(this,function(n){return t=Kl(e),[2,jo.getManager(t.scheme).removeModel(t.path)]})})}}),zi;D({confusionMatrix_:function(e,t,n){var r=T(e,"labels","confusionMatrix"),o=T(t,"predictions","confusionMatrix");A(n==null||n>0&&Number.isInteger(n),function(){return"If provided, numClasses must be a positive integer, but got "+n}),A(r.rank===1,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),A(o.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+o.rank}),A(r.shape[0]===o.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+o.shape[0]+". Labels and predictions should have the same number of elements."}),A(n>0&&Number.isInteger(n),function(){return"numClasses is required to be a positive integer, but got "+n});var i=pm(r.asType("int32"),n),a=pm(o.asType("int32"),n);return i.transpose().matMul(a).asType("int32")}});var gB=D({fromPixels_:function(e,t){if(t===void 0&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,o=!1,i=!1,a=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)o=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)i=!0;else{if(e.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);a=!0}if(o&&o&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(SS("FromPixels",F.backendName)!=null)return F.runKernel("FromPixels",{pixels:e},{numChannels:t});var s,u,l=o?[e.videoWidth,e.videoHeight]:[e.width,e.height],c=l[0],d=l[1];if(a?s=e.getContext("2d").getImageData(0,0,c,d).data:r||n?s=e.data:(i||o)&&(zi==null&&(zi=document.createElement("canvas").getContext("2d")),zi.canvas.width=c,zi.canvas.height=d,zi.drawImage(e,0,0,c,d),s=zi.getImageData(0,0,c,d).data),t===4)u=new Int32Array(s);else{var f=c*d;u=new Int32Array(f*t);for(var h=0;h<f;h++)for(var p=0;p<t;++p)u[h*t+p]=s[4*h+p]}return sg(u,[d,c,t],"int32")}}),Dg=Object.freeze({toPixels:function(e,t){return Z(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,d,f,h,p,m,g,v,y,b,w,C,S,E,k;return ee(this,function(R){switch(R.label){case 0:if(n=T(e,"img","toPixels"),e instanceof qe||(n=n.toInt()),n.rank!==2&&n.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),o=r[0],i=r[1],(a=n.rank===2?1:n.shape[2])>4||a===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+a);return[4,n.data()];case 1:return s=R.sent(),u=n.min(),l=n.max(),[4,Promise.all([u.data(),l.data()])];case 2:if(c=R.sent(),d=c[0],f=c[1],h=d[0],p=f[0],u.dispose(),l.dispose(),n.dtype==="float32"){if(h<0||p>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+h+" - "+p+"].")}else{if(n.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(h<0||p>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+h+" - "+p+"].")}for(m=n.dtype==="float32"?255:1,g=new Uint8ClampedArray(i*o*4),v=0;v<o*i;++v)y=void 0,b=void 0,w=void 0,C=void 0,a===1?(y=s[v]*m,b=s[v]*m,w=s[v]*m,C=255):a===3?(y=s[3*v]*m,b=s[3*v+1]*m,w=s[3*v+2]*m,C=255):a===4&&(y=s[4*v]*m,b=s[4*v+1]*m,w=s[4*v+2]*m,C=s[4*v+3]*m),g[(S=4*v)+0]=Math.round(y),g[S+1]=Math.round(b),g[S+2]=Math.round(w),g[S+3]=Math.round(C);return t!=null&&(t.width=i,t.height=o,E=t.getContext("2d"),k=new ImageData(g,i,o),E.putImageData(k,0,0)),n!==e&&n.dispose(),[2,g]}})})},fromPixels:gB}),yB=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(t,n){return new t(n)},e}(),xB=function(){function e(){this.classNameMap={}}return e.getMap=function(){return e.instance==null&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function Fi(e){A(e.className!=null,function(){return"Class being registered does not have the static className property defined."}),A(typeof e.className=="string",function(){return"className is required to be a string, but got type "+typeof e.className}),A(e.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),xB.register(e)}var Oi=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return pr(t,e),t.prototype.minimize=function(n,r,o){r===void 0&&(r=!1);var i=this.computeGradients(n,o),a=i.value,s=i.grads;if(o!=null){var u=o.map(function(l){return{name:l.name,tensor:s[l.name]}});this.applyGradients(u)}else this.applyGradients(s);return ln(s),r?a:(a.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(n,r){return AD(n,r)},t.prototype.dispose=function(){this.iterations_!=null&&ln(this.iterations_)},t.prototype.saveIterations=function(){return Z(this,void 0,void 0,function(){return ee(this,function(n){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:Y(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return Z(this,void 0,void 0,function(){return ee(this,function(n){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(n){return Z(this,void 0,void 0,function(){return ee(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(n){return Z(this,void 0,void 0,function(){var r;return ee(this,function(o){switch(o.label){case 0:return r=this,[4,n[0].tensor.data()];case 1:return r.iterations_=o.sent()[0],[2,n.slice(1)]}})})},t}(yB);Object.defineProperty(Oi,Symbol.hasInstance,{value:function(e){return e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null}});var bB=function(e){function t(n,r,o){o===void 0&&(o=null);var i=e.call(this)||this;return i.learningRate=n,i.rho=r,i.epsilon=o,i.accumulatedGrads=[],i.accumulatedUpdates=[],o==null&&(i.epsilon=F.backend.epsilon()),i}return pr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=F.registeredVariables[o];r.accumulatedGrads[i]==null&&(r.accumulatedGrads[i]={originalName:o+"/accum_grad",variable:Q(function(){return Se(a).variable(!1)})}),r.accumulatedUpdates[i]==null&&(r.accumulatedUpdates[i]={originalName:o+"/accum_var",variable:Q(function(){return Se(a).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var u=r.accumulatedGrads[i].variable,l=r.accumulatedUpdates[i].variable;Q(function(){var c=u.mul(r.rho).add(s.square().mul(1-r.rho)),d=l.add(r.epsilon).sqrt().div(u.add(r.epsilon).sqrt()).mul(s),f=l.mul(r.rho).add(d.square().mul(1-r.rho));u.assign(c),l.assign(f);var h=d.mul(-r.learningRate).add(a);a.assign(h)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedUpdates!=null&&(ln(this.accumulatedGrads.map(function(n){return n.variable})),ln(this.accumulatedUpdates.map(function(n){return n.variable})))},t.prototype.getWeights=function(){return Z(this,void 0,void 0,function(){var n;return ee(this,function(r){switch(r.label){case 0:return n=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},t.prototype.setWeights=function(n){return Z(this,void 0,void 0,function(){var r;return ee(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(n)];case 1:return n=o.sent(),r=n.length/2,this.accumulatedGrads=n.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedUpdates=n.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.rho,r.epsilon)},t.className="Adadelta",t}(Oi);Fi(bB);var wB=function(e){function t(n,r){r===void 0&&(r=.1);var o=e.call(this)||this;return o.learningRate=n,o.initialAccumulatorValue=r,o.accumulatedGrads=[],o}return pr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=F.registeredVariables[o];r.accumulatedGrads[i]==null&&(r.accumulatedGrads[i]={originalName:o+"/accumulator",variable:Q(function(){return Mr(a.shape,r.initialAccumulatorValue).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var u=r.accumulatedGrads[i].variable;Q(function(){var l=u.add(s.square());u.assign(l);var c=s.div(l.add(F.backend.epsilon()).sqrt()).mul(-r.learningRate).add(a);a.assign(c)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedGrads!=null&&ln(this.accumulatedGrads.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return Z(this,void 0,void 0,function(){return ee(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return Z(this,void 0,void 0,function(){return ee(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulatedGrads=n.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(n,r){return new n(r.learningRate,r.initialAccumulatorValue)},t.className="Adagrad",t}(Oi);Fi(wB);var CB=function(e){function t(n,r,o,i){i===void 0&&(i=null);var a=e.call(this)||this;return a.learningRate=n,a.beta1=r,a.beta2=o,a.epsilon=i,a.accumulatedFirstMoment=[],a.accumulatedSecondMoment=[],Q(function(){a.accBeta1=Y(r).variable(),a.accBeta2=Y(o).variable()}),i==null&&(a.epsilon=F.backend.epsilon()),a}return pr(t,e),t.prototype.applyGradients=function(n){var r=this,o=Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n);Q(function(){var i=xt(1,r.accBeta1),a=xt(1,r.accBeta2);o.forEach(function(s,u){var l=F.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:Q(function(){return Se(l).variable(!1)})}),r.accumulatedSecondMoment[u]==null&&(r.accumulatedSecondMoment[u]={originalName:s+"/v",variable:Q(function(){return Se(l).variable(!1)})});var c=Array.isArray(n)?n[u].tensor:n[s];if(c!=null){var d=r.accumulatedFirstMoment[u].variable,f=r.accumulatedSecondMoment[u].variable,h=d.mul(r.beta1).add(c.mul(1-r.beta1)),p=f.mul(r.beta2).add(c.square().mul(1-r.beta2)),m=h.div(i),g=p.div(a);d.assign(h),f.assign(p);var v=m.div(g.sqrt().add(r.epsilon)).mul(-r.learningRate).add(l);l.assign(v)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&ln(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedSecondMoment!=null&&ln(this.accumulatedSecondMoment.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return Z(this,void 0,void 0,function(){var n;return ee(this,function(r){switch(r.label){case 0:return n=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},t.prototype.setWeights=function(n){return Z(this,void 0,void 0,function(){var r,o=this;return ee(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(n)];case 1:return n=i.sent(),Q(function(){o.accBeta1.assign(qc(o.beta1,o.iterations_+1)),o.accBeta2.assign(qc(o.beta2,o.iterations_+1))}),r=n.length/2,this.accumulatedFirstMoment=n.slice(0,r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedSecondMoment=n.slice(r,2*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon)},t.className="Adam",t}(Oi);Fi(CB);var SB=function(e){function t(n,r,o,i,a){i===void 0&&(i=null),a===void 0&&(a=0);var s=e.call(this)||this;return s.learningRate=n,s.beta1=r,s.beta2=o,s.epsilon=i,s.decay=a,s.accumulatedFirstMoment=[],s.accumulatedWeightedInfNorm=[],Q(function(){s.iteration=Y(0).variable(),s.accBeta1=Y(r).variable()}),i==null&&(s.epsilon=F.backend.epsilon()),s}return pr(t,e),t.prototype.applyGradients=function(n){var r=this,o=Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n);Q(function(){var i=xt(1,r.accBeta1),a=sr(-r.learningRate,r.iteration.mul(r.decay).add(1));o.forEach(function(s,u){var l=F.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:Se(l).variable(!1)}),r.accumulatedWeightedInfNorm[u]==null&&(r.accumulatedWeightedInfNorm[u]={originalName:s+"/v",variable:Se(l).variable(!1)});var c=Array.isArray(n)?n[u].tensor:n[s];if(c!=null){var d=r.accumulatedFirstMoment[u].variable,f=r.accumulatedWeightedInfNorm[u].variable,h=d.mul(r.beta1).add(c.mul(1-r.beta1)),p=f.mul(r.beta2),m=c.abs(),g=p.maximum(m);d.assign(h),f.assign(g);var v=a.div(i).mul(h.div(g.add(r.epsilon))).add(l);l.assign(v)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&ln(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedWeightedInfNorm!=null&&ln(this.accumulatedWeightedInfNorm.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return Z(this,void 0,void 0,function(){return ee(this,function(n){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(n){return Z(this,void 0,void 0,function(){return ee(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},t.className="Adamax",t}(Oi);Fi(SB);var ek=function(e){function t(n){var r=e.call(this)||this;return r.learningRate=n,r.setLearningRate(n),r}return pr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=Array.isArray(n)?n[i].tensor:n[o];if(a!=null){var s=F.registeredVariables[o];Q(function(){var u=r.c.mul(a).add(s);s.assign(u)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(n){this.learningRate=n,this.c!=null&&this.c.dispose(),this.c=W3(Y(-n))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return Z(this,void 0,void 0,function(){return ee(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()]]}})})},t.prototype.setWeights=function(n){return Z(this,void 0,void 0,function(){return ee(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:if((n=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(n,r){return new n(r.learningRate)},t.className="SGD",t}(Oi);Fi(ek);var EB=function(e){function t(n,r,o){o===void 0&&(o=!1);var i=e.call(this,n)||this;return i.learningRate=n,i.momentum=r,i.useNesterov=o,i.accumulations=[],i.m=Y(i.momentum),i}return pr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=F.registeredVariables[o];r.accumulations[i]==null&&(r.accumulations[i]={originalName:o+"/momentum",variable:Q(function(){return Se(a).variable(!1)})});var s=r.accumulations[i].variable,u=Array.isArray(n)?n[i].tensor:n[o];u!=null&&Q(function(){var l,c=r.m.mul(s).add(u);l=r.useNesterov?r.c.mul(u.add(c.mul(r.m))).add(a):r.c.mul(c).add(a),s.assign(c),a.assign(l)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&ln(this.accumulations.map(function(n){return n.variable}))},t.prototype.setMomentum=function(n){this.momentum=n},t.prototype.getWeights=function(){return Z(this,void 0,void 0,function(){return ee(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return Z(this,void 0,void 0,function(){return ee(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulations=n.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(n,r){return new n(r.learningRate,r.momentum,r.useNesterov)},t.className="Momentum",t}(ek);Fi(EB);var kB=function(e){function t(n,r,o,i,a){r===void 0&&(r=.9),o===void 0&&(o=0),i===void 0&&(i=null),a===void 0&&(a=!1);var s=e.call(this)||this;if(s.learningRate=n,s.decay=r,s.momentum=o,s.epsilon=i,s.accumulatedMeanSquares=[],s.accumulatedMoments=[],s.accumulatedMeanGrads=[],s.centered=a,i==null&&(s.epsilon=F.backend.epsilon()),n==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return s}return pr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=F.registeredVariables[o];r.accumulatedMeanSquares[i]==null&&(r.accumulatedMeanSquares[i]={originalName:o+"/rms",variable:Q(function(){return Se(a).variable(!1)})}),r.accumulatedMoments[i]==null&&(r.accumulatedMoments[i]={originalName:o+"/momentum",variable:Q(function(){return Se(a).variable(!1)})}),r.accumulatedMeanGrads[i]==null&&r.centered&&(r.accumulatedMeanGrads[i]={originalName:o+"/mg",variable:Q(function(){return Se(a).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var u=r.accumulatedMeanSquares[i].variable,l=r.accumulatedMoments[i].variable;Q(function(){var c=u.mul(r.decay).add(s.square().mul(1-r.decay));if(r.centered){var d=r.accumulatedMeanGrads[i].variable,f=d.mul(r.decay).add(s.mul(1-r.decay)),h=l.mul(r.momentum).add(s.mul(r.learningRate).div(c.sub(f.square().add(r.epsilon)).sqrt()));u.assign(c),d.assign(f),l.assign(h);var p=a.sub(h);a.assign(p)}else{var m=u.mul(r.decay).add(s.square().mul(1-r.decay));h=l.mul(r.momentum).add(s.mul(r.learningRate).div(m.add(r.epsilon).sqrt())),u.assign(m),l.assign(h),p=a.sub(h),a.assign(p)}})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&ln(this.accumulatedMeanSquares.map(function(n){return n.variable})),this.accumulatedMeanGrads!=null&&this.centered&&ln(this.accumulatedMeanGrads.map(function(n){return n.variable})),this.accumulatedMoments!=null&&ln(this.accumulatedMoments.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return Z(this,void 0,void 0,function(){var n;return ee(this,function(r){switch(r.label){case 0:return n=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&n.push.apply(n,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},t.prototype.setWeights=function(n){return Z(this,void 0,void 0,function(){var r;return ee(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(n)];case 1:return n=o.sent(),r=this.centered?n.length/3:n.length/2,this.accumulatedMeanSquares=n.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedMoments=n.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=n.slice(2*r,3*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(n,r){return new n(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},t.className="RMSProp",t}(Oi);Fi(kB);qe.prototype.squaredDifference=function(e){return mE(this,e)},W=Q5;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Em=function(e,t){return Em=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r.hasOwnProperty(o)&&(n[o]=r[o])},Em(e,t)};function pe(e,t){Em(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var zt=function(){return zt=Object.assign||function(t){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},zt.apply(this,arguments)};function oe(e,t,n,r){function o(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function s(c){try{l(r.next(c))}catch(d){a(d)}}function u(c){try{l(r.throw(c))}catch(d){a(d)}}function l(c){c.done?i(c.value):o(c.value).then(s,u)}l((r=r.apply(e,t||[])).next())})}function ie(e,t){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,o,i,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(l){return function(c){return u([l,c])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,o&&(i=l[0]&2?o.return:l[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,l[1])).done)return i;switch(o=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,o=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){n.label=l[1];break}if(l[0]===6&&n.label<i[1]){n.label=i[1],i=l;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(l);break}i[2]&&n.ops.pop(),n.trys.pop();continue}l=t.call(e,n)}catch(c){l=[6,c],o=0}finally{r=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Ls(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),o=0,t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}var Ra=function(){function e(t,n){if(!bi(t)||!bi(n))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:t,height:n}));this._width=t,this._height=n}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),e.prototype.reverse=function(){return new e(1/this.width,1/this.height)},e}();function zd(e,t){return e instanceof qe&&e.shape.length===t}function _B(e){return zd(e,2)}function Vd(e){return zd(e,3)}function zo(e){return zd(e,4)}function RB(e){return e%1!==0}function jx(e){return e%2===0}function TB(e,t){t===void 0&&(t=2);var n=Math.pow(10,t);return Math.floor(e*n)/n}function zx(e){return e&&e.width&&e.height}function AB(e,t){var n=e.width,r=e.height,o=t/Math.max(r,n);return new Ra(Math.round(n*o),Math.round(r*o))}function Mg(e){return e.reduce(function(t,n){return t.add(n)},new Ae(0,0)).div(new Ae(e.length,e.length))}function hu(e,t,n){return Array(e).fill(0).map(function(r,o){return t+o*n})}function bi(e){return!!e&&e!==1/0&&e!==-1/0&&!isNaN(e)||e===0}function Vx(e){return bi(e)&&0<=e&&e<=1}var Ae=function(){function e(t,n){this._x=t,this._y=n}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.sub=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.mul=function(t){return new e(this.x*t.x,this.y*t.y)},e.prototype.div=function(t){return new e(this.x/t.x,this.y/t.y)},e.prototype.abs=function(){return new e(Math.abs(this.x),Math.abs(this.y))},e.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},e.prototype.floor=function(){return new e(Math.floor(this.x),Math.floor(this.y))},e}(),Go=function(){function e(t,n){n===void 0&&(n=!0);var r=t||{},o=[r.left,r.top,r.right,r.bottom].every(bi),i=[r.x,r.y,r.width,r.height].every(bi);if(!i&&!o)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var a=i?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],s=a[0],u=a[1],l=a[2],c=a[3];e.assertIsValidBox({x:s,y:u,width:l,height:c},"Box.constructor",n),this._x=s,this._y=u,this._width=l,this._height=c}return e.isRect=function(t){return!!t&&[t.x,t.y,t.width,t.height].every(bi)},e.assertIsValidBox=function(t,n,r){if(r===void 0&&(r=!1),!e.isRect(t))throw new Error(n+" - invalid box: "+JSON.stringify(t)+", expected object with properties x, y, width, height");if(!r&&(t.width<0||t.height<0))throw new Error(n+" - width ("+t.width+") and height ("+t.height+") must be positive numbers")},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topLeft",{get:function(){return new Ae(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topRight",{get:function(){return new Ae(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomLeft",{get:function(){return new Ae(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomRight",{get:function(){return new Ae(this.right,this.bottom)},enumerable:!0,configurable:!0}),e.prototype.round=function(){var t=[this.x,this.y,this.width,this.height].map(function(a){return Math.round(a)}),n=t[0],r=t[1],o=t[2],i=t[3];return new e({x:n,y:r,width:o,height:i})},e.prototype.floor=function(){var t=[this.x,this.y,this.width,this.height].map(function(a){return Math.floor(a)}),n=t[0],r=t[1],o=t[2],i=t[3];return new e({x:n,y:r,width:o,height:i})},e.prototype.toSquare=function(){var t=this,n=t.x,r=t.y,o=t.width,i=t.height,a=Math.abs(o-i);return o<i&&(n-=a/2,o+=a),i<o&&(r-=a/2,i+=a),new e({x:n,y:r,width:o,height:i})},e.prototype.rescale=function(t){var n=zx(t)?t.width:t,r=zx(t)?t.height:t;return new e({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})},e.prototype.pad=function(t,n){var r=[this.x-t/2,this.y-n/2,this.width+t,this.height+n],o=r[0],i=r[1],a=r[2],s=r[3];return new e({x:o,y:i,width:a,height:s})},e.prototype.clipAtImageBorders=function(t,n){var r=this,o=r.x,i=r.y,a=r.right,s=r.bottom,u=Math.max(o,0),l=Math.max(i,0),c=a-u,d=s-l,f=Math.min(c,t-u),h=Math.min(d,n-l);return new e({x:u,y:l,width:f,height:h}).floor()},e.prototype.shift=function(t,n){var r=this,o=r.width,i=r.height,a=this.x+t,s=this.y+n;return new e({x:a,y:s,width:o,height:i})},e.prototype.padAtBorders=function(t,n){var r=this.width+1,o=this.height+1,i=1,a=1,s=r,u=o,l=this.left,c=this.top,d=this.right,f=this.bottom;return d>n&&(s=-d+n+r,d=n),f>t&&(u=-f+t+o,f=t),l<1&&(u=2-l,l=1),c<1&&(u=2-c,c=1),{dy:a,edy:u,dx:i,edx:s,y:c,ey:f,x:l,ex:d,w:r,h:o}},e.prototype.calibrate=function(t){return new e({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()},e}(),$d=function(e){pe(t,e);function t(n,r,o,i,a){return a===void 0&&(a=!1),e.call(this,{left:n,top:r,right:o,bottom:i},a)||this}return t}(Go),tk=function(){function e(t,n,r,o,i){this._imageDims=new Ra(i.width,i.height),this._score=t,this._classScore=n,this._className=r,this._box=new Go(o).rescale(this._imageDims)}return Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativeBox",{get:function(){return new Go(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new e(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:n})},e}(),Vr=function(e){pe(t,e);function t(n,r,o){return e.call(this,n,n,"",r,o)||this}return t.prototype.forSize=function(n,r){var o=e.prototype.forSize.call(this,n,r),i=o.score,a=o.relativeBox,s=o.imageDims;return new t(i,a,s)},t}(tk);function IB(e,t,n){n===void 0&&(n=!0);var r=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left)),o=Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),i=r*o;return n?i/(e.area+t.area-i):i/Math.min(e.area,t.area)}function NB(e){var t=e.map(function(s){return s.x}),n=e.map(function(s){return s.y}),r=t.reduce(function(s,u){return u<s?u:s},1/0),o=n.reduce(function(s,u){return u<s?u:s},1/0),i=t.reduce(function(s,u){return s<u?u:s},0),a=n.reduce(function(s,u){return s<u?u:s},0);return new $d(r,o,i,a)}function pu(e,t,n,r){r===void 0&&(r=!0);for(var o=t.map(function(s,u){return{score:s,boxIndex:u}}).sort(function(s,u){return s.score-u.score}).map(function(s){return s.boxIndex}),i=[],a=function(){var s=o.pop();i.push(s);for(var u=o,l=[],c=0;c<u.length;c++){var d=u[c],f=e[s],h=e[d];l.push(IB(f,h,r))}o=o.filter(function(p,m){return l[m]<=n})};o.length>0;)a();return i}function Bu(e,t){return Q(function(){var n=t[0],r=t[1],o=t[2],i=Mr(Ls(e.shape.slice(0,3),[1]),n),a=Mr(Ls(e.shape.slice(0,3),[1]),r),s=Mr(Ls(e.shape.slice(0,3),[1]),o),u=vt([i,a,s],3);return xt(e,u)})}function PB(e,t){return t===void 0&&(t=!1),Q(function(){var n=e.shape.slice(1),r=n[0],o=n[1];if(r===o)return e;var i=Math.abs(r-o),a=Math.round(i*(t?.5:1)),s=r>o?2:1,u=function(h){var p=e.shape.slice();return p[s]=h,Mr(p,0)},l=u(a),c=i-l.shape[s],d=t&&c?u(c):null,f=[d,e,l].filter(function(h){return!!h}).map(function(h){return h.toFloat()});return vt(f,s)})}function zh(e){return 1/(1+Math.exp(-e))}var Fg=function(e){pe(t,e);function t(n,r,o,i,a){return a===void 0&&(a=!1),e.call(this,{x:n,y:r,width:o,height:i},a)||this}return t}(Go),DB=.5,MB=.43,FB=.45,Qc=function(){function e(t,n,r){r===void 0&&(r=new Ae(0,0));var o=n.width,i=n.height;this._imgDims=new Ra(o,i),this._shift=r,this._positions=t.map(function(a){return a.mul(new Ae(o,i)).add(r)})}return Object.defineProperty(e.prototype,"shift",{get:function(){return new Ae(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativePositions",{get:function(){var t=this;return this._positions.map(function(n){return n.sub(t._shift).div(new Ae(t.imageWidth,t.imageHeight))})},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new this.constructor(this.relativePositions,{width:t,height:n})},e.prototype.shiftBy=function(t,n){return new this.constructor(this.relativePositions,this._imgDims,new Ae(t,n))},e.prototype.shiftByPoint=function(t){return this.shiftBy(t.x,t.y)},e.prototype.align=function(t,n){if(n===void 0&&(n={}),t){var r=t instanceof Vr?t.box.floor():new Go(t);return this.shiftBy(r.x,r.y).align(null,n)}var o=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},n),i=o.useDlibAlignment,a=o.minBoxPadding;return i?this.alignDlib():this.alignMinBbox(a)},e.prototype.alignDlib=function(){var t=this.getRefPointsForAlignment(),n=t[0],r=t[1],o=t[2],i=function(d){return o.sub(d).magnitude()},a=(i(n)+i(r))/2,s=Math.floor(a/FB),u=Mg(t),l=Math.floor(Math.max(0,u.x-DB*s)),c=Math.floor(Math.max(0,u.y-MB*s));return new Fg(l,c,Math.min(s,this.imageWidth+l),Math.min(s,this.imageHeight+c))},e.prototype.alignMinBbox=function(t){var n=NB(this.positions);return n.pad(n.width*t,n.height*t)},e.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},e}(),OB=function(e){pe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getRefPointsForAlignment=function(){var n=this.positions;return[n[0],n[1],Mg([n[3],n[4]])]},t}(Qc),BB=function(e){pe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getJawOutline=function(){return this.positions.slice(0,17)},t.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},t.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},t.prototype.getNose=function(){return this.positions.slice(27,36)},t.prototype.getLeftEye=function(){return this.positions.slice(36,42)},t.prototype.getRightEye=function(){return this.positions.slice(42,48)},t.prototype.getMouth=function(){return this.positions.slice(48,68)},t.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(Mg)},t}(Qc),$x=function(){function e(t,n){this._label=t,this._distance=n}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),e.prototype.toString=function(t){return t===void 0&&(t=!0),""+this.label+(t?" ("+TB(this.distance)+")":"")},e}(),Wx=function(e){pe(t,e);function t(n,r){var o=e.call(this,n)||this;return o._label=r,o}return t.assertIsValidLabeledBox=function(n,r){if(Go.assertIsValidBox(n,r),!bi(n.label))throw new Error(r+" - expected property label ("+n.label+") to be a number")},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t}(Go),Sl=function(){function e(t,n){if(typeof t!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(n)||n.some(function(r){return!(r instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=t,this._descriptors=n}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(t){return Array.from(t)})}},e.fromJSON=function(t){var n=t.descriptors.map(function(r){return new Float32Array(r)});return new e(t.label,n)},e}();(function(e){pe(t,e);function t(n,r,o,i){var a=e.call(this,n,r)||this;return a._score=o,a._classScore=i,a}return t.assertIsValidPredictedBox=function(n,r){if(Wx.assertIsValidLabeledBox(n,r),!Vx(n.score)||!Vx(n.classScore))throw new Error(r+" - expected properties score ("+n.score+") and ("+n.classScore+") to be a number between [0, 1]")},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),t})(Wx);function LB(e){return e.detection instanceof Vr}function Og(e,t){var n={detection:t};return Object.assign({},e,n)}function nk(){var e=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},t=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:e,readFile:t}}function rk(e){var t="";if(!e)try{e=require("fs")}catch(r){t=r.toString()}var n=e?function(r){return new Promise(function(o,i){e.readFile(r,function(a,s){return a?i(a):o(s)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)};return{readFile:n}}function ok(){var e=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,n=function(){if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},r=function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},o=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},i=rk();return zt({Canvas:e||function(){function a(){}return a}(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||function(){function a(){}return a}(),Image:t||function(){function a(){}return a}(),ImageData:global.ImageData||function(){function a(){}return a}(),Video:global.HTMLVideoElement||function(){function a(){}return a}(),createCanvasElement:n,createImageElement:r,fetch:o},i)}function ik(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function ak(){return typeof global=="object"&&typeof require=="function"&&typeof U_<"u"&&typeof process<"u"&&!!process.version}var ht;function jB(){if(!ht)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return ht}function km(e){ht=e}function Bg(){ik()&&km(nk()),ak()&&km(ok())}function zB(e){if(ht||Bg(),!ht)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=e.Canvas,n=t===void 0?ht.Canvas:t,r=e.Image,o=r===void 0?ht.Image:r;ht.Canvas=n,ht.Image=o,ht.createCanvasElement=e.createCanvasElement||function(){return new n},ht.createImageElement=e.createImageElement||function(){return new o},ht.ImageData=e.ImageData||ht.ImageData,ht.Video=e.Video||ht.Video,ht.fetch=e.fetch||ht.fetch,ht.readFile=e.readFile||ht.readFile}var Ht={getEnv:jB,setEnv:km,initialize:Bg,createBrowserEnv:nk,createFileSystem:rk,createNodejsEnv:ok,monkeyPatch:zB,isBrowser:ik,isNodejs:ak};Bg();function sk(e){return!Ht.isNodejs()&&typeof e=="string"?document.getElementById(e):e}function Ri(e){var t=Ht.getEnv(),n=t.Canvas,r=t.CanvasRenderingContext2D;if(e instanceof r)return e;var o=sk(e);if(!(o instanceof n))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var i=o.getContext("2d");if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}var Ux;(function(e){e.TOP_LEFT="TOP_LEFT",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT"})(Ux||(Ux={}));function uk(e){var t=Ht.getEnv(),n=t.Image,r=t.Video;return e instanceof n&&e.complete||e instanceof r&&e.readyState>=3}function VB(e){return new Promise(function(t,n){if(e instanceof Ht.getEnv().Canvas||uk(e))return t();function r(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",o),t(i))}function o(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",o),n(i))}e.addEventListener("load",r),e.addEventListener("error",o)})}function lk(e){var t=Ht.getEnv(),n=t.Image,r=t.Video;return e instanceof n?new Ra(e.naturalWidth,e.naturalHeight):e instanceof r?new Ra(e.videoWidth,e.videoHeight):new Ra(e.width,e.height)}function Wd(e){var t=e.width,n=e.height,r=Ht.getEnv().createCanvasElement,o=r();return o.width=t,o.height=n,o}function Lg(e,t){var n=Ht.getEnv().ImageData;if(!(e instanceof n)&&!uk(e))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=t||lk(e),o=r.width,i=r.height,a=Wd({width:o,height:i});return e instanceof n?Ri(a).putImageData(e,0,0):Ri(a).drawImage(e,0,0,o,i),a}function $B(e,t){return oe(this,void 0,void 0,function(){var n,r,o,i,a,s;return ie(this,function(u){switch(u.label){case 0:return n=t||Ht.getEnv().createCanvasElement(),r=e.shape.slice(zo(e)?1:0),o=r[0],i=r[1],a=r[2],s=Q(function(){return e.as3D(o,i,a).toInt()}),[4,Dg.toPixels(s,n)];case 1:return u.sent(),s.dispose(),[2,n]}})})}function Hx(e){var t=Ht.getEnv(),n=t.Image,r=t.Canvas,o=t.Video;return e instanceof n||e instanceof r||e instanceof o}function WB(e,t,n){n===void 0&&(n=!1);var r=Ht.getEnv(),o=r.Image,i=r.Canvas;if(!(e instanceof o||e instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var a=lk(e),s=t/Math.max(a.height,a.width),u=s*a.width,l=s*a.height,c=Wd({width:t,height:t}),d=e instanceof i?e:Lg(e),f=Math.abs(u-l)/2,h=n&&u<l?f:0,p=n&&l<u?f:0;return Ri(c).drawImage(d,h,p,u,l),c}var Jc=function(){function e(t,n){var r=this;if(n===void 0&&(n=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(t))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+t);this._treatAsBatchInput=n,this._batchSize=t.length,t.forEach(function(o,i){if(Vd(o)){r._imageTensors[i]=o,r._inputDimensions[i]=o.shape;return}if(zo(o)){var a=o.shape[0];if(a!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+a+" passed, but not supported in input array");r._imageTensors[i]=o,r._inputDimensions[i]=o.shape.slice(1);return}var s=o instanceof Ht.getEnv().Canvas?o:Lg(o);r._canvases[i]=s,r._inputDimensions[i]=[s.height,s.width,3]})}return Object.defineProperty(e.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reshapedInputDimensions",{get:function(){var t=this;return hu(this.batchSize,0,1).map(function(n,r){return t.getReshapedInputDimensions(r)})},enumerable:!0,configurable:!0}),e.prototype.getInput=function(t){return this.canvases[t]||this.imageTensors[t]},e.prototype.getInputDimensions=function(t){return this._inputDimensions[t]},e.prototype.getInputHeight=function(t){return this._inputDimensions[t][0]},e.prototype.getInputWidth=function(t){return this._inputDimensions[t][1]},e.prototype.getReshapedInputDimensions=function(t){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var n=this.getInputWidth(t),r=this.getInputHeight(t);return AB({width:n,height:r},this.inputSize)},e.prototype.toBatchTensor=function(t,n){var r=this;return n===void 0&&(n=!0),this._inputSize=t,Q(function(){var o=hu(r.batchSize,0,1).map(function(a){var s=r.getInput(a);if(s instanceof qe){var u=zo(s)?s:s.expandDims();return u=PB(u,n),(u.shape[1]!==t||u.shape[2]!==t)&&(u=Rg.resizeBilinear(u,[t,t])),u.as3D(t,t,3)}if(s instanceof Ht.getEnv().Canvas)return Dg.fromPixels(WB(s,t,n));throw new Error("toBatchTensor - at batchIdx "+a+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+s)}),i=En(o.map(function(a){return a.toFloat()})).as4D(r.batchSize,t,t,3);return i})},e}();function kt(e){return oe(this,void 0,void 0,function(){var t,n,r;return ie(this,function(o){switch(o.label){case 0:if(e instanceof Jc)return[2,e];if(t=Array.isArray(e)?e:[e],!t.length)throw new Error("toNetInput - empty array passed as input");return n=function(i){return Array.isArray(e)?" at input index "+i+":":""},r=t.map(sk),r.forEach(function(i,a){if(!Hx(i)&&!Vd(i)&&!zo(i))throw typeof t[a]=="string"?new Error("toNetInput -"+n(a)+" string passed, but could not resolve HTMLElement for element id "+t[a]):new Error("toNetInput -"+n(a)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(zo(i)){var s=i.shape[0];if(s!==1)throw new Error("toNetInput -"+n(a)+" tf.Tensor4D with batchSize "+s+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(i){return Hx(i)&&VB(i)}))];case 1:return o.sent(),[2,new Jc(r,Array.isArray(e))]}})})}function jg(e,t){return oe(this,void 0,void 0,function(){var n,r,o,i,a,s,u;return ie(this,function(l){switch(l.label){case 0:return n=Ht.getEnv().Canvas,r=e,e instanceof n?[3,5]:[4,kt(e)];case 1:if(o=l.sent(),o.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return i=o.getInput(0),i instanceof n?(a=i,[3,4]):[3,2];case 2:return[4,$B(i)];case 3:a=l.sent(),l.label=4;case 4:r=a,l.label=5;case 5:return s=Ri(r),u=t.map(function(c){return c instanceof Vr?c.forSize(r.width,r.height).box.floor():c}).map(function(c){return c.clipAtImageBorders(r.width,r.height)}),[2,u.map(function(c){var d=c.x,f=c.y,h=c.width,p=c.height,m=Wd({width:h,height:p});return Ri(m).putImageData(s.getImageData(d,f,h,p),0,0),m})]}})})}function zg(e,t){return oe(this,void 0,void 0,function(){return ie(this,function(n){if(!Vd(e)&&!zo(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(zo(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,Q(function(){var r=e.shape.slice(zo(e)?1:0),o=r[0],i=r[1],a=r[2],s=t.map(function(l){return l instanceof Vr?l.forSize(i,o).box:l}).map(function(l){return l.clipAtImageBorders(i,o)}),u=s.map(function(l){var c=l.x,d=l.y,f=l.width,h=l.height;return OE(e.as3D(o,i,a),[d,c,0],[h,f,a])});return u})]})})}function UB(e,t){return oe(this,void 0,void 0,function(){var n,r;return ie(this,function(o){switch(o.label){case 0:return n=Ht.getEnv().fetch,[4,n(e,t)];case 1:if(r=o.sent(),!(r.status<400))throw new Error("failed to fetch: ("+r.status+") "+r.statusText+", from url: "+r.url);return[2,r]}})})}function HB(e){return oe(this,void 0,void 0,function(){return ie(this,function(t){switch(t.label){case 0:return[4,UB(e)];case 1:return[2,t.sent().json()]}})})}function ck(e,t){var n=t+"-weights_manifest.json";if(!e)return{modelBaseUri:"",manifestUri:n};if(e==="/")return{modelBaseUri:"/",manifestUri:"/"+n};var r=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"";e=e.replace(r,"");var o=e.split("/").filter(function(s){return s}),i=e.endsWith(".json")?o[o.length-1]:n,a=r+(e.endsWith(".json")?o.slice(0,o.length-1):o).join("/");return a=e.startsWith("/")?"/"+a:a,{modelBaseUri:a,manifestUri:a==="/"?"/"+i:a+"/"+i}}function GB(e,t){return oe(this,void 0,void 0,function(){var n,r,o,i;return ie(this,function(a){switch(a.label){case 0:return n=ck(e,t),r=n.manifestUri,o=n.modelBaseUri,[4,HB(r)];case 1:return i=a.sent(),[2,ZE.loadWeights(i,o)]}})})}var co=function(){function e(t){this._name=t,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(e.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),e.prototype.getParamFromPath=function(t){var n=this.traversePropertyPath(t),r=n.obj,o=n.objProp;return r[o]},e.prototype.reassignParamFromPath=function(t,n){var r=this.traversePropertyPath(t),o=r.obj,i=r.objProp;o[i].dispose(),o[i]=n},e.prototype.getParamList=function(){var t=this;return this._paramMappings.map(function(n){var r=n.paramPath;return{path:r,tensor:t.getParamFromPath(r)}})},e.prototype.getTrainableParams=function(){return this.getParamList().filter(function(t){return t.tensor instanceof Va})},e.prototype.getFrozenParams=function(){return this.getParamList().filter(function(t){return!(t.tensor instanceof Va)})},e.prototype.variable=function(){var t=this;this.getFrozenParams().forEach(function(n){var r=n.path,o=n.tensor;t.reassignParamFromPath(r,o.variable())})},e.prototype.freeze=function(){var t=this;this.getTrainableParams().forEach(function(n){var r=n.path,o=n.tensor,i=It(o.dataSync());o.dispose(),t.reassignParamFromPath(r,i)})},e.prototype.dispose=function(t){t===void 0&&(t=!0),this.getParamList().forEach(function(n){if(t&&n.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+n.path);n.tensor.dispose()}),this._params=void 0},e.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(t){var n=t.tensor;return Array.from(n.dataSync())}).reduce(function(t,n){return t.concat(n)}))},e.prototype.load=function(t){return oe(this,void 0,void 0,function(){return ie(this,function(n){switch(n.label){case 0:return t instanceof Float32Array?(this.extractWeights(t),[2]):[4,this.loadFromUri(t)];case 1:return n.sent(),[2]}})})},e.prototype.loadFromUri=function(t){return oe(this,void 0,void 0,function(){var n;return ie(this,function(r){switch(r.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,GB(t,this.getDefaultModelName())];case 1:return n=r.sent(),this.loadFromWeightMap(n),[2]}})})},e.prototype.loadFromDisk=function(t){return oe(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,d;return ie(this,function(f){switch(f.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return n=Ht.getEnv().readFile,r=ck(t,this.getDefaultModelName()),o=r.manifestUri,i=r.modelBaseUri,a=function(h){return Promise.all(h.map(function(p){return n(p).then(function(m){return m.buffer})}))},s=ZE.weightsLoaderFactory(a),c=(l=JSON).parse,[4,n(o)];case 1:return u=c.apply(l,[f.sent().toString()]),[4,s(u,i)];case 2:return d=f.sent(),this.loadFromWeightMap(d),[2]}})})},e.prototype.loadFromWeightMap=function(t){var n=this.extractParamsFromWeigthMap(t),r=n.paramMappings,o=n.params;this._paramMappings=r,this._params=o},e.prototype.extractWeights=function(t){var n=this.extractParams(t),r=n.paramMappings,o=n.params;this._paramMappings=r,this._params=o},e.prototype.traversePropertyPath=function(t){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var n=t.split("/").reduce(function(i,a){if(!i.nextObj.hasOwnProperty(a))throw new Error("traversePropertyPath - object does not have property "+a+", for path "+t);return{obj:i.nextObj,objProp:a,nextObj:i.nextObj[a]}},{nextObj:this.params}),r=n.obj,o=n.objProp;if(!r||!o||!(r[o]instanceof qe))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+t);return{obj:r,objProp:o}},e}();function Cn(e,t,n){return Q(function(){var r=Cg(e,t.depthwise_filter,t.pointwise_filter,n,"same");return r=be(r,t.bias),r})}function Vh(e,t,n){return n===void 0&&(n=!1),Q(function(){var r=Ye(n?be(Jn(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):Cn(e,t.conv0,[2,2])),o=Cn(r,t.conv1,[1,1]),i=Ye(be(r,o)),a=Cn(i,t.conv2,[1,1]);return Ye(be(r,be(o,a)))})}function El(e,t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!0),Q(function(){var o=Ye(n?be(Jn(e,t.conv0.filters,r?[2,2]:[1,1],"same"),t.conv0.bias):Cn(e,t.conv0,r?[2,2]:[1,1])),i=Cn(o,t.conv1,[1,1]),a=Ye(be(o,i)),s=Cn(a,t.conv2,[1,1]),u=Ye(be(o,be(i,s))),l=Cn(u,t.conv3,[1,1]);return Ye(be(o,be(i,be(s,l))))})}function dr(e,t,n,r){return n===void 0&&(n="same"),r===void 0&&(r=!1),Q(function(){var o=be(Jn(e,t.filters,[1,1],n),t.bias);return r?Ye(o):o})}function fo(e,t){Object.keys(e).forEach(function(n){t.some(function(r){return r.originalPath===n})||e[n].dispose()})}function Ud(e,t){return function(n,r,o,i){var a=en(e(n*r*o*o),[o,o,n,r]),s=ft(e(r));return t.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:a,bias:s}}}function Vg(e,t){return function(n,r,o){var i=Lo(e(n*r),[n,r]),a=ft(e(r));return t.push({paramPath:o+"/weights"},{paramPath:o+"/bias"}),{weights:i,bias:a}}}var dk=function(){function e(t,n,r){this.depthwise_filter=t,this.pointwise_filter=n,this.bias=r}return e}();function $g(e,t){return function(n,r,o){var i=en(e(9*n),[3,3,n,1]),a=en(e(n*r),[1,1,n,r]),s=ft(e(r));return t.push({paramPath:o+"/depthwise_filter"},{paramPath:o+"/pointwise_filter"},{paramPath:o+"/bias"}),new dk(i,a,s)}}function Wg(e){return function(t){var n=e(t+"/depthwise_filter",4),r=e(t+"/pointwise_filter",4),o=e(t+"/bias",1);return new dk(n,r,o)}}function ei(e,t){return function(n,r,o){var i=e[n];if(!zd(i,r))throw new Error("expected weightMap["+n+"] to be a Tensor"+r+"D, instead have "+i);return t.push({originalPath:n,paramPath:o||n}),i}}function ho(e){var t=e;function n(o){var i=t.slice(0,o);return t=t.slice(o),i}function r(){return t}return{extractWeights:n,getRemainingWeights:r}}function fk(e,t){var n=Ud(e,t),r=$g(e,t);function o(a,s,u,l){l===void 0&&(l=!1);var c=l?n(a,s,3,u+"/conv0"):r(a,s,u+"/conv0"),d=r(s,s,u+"/conv1"),f=r(s,s,u+"/conv2");return{conv0:c,conv1:d,conv2:f}}function i(a,s,u,l){l===void 0&&(l=!1);var c=o(a,s,u,l),d=c.conv0,f=c.conv1,h=c.conv2,p=r(s,s,u+"/conv3");return{conv0:d,conv1:f,conv2:h,conv3:p}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:i}}function KB(e){var t=[],n=ho(e),r=n.extractWeights,o=n.getRemainingWeights,i=fk(r,t).extractDenseBlock4Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2"),l=i(128,256,"dense3");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{dense0:a,dense1:s,dense2:u,dense3:l}}}function hk(e){return function(t){var n=e(t+"/filters",4),r=e(t+"/bias",1);return{filters:n,bias:r}}}function pk(e,t){var n=ei(e,t),r=hk(n),o=Wg(n);function i(s,u){u===void 0&&(u=!1);var l=u?r(s+"/conv0"):o(s+"/conv0"),c=o(s+"/conv1"),d=o(s+"/conv2");return{conv0:l,conv1:c,conv2:d}}function a(s,u){u===void 0&&(u=!1);var l=u?r(s+"/conv0"):o(s+"/conv0"),c=o(s+"/conv1"),d=o(s+"/conv2"),f=o(s+"/conv3");return{conv0:l,conv1:c,conv2:d,conv3:f}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:a}}function qB(e){var t=[],n=pk(e,t).extractDenseBlock4Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return fo(e,t),{params:r,paramMappings:t}}var mk=function(e){pe(t,e);function t(){return e.call(this,"FaceFeatureExtractor")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceFeatureExtractor - load model before inference");return Q(function(){var o=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],a=Bu(o,i).div(Y(255)),s=El(a,r.dense0,!0);return s=El(s,r.dense1),s=El(s,r.dense2),s=El(s,r.dense3),s=Fu(s,[7,7],[2,2],"valid"),s})},t.prototype.forward=function(n){return oe(this,void 0,void 0,function(){var r;return ie(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,kt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},t.prototype.extractParamsFromWeigthMap=function(n){return qB(n)},t.prototype.extractParams=function(n){return KB(n)},t}(co);function Tr(e,t){return Q(function(){return be(Bd(e,t.weights),t.bias)})}function XB(e,t,n){var r=[],o=ho(e),i=o.extractWeights,a=o.getRemainingWeights,s=Vg(i,r),u=s(t,n,"fc");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:r,params:{fc:u}}}function YB(e){var t=[],n=ei(e,t);function r(i){var a=n(i+"/weights",2),s=n(i+"/bias",1);return{weights:a,bias:s}}var o={fc:r("fc")};return fo(e,t),{params:o,paramMappings:t}}function vk(e){var t={},n={};return Object.keys(e).forEach(function(r){var o=r.startsWith("fc")?n:t;o[r]=e[r]}),{featureExtractorMap:t,classifierMap:n}}var gk=function(e){pe(t,e);function t(n,r){var o=e.call(this,n)||this;return o._faceFeatureExtractor=r,o}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(n){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return Q(function(){var i=n instanceof Jc?r.faceFeatureExtractor.forwardInput(n):n;return Tr(i.as2D(i.shape[0],-1),o.fc)})},t.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),e.prototype.dispose.call(this,n)},t.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),o=r.params,i=r.paramMappings;this._params=o,this._paramMappings=i},t.prototype.extractClassifierParams=function(n){return XB(n,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},t.prototype.extractParamsFromWeigthMap=function(n){var r=vk(n),o=r.featureExtractorMap,i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(o),YB(i)},t.prototype.extractParams=function(n){var r=this.getClassifierChannelsIn(),o=this.getClassifierChannelsOut(),i=o*r+o,a=n.slice(0,n.length-i),s=n.slice(n.length-i);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(s)},t}(co),Gx=["neutral","happy","sad","angry","fearful","disgusted","surprised"],QB=function(){function e(t){var n=this;if(t.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+t.length);Gx.forEach(function(r,o){n[r]=t[o]})}return e.prototype.asSortedArray=function(){var t=this;return Gx.map(function(n){return{expression:n,probability:t[n]}}).sort(function(n,r){return r.probability-n.probability})},e}(),JB=function(e){pe(t,e);function t(n){return n===void 0&&(n=new mk),e.call(this,"FaceExpressionNet",n)||this}return t.prototype.forwardInput=function(n){var r=this;return Q(function(){return uo(r.runNet(n))})},t.prototype.forward=function(n){return oe(this,void 0,void 0,function(){var r;return ie(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,kt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.predictExpressions=function(n){return oe(this,void 0,void 0,function(){var r,o,i,a,s=this;return ie(this,function(u){switch(u.label){case 0:return[4,kt(n)];case 1:return r=u.sent(),[4,this.forwardInput(r)];case 2:return o=u.sent(),[4,Promise.all(gt(o).map(function(l){return oe(s,void 0,void 0,function(){var c;return ie(this,function(d){switch(d.label){case 0:return[4,l.data()];case 1:return c=d.sent(),l.dispose(),[2,c]}})})}))];case 3:return i=u.sent(),o.dispose(),a=i.map(function(l){return new QB(l)}),[2,r.isBatchInput?a:a[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_expression_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t.prototype.getClassifierChannelsOut=function(){return 7},t}(gk);function yk(e,t){var n={expressions:t};return Object.assign({},e,n)}function ZB(e){return LB(e)&&e.landmarks instanceof Qc&&e.unshiftedLandmarks instanceof Qc&&e.alignedRect instanceof Vr}function Ug(e,t){var n=e.detection.box,r=t.shiftBy(n.x,n.y),o=r.align(),i=e.detection.imageDims,a=new Vr(e.detection.score,o.rescale(i.reverse()),i),s={landmarks:r,unshiftedLandmarks:t,alignedRect:a};return Object.assign({},e,s)}function eL(e,t){var n=Ud(e,t),r=$g(e,t);function o(a,s,u){var l=r(a,s,u+"/separable_conv0"),c=r(s,s,u+"/separable_conv1"),d=n(a,s,1,u+"/expansion_conv");return{separable_conv0:l,separable_conv1:c,expansion_conv:d}}function i(a,s){var u=r(a,a,s+"/separable_conv0"),l=r(a,a,s+"/separable_conv1"),c=r(a,a,s+"/separable_conv2");return{separable_conv0:u,separable_conv1:l,separable_conv2:c}}return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:o,extractMainBlockParams:i}}function tL(e,t){var n=[],r=ho(e),o=r.extractWeights,i=r.getRemainingWeights,a=eL(o,n),s=a.extractConvParams,u=a.extractSeparableConvParams,l=a.extractReductionBlockParams,c=a.extractMainBlockParams,d=s(3,32,3,"entry_flow/conv_in"),f=l(32,64,"entry_flow/reduction_block_0"),h=l(64,128,"entry_flow/reduction_block_1"),p={conv_in:d,reduction_block_0:f,reduction_block_1:h},m={};hu(t,0,1).forEach(function(b){m["main_block_"+b]=c(128,"middle_flow/main_block_"+b)});var g=l(128,256,"exit_flow/reduction_block"),v=u(256,512,"exit_flow/separable_conv"),y={reduction_block:g,separable_conv:v};if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:n,params:{entry_flow:p,middle_flow:m,exit_flow:y}}}function nL(e,t){var n=ei(e,t),r=hk(n),o=Wg(n);function i(s){var u=o(s+"/separable_conv0"),l=o(s+"/separable_conv1"),c=r(s+"/expansion_conv");return{separable_conv0:u,separable_conv1:l,expansion_conv:c}}function a(s){var u=o(s+"/separable_conv0"),l=o(s+"/separable_conv1"),c=o(s+"/separable_conv2");return{separable_conv0:u,separable_conv1:l,separable_conv2:c}}return{extractConvParams:r,extractSeparableConvParams:o,extractReductionBlockParams:i,extractMainBlockParams:a}}function rL(e,t){var n=[],r=nL(e,n),o=r.extractConvParams,i=r.extractSeparableConvParams,a=r.extractReductionBlockParams,s=r.extractMainBlockParams,u=o("entry_flow/conv_in"),l=a("entry_flow/reduction_block_0"),c=a("entry_flow/reduction_block_1"),d={conv_in:u,reduction_block_0:l,reduction_block_1:c},f={};hu(t,0,1).forEach(function(g){f["main_block_"+g]=s("middle_flow/main_block_"+g)});var h=a("exit_flow/reduction_block"),p=i("exit_flow/separable_conv"),m={reduction_block:h,separable_conv:p};return fo(e,n),{params:{entry_flow:d,middle_flow:f,exit_flow:m},paramMappings:n}}function xk(e,t,n){return be(Jn(e,t.filters,n,"same"),t.bias)}function $h(e,t,n){n===void 0&&(n=!0);var r=n?Ye(e):e;return r=Cn(r,t.separable_conv0,[1,1]),r=Cn(Ye(r),t.separable_conv1,[1,1]),r=wt(r,[3,3],[2,2],"same"),r=be(r,xk(e,t.expansion_conv,[2,2])),r}function oL(e,t){var n=Cn(Ye(e),t.separable_conv0,[1,1]);return n=Cn(Ye(n),t.separable_conv1,[1,1]),n=Cn(Ye(n),t.separable_conv2,[1,1]),n=be(n,e),n}var iL=function(e){pe(t,e);function t(n){var r=e.call(this,"TinyXception")||this;return r._numMainBlocks=n,r}return t.prototype.forwardInput=function(n){var r=this,o=this.params;if(!o)throw new Error("TinyXception - load model before inference");return Q(function(){var i=n.toBatchTensor(112,!0),a=[122.782,117.001,104.298],s=Bu(i,a).div(Y(256)),u=Ye(xk(s,o.entry_flow.conv_in,[2,2]));return u=$h(u,o.entry_flow.reduction_block_0,!1),u=$h(u,o.entry_flow.reduction_block_1),hu(r._numMainBlocks,0,1).forEach(function(l){u=oL(u,o.middle_flow["main_block_"+l])}),u=$h(u,o.exit_flow.reduction_block),u=Ye(Cn(u,o.exit_flow.separable_conv,[1,1])),u})},t.prototype.forward=function(n){return oe(this,void 0,void 0,function(){var r;return ie(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,kt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"tiny_xception_model"},t.prototype.extractParamsFromWeigthMap=function(n){return rL(n,this._numMainBlocks)},t.prototype.extractParams=function(n){return tL(n,this._numMainBlocks)},t}(co);function aL(e){var t=[],n=ho(e),r=n.extractWeights,o=n.getRemainingWeights,i=Vg(r,t),a=i(512,1,"fc/age"),s=i(512,2,"fc/gender");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{fc:{age:a,gender:s}}}}function sL(e){var t=[],n=ei(e,t);function r(i){var a=n(i+"/weights",2),s=n(i+"/bias",1);return{weights:a,bias:s}}var o={fc:{age:r("fc/age"),gender:r("fc/gender")}};return fo(e,t),{params:o,paramMappings:t}}var Zc;(function(e){e.FEMALE="female",e.MALE="male"})(Zc||(Zc={}));var uL=function(e){pe(t,e);function t(n){n===void 0&&(n=new iL(2));var r=e.call(this,"AgeGenderNet")||this;return r._faceFeatureExtractor=n,r}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(n){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return Q(function(){var i=n instanceof Jc?r.faceFeatureExtractor.forwardInput(n):n,a=Fu(i,[7,7],[2,2],"valid").as2D(i.shape[0],-1),s=Tr(a,o.fc.age).as1D(),u=Tr(a,o.fc.gender);return{age:s,gender:u}})},t.prototype.forwardInput=function(n){var r=this;return Q(function(){var o=r.runNet(n),i=o.age,a=o.gender;return{age:i,gender:uo(a)}})},t.prototype.forward=function(n){return oe(this,void 0,void 0,function(){var r;return ie(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,kt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.predictAgeAndGender=function(n){return oe(this,void 0,void 0,function(){var r,o,i,a,s,u,l=this;return ie(this,function(c){switch(c.label){case 0:return[4,kt(n)];case 1:return r=c.sent(),[4,this.forwardInput(r)];case 2:return o=c.sent(),i=gt(o.age),a=gt(o.gender),s=i.map(function(d,f){return{ageTensor:d,genderTensor:a[f]}}),[4,Promise.all(s.map(function(d){var f=d.ageTensor,h=d.genderTensor;return oe(l,void 0,void 0,function(){var p,m,g,v,y;return ie(this,function(b){switch(b.label){case 0:return[4,f.data()];case 1:return p=b.sent()[0],[4,h.data()];case 2:return m=b.sent()[0],g=m>.5,v=g?Zc.MALE:Zc.FEMALE,y=g?m:1-m,f.dispose(),h.dispose(),[2,{age:p,gender:v,genderProbability:y}]}})})}))];case 3:return u=c.sent(),o.age.dispose(),o.gender.dispose(),[2,r.isBatchInput?u:u[0]]}})})},t.prototype.getDefaultModelName=function(){return"age_gender_model"},t.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),e.prototype.dispose.call(this,n)},t.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),o=r.params,i=r.paramMappings;this._params=o,this._paramMappings=i},t.prototype.extractClassifierParams=function(n){return aL(n)},t.prototype.extractParamsFromWeigthMap=function(n){var r=vk(n),o=r.featureExtractorMap,i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(o),sL(i)},t.prototype.extractParams=function(n){var r=1539,o=n.slice(0,n.length-r),i=n.slice(n.length-r);return this.faceFeatureExtractor.extractWeights(o),this.extractClassifierParams(i)},t}(co),bk=function(e){pe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.postProcess=function(n,r,o){var i=o.map(function(s){var u=s.width,l=s.height,c=r/Math.max(l,u);return{width:u*c,height:l*c}}),a=i.length;return Q(function(){var s=function(f,h){return En([Mr([68],f),Mr([68],h)],1).as2D(1,136).as1D()},u=function(f,h){var p=i[f],m=p.width,g=p.height;return h(m,g)?Math.abs(m-g)/2:0},l=function(f){return u(f,function(h,p){return h<p})},c=function(f){return u(f,function(h,p){return p<h})},d=n.mul(Mr([a,136],r)).sub(En(Array.from(Array(a),function(f,h){return s(l(h),c(h))}))).div(En(Array.from(Array(a),function(f,h){return s(i[h].width,i[h].height)})));return d})},t.prototype.forwardInput=function(n){var r=this;return Q(function(){var o=r.runNet(n);return r.postProcess(o,n.inputSize,n.inputDimensions.map(function(i){var a=i[0],s=i[1];return{height:a,width:s}}))})},t.prototype.forward=function(n){return oe(this,void 0,void 0,function(){var r;return ie(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,kt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.detectLandmarks=function(n){return oe(this,void 0,void 0,function(){var r,o,i,a=this;return ie(this,function(s){switch(s.label){case 0:return[4,kt(n)];case 1:return r=s.sent(),o=Q(function(){return gt(a.forwardInput(r))}),[4,Promise.all(o.map(function(u,l){return oe(a,void 0,void 0,function(){var c,d,f,h,p;return ie(this,function(m){switch(m.label){case 0:return f=(d=Array).from,[4,u.data()];case 1:return c=f.apply(d,[m.sent()]),h=c.filter(function(g,v){return jx(v)}),p=c.filter(function(g,v){return!jx(v)}),[2,new BB(Array(68).fill(0).map(function(g,v){return new Ae(h[v],p[v])}),{height:r.getInputHeight(l),width:r.getInputWidth(l)})]}})})}))];case 2:return i=s.sent(),o.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},t.prototype.getClassifierChannelsOut=function(){return 136},t}(gk),wk=function(e){pe(t,e);function t(n){return n===void 0&&(n=new mk),e.call(this,"FaceLandmark68Net",n)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t}(bk);function lL(e){var t=[],n=pk(e,t).extractDenseBlock3Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return fo(e,t),{params:r,paramMappings:t}}function cL(e){var t=[],n=ho(e),r=n.extractWeights,o=n.getRemainingWeights,i=fk(r,t).extractDenseBlock3Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{dense0:a,dense1:s,dense2:u}}}var dL=function(e){pe(t,e);function t(){return e.call(this,"TinyFaceFeatureExtractor")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("TinyFaceFeatureExtractor - load model before inference");return Q(function(){var o=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],a=Bu(o,i).div(Y(255)),s=Vh(a,r.dense0,!0);return s=Vh(s,r.dense1),s=Vh(s,r.dense2),s=Fu(s,[14,14],[2,2],"valid"),s})},t.prototype.forward=function(n){return oe(this,void 0,void 0,function(){var r;return ie(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,kt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},t.prototype.extractParamsFromWeigthMap=function(n){return lL(n)},t.prototype.extractParams=function(n){return cL(n)},t}(co),fL=function(e){pe(t,e);function t(n){return n===void 0&&(n=new dL),e.call(this,"FaceLandmark68TinyNet",n)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},t.prototype.getClassifierChannelsIn=function(){return 128},t}(bk);(function(e){pe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(wk);function hL(e,t){return be(Wt(e,t.weights),t.biases)}function Hg(e,t,n,r,o){o===void 0&&(o="same");var i=t.conv,a=i.filters,s=i.bias,u=Jn(e,a,n,o);return u=be(u,s),u=hL(u,t.scale),r?Ye(u):u}function pL(e,t){return Hg(e,t,[1,1],!0)}function Ck(e,t){return Hg(e,t,[1,1],!1)}function Sk(e,t){return Hg(e,t,[2,2],!0,"valid")}function mL(e,t){function n(s,u,l){var c=e(s),d=c.length/(u*l*l);if(RB(d))throw new Error("depth has to be an integer: "+d+", weights.length: "+c.length+", numFilters: "+u+", filterSize: "+l);return Q(function(){return Ho(en(c,[u,d,l,l]),[2,3,1,0])})}function r(s,u,l,c){var d=n(s,u,l),f=ft(e(u));return t.push({paramPath:c+"/filters"},{paramPath:c+"/bias"}),{filters:d,bias:f}}function o(s,u){var l=ft(e(s)),c=ft(e(s));return t.push({paramPath:u+"/weights"},{paramPath:u+"/biases"}),{weights:l,biases:c}}function i(s,u,l,c){var d=r(s,u,l,c+"/conv"),f=o(u,c+"/scale");return{conv:d,scale:f}}function a(s,u,l,c,d){d===void 0&&(d=!1);var f=i((d?.5:1)*s,u,l,c+"/conv1"),h=i(s,u,l,c+"/conv2");return{conv1:f,conv2:h}}return{extractConvLayerParams:i,extractResidualLayerParams:a}}function vL(e){var t=ho(e),n=t.extractWeights,r=t.getRemainingWeights,o=[],i=mL(n,o),a=i.extractConvLayerParams,s=i.extractResidualLayerParams,u=a(4704,32,7,"conv32_down"),l=s(9216,32,3,"conv32_1"),c=s(9216,32,3,"conv32_2"),d=s(9216,32,3,"conv32_3"),f=s(36864,64,3,"conv64_down",!0),h=s(36864,64,3,"conv64_1"),p=s(36864,64,3,"conv64_2"),m=s(36864,64,3,"conv64_3"),g=s(147456,128,3,"conv128_down",!0),v=s(147456,128,3,"conv128_1"),y=s(147456,128,3,"conv128_2"),b=s(589824,256,3,"conv256_down",!0),w=s(589824,256,3,"conv256_1"),C=s(589824,256,3,"conv256_2"),S=s(589824,256,3,"conv256_down_out"),E=Q(function(){return Ho(Lo(n(256*128),[128,256]),[1,0])});if(o.push({paramPath:"fc"}),r().length!==0)throw new Error("weights remaing after extract: "+r().length);var k={conv32_down:u,conv32_1:l,conv32_2:c,conv32_3:d,conv64_down:f,conv64_1:h,conv64_2:p,conv64_3:m,conv128_down:g,conv128_1:v,conv128_2:y,conv256_down:b,conv256_1:w,conv256_2:C,conv256_down_out:S,fc:E};return{params:k,paramMappings:o}}function gL(e,t){var n=ei(e,t);function r(a){var s=n(a+"/scale/weights",1),u=n(a+"/scale/biases",1);return{weights:s,biases:u}}function o(a){var s=n(a+"/conv/filters",4),u=n(a+"/conv/bias",1),l=r(a);return{conv:{filters:s,bias:u},scale:l}}function i(a){return{conv1:o(a+"/conv1"),conv2:o(a+"/conv2")}}return{extractConvLayerParams:o,extractResidualLayerParams:i}}function yL(e){var t=[],n=gL(e,t),r=n.extractConvLayerParams,o=n.extractResidualLayerParams,i=r("conv32_down"),a=o("conv32_1"),s=o("conv32_2"),u=o("conv32_3"),l=o("conv64_down"),c=o("conv64_1"),d=o("conv64_2"),f=o("conv64_3"),h=o("conv128_down"),p=o("conv128_1"),m=o("conv128_2"),g=o("conv256_down"),v=o("conv256_1"),y=o("conv256_2"),b=o("conv256_down_out"),w=e.fc;if(t.push({originalPath:"fc",paramPath:"fc"}),!_B(w))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+w);var C={conv32_down:i,conv32_1:a,conv32_2:s,conv32_3:u,conv64_down:l,conv64_1:c,conv64_2:d,conv64_3:f,conv128_down:h,conv128_1:p,conv128_2:m,conv256_down:g,conv256_1:v,conv256_2:y,conv256_down_out:b,fc:w};return fo(e,t),{params:C,paramMappings:t}}function xr(e,t){var n=pL(e,t.conv1);return n=Ck(n,t.conv2),n=be(n,e),n=Ye(n),n}function kl(e,t){var n=Sk(e,t.conv1);n=Ck(n,t.conv2);var r=Fu(e,2,2,"valid"),o=$e(r.shape),i=r.shape[3]!==n.shape[3],a=r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2];if(a){var s=Ls(n.shape);s[1]=1;var u=$e(s);n=vt([n,u],1);var l=Ls(n.shape);l[2]=1;var c=$e(l);n=vt([n,c],2)}return r=i?vt([r,o],3):r,n=be(r,n),n=Ye(n),n}var xL=function(e){pe(t,e);function t(){return e.call(this,"FaceRecognitionNet")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceRecognitionNet - load model before inference");return Q(function(){var o=n.toBatchTensor(150,!0).toFloat(),i=[122.782,117.001,104.298],a=Bu(o,i).div(Y(256)),s=Sk(a,r.conv32_down);s=wt(s,3,2,"valid"),s=xr(s,r.conv32_1),s=xr(s,r.conv32_2),s=xr(s,r.conv32_3),s=kl(s,r.conv64_down),s=xr(s,r.conv64_1),s=xr(s,r.conv64_2),s=xr(s,r.conv64_3),s=kl(s,r.conv128_down),s=xr(s,r.conv128_1),s=xr(s,r.conv128_2),s=kl(s,r.conv256_down),s=xr(s,r.conv256_1),s=xr(s,r.conv256_2),s=kl(s,r.conv256_down_out);var u=s.mean([1,2]),l=Bd(u,r.fc);return l})},t.prototype.forward=function(n){return oe(this,void 0,void 0,function(){var r;return ie(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,kt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.computeFaceDescriptor=function(n){return oe(this,void 0,void 0,function(){var r,o,i,a=this;return ie(this,function(s){switch(s.label){case 0:return[4,kt(n)];case 1:return r=s.sent(),o=Q(function(){return gt(a.forwardInput(r))}),[4,Promise.all(o.map(function(u){return u.data()}))];case 2:return i=s.sent(),o.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_recognition_model"},t.prototype.extractParamsFromWeigthMap=function(n){return yL(n)},t.prototype.extractParams=function(n){return vL(n)},t}(co);function Ek(e,t){var n={descriptor:t};return Object.assign({},e,n)}function kk(e,t){var n={age:t};return Object.assign({},e,n)}function _k(e,t,n){var r={gender:t,genderProbability:n};return Object.assign({},e,r)}var Rk=function(){function e(t){var n=t===void 0?{}:t,r=n.minFaceSize,o=n.scaleFactor,i=n.maxNumScales,a=n.scoreThresholds,s=n.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=r||20,this._scaleFactor=o||.709,this._maxNumScales=i||10,this._scoreThresholds=a||[.6,.7,.7],this._scaleSteps=s,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(u){return typeof u!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(u){return typeof u!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(e.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),e}();function bL(e,t){function n(u,l){var c=en(e(9*u),[3,3,u,1]),d=ft(e(u)),f=ft(e(u)),h=ft(e(u)),p=ft(e(u));return t.push({paramPath:l+"/filters"},{paramPath:l+"/batch_norm_scale"},{paramPath:l+"/batch_norm_offset"},{paramPath:l+"/batch_norm_mean"},{paramPath:l+"/batch_norm_variance"}),{filters:c,batch_norm_scale:d,batch_norm_offset:f,batch_norm_mean:h,batch_norm_variance:p}}function r(u,l,c,d,f){var h=en(e(u*l*c*c),[c,c,u,l]),p=ft(e(l));return t.push({paramPath:d+"/filters"},{paramPath:d+"/"+(f?"batch_norm_offset":"bias")}),{filters:h,bias:p}}function o(u,l,c,d){var f=r(u,l,c,d,!0),h=f.filters,p=f.bias;return{filters:h,batch_norm_offset:p}}function i(u,l,c){var d=n(u,c+"/depthwise_conv"),f=o(u,l,1,c+"/pointwise_conv");return{depthwise_conv:d,pointwise_conv:f}}function a(){var u=o(3,32,3,"mobilenetv1/conv_0"),l=i(32,64,"mobilenetv1/conv_1"),c=i(64,128,"mobilenetv1/conv_2"),d=i(128,128,"mobilenetv1/conv_3"),f=i(128,256,"mobilenetv1/conv_4"),h=i(256,256,"mobilenetv1/conv_5"),p=i(256,512,"mobilenetv1/conv_6"),m=i(512,512,"mobilenetv1/conv_7"),g=i(512,512,"mobilenetv1/conv_8"),v=i(512,512,"mobilenetv1/conv_9"),y=i(512,512,"mobilenetv1/conv_10"),b=i(512,512,"mobilenetv1/conv_11"),w=i(512,1024,"mobilenetv1/conv_12"),C=i(1024,1024,"mobilenetv1/conv_13");return{conv_0:u,conv_1:l,conv_2:c,conv_3:d,conv_4:f,conv_5:h,conv_6:p,conv_7:m,conv_8:g,conv_9:v,conv_10:y,conv_11:b,conv_12:w,conv_13:C}}function s(){var u=o(1024,256,1,"prediction_layer/conv_0"),l=o(256,512,3,"prediction_layer/conv_1"),c=o(512,128,1,"prediction_layer/conv_2"),d=o(128,256,3,"prediction_layer/conv_3"),f=o(256,128,1,"prediction_layer/conv_4"),h=o(128,256,3,"prediction_layer/conv_5"),p=o(256,64,1,"prediction_layer/conv_6"),m=o(64,128,3,"prediction_layer/conv_7"),g=r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),v=r(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),y=r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),b=r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),w=r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),C=r(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),S=r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),E=r(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),k=r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),R=r(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),_=r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),N=r(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),I={box_encoding_predictor:g,class_predictor:v},L={box_encoding_predictor:y,class_predictor:b},O={box_encoding_predictor:w,class_predictor:C},V={box_encoding_predictor:S,class_predictor:E},$={box_encoding_predictor:k,class_predictor:R},U={box_encoding_predictor:_,class_predictor:N};return{conv_0:u,conv_1:l,conv_2:c,conv_3:d,conv_4:f,conv_5:h,conv_6:p,conv_7:m,box_predictor_0:I,box_predictor_1:L,box_predictor_2:O,box_predictor_3:V,box_predictor_4:$,box_predictor_5:U}}return{extractMobilenetV1Params:a,extractPredictionLayerParams:s}}function wL(e){var t=[],n=ho(e),r=n.extractWeights,o=n.getRemainingWeights,i=bL(r,t),a=i.extractMobilenetV1Params,s=i.extractPredictionLayerParams,u=a(),l=s(),c=sg(r(5118*4),[1,5118,4]),d={extra_dim:c};if(t.push({paramPath:"output_layer/extra_dim"}),o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{params:{mobilenetv1:u,prediction_layer:l,output_layer:d},paramMappings:t}}function CL(e,t){var n=ei(e,t);function r(l,c,d){var f=n(l+"/Conv2d_"+c+"_pointwise/weights",4,d+"/filters"),h=n(l+"/Conv2d_"+c+"_pointwise/convolution_bn_offset",1,d+"/batch_norm_offset");return{filters:f,batch_norm_offset:h}}function o(l){var c="mobilenetv1/conv_"+l,d="MobilenetV1/Conv2d_"+l+"_depthwise",f=c+"/depthwise_conv",h=c+"/pointwise_conv",p=n(d+"/depthwise_weights",4,f+"/filters"),m=n(d+"/BatchNorm/gamma",1,f+"/batch_norm_scale"),g=n(d+"/BatchNorm/beta",1,f+"/batch_norm_offset"),v=n(d+"/BatchNorm/moving_mean",1,f+"/batch_norm_mean"),y=n(d+"/BatchNorm/moving_variance",1,f+"/batch_norm_variance");return{depthwise_conv:{filters:p,batch_norm_scale:m,batch_norm_offset:g,batch_norm_mean:v,batch_norm_variance:y},pointwise_conv:r("MobilenetV1",l,h)}}function i(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:o(1),conv_2:o(2),conv_3:o(3),conv_4:o(4),conv_5:o(5),conv_6:o(6),conv_7:o(7),conv_8:o(8),conv_9:o(9),conv_10:o(10),conv_11:o(11),conv_12:o(12),conv_13:o(13)}}function a(l,c){var d=n(l+"/weights",4,c+"/filters"),f=n(l+"/biases",1,c+"/bias");return{filters:d,bias:f}}function s(l){var c=a("Prediction/BoxPredictor_"+l+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+l+"/box_encoding_predictor"),d=a("Prediction/BoxPredictor_"+l+"/ClassPredictor","prediction_layer/box_predictor_"+l+"/class_predictor");return{box_encoding_predictor:c,class_predictor:d}}function u(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:s(0),box_predictor_1:s(1),box_predictor_2:s(2),box_predictor_3:s(3),box_predictor_4:s(4),box_predictor_5:s(5)}}return{extractMobilenetV1Params:i,extractPredictionLayerParams:u}}function SL(e){var t=[],n=CL(e,t),r=n.extractMobilenetV1Params,o=n.extractPredictionLayerParams,i=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!Vd(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var a={mobilenetv1:r(),prediction_layer:o(),output_layer:{extra_dim:i}};return fo(e,t),{params:a,paramMappings:t}}function wr(e,t,n){return Q(function(){var r=Jn(e,t.filters,n,"same");return r=be(r,t.batch_norm_offset),yg(r,0,6)})}var EL=.0010000000474974513;function kL(e,t,n){return Q(function(){var r=Od(e,t.filters,n,"same");return r=wE(r,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,EL),yg(r,0,6)})}function _L(e){return[2,4,6,12].some(function(t){return t===e})?[2,2]:[1,1]}function RL(e,t){return Q(function(){var n=null,r=wr(e,t.conv_0,[2,2]),o=[t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13];if(o.forEach(function(i,a){var s=a+1,u=_L(s);r=kL(r,i.depthwise_conv,u),r=wr(r,i.pointwise_conv,[1,1]),s===11&&(n=r)}),n===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}})}function TL(e,t,n,r,o){var i=e.shape[0],a=Math.min(n,i),s=t.map(function(c,d){return{score:c,boxIndex:d}}).filter(function(c){return c.score>o}).sort(function(c,d){return d.score-c.score}),u=function(c){return c<=r?1:0},l=[];return s.forEach(function(c){if(!(l.length>=a)){for(var d=c.score,f=l.length-1;f>=0;--f){var h=AL(e,c.boxIndex,l[f]);if(h!==0&&(c.score*=u(h),c.score<=o))break}d===c.score&&l.push(c.boxIndex)}}),l}function AL(e,t,n){var r=e.arraySync(),o=Math.min(r[t][0],r[t][2]),i=Math.min(r[t][1],r[t][3]),a=Math.max(r[t][0],r[t][2]),s=Math.max(r[t][1],r[t][3]),u=Math.min(r[n][0],r[n][2]),l=Math.min(r[n][1],r[n][3]),c=Math.max(r[n][0],r[n][2]),d=Math.max(r[n][1],r[n][3]),f=(a-o)*(s-i),h=(c-u)*(d-l);if(f<=0||h<=0)return 0;var p=Math.max(o,u),m=Math.max(i,l),g=Math.min(a,c),v=Math.min(s,d),y=Math.max(g-p,0)*Math.max(v-m,0);return y/(f+h-y)}function IL(e){var t=gt(Ho(e,[1,0])),n=[xt(t[2],t[0]),xt(t[3],t[1])],r=[be(t[0],sr(n[0],Y(2))),be(t[1],sr(n[1],Y(2)))];return{sizes:n,centers:r}}function NL(e,t){var n=IL(e),r=n.sizes,o=n.centers,i=gt(Ho(t,[1,0])),a=sr(Wt(ym(sr(i[2],Y(5))),r[0]),Y(2)),s=be(Wt(sr(i[0],Y(10)),r[0]),o[0]),u=sr(Wt(ym(sr(i[3],Y(5))),r[1]),Y(2)),l=be(Wt(sr(i[1],Y(10)),r[1]),o[1]);return Ho(En([xt(s,a),xt(l,u),be(s,a),be(l,u)]),[1,0])}function PL(e,t,n){return Q(function(){var r=e.shape[0],o=NL(ur(Ca(n.extra_dim,[r,1,1]),[-1,4]),ur(e,[-1,4]));o=ur(o,[r,o.shape[0]/r,4]);var i=gE(Br(t,[0,0,1],[-1,-1,-1])),a=Br(i,[0,0,0],[-1,-1,1]);a=ur(a,[r,a.shape[1]]);var s=gt(o),u=gt(a);return{boxes:s,scores:u}})}function Vi(e,t){return Q(function(){var n=e.shape[0],r=ur(dr(e,t.box_encoding_predictor),[n,-1,1,4]),o=ur(dr(e,t.class_predictor),[n,-1,3]);return{boxPredictionEncoding:r,classPrediction:o}})}function DL(e,t,n){return Q(function(){var r=wr(e,n.conv_0,[1,1]),o=wr(r,n.conv_1,[2,2]),i=wr(o,n.conv_2,[1,1]),a=wr(i,n.conv_3,[2,2]),s=wr(a,n.conv_4,[1,1]),u=wr(s,n.conv_5,[2,2]),l=wr(u,n.conv_6,[1,1]),c=wr(l,n.conv_7,[2,2]),d=Vi(t,n.box_predictor_0),f=Vi(e,n.box_predictor_1),h=Vi(o,n.box_predictor_2),p=Vi(a,n.box_predictor_3),m=Vi(u,n.box_predictor_4),g=Vi(c,n.box_predictor_5),v=vt([d.boxPredictionEncoding,f.boxPredictionEncoding,h.boxPredictionEncoding,p.boxPredictionEncoding,m.boxPredictionEncoding,g.boxPredictionEncoding],1),y=vt([d.classPrediction,f.classPrediction,h.classPrediction,p.classPrediction,m.classPrediction,g.classPrediction],1);return{boxPredictions:v,classPredictions:y}})}var Hd=function(){function e(t){var n=t===void 0?{}:t,r=n.minConfidence,o=n.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=r||.5,this._maxResults=o||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(e.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),e}(),Tk=function(e){pe(t,e);function t(){return e.call(this,"SsdMobilenetv1")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("SsdMobilenetv1 - load model before inference");return Q(function(){var o=n.toBatchTensor(512,!1).toFloat(),i=xt(Wt(o,Y(.007843137718737125)),Y(1)),a=RL(i,r.mobilenetv1),s=DL(a.out,a.conv11,r.prediction_layer),u=s.boxPredictions,l=s.classPredictions;return PL(u,l,r.output_layer)})},t.prototype.forward=function(n){return oe(this,void 0,void 0,function(){var r;return ie(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,kt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.locateFaces=function(n,r){return r===void 0&&(r={}),oe(this,void 0,void 0,function(){var o,i,a,s,u,l,c,d,f,h,p,m,g,v,y,b,w,C,S,E,k;return ie(this,function(R){switch(R.label){case 0:return o=new Hd(r),i=o.maxResults,a=o.minConfidence,[4,kt(n)];case 1:for(s=R.sent(),u=this.forwardInput(s),l=u.boxes,c=u.scores,d=l[0],f=c[0],h=1;h<l.length;h++)l[h].dispose(),c[h].dispose();return g=(m=Array).from,[4,f.data()];case 2:return p=g.apply(m,[R.sent()]),v=.5,y=TL(d,p,i,v,a),b=s.getReshapedInputDimensions(0),w=s.inputSize,C=w/b.width,S=w/b.height,E=d.arraySync(),k=y.map(function(_){var N=[Math.max(0,E[_][0]),Math.min(1,E[_][2])].map(function(U){return U*S}),I=N[0],L=N[1],O=[Math.max(0,E[_][1]),Math.min(1,E[_][3])].map(function(U){return U*C}),V=O[0],$=O[1];return new Vr(p[_],new Fg(V,I,$-V,L-I),{height:s.getInputHeight(0),width:s.getInputWidth(0)})}),d.dispose(),f.dispose(),[2,k]}})})},t.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},t.prototype.extractParamsFromWeigthMap=function(n){return SL(n)},t.prototype.extractParams=function(n){return wL(n)},t}(co);(function(e){pe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(Tk);var ML=.4,FL=[new Ae(.738768,.874946),new Ae(2.42204,2.65704),new Ae(4.30971,7.04493),new Ae(10.246,4.59428),new Ae(12.6868,11.8741)],OL=[new Ae(1.603231,2.094468),new Ae(6.041143,7.080126),new Ae(2.882459,3.518061),new Ae(4.266906,5.178857),new Ae(9.041765,10.66308)],BL=[117.001,114.697,97.404],LL="tiny_yolov2_model",jL="tiny_yolov2_separable_conv_model",_l=function(e){return typeof e=="number"};function zL(e){if(!e)throw new Error("invalid config: "+e);if(typeof e.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+e.withSeparableConvs);if(!_l(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+e.iouThreshold);if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every(function(t){return typeof t=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(e.classes));if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map(function(t){return t||{}}).every(function(t){return _l(t.x)&&_l(t.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(e.anchors));if(e.meanRgb&&(!Array.isArray(e.meanRgb)||e.meanRgb.length!==3||!e.meanRgb.every(_l)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(e.meanRgb))}function Gg(e){return Q(function(){var t=Wt(e,Y(.10000000149011612));return be(Ye(xt(e,t)),t)})}function mo(e,t){return Q(function(){var n=Di(e,[[0,0],[1,1],[1,1],[0,0]]);return n=Jn(n,t.conv.filters,[1,1],"valid"),n=xt(n,t.bn.sub),n=Wt(n,t.bn.truediv),n=be(n,t.conv.bias),Gg(n)})}function vo(e,t){return Q(function(){var n=Di(e,[[0,0],[1,1],[1,1],[0,0]]);return n=Cg(n,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),n=be(n,t.bias),Gg(n)})}function VL(e,t){var n=Ud(e,t);function r(a,s){var u=ft(e(a)),l=ft(e(a));return t.push({paramPath:s+"/sub"},{paramPath:s+"/truediv"}),{sub:u,truediv:l}}function o(a,s,u){var l=n(a,s,3,u+"/conv"),c=r(s,u+"/bn");return{conv:l,bn:c}}var i=$g(e,t);return{extractConvParams:n,extractConvWithBatchNormParams:o,extractSeparableConvParams:i}}function $L(e,t,n,r){var o=ho(e),i=o.extractWeights,a=o.getRemainingWeights,s=[],u=VL(i,s),l=u.extractConvParams,c=u.extractConvWithBatchNormParams,d=u.extractSeparableConvParams,f;if(t.withSeparableConvs){var h=r[0],p=r[1],m=r[2],g=r[3],v=r[4],y=r[5],b=r[6],w=r[7],C=r[8],S=t.isFirstLayerConv2d?l(h,p,3,"conv0"):d(h,p,"conv0"),E=d(p,m,"conv1"),k=d(m,g,"conv2"),R=d(g,v,"conv3"),_=d(v,y,"conv4"),N=d(y,b,"conv5"),I=w?d(b,w,"conv6"):void 0,L=C?d(w,C,"conv7"):void 0,O=l(C||w||b,5*n,1,"conv8");f={conv0:S,conv1:E,conv2:k,conv3:R,conv4:_,conv5:N,conv6:I,conv7:L,conv8:O}}else{var h=r[0],p=r[1],m=r[2],g=r[3],v=r[4],y=r[5],b=r[6],w=r[7],C=r[8],S=c(h,p,"conv0"),E=c(p,m,"conv1"),k=c(m,g,"conv2"),R=c(g,v,"conv3"),_=c(v,y,"conv4"),N=c(y,b,"conv5"),I=c(b,w,"conv6"),L=c(w,C,"conv7"),O=l(C,5*n,1,"conv8");f={conv0:S,conv1:E,conv2:k,conv3:R,conv4:_,conv5:N,conv6:I,conv7:L,conv8:O}}if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{params:f,paramMappings:s}}function WL(e,t){var n=ei(e,t);function r(s){var u=n(s+"/sub",1),l=n(s+"/truediv",1);return{sub:u,truediv:l}}function o(s){var u=n(s+"/filters",4),l=n(s+"/bias",1);return{filters:u,bias:l}}function i(s){var u=o(s+"/conv"),l=r(s+"/bn");return{conv:u,bn:l}}var a=Wg(n);return{extractConvParams:o,extractConvWithBatchNormParams:i,extractSeparableConvParams:a}}function UL(e,t){var n=[],r=WL(e,n),o=r.extractConvParams,i=r.extractConvWithBatchNormParams,a=r.extractSeparableConvParams,s;if(t.withSeparableConvs){var u=t.filterSizes&&t.filterSizes.length||9;s={conv0:t.isFirstLayerConv2d?o("conv0"):a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:u>7?a("conv6"):void 0,conv7:u>8?a("conv7"):void 0,conv8:o("conv8")}}else s={conv0:i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:i("conv6"),conv7:i("conv7"),conv8:o("conv8")};return fo(e,n),{params:s,paramMappings:n}}var Kx;(function(e){e[e.XS=224]="XS",e[e.SM=320]="SM",e[e.MD=416]="MD",e[e.LG=608]="LG"})(Kx||(Kx={}));var Kg=function(){function e(t){var n=t===void 0?{}:t,r=n.inputSize,o=n.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=r||416,this._scoreThreshold=o||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),e}(),Ak=function(e){pe(t,e);function t(n){var r=e.call(this,"TinyYolov2")||this;return zL(n),r._config=n,r}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),t.prototype.runTinyYolov2=function(n,r){var o=mo(n,r.conv0);return o=wt(o,[2,2],[2,2],"same"),o=mo(o,r.conv1),o=wt(o,[2,2],[2,2],"same"),o=mo(o,r.conv2),o=wt(o,[2,2],[2,2],"same"),o=mo(o,r.conv3),o=wt(o,[2,2],[2,2],"same"),o=mo(o,r.conv4),o=wt(o,[2,2],[2,2],"same"),o=mo(o,r.conv5),o=wt(o,[2,2],[1,1],"same"),o=mo(o,r.conv6),o=mo(o,r.conv7),dr(o,r.conv8,"valid",!1)},t.prototype.runMobilenet=function(n,r){var o=this.config.isFirstLayerConv2d?Gg(dr(n,r.conv0,"valid",!1)):vo(n,r.conv0);return o=wt(o,[2,2],[2,2],"same"),o=vo(o,r.conv1),o=wt(o,[2,2],[2,2],"same"),o=vo(o,r.conv2),o=wt(o,[2,2],[2,2],"same"),o=vo(o,r.conv3),o=wt(o,[2,2],[2,2],"same"),o=vo(o,r.conv4),o=wt(o,[2,2],[2,2],"same"),o=vo(o,r.conv5),o=wt(o,[2,2],[1,1],"same"),o=r.conv6?vo(o,r.conv6):o,o=r.conv7?vo(o,r.conv7):o,dr(o,r.conv8,"valid",!1)},t.prototype.forwardInput=function(n,r){var o=this,i=this.params;if(!i)throw new Error("TinyYolov2 - load model before inference");return Q(function(){var a=n.toBatchTensor(r,!1).toFloat();return a=o.config.meanRgb?Bu(a,o.config.meanRgb):a,a=a.div(Y(256)),o.config.withSeparableConvs?o.runMobilenet(a,i):o.runTinyYolov2(a,i)})},t.prototype.forward=function(n,r){return oe(this,void 0,void 0,function(){var o;return ie(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,kt(n)];case 1:return[4,o.apply(this,[i.sent(),r])];case 2:return[2,i.sent()]}})})},t.prototype.detect=function(n,r){return r===void 0&&(r={}),oe(this,void 0,void 0,function(){var o,i,a,s,u,l,c,d,f,h,p,m,g,v,y=this;return ie(this,function(b){switch(b.label){case 0:return o=new Kg(r),i=o.inputSize,a=o.scoreThreshold,[4,kt(n)];case 1:return s=b.sent(),[4,this.forwardInput(s,i)];case 2:return u=b.sent(),l=Q(function(){return gt(u)[0].expandDims()}),c={width:s.getInputWidth(0),height:s.getInputHeight(0)},[4,this.extractBoxes(l,s.getReshapedInputDimensions(0),a)];case 3:return d=b.sent(),u.dispose(),l.dispose(),f=d.map(function(w){return w.box}),h=d.map(function(w){return w.score}),p=d.map(function(w){return w.classScore}),m=d.map(function(w){return y.config.classes[w.label]}),g=pu(f.map(function(w){return w.rescale(i)}),h,this.config.iouThreshold,!0),v=g.map(function(w){return new tk(h[w],p[w],m[w],f[w],c)}),[2,v]}})})},t.prototype.getDefaultModelName=function(){return""},t.prototype.extractParamsFromWeigthMap=function(n){return UL(n,this.config)},t.prototype.extractParams=function(n){var r=this.config.filterSizes||t.DEFAULT_FILTER_SIZES,o=r?r.length:void 0;if(o!==7&&o!==8&&o!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+o+" filterSizes in config");return $L(n,this.config,this.boxEncodingSize,r)},t.prototype.extractBoxes=function(n,r,o){return oe(this,void 0,void 0,function(){var i,a,s,u,l,c,d,f,h,p,m,g,v,y,b,w,C,S,E,k,R,_,N,I,L,O,V,$,U,M=this;return ie(this,function(B){switch(B.label){case 0:return i=r.width,a=r.height,s=Math.max(i,a),u=s/i,l=s/a,c=n.shape[1],d=this.config.anchors.length,f=Q(function(){var z=n.reshape([c,c,d,M.boxEncodingSize]),G=z.slice([0,0,0,0],[c,c,d,4]),X=z.slice([0,0,0,4],[c,c,d,1]),te=M.withClassScores?uo(z.slice([0,0,0,5],[c,c,d,M.config.classes.length]),3):Y(0);return[G,X,te]}),h=f[0],p=f[1],m=f[2],g=[],[4,p.array()];case 1:return v=B.sent(),[4,h.array()];case 2:y=B.sent(),b=0,B.label=3;case 3:if(!(b<c))return[3,12];w=0,B.label=4;case 4:if(!(w<c))return[3,11];C=0,B.label=5;case 5:return C<d?(S=zh(v[b][w][C][0]),!o||S>o?(E=(w+zh(y[b][w][C][0]))/c*u,k=(b+zh(y[b][w][C][1]))/c*l,R=Math.exp(y[b][w][C][2])*this.config.anchors[C].x/c*u,_=Math.exp(y[b][w][C][3])*this.config.anchors[C].y/c*l,N=E-R/2,I=k-_/2,L={row:b,col:w,anchor:C},this.withClassScores?[4,this.extractPredictedClass(m,L)]:[3,7]):[3,9]):[3,10];case 6:return U=B.sent(),[3,8];case 7:U={classScore:1,label:0},B.label=8;case 8:O=U,V=O.classScore,$=O.label,g.push(zt({box:new $d(N,I,N+R,I+_),score:S,classScore:S*V,label:$},L)),B.label=9;case 9:return C++,[3,5];case 10:return w++,[3,4];case 11:return b++,[3,3];case 12:return h.dispose(),p.dispose(),m.dispose(),[2,g]}})})},t.prototype.extractPredictedClass=function(n,r){return oe(this,void 0,void 0,function(){var o,i,a,s;return ie(this,function(u){switch(u.label){case 0:return o=r.row,i=r.col,a=r.anchor,[4,n.array()];case 1:return s=u.sent(),[2,Array(this.config.classes.length).fill(0).map(function(l,c){return s[o][i][a][c]}).map(function(l,c){return{classScore:l,label:c}}).reduce(function(l,c){return l.classScore>c.classScore?l:c})]}})})},t.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],t}(co),HL=function(e){pe(t,e);function t(n){n===void 0&&(n=!0);var r=this,o=Object.assign({},{withSeparableConvs:n,iouThreshold:ML,classes:["face"]},n?{anchors:OL,meanRgb:BL}:{anchors:FL,withClassScores:!0});return r=e.call(this,o)||this,r}return Object.defineProperty(t.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(n,r){return oe(this,void 0,void 0,function(){var o;return ie(this,function(i){switch(i.label){case 0:return[4,this.detect(n,r)];case 1:return o=i.sent(),[2,o.map(function(a){return new Vr(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return this.withSeparableConvs?jL:LL},t.prototype.extractParamsFromWeigthMap=function(n){return e.prototype.extractParamsFromWeigthMap.call(this,n)},t}(Ak),Ik=function(e){pe(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n._name="TinyFaceDetectorOptions",n}return t}(Kg),Lu=function(){function e(){}return e.prototype.then=function(t){return oe(this,void 0,void 0,function(){var n;return ie(this,function(r){switch(r.label){case 0:return n=t,[4,this.run()];case 1:return[2,n.apply(void 0,[r.sent()])]}})})},e.prototype.run=function(){return oe(this,void 0,void 0,function(){return ie(this,function(t){throw new Error("ComposableTask - run is not implemented")})})},e}();function Gd(e,t,n,r,o){return o===void 0&&(o=function(i){var a=i.alignedRect;return a}),oe(this,void 0,void 0,function(){var i,a,s,u,l;return ie(this,function(c){switch(c.label){case 0:return i=e.map(function(d){return ZB(d)?o(d):d.detection}),s=r,s?[3,5]:t instanceof qe?[4,zg(t,i)]:[3,2];case 1:return u=c.sent(),[3,4];case 2:return[4,jg(t,i)];case 3:u=c.sent(),c.label=4;case 4:s=u,c.label=5;case 5:return a=s,[4,n(a)];case 6:return l=c.sent(),a.forEach(function(d){return d instanceof qe&&d.dispose()}),[2,l]}})})}function qg(e,t,n,r,o){return oe(this,void 0,void 0,function(){var i=this;return ie(this,function(a){return[2,Gd([e],t,function(s){return oe(i,void 0,void 0,function(){return ie(this,function(u){return[2,n(s[0])]})})},r,o)]})})}function GL(e){return Q(function(){return En(gt(e,3).reverse(),3)})}var Rl=2,ed=12;function KL(e,t){var n=Ud(e,t),r=Vg(e,t);function o(l,c){var d=ft(e(l));return t.push({paramPath:c}),d}function i(l,c,d){d===void 0&&(d=!1);var f=n(l[0],l[1],3,c+"/conv1"),h=o(l[1],c+"/prelu1_alpha"),p=n(l[1],l[2],3,c+"/conv2"),m=o(l[2],c+"/prelu2_alpha"),g=n(l[2],l[3],d?2:3,c+"/conv3"),v=o(l[3],c+"/prelu3_alpha");return{conv1:f,prelu1_alpha:h,conv2:p,prelu2_alpha:m,conv3:g,prelu3_alpha:v}}function a(){var l=i([3,10,16,32],"pnet"),c=n(32,2,1,"pnet/conv4_1"),d=n(32,4,1,"pnet/conv4_2");return zt(zt({},l),{conv4_1:c,conv4_2:d})}function s(){var l=i([3,28,48,64],"rnet",!0),c=r(576,128,"rnet/fc1"),d=o(128,"rnet/prelu4_alpha"),f=r(128,2,"rnet/fc2_1"),h=r(128,4,"rnet/fc2_2");return zt(zt({},l),{fc1:c,prelu4_alpha:d,fc2_1:f,fc2_2:h})}function u(){var l=i([3,32,64,64],"onet"),c=n(64,128,2,"onet/conv4"),d=o(128,"onet/prelu4_alpha"),f=r(1152,256,"onet/fc1"),h=o(256,"onet/prelu5_alpha"),p=r(256,2,"onet/fc2_1"),m=r(256,4,"onet/fc2_2"),g=r(256,10,"onet/fc2_3");return zt(zt({},l),{conv4:c,prelu4_alpha:d,fc1:f,prelu5_alpha:h,fc2_1:p,fc2_2:m,fc2_3:g})}return{extractPNetParams:a,extractRNetParams:s,extractONetParams:u}}function qL(e){var t=ho(e),n=t.extractWeights,r=t.getRemainingWeights,o=[],i=KL(n,o),a=i.extractPNetParams,s=i.extractRNetParams,u=i.extractONetParams,l=a(),c=s(),d=u();if(r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:l,rnet:c,onet:d},paramMappings:o}}function XL(e,t){var n=ei(e,t);function r(c){var d=n(c+"/weights",4,c+"/filters"),f=n(c+"/bias",1);return{filters:d,bias:f}}function o(c){var d=n(c+"/weights",2),f=n(c+"/bias",1);return{weights:d,bias:f}}function i(c){return n(c,1)}function a(c){var d=r(c+"/conv1"),f=i(c+"/prelu1_alpha"),h=r(c+"/conv2"),p=i(c+"/prelu2_alpha"),m=r(c+"/conv3"),g=i(c+"/prelu3_alpha");return{conv1:d,prelu1_alpha:f,conv2:h,prelu2_alpha:p,conv3:m,prelu3_alpha:g}}function s(){var c=a("pnet"),d=r("pnet/conv4_1"),f=r("pnet/conv4_2");return zt(zt({},c),{conv4_1:d,conv4_2:f})}function u(){var c=a("rnet"),d=o("rnet/fc1"),f=i("rnet/prelu4_alpha"),h=o("rnet/fc2_1"),p=o("rnet/fc2_2");return zt(zt({},c),{fc1:d,prelu4_alpha:f,fc2_1:h,fc2_2:p})}function l(){var c=a("onet"),d=r("onet/conv4"),f=i("onet/prelu4_alpha"),h=o("onet/fc1"),p=i("onet/prelu5_alpha"),m=o("onet/fc2_1"),g=o("onet/fc2_2"),v=o("onet/fc2_3");return zt(zt({},c),{conv4:d,prelu4_alpha:f,fc1:h,prelu5_alpha:p,fc2_1:m,fc2_2:g,fc2_3:v})}return{extractPNetParams:s,extractRNetParams:u,extractONetParams:l}}function YL(e){var t=[],n=XL(e,t),r=n.extractPNetParams,o=n.extractRNetParams,i=n.extractONetParams,a=r(),s=o(),u=i();return fo(e,t),{params:{pnet:a,rnet:s,onet:u},paramMappings:t}}function _m(e,t){var n=t[0],r=t[1];return{height:Math.floor(n*e),width:Math.floor(r*e)}}function QL(e,t,n){for(var r=n[0],o=n[1],i=ed/e,a=[],s=Math.min(r,o)*i,u=0;s>=12;)a.push(i*Math.pow(t,u)),s=s*t,u+=1;return a}var Xg=function(e){pe(t,e);function t(n,r,o,i){return e.call(this,{left:n,top:r,right:o,bottom:i},!0)||this}return t}(Go);function Nk(e){return Q(function(){return Wt(xt(e,Y(127.5)),Y(.0078125))})}function Ta(e,t){return Q(function(){return be(Ye(e),Wt(t,Kc(Ye(Kc(e)))))})}function Yg(e,t,n){return n===void 0&&(n=!1),Q(function(){var r=dr(e,t.conv1,"valid");return r=Ta(r,t.prelu1_alpha),r=wt(r,n?[2,2]:[3,3],[2,2],"same"),r=dr(r,t.conv2,"valid"),r=Ta(r,t.prelu2_alpha),r=n?r:wt(r,[3,3],[2,2],"valid"),r=dr(r,t.conv3,"valid"),r=Ta(r,t.prelu3_alpha),r})}function JL(e,t){return Q(function(){var n=Yg(e,t,!0),r=dr(n,t.conv4_1,"valid"),o=$n(Ld(r,3),3),i=uo(xt(r,o),3),a=dr(n,t.conv4_2,"valid");return{prob:i,regions:a}})}function ZL(e,t){return Q(function(){var n=_m(t,e.shape.slice(1)),r=n.height,o=n.width,i=Rg.resizeBilinear(e,[r,o]),a=Nk(i);return Ho(a,[0,2,1,3])})}function ej(e,t,n,r){for(var o=[],i=e.arraySync(),a=0;a<e.shape[0];a++)for(var s=0;s<e.shape[1];s++)i[a][s]>=r&&o.push(new Ae(s,a));var u=o.map(function(l){var c=new $d(Math.round((l.y*Rl+1)/n),Math.round((l.x*Rl+1)/n),Math.round((l.y*Rl+ed)/n),Math.round((l.x*Rl+ed)/n)),d=i[l.y][l.x],f=t.arraySync(),h=new Xg(f[l.y][l.x][0],f[l.y][l.x][1],f[l.y][l.x][2],f[l.y][l.x][3]);return{cell:c,score:d,region:h}});return u}function tj(e,t,n,r,o){o.stage1=[];var i=t.map(function(f){return Q(function(){var h={scale:f},p=ZL(e,f),m=Date.now(),g=JL(p,r),v=g.prob,y=g.regions;h.pnet=Date.now()-m;var b=gt(gt(v,3)[1])[0],w=gt(y)[0];return{scoresTensor:b,regionsTensor:w,scale:f,statsForScale:h}})}),a=i.map(function(f){var h=f.scoresTensor,p=f.regionsTensor,m=f.scale,g=f.statsForScale,v=ej(h,p,m,n);if(h.dispose(),p.dispose(),!v.length)return o.stage1.push(g),[];var y=Date.now(),b=pu(v.map(function(w){return w.cell}),v.map(function(w){return w.score}),.5);return g.nms=Date.now()-y,g.numBoxes=b.length,o.stage1.push(g),b.map(function(w){return v[w]})}),s=a.reduce(function(f,h){return f.concat(h)},[]),u=[],l=[];if(s.length>0){var c=Date.now(),d=pu(s.map(function(f){return f.cell}),s.map(function(f){return f.score}),.7);o.stage1_nms=Date.now()-c,l=d.map(function(f){return s[f].score}),u=d.map(function(f){return s[f]}).map(function(f){var h=f.cell,p=f.region;return new $d(h.left+p.left*h.width,h.top+p.top*h.height,h.right+p.right*h.width,h.bottom+p.bottom*h.height).toSquare().round()})}return{boxes:u,scores:l}}function Pk(e,t,n){var r=n.width,o=n.height;return oe(this,void 0,void 0,function(){var i,a,s,u=this;return ie(this,function(l){switch(l.label){case 0:return i=Ri(e),[4,Promise.all(t.map(function(c){return oe(u,void 0,void 0,function(){var d,f,h,p,m,g,v,y;return ie(this,function(b){return d=c.padAtBorders(e.height,e.width),f=d.y,h=d.ey,p=d.x,m=d.ex,g=p-1,v=f-1,y=i.getImageData(g,v,m-g,h-v),[2,Ht.isNodejs()?Lg(y):createImageBitmap(y)]})})}))];case 1:return a=l.sent(),s=[],a.forEach(function(c){var d=Wd({width:r,height:o}),f=Ri(d);f.drawImage(c,0,0,r,o);for(var h=f.getImageData(0,0,r,o).data,p=[],m=0;m<h.length;m+=4)p.push(h[m+2]),p.push(h[m+1]),p.push(h[m]);s.push(p)}),[2,s.map(function(c){var d=Q(function(){var f=Ho(en(c,[1,r,o,3]),[0,2,1,3]).toFloat();return Nk(f)});return d})]}})})}function nj(e,t){return Q(function(){var n=Yg(e,t),r=ur(n,[n.shape[0],t.fc1.weights.shape[0]]),o=Tr(r,t.fc1),i=Ta(o,t.prelu4_alpha),a=Tr(i,t.fc2_1),s=$n(Ld(a,1),1),u=uo(xt(a,s),1),l=Tr(i,t.fc2_2),c=gt(u,1)[1];return{scores:c,regions:l}})}function rj(e,t,n,r,o){return oe(this,void 0,void 0,function(){var i,a,s,u,l,c,d,f,h,p,m,g,v,y;return ie(this,function(b){switch(b.label){case 0:return i=Date.now(),[4,Pk(e,t,{width:24,height:24})];case 1:return a=b.sent(),o.stage2_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(w){var C=nj(w,r);return w.dispose(),C}),o.stage2_rnet=Date.now()-i,u=s.length>1?vt(s.map(function(w){return w.scores})):s[0].scores,d=(c=Array).from,[4,u.data()];case 2:return l=d.apply(c,[b.sent()]),u.dispose(),f=l.map(function(w,C){return{score:w,idx:C}}).filter(function(w){return w.score>n}).map(function(w){var C=w.idx;return C}),h=f.map(function(w){return t[w]}),p=f.map(function(w){return l[w]}),m=[],g=[],h.length>0&&(i=Date.now(),v=pu(h,p,.7),o.stage2_nms=Date.now()-i,y=v.map(function(w){var C=s[f[w]].regions.arraySync();return new Xg(C[0][0],C[0][1],C[0][2],C[0][3])}),g=v.map(function(w){return p[w]}),m=v.map(function(w,C){return h[w].calibrate(y[C])})),s.forEach(function(w){w.regions.dispose(),w.scores.dispose()}),[2,{boxes:m,scores:g}]}})})}function oj(e,t){return Q(function(){var n=Yg(e,t);n=wt(n,[2,2],[2,2],"same"),n=dr(n,t.conv4,"valid"),n=Ta(n,t.prelu4_alpha);var r=ur(n,[n.shape[0],t.fc1.weights.shape[0]]),o=Tr(r,t.fc1),i=Ta(o,t.prelu5_alpha),a=Tr(i,t.fc2_1),s=$n(Ld(a,1),1),u=uo(xt(a,s),1),l=Tr(i,t.fc2_2),c=Tr(i,t.fc2_3),d=gt(u,1)[1];return{scores:d,regions:l,points:c}})}function ij(e,t,n,r,o){return oe(this,void 0,void 0,function(){var i,a,s,u,l,c,d,f,h,p,m,g,v,y,b;return ie(this,function(w){switch(w.label){case 0:return i=Date.now(),[4,Pk(e,t,{width:48,height:48})];case 1:return a=w.sent(),o.stage3_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(C){var S=oj(C,r);return C.dispose(),S}),o.stage3_onet=Date.now()-i,u=s.length>1?vt(s.map(function(C){return C.scores})):s[0].scores,d=(c=Array).from,[4,u.data()];case 2:return l=d.apply(c,[w.sent()]),u.dispose(),f=l.map(function(C,S){return{score:C,idx:S}}).filter(function(C){return C.score>n}).map(function(C){var S=C.idx;return S}),h=f.map(function(C){var S=s[C].regions.arraySync();return new Xg(S[0][0],S[0][1],S[0][2],S[0][3])}),p=f.map(function(C,S){return t[C].calibrate(h[S])}),m=f.map(function(C){return l[C]}),g=[],v=[],y=[],p.length>0&&(i=Date.now(),b=pu(p,m,.7,!1),o.stage3_nms=Date.now()-i,g=b.map(function(C){return p[C]}),v=b.map(function(C){return m[C]}),y=b.map(function(C,S){return Array(5).fill(0).map(function(E,k){var R=s[C].points.arraySync();return new Ae(R[0][k]*(g[S].width+1)+g[S].left,R[0][k+5]*(g[S].height+1)+g[S].top)})})),s.forEach(function(C){C.regions.dispose(),C.scores.dispose(),C.points.dispose()}),[2,{boxes:g,scores:v,points:y}]}})})}var aj=function(e){pe(t,e);function t(){return e.call(this,"Mtcnn")||this}return t.prototype.load=function(n){return oe(this,void 0,void 0,function(){return ie(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.load.call(this,n)]})})},t.prototype.loadFromDisk=function(n){return oe(this,void 0,void 0,function(){return ie(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.loadFromDisk.call(this,n)]})})},t.prototype.forwardInput=function(n,r){return r===void 0&&(r={}),oe(this,void 0,void 0,function(){var o,i,a,s,u,l,c,d,f,h,p,m,g,v,y,b,w,C,S,E,k;return ie(this,function(R){switch(R.label){case 0:if(o=this.params,!o)throw new Error("Mtcnn - load model before inference");if(i=n.canvases[0],!i)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return a={},s=Date.now(),u=Q(function(){return GL($n(Dg.fromPixels(i)).toFloat())}),l=function(_){return u.dispose(),a.total=Date.now()-s,_},c=u.shape.slice(1),d=c[0],f=c[1],h=new Rk(r),p=h.minFaceSize,m=h.scaleFactor,g=h.maxNumScales,v=h.scoreThresholds,y=h.scaleSteps,b=(y||QL(p,m,[d,f])).filter(function(_){var N=_m(_,[d,f]);return Math.min(N.width,N.height)>ed}).slice(0,g),a.scales=b,a.pyramid=b.map(function(_){return _m(_,[d,f])}),w=Date.now(),[4,tj(u,b,v[0],o.pnet,a)];case 1:return C=R.sent(),a.total_stage1=Date.now()-w,C.boxes.length?(a.stage2_numInputBoxes=C.boxes.length,w=Date.now(),[4,rj(i,C.boxes,v[1],o.rnet,a)]):[2,l({results:[],stats:a})];case 2:return S=R.sent(),a.total_stage2=Date.now()-w,S.boxes.length?(a.stage3_numInputBoxes=S.boxes.length,w=Date.now(),[4,ij(i,S.boxes,v[2],o.onet,a)]):[2,l({results:[],stats:a})];case 3:return E=R.sent(),a.total_stage3=Date.now()-w,k=E.boxes.map(function(_,N){return Ug(Og({},new Vr(E.scores[N],new Fg(_.left/f,_.top/d,_.width/f,_.height/d),{height:d,width:f})),new OB(E.points[N].map(function(I){return I.sub(new Ae(_.left,_.top)).div(new Ae(_.width,_.height))}),{width:_.width,height:_.height}))}),[2,l({results:k,stats:a})]}})})},t.prototype.forward=function(n,r){return r===void 0&&(r={}),oe(this,void 0,void 0,function(){var o;return ie(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,kt(n)];case 1:return[4,o.apply(this,[i.sent(),r])];case 2:return[2,i.sent().results]}})})},t.prototype.forwardWithStats=function(n,r){return r===void 0&&(r={}),oe(this,void 0,void 0,function(){var o;return ie(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,kt(n)];case 1:return[2,o.apply(this,[i.sent(),r])]}})})},t.prototype.getDefaultModelName=function(){return"mtcnn_model"},t.prototype.extractParamsFromWeigthMap=function(n){return YL(n)},t.prototype.extractParams=function(n){return qL(n)},t}(co),sj=.4,uj=[new Ae(1.603231,2.094468),new Ae(6.041143,7.080126),new Ae(2.882459,3.518061),new Ae(4.266906,5.178857),new Ae(9.041765,10.66308)],lj=[117.001,114.697,97.404],cj=function(e){pe(t,e);function t(){var n=this,r={withSeparableConvs:!0,iouThreshold:sj,classes:["face"],anchors:uj,meanRgb:lj,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return n=e.call(this,r)||this,n}return Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(n,r){return oe(this,void 0,void 0,function(){var o;return ie(this,function(i){switch(i.label){case 0:return[4,this.detect(n,r)];case 1:return o=i.sent(),[2,o.map(function(a){return new Vr(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},t.prototype.extractParamsFromWeigthMap=function(n){return e.prototype.extractParamsFromWeigthMap.call(this,n)},t}(Ak),on={ssdMobilenetv1:new Tk,tinyFaceDetector:new cj,tinyYolov2:new HL,mtcnn:new aj,faceLandmark68Net:new wk,faceLandmark68TinyNet:new fL,faceRecognitionNet:new xL,faceExpressionNet:new JB,ageGenderNet:new uL},Dk=function(e){pe(t,e);function t(n,r,o){var i=e.call(this)||this;return i.parentTask=n,i.input=r,i.extractedFaces=o,i}return t}(Lu),Qg=function(e){pe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return oe(this,void 0,void 0,function(){var n,r,o=this;return ie(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),[4,Gd(n,this.input,function(a){return oe(o,void 0,void 0,function(){return ie(this,function(s){switch(s.label){case 0:return[4,Promise.all(a.map(function(u){return on.faceExpressionNet.predictExpressions(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,n.map(function(a,s){return yk(a,r[s])})]}})})},t.prototype.withAgeAndGender=function(){return new t0(this,this.input)},t}(Dk),Jg=function(e){pe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return oe(this,void 0,void 0,function(){var n,r;return ie(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),n?[4,qg(n,this.input,function(i){return on.faceExpressionNet.predictExpressions(i)},this.extractedFaces)]:[2];case 2:return r=o.sent(),[2,yk(n,r)]}})})},t.prototype.withAgeAndGender=function(){return new n0(this,this.input)},t}(Dk),Zg=function(e){pe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new r0(this,this.input)},t.prototype.withFaceDescriptors=function(){return new i0(this,this.input)},t}(Qg),e0=function(e){pe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new o0(this,this.input)},t.prototype.withFaceDescriptor=function(){return new a0(this,this.input)},t}(Jg),Mk=function(e){pe(t,e);function t(n,r,o){var i=e.call(this)||this;return i.parentTask=n,i.input=r,i.extractedFaces=o,i}return t}(Lu),t0=function(e){pe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return oe(this,void 0,void 0,function(){var n,r,o=this;return ie(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),[4,Gd(n,this.input,function(a){return oe(o,void 0,void 0,function(){return ie(this,function(s){switch(s.label){case 0:return[4,Promise.all(a.map(function(u){return on.ageGenderNet.predictAgeAndGender(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,n.map(function(a,s){var u=r[s],l=u.age,c=u.gender,d=u.genderProbability;return kk(_k(a,c,d),l)})]}})})},t.prototype.withFaceExpressions=function(){return new Qg(this,this.input)},t}(Mk),n0=function(e){pe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return oe(this,void 0,void 0,function(){var n,r,o,i,a;return ie(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?[4,qg(n,this.input,function(u){return on.ageGenderNet.predictAgeAndGender(u)},this.extractedFaces)]:[2];case 2:return r=s.sent(),o=r.age,i=r.gender,a=r.genderProbability,[2,kk(_k(n,i,a),o)]}})})},t.prototype.withFaceExpressions=function(){return new Jg(this,this.input)},t}(Mk),r0=function(e){pe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new Zg(this,this.input)},t.prototype.withFaceDescriptors=function(){return new i0(this,this.input)},t}(t0),o0=function(e){pe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new e0(this,this.input)},t.prototype.withFaceDescriptor=function(){return new a0(this,this.input)},t}(n0),Fk=function(e){pe(t,e);function t(n,r){var o=e.call(this)||this;return o.parentTask=n,o.input=r,o}return t}(Lu),i0=function(e){pe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return oe(this,void 0,void 0,function(){var n,r;return ie(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),[4,Gd(n,this.input,function(i){return Promise.all(i.map(function(a){return on.faceRecognitionNet.computeFaceDescriptor(a)}))},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return r=o.sent(),[2,r.map(function(i,a){return Ek(n[a],i)})]}})})},t.prototype.withFaceExpressions=function(){return new Zg(this,this.input)},t.prototype.withAgeAndGender=function(){return new r0(this,this.input)},t}(Fk),a0=function(e){pe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return oe(this,void 0,void 0,function(){var n,r;return ie(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),n?[4,qg(n,this.input,function(i){return on.faceRecognitionNet.computeFaceDescriptor(i)},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return r=o.sent(),[2,Ek(n,r)]}})})},t.prototype.withFaceExpressions=function(){return new e0(this,this.input)},t.prototype.withAgeAndGender=function(){return new o0(this,this.input)},t}(Fk),Ok=function(e){pe(t,e);function t(n,r,o){var i=e.call(this)||this;return i.parentTask=n,i.input=r,i.useTinyLandmarkNet=o,i}return Object.defineProperty(t.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?on.faceLandmark68TinyNet:on.faceLandmark68Net},enumerable:!0,configurable:!0}),t}(Lu),dj=function(e){pe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return oe(this,void 0,void 0,function(){var n,r,o,i,a,s=this;return ie(this,function(u){switch(u.label){case 0:return[4,this.parentTask];case 1:return n=u.sent(),r=n.map(function(l){return l.detection}),this.input instanceof qe?[4,zg(this.input,r)]:[3,3];case 2:return i=u.sent(),[3,5];case 3:return[4,jg(this.input,r)];case 4:i=u.sent(),u.label=5;case 5:return o=i,[4,Promise.all(o.map(function(l){return s.landmarkNet.detectLandmarks(l)}))];case 6:return a=u.sent(),o.forEach(function(l){return l instanceof qe&&l.dispose()}),[2,n.map(function(l,c){return Ug(l,a[c])})]}})})},t.prototype.withFaceExpressions=function(){return new Zg(this,this.input)},t.prototype.withAgeAndGender=function(){return new r0(this,this.input)},t.prototype.withFaceDescriptors=function(){return new i0(this,this.input)},t}(Ok),fj=function(e){pe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return oe(this,void 0,void 0,function(){var n,r,o,i,a;return ie(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?(r=n.detection,this.input instanceof qe?[4,zg(this.input,[r])]:[3,3]):[2];case 2:return i=s.sent(),[3,5];case 3:return[4,jg(this.input,[r])];case 4:i=s.sent(),s.label=5;case 5:return o=i,[4,this.landmarkNet.detectLandmarks(o[0])];case 6:return a=s.sent(),o.forEach(function(u){return u instanceof qe&&u.dispose()}),[2,Ug(n,a)]}})})},t.prototype.withFaceExpressions=function(){return new e0(this,this.input)},t.prototype.withAgeAndGender=function(){return new o0(this,this.input)},t.prototype.withFaceDescriptor=function(){return new a0(this,this.input)},t}(Ok),Bk=function(e){pe(t,e);function t(n,r){r===void 0&&(r=new Hd);var o=e.call(this)||this;return o.input=n,o.options=r,o}return t}(Lu),Lk=function(e){pe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return oe(this,void 0,void 0,function(){var n,r,o,i;return ie(this,function(a){switch(a.label){case 0:return n=this,r=n.input,o=n.options,o instanceof Rk?[4,on.mtcnn.forward(r,o)]:[3,2];case 1:return[2,a.sent().map(function(s){return s.detection})];case 2:if(i=o instanceof Ik?function(s){return on.tinyFaceDetector.locateFaces(s,o)}:o instanceof Hd?function(s){return on.ssdMobilenetv1.locateFaces(s,o)}:o instanceof Kg?function(s){return on.tinyYolov2.locateFaces(s,o)}:null,!i)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,i(r)]}})})},t.prototype.runAndExtendWithFaceDetections=function(){var n=this;return new Promise(function(r){return oe(n,void 0,void 0,function(){var o;return ie(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return o=i.sent(),[2,r(o.map(function(a){return Og({},a)}))]}})})})},t.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new dj(this.runAndExtendWithFaceDetections(),this.input,n)},t.prototype.withFaceExpressions=function(){return new Qg(this.runAndExtendWithFaceDetections(),this.input)},t.prototype.withAgeAndGender=function(){return new t0(this.runAndExtendWithFaceDetections(),this.input)},t}(Bk);(function(e){pe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return oe(this,void 0,void 0,function(){var n,r;return ie(this,function(o){switch(o.label){case 0:return[4,new Lk(this.input,this.options)];case 1:return n=o.sent(),r=n[0],n.forEach(function(i){i.score>r.score&&(r=i)}),[2,r]}})})},t.prototype.runAndExtendWithFaceDetection=function(){var n=this;return new Promise(function(r){return oe(n,void 0,void 0,function(){var o;return ie(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return o=i.sent(),[2,r(o?Og({},o):void 0)]}})})})},t.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new fj(this.runAndExtendWithFaceDetection(),this.input,n)},t.prototype.withFaceExpressions=function(){return new Jg(this.runAndExtendWithFaceDetection(),this.input)},t.prototype.withAgeAndGender=function(){return new n0(this.runAndExtendWithFaceDetection(),this.input)},t})(Bk);function hj(e,t){return t===void 0&&(t=new Hd),new Lk(e,t)}function pj(e,t){if(e.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(e),r=Array.from(t);return Math.sqrt(n.map(function(o,i){return o-r[i]}).reduce(function(o,i){return o+Math.pow(i,2)},0))}(function(){function e(t,n){n===void 0&&(n=.6),this._distanceThreshold=n;var r=Array.isArray(t)?t:[t];if(!r.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var o=1,i=function(){return"person "+o++};this._labeledDescriptors=r.map(function(a){if(a instanceof Sl)return a;if(a instanceof Float32Array)return new Sl(i(),[a]);if(a.descriptor&&a.descriptor instanceof Float32Array)return new Sl(i(),[a.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(e.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),e.prototype.computeMeanDistance=function(t,n){return n.map(function(r){return pj(r,t)}).reduce(function(r,o){return r+o},0)/(n.length||1)},e.prototype.matchDescriptor=function(t){var n=this;return this.labeledDescriptors.map(function(r){var o=r.descriptors,i=r.label;return new $x(i,n.computeMeanDistance(t,o))}).reduce(function(r,o){return r.distance<o.distance?r:o})},e.prototype.findBestMatch=function(t){var n=this.matchDescriptor(t);return n.distance<this.distanceThreshold?n:new $x("unknown",n.distance)},e.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(t){return t.toJSON()})}},e.fromJSON=function(t){var n=t.labeledDescriptors.map(function(r){return Sl.fromJSON(r)});return new e(n,t.distanceThreshold)},e})();function mj(e){return e?e instanceof HTMLImageElement?e.complete&&e.naturalWidth>0:e instanceof HTMLVideoElement?e.readyState>=2&&e.videoWidth>0:!1:!1}function vj(e){const t=Object.values(e).reduce((n,r)=>n+r,0);return t===0?{angry:0,disgusted:0,fearful:0,happy:0,neutral:1,sad:0,surprised:0}:{angry:e.angry/t,disgusted:e.disgusted/t,fearful:e.fearful/t,happy:e.happy/t,neutral:e.neutral/t,sad:e.sad/t,surprised:e.surprised/t}}const jk=["/models","https://raw.githubusercontent.com/justadudewhohacks/face-api.js/master/weights/","https://cdn.jsdelivr.net/gh/justadudewhohacks/face-api.js@master/weights/","https://cdn.jsdelivr.net/npm/@vladmandic/face-api/model/"];let td=!1,js=0,Ji=null;async function gj(){const e=jk[js];try{return await Promise.all([on.tinyFaceDetector.loadFromUri(e),on.faceExpressionNet.loadFromUri(e)]),!0}catch{return console.warn(`Failed to load from ${e}`),!1}}async function zk(){if(td)return!0;if(Ji)return Ji;Ji=(async()=>{for(;js<jk.length;){try{if(await gj())return td=!0,!0}catch{console.error(`Failed to load models from URL ${js}`)}js++}throw new Error("Failed to load models from all available sources")})();try{return await Ji}finally{Ji=null}}function Rm(){return td}function yj(){td=!1,js=0,Ji=null}async function Vk(e){try{if(!mj(e))throw new Error("Invalid image input");Rm()||await zk();const t=await hj(e,new Ik({inputSize:224})).withFaceExpressions();return!t||t.length===0?[]:t.map(n=>({expressions:vj(n.expressions),detection:{box:{x:n.detection.box.x,y:n.detection.box.y,width:n.detection.box.width,height:n.detection.box.height}}}))}catch(t){throw console.error("Face detection error:",t),t}}function xj(e,t,n){const[r,o]=P.useState([]),[i,a]=P.useState(!1),[s,u]=P.useState(null),l=P.useRef(),c=P.useRef(0),d=3;return P.useEffect(()=>{let f=!0;async function h(){var m;if(!(!((m=e.current)!=null&&m.video)||!t||!Rm())){try{const g=await Vk(e.current.video);f&&t&&(o(g),n==null||n(g),u(null),c.current=0)}catch{if(c.current+=1,c.current>=d){u("Detection failed. Please refresh the page and try again."),yj();return}}f&&t&&(l.current=requestAnimationFrame(h))}}async function p(){if(t&&!Rm()){a(!0),u(null);try{await zk(),f&&(a(!1),h())}catch{f&&(a(!1),u("Failed to load face detection models. Please check your internet connection and refresh the page."))}}else t?h():(o([]),n==null||n([]))}return p(),()=>{f=!1,l.current&&cancelAnimationFrame(l.current)}},[e,t,n]),{detections:r,isLoading:i,error:s}}const $k=P.createContext(void 0),bj=({children:e})=>{const[t,n]=P.useState(!1),r=()=>n(!t);return x.jsx($k.Provider,{value:{isWebcamOn:t,toggleWebcam:r},children:e})},Wk=()=>{const e=P.useContext($k);if(e===void 0)throw new Error("useWebcam must be used within a WebcamProvider");return e},wj={black:"#000",white:"#fff"},mu=wj,Cj={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},$i=Cj,Sj={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},Wi=Sj,Ej={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Ui=Ej,kj={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},Hi=kj,_j={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},Gi=_j,Rj={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},vs=Rj,Tj={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Aj=Tj;function vu(e){let t="https://mui.com/production-error/?code="+e;for(let n=1;n<arguments.length;n+=1)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+e+"; visit "+t+" for the full message."}const Ij=Object.freeze(Object.defineProperty({__proto__:null,default:vu},Symbol.toStringTag,{value:"Module"})),Tm="$$material";function de(){return de=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},de.apply(null,arguments)}function In(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}var Nj=!1;function Pj(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function Dj(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var Mj=function(){function e(n){var r=this;this._insertTag=function(o){var i;r.tags.length===0?r.insertionPoint?i=r.insertionPoint.nextSibling:r.prepend?i=r.container.firstChild:i=r.before:i=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(o,i),r.tags.push(o)},this.isSpeedy=n.speedy===void 0?!Nj:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(r){r.forEach(this._insertTag)},t.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(Dj(this));var o=this.tags[this.tags.length-1];if(this.isSpeedy){var i=Pj(o);try{i.insertRule(r,i.cssRules.length)}catch{}}else o.appendChild(document.createTextNode(r));this.ctr++},t.flush=function(){this.tags.forEach(function(r){var o;return(o=r.parentNode)==null?void 0:o.removeChild(r)}),this.tags=[],this.ctr=0},e}(),Ot="-ms-",nd="-moz-",Re="-webkit-",Uk="comm",s0="rule",u0="decl",Fj="@import",Hk="@keyframes",Oj="@layer",Bj=Math.abs,Kd=String.fromCharCode,Lj=Object.assign;function jj(e,t){return Nt(e,0)^45?(((t<<2^Nt(e,0))<<2^Nt(e,1))<<2^Nt(e,2))<<2^Nt(e,3):0}function Gk(e){return e.trim()}function zj(e,t){return(e=t.exec(e))?e[0]:e}function Te(e,t,n){return e.replace(t,n)}function Am(e,t){return e.indexOf(t)}function Nt(e,t){return e.charCodeAt(t)|0}function gu(e,t,n){return e.slice(t,n)}function Sr(e){return e.length}function l0(e){return e.length}function Tl(e,t){return t.push(e),e}function Vj(e,t){return e.map(t).join("")}var qd=1,Ua=1,Kk=0,hn=0,ct=0,Ya="";function Xd(e,t,n,r,o,i,a){return{value:e,root:t,parent:n,type:r,props:o,children:i,line:qd,column:Ua,length:a,return:""}}function gs(e,t){return Lj(Xd("",null,null,"",null,null,0),e,{length:-e.length},t)}function $j(){return ct}function Wj(){return ct=hn>0?Nt(Ya,--hn):0,Ua--,ct===10&&(Ua=1,qd--),ct}function kn(){return ct=hn<Kk?Nt(Ya,hn++):0,Ua++,ct===10&&(Ua=1,qd++),ct}function Fr(){return Nt(Ya,hn)}function ql(){return hn}function ju(e,t){return gu(Ya,e,t)}function yu(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function qk(e){return qd=Ua=1,Kk=Sr(Ya=e),hn=0,[]}function Xk(e){return Ya="",e}function Xl(e){return Gk(ju(hn-1,Im(e===91?e+2:e===40?e+1:e)))}function Uj(e){for(;(ct=Fr())&&ct<33;)kn();return yu(e)>2||yu(ct)>3?"":" "}function Hj(e,t){for(;--t&&kn()&&!(ct<48||ct>102||ct>57&&ct<65||ct>70&&ct<97););return ju(e,ql()+(t<6&&Fr()==32&&kn()==32))}function Im(e){for(;kn();)switch(ct){case e:return hn;case 34:case 39:e!==34&&e!==39&&Im(ct);break;case 40:e===41&&Im(e);break;case 92:kn();break}return hn}function Gj(e,t){for(;kn()&&e+ct!==47+10;)if(e+ct===42+42&&Fr()===47)break;return"/*"+ju(t,hn-1)+"*"+Kd(e===47?e:kn())}function Kj(e){for(;!yu(Fr());)kn();return ju(e,hn)}function qj(e){return Xk(Yl("",null,null,null,[""],e=qk(e),0,[0],e))}function Yl(e,t,n,r,o,i,a,s,u){for(var l=0,c=0,d=a,f=0,h=0,p=0,m=1,g=1,v=1,y=0,b="",w=o,C=i,S=r,E=b;g;)switch(p=y,y=kn()){case 40:if(p!=108&&Nt(E,d-1)==58){Am(E+=Te(Xl(y),"&","&\f"),"&\f")!=-1&&(v=-1);break}case 34:case 39:case 91:E+=Xl(y);break;case 9:case 10:case 13:case 32:E+=Uj(p);break;case 92:E+=Hj(ql()-1,7);continue;case 47:switch(Fr()){case 42:case 47:Tl(Xj(Gj(kn(),ql()),t,n),u);break;default:E+="/"}break;case 123*m:s[l++]=Sr(E)*v;case 125*m:case 59:case 0:switch(y){case 0:case 125:g=0;case 59+c:v==-1&&(E=Te(E,/\f/g,"")),h>0&&Sr(E)-d&&Tl(h>32?Xx(E+";",r,n,d-1):Xx(Te(E," ","")+";",r,n,d-2),u);break;case 59:E+=";";default:if(Tl(S=qx(E,t,n,l,c,o,s,b,w=[],C=[],d),i),y===123)if(c===0)Yl(E,t,S,S,w,i,d,s,C);else switch(f===99&&Nt(E,3)===110?100:f){case 100:case 108:case 109:case 115:Yl(e,S,S,r&&Tl(qx(e,S,S,0,0,o,s,b,o,w=[],d),C),o,C,d,s,r?w:C);break;default:Yl(E,S,S,S,[""],C,0,s,C)}}l=c=h=0,m=v=1,b=E="",d=a;break;case 58:d=1+Sr(E),h=p;default:if(m<1){if(y==123)--m;else if(y==125&&m++==0&&Wj()==125)continue}switch(E+=Kd(y),y*m){case 38:v=c>0?1:(E+="\f",-1);break;case 44:s[l++]=(Sr(E)-1)*v,v=1;break;case 64:Fr()===45&&(E+=Xl(kn())),f=Fr(),c=d=Sr(b=E+=Kj(ql())),y++;break;case 45:p===45&&Sr(E)==2&&(m=0)}}return i}function qx(e,t,n,r,o,i,a,s,u,l,c){for(var d=o-1,f=o===0?i:[""],h=l0(f),p=0,m=0,g=0;p<r;++p)for(var v=0,y=gu(e,d+1,d=Bj(m=a[p])),b=e;v<h;++v)(b=Gk(m>0?f[v]+" "+y:Te(y,/&\f/g,f[v])))&&(u[g++]=b);return Xd(e,t,n,o===0?s0:s,u,l,c)}function Xj(e,t,n){return Xd(e,t,n,Uk,Kd($j()),gu(e,2,-2),0)}function Xx(e,t,n,r){return Xd(e,t,n,u0,gu(e,0,r),gu(e,r+1,-1),r)}function Aa(e,t){for(var n="",r=l0(e),o=0;o<r;o++)n+=t(e[o],o,e,t)||"";return n}function Yj(e,t,n,r){switch(e.type){case Oj:if(e.children.length)break;case Fj:case u0:return e.return=e.return||e.value;case Uk:return"";case Hk:return e.return=e.value+"{"+Aa(e.children,r)+"}";case s0:e.value=e.props.join(",")}return Sr(n=Aa(e.children,r))?e.return=e.value+"{"+n+"}":""}function Qj(e){var t=l0(e);return function(n,r,o,i){for(var a="",s=0;s<t;s++)a+=e[s](n,r,o,i)||"";return a}}function Jj(e){return function(t){t.root||(t=t.return)&&e(t)}}var Zj=function(t,n,r){for(var o=0,i=0;o=i,i=Fr(),o===38&&i===12&&(n[r]=1),!yu(i);)kn();return ju(t,hn)},e6=function(t,n){var r=-1,o=44;do switch(yu(o)){case 0:o===38&&Fr()===12&&(n[r]=1),t[r]+=Zj(hn-1,n,r);break;case 2:t[r]+=Xl(o);break;case 4:if(o===44){t[++r]=Fr()===58?"&\f":"",n[r]=t[r].length;break}default:t[r]+=Kd(o)}while(o=kn());return t},t6=function(t,n){return Xk(e6(qk(t),n))},Yx=new WeakMap,n6=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var n=t.value,r=t.parent,o=t.column===r.column&&t.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(t.props.length===1&&n.charCodeAt(0)!==58&&!Yx.get(r))&&!o){Yx.set(t,!0);for(var i=[],a=t6(n,i),s=r.props,u=0,l=0;u<a.length;u++)for(var c=0;c<s.length;c++,l++)t.props[l]=i[u]?a[u].replace(/&\f/g,s[c]):s[c]+" "+a[u]}}},r6=function(t){if(t.type==="decl"){var n=t.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(t.return="",t.value="")}};function Yk(e,t){switch(jj(e,t)){case 5103:return Re+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Re+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Re+e+nd+e+Ot+e+e;case 6828:case 4268:return Re+e+Ot+e+e;case 6165:return Re+e+Ot+"flex-"+e+e;case 5187:return Re+e+Te(e,/(\w+).+(:[^]+)/,Re+"box-$1$2"+Ot+"flex-$1$2")+e;case 5443:return Re+e+Ot+"flex-item-"+Te(e,/flex-|-self/,"")+e;case 4675:return Re+e+Ot+"flex-line-pack"+Te(e,/align-content|flex-|-self/,"")+e;case 5548:return Re+e+Ot+Te(e,"shrink","negative")+e;case 5292:return Re+e+Ot+Te(e,"basis","preferred-size")+e;case 6060:return Re+"box-"+Te(e,"-grow","")+Re+e+Ot+Te(e,"grow","positive")+e;case 4554:return Re+Te(e,/([^-])(transform)/g,"$1"+Re+"$2")+e;case 6187:return Te(Te(Te(e,/(zoom-|grab)/,Re+"$1"),/(image-set)/,Re+"$1"),e,"")+e;case 5495:case 3959:return Te(e,/(image-set\([^]*)/,Re+"$1$`$1");case 4968:return Te(Te(e,/(.+:)(flex-)?(.*)/,Re+"box-pack:$3"+Ot+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Re+e+e;case 4095:case 3583:case 4068:case 2532:return Te(e,/(.+)-inline(.+)/,Re+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Sr(e)-1-t>6)switch(Nt(e,t+1)){case 109:if(Nt(e,t+4)!==45)break;case 102:return Te(e,/(.+:)(.+)-([^]+)/,"$1"+Re+"$2-$3$1"+nd+(Nt(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~Am(e,"stretch")?Yk(Te(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(Nt(e,t+1)!==115)break;case 6444:switch(Nt(e,Sr(e)-3-(~Am(e,"!important")&&10))){case 107:return Te(e,":",":"+Re)+e;case 101:return Te(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Re+(Nt(e,14)===45?"inline-":"")+"box$3$1"+Re+"$2$3$1"+Ot+"$2box$3")+e}break;case 5936:switch(Nt(e,t+11)){case 114:return Re+e+Ot+Te(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Re+e+Ot+Te(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Re+e+Ot+Te(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Re+e+Ot+e+e}return e}var o6=function(t,n,r,o){if(t.length>-1&&!t.return)switch(t.type){case u0:t.return=Yk(t.value,t.length);break;case Hk:return Aa([gs(t,{value:Te(t.value,"@","@"+Re)})],o);case s0:if(t.length)return Vj(t.props,function(i){switch(zj(i,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Aa([gs(t,{props:[Te(i,/:(read-\w+)/,":"+nd+"$1")]})],o);case"::placeholder":return Aa([gs(t,{props:[Te(i,/:(plac\w+)/,":"+Re+"input-$1")]}),gs(t,{props:[Te(i,/:(plac\w+)/,":"+nd+"$1")]}),gs(t,{props:[Te(i,/:(plac\w+)/,Ot+"input-$1")]})],o)}return""})}},i6=[o6],Qk=function(t){var n=t.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(m){var g=m.getAttribute("data-emotion");g.indexOf(" ")!==-1&&(document.head.appendChild(m),m.setAttribute("data-s",""))})}var o=t.stylisPlugins||i6,i={},a,s=[];a=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(m){for(var g=m.getAttribute("data-emotion").split(" "),v=1;v<g.length;v++)i[g[v]]=!0;s.push(m)});var u,l=[n6,r6];{var c,d=[Yj,Jj(function(m){c.insert(m)})],f=Qj(l.concat(o,d)),h=function(g){return Aa(qj(g),f)};u=function(g,v,y,b){c=y,h(g?g+"{"+v.styles+"}":v.styles),b&&(p.inserted[v.name]=!0)}}var p={key:n,sheet:new Mj({key:n,container:a,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:i,registered:{},insert:u};return p.sheet.hydrate(s),p},Jk={exports:{}},De={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _t=typeof Symbol=="function"&&Symbol.for,c0=_t?Symbol.for("react.element"):60103,d0=_t?Symbol.for("react.portal"):60106,Yd=_t?Symbol.for("react.fragment"):60107,Qd=_t?Symbol.for("react.strict_mode"):60108,Jd=_t?Symbol.for("react.profiler"):60114,Zd=_t?Symbol.for("react.provider"):60109,ef=_t?Symbol.for("react.context"):60110,f0=_t?Symbol.for("react.async_mode"):60111,tf=_t?Symbol.for("react.concurrent_mode"):60111,nf=_t?Symbol.for("react.forward_ref"):60112,rf=_t?Symbol.for("react.suspense"):60113,a6=_t?Symbol.for("react.suspense_list"):60120,of=_t?Symbol.for("react.memo"):60115,af=_t?Symbol.for("react.lazy"):60116,s6=_t?Symbol.for("react.block"):60121,u6=_t?Symbol.for("react.fundamental"):60117,l6=_t?Symbol.for("react.responder"):60118,c6=_t?Symbol.for("react.scope"):60119;function Nn(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case c0:switch(e=e.type,e){case f0:case tf:case Yd:case Jd:case Qd:case rf:return e;default:switch(e=e&&e.$$typeof,e){case ef:case nf:case af:case of:case Zd:return e;default:return t}}case d0:return t}}}function Zk(e){return Nn(e)===tf}De.AsyncMode=f0;De.ConcurrentMode=tf;De.ContextConsumer=ef;De.ContextProvider=Zd;De.Element=c0;De.ForwardRef=nf;De.Fragment=Yd;De.Lazy=af;De.Memo=of;De.Portal=d0;De.Profiler=Jd;De.StrictMode=Qd;De.Suspense=rf;De.isAsyncMode=function(e){return Zk(e)||Nn(e)===f0};De.isConcurrentMode=Zk;De.isContextConsumer=function(e){return Nn(e)===ef};De.isContextProvider=function(e){return Nn(e)===Zd};De.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===c0};De.isForwardRef=function(e){return Nn(e)===nf};De.isFragment=function(e){return Nn(e)===Yd};De.isLazy=function(e){return Nn(e)===af};De.isMemo=function(e){return Nn(e)===of};De.isPortal=function(e){return Nn(e)===d0};De.isProfiler=function(e){return Nn(e)===Jd};De.isStrictMode=function(e){return Nn(e)===Qd};De.isSuspense=function(e){return Nn(e)===rf};De.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Yd||e===tf||e===Jd||e===Qd||e===rf||e===a6||typeof e=="object"&&e!==null&&(e.$$typeof===af||e.$$typeof===of||e.$$typeof===Zd||e.$$typeof===ef||e.$$typeof===nf||e.$$typeof===u6||e.$$typeof===l6||e.$$typeof===c6||e.$$typeof===s6)};De.typeOf=Nn;Jk.exports=De;var d6=Jk.exports,e_=d6,f6={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},h6={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},t_={};t_[e_.ForwardRef]=f6;t_[e_.Memo]=h6;var p6=!0;function n_(e,t,n){var r="";return n.split(" ").forEach(function(o){e[o]!==void 0?t.push(e[o]+";"):o&&(r+=o+" ")}),r}var h0=function(t,n,r){var o=t.key+"-"+n.name;(r===!1||p6===!1)&&t.registered[o]===void 0&&(t.registered[o]=n.styles)},p0=function(t,n,r){h0(t,n,r);var o=t.key+"-"+n.name;if(t.inserted[n.name]===void 0){var i=n;do t.insert(n===i?"."+o:"",i,t.sheet,!0),i=i.next;while(i!==void 0)}};function m6(e){for(var t=0,n,r=0,o=e.length;o>=4;++r,o-=4)n=e.charCodeAt(r)&255|(e.charCodeAt(++r)&255)<<8|(e.charCodeAt(++r)&255)<<16|(e.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,t=(n&65535)*1540483477+((n>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(o){case 3:t^=(e.charCodeAt(r+2)&255)<<16;case 2:t^=(e.charCodeAt(r+1)&255)<<8;case 1:t^=e.charCodeAt(r)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var v6={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function g6(e){var t=Object.create(null);return function(n){return t[n]===void 0&&(t[n]=e(n)),t[n]}}var y6=!1,x6=/[A-Z]|^ms/g,b6=/_EMO_([^_]+?)_([^]*?)_EMO_/g,r_=function(t){return t.charCodeAt(1)===45},Qx=function(t){return t!=null&&typeof t!="boolean"},Wh=g6(function(e){return r_(e)?e:e.replace(x6,"-$&").toLowerCase()}),Jx=function(t,n){switch(t){case"animation":case"animationName":if(typeof n=="string")return n.replace(b6,function(r,o,i){return Er={name:o,styles:i,next:Er},o})}return v6[t]!==1&&!r_(t)&&typeof n=="number"&&n!==0?n+"px":n},w6="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function xu(e,t,n){if(n==null)return"";var r=n;if(r.__emotion_styles!==void 0)return r;switch(typeof n){case"boolean":return"";case"object":{var o=n;if(o.anim===1)return Er={name:o.name,styles:o.styles,next:Er},o.name;var i=n;if(i.styles!==void 0){var a=i.next;if(a!==void 0)for(;a!==void 0;)Er={name:a.name,styles:a.styles,next:Er},a=a.next;var s=i.styles+";";return s}return C6(e,t,n)}case"function":{if(e!==void 0){var u=Er,l=n(e);return Er=u,xu(e,t,l)}break}}var c=n;if(t==null)return c;var d=t[c];return d!==void 0?d:c}function C6(e,t,n){var r="";if(Array.isArray(n))for(var o=0;o<n.length;o++)r+=xu(e,t,n[o])+";";else for(var i in n){var a=n[i];if(typeof a!="object"){var s=a;t!=null&&t[s]!==void 0?r+=i+"{"+t[s]+"}":Qx(s)&&(r+=Wh(i)+":"+Jx(i,s)+";")}else{if(i==="NO_COMPONENT_SELECTOR"&&y6)throw new Error(w6);if(Array.isArray(a)&&typeof a[0]=="string"&&(t==null||t[a[0]]===void 0))for(var u=0;u<a.length;u++)Qx(a[u])&&(r+=Wh(i)+":"+Jx(i,a[u])+";");else{var l=xu(e,t,a);switch(i){case"animation":case"animationName":{r+=Wh(i)+":"+l+";";break}default:r+=i+"{"+l+"}"}}}}return r}var Zx=/label:\s*([^\s;{]+)\s*(;|$)/g,Er;function sf(e,t,n){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var r=!0,o="";Er=void 0;var i=e[0];if(i==null||i.raw===void 0)r=!1,o+=xu(n,t,i);else{var a=i;o+=a[0]}for(var s=1;s<e.length;s++)if(o+=xu(n,t,e[s]),r){var u=i;o+=u[s]}Zx.lastIndex=0;for(var l="",c;(c=Zx.exec(o))!==null;)l+="-"+c[1];var d=m6(o)+l;return{name:d,styles:o,next:Er}}var S6=function(t){return t()},o_=O0["useInsertionEffect"]?O0["useInsertionEffect"]:!1,i_=o_||S6,eb=o_||P.useLayoutEffect,E6=!1,a_=P.createContext(typeof HTMLElement<"u"?Qk({key:"css"}):null),k6=a_.Provider,m0=function(t){return P.forwardRef(function(n,r){var o=P.useContext(a_);return t(n,o,r)})},Qa=P.createContext({}),v0={}.hasOwnProperty,Nm="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",_6=function(t,n){var r={};for(var o in n)v0.call(n,o)&&(r[o]=n[o]);return r[Nm]=t,r},R6=function(t){var n=t.cache,r=t.serialized,o=t.isStringTag;return h0(n,r,o),i_(function(){return p0(n,r,o)}),null},T6=m0(function(e,t,n){var r=e.css;typeof r=="string"&&t.registered[r]!==void 0&&(r=t.registered[r]);var o=e[Nm],i=[r],a="";typeof e.className=="string"?a=n_(t.registered,i,e.className):e.className!=null&&(a=e.className+" ");var s=sf(i,void 0,P.useContext(Qa));a+=t.key+"-"+s.name;var u={};for(var l in e)v0.call(e,l)&&l!=="css"&&l!==Nm&&!E6&&(u[l]=e[l]);return u.className=a,n&&(u.ref=n),P.createElement(P.Fragment,null,P.createElement(R6,{cache:t,serialized:s,isStringTag:typeof o=="string"}),P.createElement(o,u))}),A6=T6,Uh={exports:{}},tb;function s_(){return tb||(tb=1,function(e){function t(){return e.exports=t=Object.assign?Object.assign.bind():function(n){for(var r=1;r<arguments.length;r++){var o=arguments[r];for(var i in o)({}).hasOwnProperty.call(o,i)&&(n[i]=o[i])}return n},e.exports.__esModule=!0,e.exports.default=e.exports,t.apply(null,arguments)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(Uh)),Uh.exports}s_();var nb=function(t,n){var r=arguments;if(n==null||!v0.call(n,"css"))return P.createElement.apply(void 0,r);var o=r.length,i=new Array(o);i[0]=A6,i[1]=_6(t,n);for(var a=2;a<o;a++)i[a]=r[a];return P.createElement.apply(null,i)};(function(e){var t;t||(t=e.JSX||(e.JSX={}))})(nb||(nb={}));var I6=m0(function(e,t){var n=e.styles,r=sf([n],void 0,P.useContext(Qa)),o=P.useRef();return eb(function(){var i=t.key+"-global",a=new t.sheet.constructor({key:i,nonce:t.sheet.nonce,container:t.sheet.container,speedy:t.sheet.isSpeedy}),s=!1,u=document.querySelector('style[data-emotion="'+i+" "+r.name+'"]');return t.sheet.tags.length&&(a.before=t.sheet.tags[0]),u!==null&&(s=!0,u.setAttribute("data-emotion",i),a.hydrate([u])),o.current=[a,s],function(){a.flush()}},[t]),eb(function(){var i=o.current,a=i[0],s=i[1];if(s){i[1]=!1;return}if(r.next!==void 0&&p0(t,r.next,!0),a.tags.length){var u=a.tags[a.tags.length-1].nextElementSibling;a.before=u,a.flush()}t.insert("",r,a,!1)},[t,r.name]),null});function u_(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return sf(t)}function uf(){var e=u_.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function N6(e){var t=Object.create(null);return function(n){return t[n]===void 0&&(t[n]=e(n)),t[n]}}var P6=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,D6=N6(function(e){return P6.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),M6=!1,F6=D6,O6=function(t){return t!=="theme"},rb=function(t){return typeof t=="string"&&t.charCodeAt(0)>96?F6:O6},ob=function(t,n,r){var o;if(n){var i=n.shouldForwardProp;o=t.__emotion_forwardProp&&i?function(a){return t.__emotion_forwardProp(a)&&i(a)}:i}return typeof o!="function"&&r&&(o=t.__emotion_forwardProp),o},B6=function(t){var n=t.cache,r=t.serialized,o=t.isStringTag;return h0(n,r,o),i_(function(){return p0(n,r,o)}),null},L6=function e(t,n){var r=t.__emotion_real===t,o=r&&t.__emotion_base||t,i,a;n!==void 0&&(i=n.label,a=n.target);var s=ob(t,n,r),u=s||rb(o),l=!u("as");return function(){var c=arguments,d=r&&t.__emotion_styles!==void 0?t.__emotion_styles.slice(0):[];if(i!==void 0&&d.push("label:"+i+";"),c[0]==null||c[0].raw===void 0)d.push.apply(d,c);else{var f=c[0];d.push(f[0]);for(var h=c.length,p=1;p<h;p++)d.push(c[p],f[p])}var m=m0(function(g,v,y){var b=l&&g.as||o,w="",C=[],S=g;if(g.theme==null){S={};for(var E in g)S[E]=g[E];S.theme=P.useContext(Qa)}typeof g.className=="string"?w=n_(v.registered,C,g.className):g.className!=null&&(w=g.className+" ");var k=sf(d.concat(C),v.registered,S);w+=v.key+"-"+k.name,a!==void 0&&(w+=" "+a);var R=l&&s===void 0?rb(b):u,_={};for(var N in g)l&&N==="as"||R(N)&&(_[N]=g[N]);return _.className=w,y&&(_.ref=y),P.createElement(P.Fragment,null,P.createElement(B6,{cache:v,serialized:k,isStringTag:typeof b=="string"}),P.createElement(b,_))});return m.displayName=i!==void 0?i:"Styled("+(typeof o=="string"?o:o.displayName||o.name||"Component")+")",m.defaultProps=t.defaultProps,m.__emotion_real=m,m.__emotion_base=o,m.__emotion_styles=d,m.__emotion_forwardProp=s,Object.defineProperty(m,"toString",{value:function(){return a===void 0&&M6?"NO_COMPONENT_SELECTOR":"."+a}}),m.withComponent=function(g,v){var y=e(g,de({},n,v,{shouldForwardProp:ob(m,v,!0)}));return y.apply(void 0,d)},m}},j6=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],Pm=L6.bind(null);j6.forEach(function(e){Pm[e]=Pm(e)});let Dm;typeof document=="object"&&(Dm=Qk({key:"css",prepend:!0}));function z6(e){const{injectFirst:t,children:n}=e;return t&&Dm?x.jsx(k6,{value:Dm,children:n}):n}function V6(e){return e==null||Object.keys(e).length===0}function $6(e){const{styles:t,defaultTheme:n={}}=e,r=typeof t=="function"?o=>t(V6(o)?n:o):t;return x.jsx(I6,{styles:r})}/**
 * @mui/styled-engine v5.16.13
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function W6(e,t){return Pm(e,t)}const U6=(e,t)=>{Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))},H6=Object.freeze(Object.defineProperty({__proto__:null,GlobalStyles:$6,StyledEngineProvider:z6,ThemeContext:Qa,css:u_,default:W6,internal_processStyles:U6,keyframes:uf},Symbol.toStringTag,{value:"Module"}));function So(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function l_(e){if(P.isValidElement(e)||!So(e))return e;const t={};return Object.keys(e).forEach(n=>{t[n]=l_(e[n])}),t}function Or(e,t,n={clone:!0}){const r=n.clone?de({},e):e;return So(e)&&So(t)&&Object.keys(t).forEach(o=>{P.isValidElement(t[o])?r[o]=t[o]:So(t[o])&&Object.prototype.hasOwnProperty.call(e,o)&&So(e[o])?r[o]=Or(e[o],t[o],n):n.clone?r[o]=So(t[o])?l_(t[o]):t[o]:r[o]=t[o]}),r}const G6=Object.freeze(Object.defineProperty({__proto__:null,default:Or,isPlainObject:So},Symbol.toStringTag,{value:"Module"})),K6=["values","unit","step"],q6=e=>{const t=Object.keys(e).map(n=>({key:n,val:e[n]}))||[];return t.sort((n,r)=>n.val-r.val),t.reduce((n,r)=>de({},n,{[r.key]:r.val}),{})};function c_(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5}=e,o=In(e,K6),i=q6(t),a=Object.keys(i);function s(f){return`@media (min-width:${typeof t[f]=="number"?t[f]:f}${n})`}function u(f){return`@media (max-width:${(typeof t[f]=="number"?t[f]:f)-r/100}${n})`}function l(f,h){const p=a.indexOf(h);return`@media (min-width:${typeof t[f]=="number"?t[f]:f}${n}) and (max-width:${(p!==-1&&typeof t[a[p]]=="number"?t[a[p]]:h)-r/100}${n})`}function c(f){return a.indexOf(f)+1<a.length?l(f,a[a.indexOf(f)+1]):s(f)}function d(f){const h=a.indexOf(f);return h===0?s(a[1]):h===a.length-1?u(a[h]):l(f,a[a.indexOf(f)+1]).replace("@media","@media not all and")}return de({keys:a,values:i,up:s,down:u,between:l,only:c,not:d,unit:n},o)}const X6={borderRadius:4},Y6=X6;function zs(e,t){return t?Or(e,t,{clone:!1}):e}const g0={xs:0,sm:600,md:900,lg:1200,xl:1536},ib={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${g0[e]}px)`};function io(e,t,n){const r=e.theme||{};if(Array.isArray(t)){const i=r.breakpoints||ib;return t.reduce((a,s,u)=>(a[i.up(i.keys[u])]=n(t[u]),a),{})}if(typeof t=="object"){const i=r.breakpoints||ib;return Object.keys(t).reduce((a,s)=>{if(Object.keys(i.values||g0).indexOf(s)!==-1){const u=i.up(s);a[u]=n(t[s],s)}else{const u=s;a[u]=t[u]}return a},{})}return n(t)}function Q6(e={}){var t;return((t=e.keys)==null?void 0:t.reduce((r,o)=>{const i=e.up(o);return r[i]={},r},{}))||{}}function J6(e,t){return e.reduce((n,r)=>{const o=n[r];return(!o||Object.keys(o).length===0)&&delete n[r],n},t)}function tn(e){if(typeof e!="string")throw new Error(vu(7));return e.charAt(0).toUpperCase()+e.slice(1)}const Z6=Object.freeze(Object.defineProperty({__proto__:null,default:tn},Symbol.toStringTag,{value:"Module"}));function lf(e,t,n=!0){if(!t||typeof t!="string")return null;if(e&&e.vars&&n){const r=`vars.${t}`.split(".").reduce((o,i)=>o&&o[i]?o[i]:null,e);if(r!=null)return r}return t.split(".").reduce((r,o)=>r&&r[o]!=null?r[o]:null,e)}function rd(e,t,n,r=n){let o;return typeof e=="function"?o=e(n):Array.isArray(e)?o=e[n]||r:o=lf(e,n)||r,t&&(o=t(o,r,e)),o}function st(e){const{prop:t,cssProperty:n=e.prop,themeKey:r,transform:o}=e,i=a=>{if(a[t]==null)return null;const s=a[t],u=a.theme,l=lf(u,r)||{};return io(a,s,d=>{let f=rd(l,o,d);return d===f&&typeof d=="string"&&(f=rd(l,o,`${t}${d==="default"?"":tn(d)}`,d)),n===!1?f:{[n]:f}})};return i.propTypes={},i.filterProps=[t],i}function ez(e){const t={};return n=>(t[n]===void 0&&(t[n]=e(n)),t[n])}const tz={m:"margin",p:"padding"},nz={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},ab={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},rz=ez(e=>{if(e.length>2)if(ab[e])e=ab[e];else return[e];const[t,n]=e.split(""),r=tz[t],o=nz[n]||"";return Array.isArray(o)?o.map(i=>r+i):[r+o]}),y0=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],x0=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...y0,...x0];function zu(e,t,n,r){var o;const i=(o=lf(e,t,!1))!=null?o:n;return typeof i=="number"?a=>typeof a=="string"?a:i*a:Array.isArray(i)?a=>typeof a=="string"?a:i[a]:typeof i=="function"?i:()=>{}}function d_(e){return zu(e,"spacing",8)}function Vu(e,t){if(typeof t=="string"||t==null)return t;const n=Math.abs(t),r=e(n);return t>=0?r:typeof r=="number"?-r:`-${r}`}function oz(e,t){return n=>e.reduce((r,o)=>(r[o]=Vu(t,n),r),{})}function iz(e,t,n,r){if(t.indexOf(n)===-1)return null;const o=rz(n),i=oz(o,r),a=e[n];return io(e,a,i)}function f_(e,t){const n=d_(e.theme);return Object.keys(e).map(r=>iz(e,t,r,n)).reduce(zs,{})}function tt(e){return f_(e,y0)}tt.propTypes={};tt.filterProps=y0;function nt(e){return f_(e,x0)}nt.propTypes={};nt.filterProps=x0;function az(e=8){if(e.mui)return e;const t=d_({spacing:e}),n=(...r)=>(r.length===0?[1]:r).map(i=>{const a=t(i);return typeof a=="number"?`${a}px`:a}).join(" ");return n.mui=!0,n}function cf(...e){const t=e.reduce((r,o)=>(o.filterProps.forEach(i=>{r[i]=o}),r),{}),n=r=>Object.keys(r).reduce((o,i)=>t[i]?zs(o,t[i](r)):o,{});return n.propTypes={},n.filterProps=e.reduce((r,o)=>r.concat(o.filterProps),[]),n}function Wn(e){return typeof e!="number"?e:`${e}px solid`}function Zn(e,t){return st({prop:e,themeKey:"borders",transform:t})}const sz=Zn("border",Wn),uz=Zn("borderTop",Wn),lz=Zn("borderRight",Wn),cz=Zn("borderBottom",Wn),dz=Zn("borderLeft",Wn),fz=Zn("borderColor"),hz=Zn("borderTopColor"),pz=Zn("borderRightColor"),mz=Zn("borderBottomColor"),vz=Zn("borderLeftColor"),gz=Zn("outline",Wn),yz=Zn("outlineColor"),df=e=>{if(e.borderRadius!==void 0&&e.borderRadius!==null){const t=zu(e.theme,"shape.borderRadius",4),n=r=>({borderRadius:Vu(t,r)});return io(e,e.borderRadius,n)}return null};df.propTypes={};df.filterProps=["borderRadius"];cf(sz,uz,lz,cz,dz,fz,hz,pz,mz,vz,df,gz,yz);const ff=e=>{if(e.gap!==void 0&&e.gap!==null){const t=zu(e.theme,"spacing",8),n=r=>({gap:Vu(t,r)});return io(e,e.gap,n)}return null};ff.propTypes={};ff.filterProps=["gap"];const hf=e=>{if(e.columnGap!==void 0&&e.columnGap!==null){const t=zu(e.theme,"spacing",8),n=r=>({columnGap:Vu(t,r)});return io(e,e.columnGap,n)}return null};hf.propTypes={};hf.filterProps=["columnGap"];const pf=e=>{if(e.rowGap!==void 0&&e.rowGap!==null){const t=zu(e.theme,"spacing",8),n=r=>({rowGap:Vu(t,r)});return io(e,e.rowGap,n)}return null};pf.propTypes={};pf.filterProps=["rowGap"];const xz=st({prop:"gridColumn"}),bz=st({prop:"gridRow"}),wz=st({prop:"gridAutoFlow"}),Cz=st({prop:"gridAutoColumns"}),Sz=st({prop:"gridAutoRows"}),Ez=st({prop:"gridTemplateColumns"}),kz=st({prop:"gridTemplateRows"}),_z=st({prop:"gridTemplateAreas"}),Rz=st({prop:"gridArea"});cf(ff,hf,pf,xz,bz,wz,Cz,Sz,Ez,kz,_z,Rz);function Ia(e,t){return t==="grey"?t:e}const Tz=st({prop:"color",themeKey:"palette",transform:Ia}),Az=st({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Ia}),Iz=st({prop:"backgroundColor",themeKey:"palette",transform:Ia});cf(Tz,Az,Iz);function yn(e){return e<=1&&e!==0?`${e*100}%`:e}const Nz=st({prop:"width",transform:yn}),b0=e=>{if(e.maxWidth!==void 0&&e.maxWidth!==null){const t=n=>{var r,o;const i=((r=e.theme)==null||(r=r.breakpoints)==null||(r=r.values)==null?void 0:r[n])||g0[n];return i?((o=e.theme)==null||(o=o.breakpoints)==null?void 0:o.unit)!=="px"?{maxWidth:`${i}${e.theme.breakpoints.unit}`}:{maxWidth:i}:{maxWidth:yn(n)}};return io(e,e.maxWidth,t)}return null};b0.filterProps=["maxWidth"];const Pz=st({prop:"minWidth",transform:yn}),Dz=st({prop:"height",transform:yn}),Mz=st({prop:"maxHeight",transform:yn}),Fz=st({prop:"minHeight",transform:yn});st({prop:"size",cssProperty:"width",transform:yn});st({prop:"size",cssProperty:"height",transform:yn});const Oz=st({prop:"boxSizing"});cf(Nz,b0,Pz,Dz,Mz,Fz,Oz);const Bz={border:{themeKey:"borders",transform:Wn},borderTop:{themeKey:"borders",transform:Wn},borderRight:{themeKey:"borders",transform:Wn},borderBottom:{themeKey:"borders",transform:Wn},borderLeft:{themeKey:"borders",transform:Wn},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Wn},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:df},color:{themeKey:"palette",transform:Ia},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Ia},backgroundColor:{themeKey:"palette",transform:Ia},p:{style:nt},pt:{style:nt},pr:{style:nt},pb:{style:nt},pl:{style:nt},px:{style:nt},py:{style:nt},padding:{style:nt},paddingTop:{style:nt},paddingRight:{style:nt},paddingBottom:{style:nt},paddingLeft:{style:nt},paddingX:{style:nt},paddingY:{style:nt},paddingInline:{style:nt},paddingInlineStart:{style:nt},paddingInlineEnd:{style:nt},paddingBlock:{style:nt},paddingBlockStart:{style:nt},paddingBlockEnd:{style:nt},m:{style:tt},mt:{style:tt},mr:{style:tt},mb:{style:tt},ml:{style:tt},mx:{style:tt},my:{style:tt},margin:{style:tt},marginTop:{style:tt},marginRight:{style:tt},marginBottom:{style:tt},marginLeft:{style:tt},marginX:{style:tt},marginY:{style:tt},marginInline:{style:tt},marginInlineStart:{style:tt},marginInlineEnd:{style:tt},marginBlock:{style:tt},marginBlockStart:{style:tt},marginBlockEnd:{style:tt},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:ff},rowGap:{style:pf},columnGap:{style:hf},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:yn},maxWidth:{style:b0},minWidth:{transform:yn},height:{transform:yn},maxHeight:{transform:yn},minHeight:{transform:yn},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}},$u=Bz;function Lz(...e){const t=e.reduce((r,o)=>r.concat(Object.keys(o)),[]),n=new Set(t);return e.every(r=>n.size===Object.keys(r).length)}function jz(e,t){return typeof e=="function"?e(t):e}function h_(){function e(n,r,o,i){const a={[n]:r,theme:o},s=i[n];if(!s)return{[n]:r};const{cssProperty:u=n,themeKey:l,transform:c,style:d}=s;if(r==null)return null;if(l==="typography"&&r==="inherit")return{[n]:r};const f=lf(o,l)||{};return d?d(a):io(a,r,p=>{let m=rd(f,c,p);return p===m&&typeof p=="string"&&(m=rd(f,c,`${n}${p==="default"?"":tn(p)}`,p)),u===!1?m:{[u]:m}})}function t(n){var r;const{sx:o,theme:i={}}=n||{};if(!o)return null;const a=(r=i.unstable_sxConfig)!=null?r:$u;function s(u){let l=u;if(typeof u=="function")l=u(i);else if(typeof u!="object")return u;if(!l)return null;const c=Q6(i.breakpoints),d=Object.keys(c);let f=c;return Object.keys(l).forEach(h=>{const p=jz(l[h],i);if(p!=null)if(typeof p=="object")if(a[h])f=zs(f,e(h,p,i,a));else{const m=io({theme:i},p,g=>({[h]:g}));Lz(m,p)?f[h]=t({sx:p,theme:i}):f=zs(f,m)}else f=zs(f,e(h,p,i,a))}),J6(d,f)}return Array.isArray(o)?o.map(s):s(o)}return t}const p_=h_();p_.filterProps=["sx"];const w0=p_;function m_(e,t){const n=this;return n.vars&&typeof n.getColorSchemeSelector=="function"?{[n.getColorSchemeSelector(e).replace(/(\[[^\]]+\])/,"*:where($1)")]:t}:n.palette.mode===e?t:{}}const zz=["breakpoints","palette","spacing","shape"];function v_(e={},...t){const{breakpoints:n={},palette:r={},spacing:o,shape:i={}}=e,a=In(e,zz),s=c_(n),u=az(o);let l=Or({breakpoints:s,direction:"ltr",components:{},palette:de({mode:"light"},r),spacing:u,shape:de({},Y6,i)},a);return l.applyStyles=m_,l=t.reduce((c,d)=>Or(c,d),l),l.unstable_sxConfig=de({},$u,a==null?void 0:a.unstable_sxConfig),l.unstable_sx=function(d){return w0({sx:d,theme:this})},l}const Vz=Object.freeze(Object.defineProperty({__proto__:null,default:v_,private_createBreakpoints:c_,unstable_applyStyles:m_},Symbol.toStringTag,{value:"Module"}));function $z(e){return Object.keys(e).length===0}function Wz(e=null){const t=P.useContext(Qa);return!t||$z(t)?e:t}const Uz=["sx"],Hz=e=>{var t,n;const r={systemProps:{},otherProps:{}},o=(t=e==null||(n=e.theme)==null?void 0:n.unstable_sxConfig)!=null?t:$u;return Object.keys(e).forEach(i=>{o[i]?r.systemProps[i]=e[i]:r.otherProps[i]=e[i]}),r};function Gz(e){const{sx:t}=e,n=In(e,Uz),{systemProps:r,otherProps:o}=Hz(n);let i;return Array.isArray(t)?i=[r,...t]:typeof t=="function"?i=(...a)=>{const s=t(...a);return So(s)?de({},r,s):r}:i=de({},r,t),de({},o,{sx:i})}const Kz=Object.freeze(Object.defineProperty({__proto__:null,default:w0,extendSxProp:Gz,unstable_createStyleFunctionSx:h_,unstable_defaultSxConfig:$u},Symbol.toStringTag,{value:"Module"})),sb=e=>e,qz=()=>{let e=sb;return{configure(t){e=t},generate(t){return e(t)},reset(){e=sb}}},Xz=qz(),Yz=Xz;function g_(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=g_(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function Ln(){for(var e,t,n=0,r="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=g_(e))&&(r&&(r+=" "),r+=t);return r}const Qz={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function C0(e,t,n="Mui"){const r=Qz[t];return r?`${n}-${r}`:`${Yz.generate(e)}-${t}`}function S0(e,t,n="Mui"){const r={};return t.forEach(o=>{r[o]=C0(e,o,n)}),r}var y_={exports:{}},Fe={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E0=Symbol.for("react.transitional.element"),k0=Symbol.for("react.portal"),mf=Symbol.for("react.fragment"),vf=Symbol.for("react.strict_mode"),gf=Symbol.for("react.profiler"),yf=Symbol.for("react.consumer"),xf=Symbol.for("react.context"),bf=Symbol.for("react.forward_ref"),wf=Symbol.for("react.suspense"),Cf=Symbol.for("react.suspense_list"),Sf=Symbol.for("react.memo"),Ef=Symbol.for("react.lazy"),Jz=Symbol.for("react.offscreen"),Zz=Symbol.for("react.client.reference");function er(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case E0:switch(e=e.type,e){case mf:case gf:case vf:case wf:case Cf:return e;default:switch(e=e&&e.$$typeof,e){case xf:case bf:case Ef:case Sf:return e;case yf:return e;default:return t}}case k0:return t}}}Fe.ContextConsumer=yf;Fe.ContextProvider=xf;Fe.Element=E0;Fe.ForwardRef=bf;Fe.Fragment=mf;Fe.Lazy=Ef;Fe.Memo=Sf;Fe.Portal=k0;Fe.Profiler=gf;Fe.StrictMode=vf;Fe.Suspense=wf;Fe.SuspenseList=Cf;Fe.isContextConsumer=function(e){return er(e)===yf};Fe.isContextProvider=function(e){return er(e)===xf};Fe.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===E0};Fe.isForwardRef=function(e){return er(e)===bf};Fe.isFragment=function(e){return er(e)===mf};Fe.isLazy=function(e){return er(e)===Ef};Fe.isMemo=function(e){return er(e)===Sf};Fe.isPortal=function(e){return er(e)===k0};Fe.isProfiler=function(e){return er(e)===gf};Fe.isStrictMode=function(e){return er(e)===vf};Fe.isSuspense=function(e){return er(e)===wf};Fe.isSuspenseList=function(e){return er(e)===Cf};Fe.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===mf||e===gf||e===vf||e===wf||e===Cf||e===Jz||typeof e=="object"&&e!==null&&(e.$$typeof===Ef||e.$$typeof===Sf||e.$$typeof===xf||e.$$typeof===yf||e.$$typeof===bf||e.$$typeof===Zz||e.getModuleId!==void 0)};Fe.typeOf=er;y_.exports=Fe;var ub=y_.exports;const eV=/^\s*function(?:\s|\s*\/\*.*\*\/\s*)+([^(\s/]*)\s*/;function x_(e){const t=`${e}`.match(eV);return t&&t[1]||""}function b_(e,t=""){return e.displayName||e.name||x_(e)||t}function lb(e,t,n){const r=b_(t);return e.displayName||(r!==""?`${n}(${r})`:n)}function tV(e){if(e!=null){if(typeof e=="string")return e;if(typeof e=="function")return b_(e,"Component");if(typeof e=="object")switch(e.$$typeof){case ub.ForwardRef:return lb(e,e.render,"ForwardRef");case ub.Memo:return lb(e,e.type,"memo");default:return}}}const nV=Object.freeze(Object.defineProperty({__proto__:null,default:tV,getFunctionName:x_},Symbol.toStringTag,{value:"Module"}));function od(e,t){const n=de({},t);return Object.keys(e).forEach(r=>{if(r.toString().match(/^(components|slots)$/))n[r]=de({},e[r],n[r]);else if(r.toString().match(/^(componentsProps|slotProps)$/)){const o=e[r]||{},i=t[r];n[r]={},!i||!Object.keys(i)?n[r]=o:!o||!Object.keys(o)?n[r]=i:(n[r]=de({},i),Object.keys(o).forEach(a=>{n[r][a]=od(o[a],i[a])}))}else n[r]===void 0&&(n[r]=e[r])}),n}const rV=typeof window<"u"?P.useLayoutEffect:P.useEffect,oV=rV;function iV(e,t=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER){return Math.max(t,Math.min(e,n))}const aV=Object.freeze(Object.defineProperty({__proto__:null,default:iV},Symbol.toStringTag,{value:"Module"}));function sV(e,t){typeof e=="function"?e(t):e&&(e.current=t)}function Al(e){const t=P.useRef(e);return oV(()=>{t.current=e}),P.useRef((...n)=>(0,t.current)(...n)).current}function cb(...e){return P.useMemo(()=>e.every(t=>t==null)?null:t=>{e.forEach(n=>{sV(n,t)})},e)}const db={};function uV(e,t){const n=P.useRef(db);return n.current===db&&(n.current=e(t)),n}const lV=[];function cV(e){P.useEffect(e,lV)}class kf{constructor(){this.currentId=null,this.clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new kf}start(t,n){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,n()},t)}}function dV(){const e=uV(kf.create).current;return cV(e.disposeEffect),e}let _f=!0,Mm=!1;const fV=new kf,hV={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function pV(e){const{type:t,tagName:n}=e;return!!(n==="INPUT"&&hV[t]&&!e.readOnly||n==="TEXTAREA"&&!e.readOnly||e.isContentEditable)}function mV(e){e.metaKey||e.altKey||e.ctrlKey||(_f=!0)}function Hh(){_f=!1}function vV(){this.visibilityState==="hidden"&&Mm&&(_f=!0)}function gV(e){e.addEventListener("keydown",mV,!0),e.addEventListener("mousedown",Hh,!0),e.addEventListener("pointerdown",Hh,!0),e.addEventListener("touchstart",Hh,!0),e.addEventListener("visibilitychange",vV,!0)}function yV(e){const{target:t}=e;try{return t.matches(":focus-visible")}catch{}return _f||pV(t)}function xV(){const e=P.useCallback(o=>{o!=null&&gV(o.ownerDocument)},[]),t=P.useRef(!1);function n(){return t.current?(Mm=!0,fV.start(100,()=>{Mm=!1}),t.current=!1,!0):!1}function r(o){return yV(o)?(t.current=!0,!0):!1}return{isFocusVisibleRef:t,onFocus:r,onBlur:n,ref:e}}function w_(e,t,n=void 0){const r={};return Object.keys(e).forEach(o=>{r[o]=e[o].reduce((i,a)=>{if(a){const s=t(a);s!==""&&i.push(s),n&&n[a]&&i.push(n[a])}return i},[]).join(" ")}),r}const bV=P.createContext(null),C_=bV;function S_(){return P.useContext(C_)}const wV=typeof Symbol=="function"&&Symbol.for,CV=wV?Symbol.for("mui.nested"):"__THEME_NESTED__";function SV(e,t){return typeof t=="function"?t(e):de({},e,t)}function EV(e){const{children:t,theme:n}=e,r=S_(),o=P.useMemo(()=>{const i=r===null?n:SV(r,n);return i!=null&&(i[CV]=r!==null),i},[n,r]);return x.jsx(C_.Provider,{value:o,children:t})}const kV=["value"],_V=P.createContext();function RV(e){let{value:t}=e,n=In(e,kV);return x.jsx(_V.Provider,de({value:t??!0},n))}const E_=P.createContext(void 0);function TV({value:e,children:t}){return x.jsx(E_.Provider,{value:e,children:t})}function AV(e){const{theme:t,name:n,props:r}=e;if(!t||!t.components||!t.components[n])return r;const o=t.components[n];return o.defaultProps?od(o.defaultProps,r):!o.styleOverrides&&!o.variants?od(o,r):r}function IV({props:e,name:t}){const n=P.useContext(E_);return AV({props:e,name:t,theme:{components:n}})}const fb={};function hb(e,t,n,r=!1){return P.useMemo(()=>{const o=e&&t[e]||t;if(typeof n=="function"){const i=n(o),a=e?de({},t,{[e]:i}):i;return r?()=>a:a}return e?de({},t,{[e]:n}):de({},t,n)},[e,t,n,r])}function NV(e){const{children:t,theme:n,themeId:r}=e,o=Wz(fb),i=S_()||fb,a=hb(r,o,n),s=hb(r,i,n,!0),u=a.direction==="rtl";return x.jsx(EV,{theme:s,children:x.jsx(Qa.Provider,{value:a,children:x.jsx(RV,{value:u,children:x.jsx(TV,{value:a==null?void 0:a.components,children:t})})})})}function PV(e,t){return de({toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}}},t)}var ut={},k_={exports:{}};(function(e){function t(n){return n&&n.__esModule?n:{default:n}}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(k_);var __=k_.exports;const DV=Ko(Ij),MV=Ko(aV);var R_=__;Object.defineProperty(ut,"__esModule",{value:!0});var Il=ut.alpha=N_;ut.blend=KV;ut.colorChannel=void 0;var FV=ut.darken=R0;ut.decomposeColor=Qn;ut.emphasize=P_;var OV=ut.getContrastRatio=$V;ut.getLuminance=id;ut.hexToRgb=T_;ut.hslToRgb=I_;var BV=ut.lighten=T0;ut.private_safeAlpha=WV;ut.private_safeColorChannel=void 0;ut.private_safeDarken=UV;ut.private_safeEmphasize=GV;ut.private_safeLighten=HV;ut.recomposeColor=Ja;ut.rgbToHex=VV;var pb=R_(DV),LV=R_(MV);function _0(e,t=0,n=1){return(0,LV.default)(e,t,n)}function T_(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let n=e.match(t);return n&&n[0].length===1&&(n=n.map(r=>r+r)),n?`rgb${n.length===4?"a":""}(${n.map((r,o)=>o<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function jV(e){const t=e.toString(16);return t.length===1?`0${t}`:t}function Qn(e){if(e.type)return e;if(e.charAt(0)==="#")return Qn(T_(e));const t=e.indexOf("("),n=e.substring(0,t);if(["rgb","rgba","hsl","hsla","color"].indexOf(n)===-1)throw new Error((0,pb.default)(9,e));let r=e.substring(t+1,e.length-1),o;if(n==="color"){if(r=r.split(" "),o=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(o)===-1)throw new Error((0,pb.default)(10,o))}else r=r.split(",");return r=r.map(i=>parseFloat(i)),{type:n,values:r,colorSpace:o}}const A_=e=>{const t=Qn(e);return t.values.slice(0,3).map((n,r)=>t.type.indexOf("hsl")!==-1&&r!==0?`${n}%`:n).join(" ")};ut.colorChannel=A_;const zV=(e,t)=>{try{return A_(e)}catch{return e}};ut.private_safeColorChannel=zV;function Ja(e){const{type:t,colorSpace:n}=e;let{values:r}=e;return t.indexOf("rgb")!==-1?r=r.map((o,i)=>i<3?parseInt(o,10):o):t.indexOf("hsl")!==-1&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),t.indexOf("color")!==-1?r=`${n} ${r.join(" ")}`:r=`${r.join(", ")}`,`${t}(${r})`}function VV(e){if(e.indexOf("#")===0)return e;const{values:t}=Qn(e);return`#${t.map((n,r)=>jV(r===3?Math.round(255*n):n)).join("")}`}function I_(e){e=Qn(e);const{values:t}=e,n=t[0],r=t[1]/100,o=t[2]/100,i=r*Math.min(o,1-o),a=(l,c=(l+n/30)%12)=>o-i*Math.max(Math.min(c-3,9-c,1),-1);let s="rgb";const u=[Math.round(a(0)*255),Math.round(a(8)*255),Math.round(a(4)*255)];return e.type==="hsla"&&(s+="a",u.push(t[3])),Ja({type:s,values:u})}function id(e){e=Qn(e);let t=e.type==="hsl"||e.type==="hsla"?Qn(I_(e)).values:e.values;return t=t.map(n=>(e.type!=="color"&&(n/=255),n<=.03928?n/12.92:((n+.055)/1.055)**2.4)),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function $V(e,t){const n=id(e),r=id(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}function N_(e,t){return e=Qn(e),t=_0(t),(e.type==="rgb"||e.type==="hsl")&&(e.type+="a"),e.type==="color"?e.values[3]=`/${t}`:e.values[3]=t,Ja(e)}function WV(e,t,n){try{return N_(e,t)}catch{return e}}function R0(e,t){if(e=Qn(e),t=_0(t),e.type.indexOf("hsl")!==-1)e.values[2]*=1-t;else if(e.type.indexOf("rgb")!==-1||e.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)e.values[n]*=1-t;return Ja(e)}function UV(e,t,n){try{return R0(e,t)}catch{return e}}function T0(e,t){if(e=Qn(e),t=_0(t),e.type.indexOf("hsl")!==-1)e.values[2]+=(100-e.values[2])*t;else if(e.type.indexOf("rgb")!==-1)for(let n=0;n<3;n+=1)e.values[n]+=(255-e.values[n])*t;else if(e.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)e.values[n]+=(1-e.values[n])*t;return Ja(e)}function HV(e,t,n){try{return T0(e,t)}catch{return e}}function P_(e,t=.15){return id(e)>.5?R0(e,t):T0(e,t)}function GV(e,t,n){try{return P_(e,t)}catch{return e}}function KV(e,t,n,r=1){const o=(u,l)=>Math.round((u**(1/r)*(1-n)+l**(1/r)*n)**r),i=Qn(e),a=Qn(t),s=[o(i.values[0],a.values[0]),o(i.values[1],a.values[1]),o(i.values[2],a.values[2])];return Ja({type:"rgb",values:s})}const qV=["mode","contrastThreshold","tonalOffset"],mb={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:mu.white,default:mu.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},Gh={text:{primary:mu.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:mu.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function vb(e,t,n,r){const o=r.light||r,i=r.dark||r*1.5;e[t]||(e.hasOwnProperty(n)?e[t]=e[n]:t==="light"?e.light=BV(e.main,o):t==="dark"&&(e.dark=FV(e.main,i)))}function XV(e="light"){return e==="dark"?{main:Ui[200],light:Ui[50],dark:Ui[400]}:{main:Ui[700],light:Ui[400],dark:Ui[800]}}function YV(e="light"){return e==="dark"?{main:Wi[200],light:Wi[50],dark:Wi[400]}:{main:Wi[500],light:Wi[300],dark:Wi[700]}}function QV(e="light"){return e==="dark"?{main:$i[500],light:$i[300],dark:$i[700]}:{main:$i[700],light:$i[400],dark:$i[800]}}function JV(e="light"){return e==="dark"?{main:Hi[400],light:Hi[300],dark:Hi[700]}:{main:Hi[700],light:Hi[500],dark:Hi[900]}}function ZV(e="light"){return e==="dark"?{main:Gi[400],light:Gi[300],dark:Gi[700]}:{main:Gi[800],light:Gi[500],dark:Gi[900]}}function e$(e="light"){return e==="dark"?{main:vs[400],light:vs[300],dark:vs[700]}:{main:"#ed6c02",light:vs[500],dark:vs[900]}}function t$(e){const{mode:t="light",contrastThreshold:n=3,tonalOffset:r=.2}=e,o=In(e,qV),i=e.primary||XV(t),a=e.secondary||YV(t),s=e.error||QV(t),u=e.info||JV(t),l=e.success||ZV(t),c=e.warning||e$(t);function d(m){return OV(m,Gh.text.primary)>=n?Gh.text.primary:mb.text.primary}const f=({color:m,name:g,mainShade:v=500,lightShade:y=300,darkShade:b=700})=>{if(m=de({},m),!m.main&&m[v]&&(m.main=m[v]),!m.hasOwnProperty("main"))throw new Error(vu(11,g?` (${g})`:"",v));if(typeof m.main!="string")throw new Error(vu(12,g?` (${g})`:"",JSON.stringify(m.main)));return vb(m,"light",y,r),vb(m,"dark",b,r),m.contrastText||(m.contrastText=d(m.main)),m},h={dark:Gh,light:mb};return Or(de({common:de({},mu),mode:t,primary:f({color:i,name:"primary"}),secondary:f({color:a,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:f({color:s,name:"error"}),warning:f({color:c,name:"warning"}),info:f({color:u,name:"info"}),success:f({color:l,name:"success"}),grey:Aj,contrastThreshold:n,getContrastText:d,augmentColor:f,tonalOffset:r},h[t]),o)}const n$=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function r$(e){return Math.round(e*1e5)/1e5}const gb={textTransform:"uppercase"},yb='"Roboto", "Helvetica", "Arial", sans-serif';function o$(e,t){const n=typeof t=="function"?t(e):t,{fontFamily:r=yb,fontSize:o=14,fontWeightLight:i=300,fontWeightRegular:a=400,fontWeightMedium:s=500,fontWeightBold:u=700,htmlFontSize:l=16,allVariants:c,pxToRem:d}=n,f=In(n,n$),h=o/14,p=d||(v=>`${v/l*h}rem`),m=(v,y,b,w,C)=>de({fontFamily:r,fontWeight:v,fontSize:p(y),lineHeight:b},r===yb?{letterSpacing:`${r$(w/y)}em`}:{},C,c),g={h1:m(i,96,1.167,-1.5),h2:m(i,60,1.2,-.5),h3:m(a,48,1.167,0),h4:m(a,34,1.235,.25),h5:m(a,24,1.334,0),h6:m(s,20,1.6,.15),subtitle1:m(a,16,1.75,.15),subtitle2:m(s,14,1.57,.1),body1:m(a,16,1.5,.15),body2:m(a,14,1.43,.15),button:m(s,14,1.75,.4,gb),caption:m(a,12,1.66,.4),overline:m(a,12,2.66,1,gb),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Or(de({htmlFontSize:l,pxToRem:p,fontFamily:r,fontSize:o,fontWeightLight:i,fontWeightRegular:a,fontWeightMedium:s,fontWeightBold:u},g),f,{clone:!1})}const i$=.2,a$=.14,s$=.12;function He(...e){return[`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px rgba(0,0,0,${i$})`,`${e[4]}px ${e[5]}px ${e[6]}px ${e[7]}px rgba(0,0,0,${a$})`,`${e[8]}px ${e[9]}px ${e[10]}px ${e[11]}px rgba(0,0,0,${s$})`].join(",")}const u$=["none",He(0,2,1,-1,0,1,1,0,0,1,3,0),He(0,3,1,-2,0,2,2,0,0,1,5,0),He(0,3,3,-2,0,3,4,0,0,1,8,0),He(0,2,4,-1,0,4,5,0,0,1,10,0),He(0,3,5,-1,0,5,8,0,0,1,14,0),He(0,3,5,-1,0,6,10,0,0,1,18,0),He(0,4,5,-2,0,7,10,1,0,2,16,1),He(0,5,5,-3,0,8,10,1,0,3,14,2),He(0,5,6,-3,0,9,12,1,0,3,16,2),He(0,6,6,-3,0,10,14,1,0,4,18,3),He(0,6,7,-4,0,11,15,1,0,4,20,3),He(0,7,8,-4,0,12,17,2,0,5,22,4),He(0,7,8,-4,0,13,19,2,0,5,24,4),He(0,7,9,-4,0,14,21,2,0,5,26,4),He(0,8,9,-5,0,15,22,2,0,6,28,5),He(0,8,10,-5,0,16,24,2,0,6,30,5),He(0,8,11,-5,0,17,26,2,0,6,32,5),He(0,9,11,-5,0,18,28,2,0,7,34,6),He(0,9,12,-6,0,19,29,2,0,7,36,6),He(0,10,13,-6,0,20,31,3,0,8,38,7),He(0,10,13,-6,0,21,33,3,0,8,40,7),He(0,10,14,-6,0,22,35,3,0,8,42,7),He(0,11,14,-7,0,23,36,3,0,9,44,8),He(0,11,15,-7,0,24,38,3,0,9,46,8)],l$=u$,c$=["duration","easing","delay"],d$={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},f$={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function xb(e){return`${Math.round(e)}ms`}function h$(e){if(!e)return 0;const t=e/36;return Math.round((4+15*t**.25+t/5)*10)}function p$(e){const t=de({},d$,e.easing),n=de({},f$,e.duration);return de({getAutoHeightDuration:h$,create:(o=["all"],i={})=>{const{duration:a=n.standard,easing:s=t.easeInOut,delay:u=0}=i;return In(i,c$),(Array.isArray(o)?o:[o]).map(l=>`${l} ${typeof a=="string"?a:xb(a)} ${s} ${typeof u=="string"?u:xb(u)}`).join(",")}},e,{easing:t,duration:n})}const m$={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},v$=m$,g$=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function D_(e={},...t){const{mixins:n={},palette:r={},transitions:o={},typography:i={}}=e,a=In(e,g$);if(e.vars)throw new Error(vu(18));const s=t$(r),u=v_(e);let l=Or(u,{mixins:PV(u.breakpoints,n),palette:s,shadows:l$.slice(),typography:o$(s,i),transitions:p$(o),zIndex:de({},v$)});return l=Or(l,a),l=t.reduce((c,d)=>Or(c,d),l),l.unstable_sxConfig=de({},$u,a==null?void 0:a.unstable_sxConfig),l.unstable_sx=function(d){return w0({sx:d,theme:this})},l}const y$=D_(),x$=y$;var Wu={},Kh={exports:{}},bb;function b$(){return bb||(bb=1,function(e){function t(n,r){if(n==null)return{};var o={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(r.includes(i))continue;o[i]=n[i]}return o}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(Kh)),Kh.exports}const w$=Ko(H6),C$=Ko(G6),S$=Ko(Z6),E$=Ko(nV),k$=Ko(Vz),_$=Ko(Kz);var Za=__;Object.defineProperty(Wu,"__esModule",{value:!0});var R$=Wu.default=z$;Wu.shouldForwardProp=Ql;Wu.systemDefaultTheme=void 0;var Bn=Za(s_()),Fm=Za(b$()),wb=M$(w$),T$=C$;Za(S$);Za(E$);var A$=Za(k$),I$=Za(_$);const N$=["ownerState"],P$=["variants"],D$=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function M_(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,n=new WeakMap;return(M_=function(r){return r?n:t})(e)}function M$(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=M_(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(i!=="default"&&Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(r,i,a):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}function F$(e){return Object.keys(e).length===0}function O$(e){return typeof e=="string"&&e.charCodeAt(0)>96}function Ql(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const B$=Wu.systemDefaultTheme=(0,A$.default)(),L$=e=>e&&e.charAt(0).toLowerCase()+e.slice(1);function Nl({defaultTheme:e,theme:t,themeId:n}){return F$(t)?e:t[n]||t}function j$(e){return e?(t,n)=>n[e]:null}function Jl(e,t){let{ownerState:n}=t,r=(0,Fm.default)(t,N$);const o=typeof e=="function"?e((0,Bn.default)({ownerState:n},r)):e;if(Array.isArray(o))return o.flatMap(i=>Jl(i,(0,Bn.default)({ownerState:n},r)));if(o&&typeof o=="object"&&Array.isArray(o.variants)){const{variants:i=[]}=o;let s=(0,Fm.default)(o,P$);return i.forEach(u=>{let l=!0;typeof u.props=="function"?l=u.props((0,Bn.default)({ownerState:n},r,n)):Object.keys(u.props).forEach(c=>{(n==null?void 0:n[c])!==u.props[c]&&r[c]!==u.props[c]&&(l=!1)}),l&&(Array.isArray(s)||(s=[s]),s.push(typeof u.style=="function"?u.style((0,Bn.default)({ownerState:n},r,n)):u.style))}),s}return o}function z$(e={}){const{themeId:t,defaultTheme:n=B$,rootShouldForwardProp:r=Ql,slotShouldForwardProp:o=Ql}=e,i=a=>(0,I$.default)((0,Bn.default)({},a,{theme:Nl((0,Bn.default)({},a,{defaultTheme:n,themeId:t}))}));return i.__mui_systemSx=!0,(a,s={})=>{(0,wb.internal_processStyles)(a,C=>C.filter(S=>!(S!=null&&S.__mui_systemSx)));const{name:u,slot:l,skipVariantsResolver:c,skipSx:d,overridesResolver:f=j$(L$(l))}=s,h=(0,Fm.default)(s,D$),p=c!==void 0?c:l&&l!=="Root"&&l!=="root"||!1,m=d||!1;let g,v=Ql;l==="Root"||l==="root"?v=r:l?v=o:O$(a)&&(v=void 0);const y=(0,wb.default)(a,(0,Bn.default)({shouldForwardProp:v,label:g},h)),b=C=>typeof C=="function"&&C.__emotion_real!==C||(0,T$.isPlainObject)(C)?S=>Jl(C,(0,Bn.default)({},S,{theme:Nl({theme:S.theme,defaultTheme:n,themeId:t})})):C,w=(C,...S)=>{let E=b(C);const k=S?S.map(b):[];u&&f&&k.push(N=>{const I=Nl((0,Bn.default)({},N,{defaultTheme:n,themeId:t}));if(!I.components||!I.components[u]||!I.components[u].styleOverrides)return null;const L=I.components[u].styleOverrides,O={};return Object.entries(L).forEach(([V,$])=>{O[V]=Jl($,(0,Bn.default)({},N,{theme:I}))}),f(N,O)}),u&&!p&&k.push(N=>{var I;const L=Nl((0,Bn.default)({},N,{defaultTheme:n,themeId:t})),O=L==null||(I=L.components)==null||(I=I[u])==null?void 0:I.variants;return Jl({variants:O},(0,Bn.default)({},N,{theme:L}))}),m||k.push(i);const R=k.length-S.length;if(Array.isArray(C)&&R>0){const N=new Array(R).fill("");E=[...C,...N],E.raw=[...C.raw,...N]}const _=y(E,...k);return a.muiName&&(_.muiName=a.muiName),_};return y.withConfig&&(w.withConfig=y.withConfig),w}}function V$(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const $$=e=>V$(e)&&e!=="classes",F_=$$,W$=R$({themeId:Tm,defaultTheme:x$,rootShouldForwardProp:F_}),es=W$,U$=["theme"];function H$(e){let{theme:t}=e,n=In(e,U$);const r=t[Tm];return x.jsx(NV,de({},n,{themeId:r?Tm:void 0,theme:r||t}))}function A0(e){return IV(e)}function Om(e,t){return Om=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Om(e,t)}function G$(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Om(e,t)}const Cb=Hn.createContext(null);function K$(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I0(e,t){var n=function(i){return t&&P.isValidElement(i)?t(i):i},r=Object.create(null);return e&&P.Children.map(e,function(o){return o}).forEach(function(o){r[o.key]=n(o)}),r}function q$(e,t){e=e||{},t=t||{};function n(c){return c in t?t[c]:e[c]}var r=Object.create(null),o=[];for(var i in e)i in t?o.length&&(r[i]=o,o=[]):o.push(i);var a,s={};for(var u in t){if(r[u])for(a=0;a<r[u].length;a++){var l=r[u][a];s[r[u][a]]=n(l)}s[u]=n(u)}for(a=0;a<o.length;a++)s[o[a]]=n(o[a]);return s}function gi(e,t,n){return n[t]!=null?n[t]:e.props[t]}function X$(e,t){return I0(e.children,function(n){return P.cloneElement(n,{onExited:t.bind(null,n),in:!0,appear:gi(n,"appear",e),enter:gi(n,"enter",e),exit:gi(n,"exit",e)})})}function Y$(e,t,n){var r=I0(e.children),o=q$(t,r);return Object.keys(o).forEach(function(i){var a=o[i];if(P.isValidElement(a)){var s=i in t,u=i in r,l=t[i],c=P.isValidElement(l)&&!l.props.in;u&&(!s||c)?o[i]=P.cloneElement(a,{onExited:n.bind(null,a),in:!0,exit:gi(a,"exit",e),enter:gi(a,"enter",e)}):!u&&s&&!c?o[i]=P.cloneElement(a,{in:!1}):u&&s&&P.isValidElement(l)&&(o[i]=P.cloneElement(a,{onExited:n.bind(null,a),in:l.props.in,exit:gi(a,"exit",e),enter:gi(a,"enter",e)}))}}),o}var Q$=Object.values||function(e){return Object.keys(e).map(function(t){return e[t]})},J$={component:"div",childFactory:function(t){return t}},N0=function(e){G$(t,e);function t(r,o){var i;i=e.call(this,r,o)||this;var a=i.handleExited.bind(K$(i));return i.state={contextValue:{isMounting:!0},handleExited:a,firstRender:!0},i}var n=t.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(o,i){var a=i.children,s=i.handleExited,u=i.firstRender;return{children:u?X$(o,s):Y$(o,a,s),firstRender:!1}},n.handleExited=function(o,i){var a=I0(this.props.children);o.key in a||(o.props.onExited&&o.props.onExited(i),this.mounted&&this.setState(function(s){var u=de({},s.children);return delete u[o.key],{children:u}}))},n.render=function(){var o=this.props,i=o.component,a=o.childFactory,s=In(o,["component","childFactory"]),u=this.state.contextValue,l=Q$(this.state.children).map(a);return delete s.appear,delete s.enter,delete s.exit,i===null?Hn.createElement(Cb.Provider,{value:u},l):Hn.createElement(Cb.Provider,{value:u},Hn.createElement(i,s,l))},t}(Hn.Component);N0.propTypes={};N0.defaultProps=J$;const Z$=N0;function e8(e){const{className:t,classes:n,pulsate:r=!1,rippleX:o,rippleY:i,rippleSize:a,in:s,onExited:u,timeout:l}=e,[c,d]=P.useState(!1),f=Ln(t,n.ripple,n.rippleVisible,r&&n.ripplePulsate),h={width:a,height:a,top:-(a/2)+i,left:-(a/2)+o},p=Ln(n.child,c&&n.childLeaving,r&&n.childPulsate);return!s&&!c&&d(!0),P.useEffect(()=>{if(!s&&u!=null){const m=setTimeout(u,l);return()=>{clearTimeout(m)}}},[u,s,l]),x.jsx("span",{className:f,style:h,children:x.jsx("span",{className:p})})}const t8=S0("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),jn=t8,n8=["center","classes","className"];let Rf=e=>e,Sb,Eb,kb,_b;const Bm=550,r8=80,o8=uf(Sb||(Sb=Rf`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),i8=uf(Eb||(Eb=Rf`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),a8=uf(kb||(kb=Rf`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),s8=es("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),u8=es(e8,{name:"MuiTouchRipple",slot:"Ripple"})(_b||(_b=Rf`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),jn.rippleVisible,o8,Bm,({theme:e})=>e.transitions.easing.easeInOut,jn.ripplePulsate,({theme:e})=>e.transitions.duration.shorter,jn.child,jn.childLeaving,i8,Bm,({theme:e})=>e.transitions.easing.easeInOut,jn.childPulsate,a8,({theme:e})=>e.transitions.easing.easeInOut),l8=P.forwardRef(function(t,n){const r=A0({props:t,name:"MuiTouchRipple"}),{center:o=!1,classes:i={},className:a}=r,s=In(r,n8),[u,l]=P.useState([]),c=P.useRef(0),d=P.useRef(null);P.useEffect(()=>{d.current&&(d.current(),d.current=null)},[u]);const f=P.useRef(!1),h=dV(),p=P.useRef(null),m=P.useRef(null),g=P.useCallback(w=>{const{pulsate:C,rippleX:S,rippleY:E,rippleSize:k,cb:R}=w;l(_=>[..._,x.jsx(u8,{classes:{ripple:Ln(i.ripple,jn.ripple),rippleVisible:Ln(i.rippleVisible,jn.rippleVisible),ripplePulsate:Ln(i.ripplePulsate,jn.ripplePulsate),child:Ln(i.child,jn.child),childLeaving:Ln(i.childLeaving,jn.childLeaving),childPulsate:Ln(i.childPulsate,jn.childPulsate)},timeout:Bm,pulsate:C,rippleX:S,rippleY:E,rippleSize:k},c.current)]),c.current+=1,d.current=R},[i]),v=P.useCallback((w={},C={},S=()=>{})=>{const{pulsate:E=!1,center:k=o||C.pulsate,fakeElement:R=!1}=C;if((w==null?void 0:w.type)==="mousedown"&&f.current){f.current=!1;return}(w==null?void 0:w.type)==="touchstart"&&(f.current=!0);const _=R?null:m.current,N=_?_.getBoundingClientRect():{width:0,height:0,left:0,top:0};let I,L,O;if(k||w===void 0||w.clientX===0&&w.clientY===0||!w.clientX&&!w.touches)I=Math.round(N.width/2),L=Math.round(N.height/2);else{const{clientX:V,clientY:$}=w.touches&&w.touches.length>0?w.touches[0]:w;I=Math.round(V-N.left),L=Math.round($-N.top)}if(k)O=Math.sqrt((2*N.width**2+N.height**2)/3),O%2===0&&(O+=1);else{const V=Math.max(Math.abs((_?_.clientWidth:0)-I),I)*2+2,$=Math.max(Math.abs((_?_.clientHeight:0)-L),L)*2+2;O=Math.sqrt(V**2+$**2)}w!=null&&w.touches?p.current===null&&(p.current=()=>{g({pulsate:E,rippleX:I,rippleY:L,rippleSize:O,cb:S})},h.start(r8,()=>{p.current&&(p.current(),p.current=null)})):g({pulsate:E,rippleX:I,rippleY:L,rippleSize:O,cb:S})},[o,g,h]),y=P.useCallback(()=>{v({},{pulsate:!0})},[v]),b=P.useCallback((w,C)=>{if(h.clear(),(w==null?void 0:w.type)==="touchend"&&p.current){p.current(),p.current=null,h.start(0,()=>{b(w,C)});return}p.current=null,l(S=>S.length>0?S.slice(1):S),d.current=C},[h]);return P.useImperativeHandle(n,()=>({pulsate:y,start:v,stop:b}),[y,v,b]),x.jsx(s8,de({className:Ln(jn.root,i.root,a),ref:m},s,{children:x.jsx(Z$,{component:null,exit:!0,children:u})}))}),c8=l8;function d8(e){return C0("MuiButtonBase",e)}const f8=S0("MuiButtonBase",["root","disabled","focusVisible"]),h8=f8,p8=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],m8=e=>{const{disabled:t,focusVisible:n,focusVisibleClassName:r,classes:o}=e,a=w_({root:["root",t&&"disabled",n&&"focusVisible"]},d8,o);return n&&r&&(a.root+=` ${r}`),a},v8=es("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${h8.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),g8=P.forwardRef(function(t,n){const r=A0({props:t,name:"MuiButtonBase"}),{action:o,centerRipple:i=!1,children:a,className:s,component:u="button",disabled:l=!1,disableRipple:c=!1,disableTouchRipple:d=!1,focusRipple:f=!1,LinkComponent:h="a",onBlur:p,onClick:m,onContextMenu:g,onDragLeave:v,onFocus:y,onFocusVisible:b,onKeyDown:w,onKeyUp:C,onMouseDown:S,onMouseLeave:E,onMouseUp:k,onTouchEnd:R,onTouchMove:_,onTouchStart:N,tabIndex:I=0,TouchRippleProps:L,touchRippleRef:O,type:V}=r,$=In(r,p8),U=P.useRef(null),M=P.useRef(null),B=cb(M,O),{isFocusVisibleRef:z,onFocus:G,onBlur:X,ref:te}=xV(),[ae,ue]=P.useState(!1);l&&ae&&ue(!1),P.useImperativeHandle(o,()=>({focusVisible:()=>{ue(!0),U.current.focus()}}),[]);const[se,me]=P.useState(!1);P.useEffect(()=>{me(!0)},[]);const xe=se&&!c&&!l;P.useEffect(()=>{ae&&f&&!c&&se&&M.current.pulsate()},[c,f,ae,se]);function ce(ve,Uu,Tf=d){return Al(Hu=>(Uu&&Uu(Hu),!Tf&&M.current&&M.current[ve](Hu),!0))}const Me=ce("start",S),he=ce("stop",g),_e=ce("stop",v),Ee=ce("stop",k),Ue=ce("stop",ve=>{ae&&ve.preventDefault(),E&&E(ve)}),je=ce("start",N),ze=ce("stop",R),Pn=ce("stop",_),Dn=ce("stop",ve=>{X(ve),z.current===!1&&ue(!1),p&&p(ve)},!1),Gt=Al(ve=>{U.current||(U.current=ve.currentTarget),G(ve),z.current===!0&&(ue(!0),b&&b(ve)),y&&y(ve)}),vr=()=>{const ve=U.current;return u&&u!=="button"&&!(ve.tagName==="A"&&ve.href)},pn=P.useRef(!1),gr=Al(ve=>{f&&!pn.current&&ae&&M.current&&ve.key===" "&&(pn.current=!0,M.current.stop(ve,()=>{M.current.start(ve)})),ve.target===ve.currentTarget&&vr()&&ve.key===" "&&ve.preventDefault(),w&&w(ve),ve.target===ve.currentTarget&&vr()&&ve.key==="Enter"&&!l&&(ve.preventDefault(),m&&m(ve))}),tr=Al(ve=>{f&&ve.key===" "&&M.current&&ae&&!ve.defaultPrevented&&(pn.current=!1,M.current.stop(ve,()=>{M.current.pulsate(ve)})),C&&C(ve),m&&ve.target===ve.currentTarget&&vr()&&ve.key===" "&&!ve.defaultPrevented&&m(ve)});let nr=u;nr==="button"&&($.href||$.to)&&(nr=h);const Kt={};nr==="button"?(Kt.type=V===void 0?"button":V,Kt.disabled=l):(!$.href&&!$.to&&(Kt.role="button"),l&&(Kt["aria-disabled"]=l));const ts=cb(n,te,U),$r=de({},r,{centerRipple:i,component:u,disabled:l,disableRipple:c,disableTouchRipple:d,focusRipple:f,tabIndex:I,focusVisible:ae}),Mn=m8($r);return x.jsxs(v8,de({as:nr,className:Ln(Mn.root,s),ownerState:$r,onBlur:Dn,onClick:m,onContextMenu:he,onFocus:Gt,onKeyDown:gr,onKeyUp:tr,onMouseDown:Me,onMouseLeave:Ue,onMouseUp:Ee,onDragLeave:_e,onTouchEnd:ze,onTouchMove:Pn,onTouchStart:je,ref:ts,tabIndex:l?-1:I,type:V},Kt,$,{children:[a,xe?x.jsx(c8,de({ref:B,center:i},L)):null]}))}),y8=g8;function x8(e){return C0("MuiButton",e)}const b8=S0("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),Pl=b8,w8=P.createContext({}),C8=w8,S8=P.createContext(void 0),E8=S8,k8=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],_8=e=>{const{color:t,disableElevation:n,fullWidth:r,size:o,variant:i,classes:a}=e,s={root:["root",i,`${i}${tn(t)}`,`size${tn(o)}`,`${i}Size${tn(o)}`,`color${tn(t)}`,n&&"disableElevation",r&&"fullWidth"],label:["label"],startIcon:["icon","startIcon",`iconSize${tn(o)}`],endIcon:["icon","endIcon",`iconSize${tn(o)}`]},u=w_(s,x8,a);return de({},a,u)},O_=e=>de({},e.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},e.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},e.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),R8=es(y8,{shouldForwardProp:e=>F_(e)||e==="classes",name:"MuiButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t[`${n.variant}${tn(n.color)}`],t[`size${tn(n.size)}`],t[`${n.variant}Size${tn(n.size)}`],n.color==="inherit"&&t.colorInherit,n.disableElevation&&t.disableElevation,n.fullWidth&&t.fullWidth]}})(({theme:e,ownerState:t})=>{var n,r;const o=e.palette.mode==="light"?e.palette.grey[300]:e.palette.grey[800],i=e.palette.mode==="light"?e.palette.grey.A100:e.palette.grey[700];return de({},e.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create(["background-color","box-shadow","border-color","color"],{duration:e.transitions.duration.short}),"&:hover":de({textDecoration:"none",backgroundColor:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.hoverOpacity})`:Il(e.palette.text.primary,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},t.variant==="text"&&t.color!=="inherit"&&{backgroundColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:Il(e.palette[t.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},t.variant==="outlined"&&t.color!=="inherit"&&{border:`1px solid ${(e.vars||e).palette[t.color].main}`,backgroundColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:Il(e.palette[t.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},t.variant==="contained"&&{backgroundColor:e.vars?e.vars.palette.Button.inheritContainedHoverBg:i,boxShadow:(e.vars||e).shadows[4],"@media (hover: none)":{boxShadow:(e.vars||e).shadows[2],backgroundColor:(e.vars||e).palette.grey[300]}},t.variant==="contained"&&t.color!=="inherit"&&{backgroundColor:(e.vars||e).palette[t.color].dark,"@media (hover: none)":{backgroundColor:(e.vars||e).palette[t.color].main}}),"&:active":de({},t.variant==="contained"&&{boxShadow:(e.vars||e).shadows[8]}),[`&.${Pl.focusVisible}`]:de({},t.variant==="contained"&&{boxShadow:(e.vars||e).shadows[6]}),[`&.${Pl.disabled}`]:de({color:(e.vars||e).palette.action.disabled},t.variant==="outlined"&&{border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`},t.variant==="contained"&&{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground})},t.variant==="text"&&{padding:"6px 8px"},t.variant==="text"&&t.color!=="inherit"&&{color:(e.vars||e).palette[t.color].main},t.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},t.variant==="outlined"&&t.color!=="inherit"&&{color:(e.vars||e).palette[t.color].main,border:e.vars?`1px solid rgba(${e.vars.palette[t.color].mainChannel} / 0.5)`:`1px solid ${Il(e.palette[t.color].main,.5)}`},t.variant==="contained"&&{color:e.vars?e.vars.palette.text.primary:(n=(r=e.palette).getContrastText)==null?void 0:n.call(r,e.palette.grey[300]),backgroundColor:e.vars?e.vars.palette.Button.inheritContainedBg:o,boxShadow:(e.vars||e).shadows[2]},t.variant==="contained"&&t.color!=="inherit"&&{color:(e.vars||e).palette[t.color].contrastText,backgroundColor:(e.vars||e).palette[t.color].main},t.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},t.size==="small"&&t.variant==="text"&&{padding:"4px 5px",fontSize:e.typography.pxToRem(13)},t.size==="large"&&t.variant==="text"&&{padding:"8px 11px",fontSize:e.typography.pxToRem(15)},t.size==="small"&&t.variant==="outlined"&&{padding:"3px 9px",fontSize:e.typography.pxToRem(13)},t.size==="large"&&t.variant==="outlined"&&{padding:"7px 21px",fontSize:e.typography.pxToRem(15)},t.size==="small"&&t.variant==="contained"&&{padding:"4px 10px",fontSize:e.typography.pxToRem(13)},t.size==="large"&&t.variant==="contained"&&{padding:"8px 22px",fontSize:e.typography.pxToRem(15)},t.fullWidth&&{width:"100%"})},({ownerState:e})=>e.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${Pl.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${Pl.disabled}`]:{boxShadow:"none"}}),T8=es("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.startIcon,t[`iconSize${tn(n.size)}`]]}})(({ownerState:e})=>de({display:"inherit",marginRight:8,marginLeft:-4},e.size==="small"&&{marginLeft:-2},O_(e))),A8=es("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.endIcon,t[`iconSize${tn(n.size)}`]]}})(({ownerState:e})=>de({display:"inherit",marginRight:-4,marginLeft:8},e.size==="small"&&{marginRight:-2},O_(e))),I8=P.forwardRef(function(t,n){const r=P.useContext(C8),o=P.useContext(E8),i=od(r,t),a=A0({props:i,name:"MuiButton"}),{children:s,color:u="primary",component:l="button",className:c,disabled:d=!1,disableElevation:f=!1,disableFocusRipple:h=!1,endIcon:p,focusVisibleClassName:m,fullWidth:g=!1,size:v="medium",startIcon:y,type:b,variant:w="text"}=a,C=In(a,k8),S=de({},a,{color:u,component:l,disabled:d,disableElevation:f,disableFocusRipple:h,fullWidth:g,size:v,type:b,variant:w}),E=_8(S),k=y&&x.jsx(T8,{className:E.startIcon,ownerState:S,children:y}),R=p&&x.jsx(A8,{className:E.endIcon,ownerState:S,children:p}),_=o||"";return x.jsxs(R8,de({ownerState:S,className:Ln(r.className,E.root,c,_),component:l,disabled:d,focusRipple:!h,focusVisibleClassName:Ln(E.focusVisible,m),ref:n,type:b},C,{classes:E,children:[k,s,R]}))}),Rb=I8,N8=({isAnalyzing:e,onToggleAnalysis:t,isProcessing:n})=>{const{isWebcamOn:r,toggleWebcam:o}=Wk(),{currentProfile:i}=hr(),a=(i==null?void 0:i.color)||"#3B82F6";return x.jsxs("div",{className:"flex justify-center gap-2",children:[x.jsx(Rb,{variant:"contained",onClick:t,disabled:!r||n,sx:{backgroundColor:e?"#EF4444":a,"&:hover":{backgroundColor:e?"#DC2626":`${a}dd`}},className:"disabled:opacity-50 disabled:cursor-not-allowed px-6 py-2 rounded-xl font-medium",children:n?"Loading...":e?"Stop Analysis":"Start Analysis"}),x.jsx(Rb,{variant:"outlined",onClick:o,disabled:n,sx:{borderColor:`${a}80`,color:a,"&:hover":{borderColor:a,backgroundColor:`${a}10`}},className:`border-2 hover:bg-white/5 font-medium px-6 py-2 rounded-xl
          disabled:opacity-50 disabled:cursor-not-allowed`,children:r?"Turn Off Camera":"Turn On Camera"})]})},P8=({isActive:e,onToggle:t,isProcessing:n})=>{const r=Hn.useRef(null),{setDetections:o}=ng(),{isWebcamOn:i}=Wk(),{isLoading:a,error:s}=xj(r,e&&i,o);return x.jsxs("div",{className:"bg-white/80 dark:bg-card/80 backdrop-blur-xl rounded-2xl border border-border overflow-hidden",children:[x.jsx("div",{className:"p-4 border-b border-border",children:x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsx("h2",{className:"text-lg font-semibold text-foreground",children:"Live Analysis"}),x.jsx(N8,{isAnalyzing:e,onToggleAnalysis:t,isProcessing:n})]})}),x.jsx("div",{className:"relative aspect-video",children:i?x.jsxs(x.Fragment,{children:[x.jsx(KP,{ref:r,screenshotFormat:"image/jpeg",className:"w-full h-full object-cover",videoConstraints:{width:1280,height:720,facingMode:"user"}}),a&&x.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:x.jsx("div",{className:"text-primary animate-pulse",children:"Initializing AI Models..."})}),s&&x.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:x.jsx("div",{className:"text-red-400 bg-red-500/20 p-4 rounded-xl border border-red-500/30",children:s})})]}):x.jsx("div",{className:"w-full h-full bg-gradient-to-br from-gray-900 to-black flex items-center justify-center",children:x.jsx("p",{className:"text-gray-400 text-lg",children:'Click "Turn On Camera" to begin analysis'})})})]})};function P0(e){const t={happy:"#D97706",sad:"#3B82F6",angry:"#EF4444",fearful:"#8B5CF6",disgusted:"#10B981",surprised:"#EC4899",neutral:"#6B7280"};return t[e]||t.neutral}const D8=({detection:e})=>{const t=hS(e.expressions),n=e.expressions[t],r=pS(t),o=P0(t),i=120,a=8,s=(i-a)/2,u=2*Math.PI*s,c=`${n*u} ${u}`;return x.jsxs("div",{className:"relative w-30 h-30",children:[x.jsxs("svg",{width:i,height:i,className:"transform -rotate-90",children:[x.jsx("circle",{cx:i/2,cy:i/2,r:s,fill:"none",stroke:"currentColor",strokeWidth:a,className:"text-gray-200 dark:text-gray-700"}),x.jsx("circle",{cx:i/2,cy:i/2,r:s,fill:"none",stroke:o,strokeWidth:a,strokeDasharray:c,strokeLinecap:"round",className:"transition-all duration-500 ease-out"})]}),x.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",style:{color:o},children:[x.jsx("span",{className:"text-3xl",children:r}),x.jsx("span",{className:"text-sm font-medium capitalize mt-1",children:t}),x.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[Math.round(n*100),"%"]})]})]})},B_=({detections:e})=>x.jsx("div",{className:"w-72 bg-white dark:bg-gray-800 rounded-lg shadow-lg p-4",children:e.length===0?x.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No faces detected"}):x.jsx("div",{className:"space-y-6",children:e.map((t,n)=>x.jsx("div",{className:"flex flex-col items-center p-4 rounded-lg bg-gray-50 dark:bg-gray-700",children:x.jsx(D8,{detection:t})},n))})}),M8=()=>{const{detections:e}=ng();return x.jsxs("div",{className:"bg-white/80 dark:bg-card/80 backdrop-blur-xl rounded-2xl border border-border p-6",children:[x.jsx("h2",{className:"text-lg font-semibold text-foreground mb-4",children:"Analysis Results"}),x.jsx(B_,{detections:e})]})},F8=()=>{const e=P.useRef(null),[t,n]=P.useState([]),[r,o]=P.useState(!1),[i,a]=P.useState(null),{currentProfile:s}=hr(),u=(s==null?void 0:s.color)||"#3B82F6",l=async c=>{o(!0);try{const d=URL.createObjectURL(c);a(d);const f=new Image;f.src=d,await new Promise(p=>f.onload=p);const h=await Vk(f);n(h)}catch(d){console.error("Failed to analyze image:",d)}finally{o(!1)}};return x.jsx("div",{className:"max-w-4xl mx-auto",children:x.jsx("div",{className:"glass-panel p-8",children:x.jsxs("div",{className:"flex flex-col items-center gap-8",children:[x.jsxs("div",{className:"text-center max-w-xl",children:[x.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Upload Image for Analysis"}),x.jsx("p",{className:"text-muted-foreground mb-6",children:"Upload a photo to analyze facial expressions and detect emotions."}),x.jsx("input",{type:"file",ref:e,onChange:c=>{var d;return((d=c.target.files)==null?void 0:d[0])&&l(c.target.files[0])},accept:"image/*",className:"hidden"}),x.jsxs("button",{onClick:()=>{var c;return(c=e.current)==null?void 0:c.click()},className:`inline-flex items-center gap-2 px-8 py-3 text-white rounded-xl 
                transition-all duration-200 text-lg font-medium hover:opacity-90`,style:{backgroundColor:u},disabled:r,children:[x.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),r?"Analyzing...":"Upload Image"]}),x.jsx("p",{className:"text-sm text-muted-foreground mt-4",children:"Supported formats: JPG, PNG, GIF (max 5MB)"})]}),i&&x.jsx("div",{className:"w-full max-w-2xl",children:x.jsxs("div",{className:"relative aspect-video rounded-lg overflow-hidden border border-border",children:[x.jsx("img",{src:i,alt:"Uploaded",className:"w-full h-full object-contain bg-card"}),r&&x.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:x.jsx("div",{className:"animate-pulse",style:{color:u},children:"Analyzing image..."})})]})}),t.length>0&&x.jsx("div",{className:"w-full",children:x.jsx(B_,{detections:t})})]})})})},O8=()=>x.jsxs("section",{children:[x.jsx("h2",{className:"text-3xl font-display font-bold mb-6",children:"Face Detection Algorithm"}),x.jsxs("div",{className:"prose dark:prose-invert max-w-none space-y-8",children:[x.jsxs("div",{className:"bg-black/5 dark:bg-white/5 rounded-xl p-6",children:[x.jsx("h3",{className:"text-xl font-display font-semibold mb-4",children:"TinyFaceDetector Model"}),x.jsxs("ul",{className:"list-disc pl-6 space-y-2 text-gray-600 dark:text-gray-300",children:[x.jsx("li",{children:"Single-shot detection network based on MobileNet architecture"}),x.jsx("li",{children:"Optimized for real-time performance (60+ FPS on modern devices)"}),x.jsx("li",{children:"Input size: 416x416 pixels"}),x.jsx("li",{children:"Uses depthwise separable convolutions for efficiency"}),x.jsx("li",{children:"Model size: ~190KB"})]})]}),x.jsxs("div",{className:"bg-black/5 dark:bg-white/5 rounded-xl p-6",children:[x.jsx("h3",{className:"text-xl font-display font-semibold mb-4",children:"Detection Pipeline"}),x.jsxs("ol",{className:"list-decimal pl-6 space-y-4",children:[x.jsxs("li",{children:[x.jsx("div",{className:"font-medium mb-2",children:"Image preprocessing"}),x.jsxs("ul",{className:"list-disc pl-6 space-y-1 text-gray-600 dark:text-gray-300",children:[x.jsx("li",{children:"Resize input to 416x416"}),x.jsx("li",{children:"Normalize pixel values to [-1, 1]"}),x.jsx("li",{children:"Convert to tensor format"})]})]}),x.jsxs("li",{children:[x.jsx("div",{className:"font-medium mb-2",children:"Feature extraction"}),x.jsxs("ul",{className:"list-disc pl-6 space-y-1 text-gray-600 dark:text-gray-300",children:[x.jsx("li",{children:"13 convolutional layers"}),x.jsx("li",{children:"Depthwise separable convolutions"}),x.jsx("li",{children:"ReLU activation functions"})]})]}),x.jsxs("li",{children:[x.jsx("div",{className:"font-medium mb-2",children:"Detection head"}),x.jsxs("ul",{className:"list-disc pl-6 space-y-1 text-gray-600 dark:text-gray-300",children:[x.jsx("li",{children:"Confidence score prediction"}),x.jsx("li",{children:"Bounding box regression"}),x.jsx("li",{children:"Non-maximum suppression"})]})]})]})]})]})]}),B8=()=>x.jsxs("section",{className:"mb-8",children:[x.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Emotion Recognition Algorithm"}),x.jsxs("div",{className:"prose dark:prose-invert max-w-none",children:[x.jsx("h3",{className:"text-xl font-medium mb-2",children:"CNN Architecture"}),x.jsxs("ul",{className:"list-disc pl-6 mb-4 space-y-2",children:[x.jsx("li",{children:"Based on MobileNet with custom emotion classification head"}),x.jsx("li",{children:"Input: 224x224x3 RGB image"}),x.jsx("li",{children:"Output: 7 emotion probabilities"}),x.jsx("li",{children:"Uses transfer learning from face recognition task"})]}),x.jsx("h3",{className:"text-xl font-medium mb-2",children:"Recognition Pipeline"}),x.jsxs("ol",{className:"list-decimal pl-6 space-y-2",children:[x.jsxs("li",{children:["Face alignment",x.jsxs("ul",{className:"list-disc pl-6 mt-1",children:[x.jsx("li",{children:"Extract face region using detection bounds"}),x.jsx("li",{children:"Resize to 224x224 pixels"}),x.jsx("li",{children:"Apply pixel normalization"})]})]}),x.jsxs("li",{children:["Feature extraction",x.jsxs("ul",{className:"list-disc pl-6 mt-1",children:[x.jsx("li",{children:"MobileNet backbone network"}),x.jsx("li",{children:"Global average pooling"}),x.jsx("li",{children:"1024-dimensional feature vector"})]})]}),x.jsxs("li",{children:["Emotion classification",x.jsxs("ul",{className:"list-disc pl-6 mt-1",children:[x.jsx("li",{children:"Fully connected layers"}),x.jsx("li",{children:"Softmax activation"}),x.jsx("li",{children:"7-class probability distribution"})]})]})]}),x.jsx("h3",{className:"text-xl font-medium mb-2",children:"Emotion Classes"}),x.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[x.jsxs("div",{children:[x.jsx("h4",{className:"font-medium mb-2",children:"Primary Emotions"}),x.jsxs("ul",{className:"list-disc pl-6",children:[x.jsx("li",{children:"Happy (Joy)"}),x.jsx("li",{children:"Sad"}),x.jsx("li",{children:"Angry"}),x.jsx("li",{children:"Fearful"})]})]}),x.jsxs("div",{children:[x.jsx("h4",{className:"font-medium mb-2",children:"Secondary Emotions"}),x.jsxs("ul",{className:"list-disc pl-6",children:[x.jsx("li",{children:"Disgusted"}),x.jsx("li",{children:"Surprised"}),x.jsx("li",{children:"Neutral"})]})]})]})]})]}),L8=()=>x.jsxs("section",{children:[x.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Model Architecture Details"}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[x.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[x.jsx("h3",{className:"font-semibold mb-2",children:"Technical Specifications"}),x.jsxs("ul",{className:"list-disc pl-6 space-y-1",children:[x.jsx("li",{children:"Framework: TensorFlow.js"}),x.jsx("li",{children:"Base Network: MobileNet"}),x.jsx("li",{children:"Model Size: ~2MB total"}),x.jsx("li",{children:"Inference Time: ~30ms"}),x.jsx("li",{children:"FLOPs: 569M"}),x.jsx("li",{children:"Parameters: 3.2M"})]})]}),x.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[x.jsx("h3",{className:"font-semibold mb-2",children:"Performance Metrics"}),x.jsxs("ul",{className:"list-disc pl-6 space-y-1",children:[x.jsx("li",{children:"Accuracy: ~90% on FER2013"}),x.jsx("li",{children:"FPS: 30-60 (device dependent)"}),x.jsx("li",{children:"Min Face Size: 20x20 pixels"}),x.jsx("li",{children:"Max Faces: No fixed limit"}),x.jsx("li",{children:"Latency: 30-50ms"})]})]})]})]}),j8=()=>x.jsxs("section",{className:"mb-8",children:[x.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Token Sentiment Analysis"}),x.jsxs("div",{className:"prose dark:prose-invert max-w-none",children:[x.jsx("h3",{className:"text-xl font-medium mb-2",children:"Analysis Components"}),x.jsxs("ul",{className:"list-disc pl-6 mb-4 space-y-2",children:[x.jsxs("li",{children:["Technical Analysis",x.jsxs("ul",{className:"list-disc pl-6 mt-1",children:[x.jsx("li",{children:"RSI (Relative Strength Index)"}),x.jsx("li",{children:"MACD (Moving Average Convergence Divergence)"}),x.jsx("li",{children:"Bollinger Bands"}),x.jsx("li",{children:"Volume Analysis"})]})]}),x.jsxs("li",{children:["Fundamental Analysis",x.jsxs("ul",{className:"list-disc pl-6 mt-1",children:[x.jsx("li",{children:"Market Cap Evaluation"}),x.jsx("li",{children:"Liquidity Analysis"}),x.jsx("li",{children:"Volume to Market Cap Ratio"})]})]})]}),x.jsx("h3",{className:"text-xl font-medium mb-2",children:"Sentiment Calculation"}),x.jsxs("ol",{className:"list-decimal pl-6 space-y-2",children:[x.jsxs("li",{children:["Signal Collection",x.jsxs("ul",{className:"list-disc pl-6 mt-1",children:[x.jsx("li",{children:"Gather technical indicators"}),x.jsx("li",{children:"Analyze price action"}),x.jsx("li",{children:"Evaluate volume patterns"})]})]}),x.jsxs("li",{children:["Signal Classification",x.jsxs("ul",{className:"list-disc pl-6 mt-1",children:[x.jsx("li",{children:"Bullish signals"}),x.jsx("li",{children:"Bearish signals"}),x.jsx("li",{children:"Neutral signals"})]})]}),x.jsxs("li",{children:["Sentiment Scoring",x.jsxs("ul",{className:"list-disc pl-6 mt-1",children:[x.jsx("li",{children:"Weight-based calculation"}),x.jsx("li",{children:"Signal strength evaluation"}),x.jsx("li",{children:"Confidence scoring"})]})]})]})]})]}),z8=()=>x.jsxs("section",{className:"mb-8",children:[x.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Chart Analysis Algorithm"}),x.jsxs("div",{className:"prose dark:prose-invert max-w-none",children:[x.jsx("h3",{className:"text-xl font-medium mb-2",children:"Detection Pipeline"}),x.jsxs("ol",{className:"list-decimal pl-6 space-y-2",children:[x.jsxs("li",{children:["Color Analysis",x.jsxs("ul",{className:"list-disc pl-6 mt-1",children:[x.jsx("li",{children:"RGB channel separation"}),x.jsx("li",{children:"Candlestick pattern detection"}),x.jsx("li",{children:"Color threshold optimization"})]})]}),x.jsxs("li",{children:["Level Detection",x.jsxs("ul",{className:"list-disc pl-6 mt-1",children:[x.jsx("li",{children:"Support level identification"}),x.jsx("li",{children:"Resistance level detection"}),x.jsx("li",{children:"Level strength calculation"})]})]}),x.jsxs("li",{children:["Pattern Recognition",x.jsxs("ul",{className:"list-disc pl-6 mt-1",children:[x.jsx("li",{children:"Trend line analysis"}),x.jsx("li",{children:"Price action patterns"}),x.jsx("li",{children:"Volume profile analysis"})]})]})]}),x.jsx("h3",{className:"text-xl font-medium mb-2",children:"Scenario Analysis"}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[x.jsxs("div",{className:"bg-green-500/10 border border-green-500/20 rounded-lg p-4",children:[x.jsx("h4",{className:"font-medium text-green-400 mb-2",children:"Bullish Scenario"}),x.jsxs("ul",{className:"list-disc pl-4 text-sm",children:[x.jsx("li",{children:"Strong support levels"}),x.jsx("li",{children:"Increasing volume"}),x.jsx("li",{children:"Higher highs pattern"})]})]}),x.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-4",children:[x.jsx("h4",{className:"font-medium text-red-400 mb-2",children:"Bearish Scenario"}),x.jsxs("ul",{className:"list-disc pl-4 text-sm",children:[x.jsx("li",{children:"Strong resistance levels"}),x.jsx("li",{children:"Decreasing volume"}),x.jsx("li",{children:"Lower lows pattern"})]})]}),x.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-4",children:[x.jsx("h4",{className:"font-medium text-blue-400 mb-2",children:"Neutral Scenario"}),x.jsxs("ul",{className:"list-disc pl-4 text-sm",children:[x.jsx("li",{children:"Range-bound trading"}),x.jsx("li",{children:"Stable volume"}),x.jsx("li",{children:"Sideways movement"})]})]})]})]})]}),V8=()=>x.jsx("div",{className:"max-w-4xl mx-auto space-y-12",children:x.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-8",children:[x.jsx("h1",{className:"text-4xl font-display font-bold mb-12 bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Technical Documentation"}),x.jsxs("div",{className:"space-y-16",children:[x.jsx(O8,{}),x.jsx("div",{className:"w-full h-px bg-gradient-to-r from-transparent via-gray-200 dark:via-gray-700 to-transparent"}),x.jsx(B8,{}),x.jsx("div",{className:"w-full h-px bg-gradient-to-r from-transparent via-gray-200 dark:via-gray-700 to-transparent"}),x.jsx(L8,{}),x.jsx("div",{className:"w-full h-px bg-gradient-to-r from-transparent via-gray-200 dark:via-gray-700 to-transparent"}),x.jsx(j8,{}),x.jsx("div",{className:"w-full h-px bg-gradient-to-r from-transparent via-gray-200 dark:via-gray-700 to-transparent"}),x.jsx(z8,{})]})]})}),$8={style:"kHsjoCQGgI0GWASmgIdIAyCCAwwrA6GAIwQEKBgNQfAeDEAwBVeBNuIGARgAVaChbIInigx+ODAVIAPZgFxmCOoICIGgPhmBYBoCfvgNPSCKSoEAEwJAKgQAPAEesAnwCNVgFvBAAAWBiAMCIdIETRwAQigXYxAuHyA3z8A5ZIELaQJUQgC6TAJ3CAHB8BVu4DUKwFNHgMQiAMIA9DwB96gBInABREA7QEIxgImGgFUegB9dgAYpgAQRACWAAASAHn2AADmAI3iAjoyAkAiAkwSAlTCAABCAiDeAmpiAnpyAplWAHqOAHwuACDqAEJ2AlJKAAD2AxjSABIqAm5mAy8KApLuADASAI5uAwL6AxMKAPbAANYDLl4DOt4C8uoAV0oDWqICtwYCxr4DKiIC4zIChEoAh0YAlQIAG04AGI4CmCoBlzgBxgCFCgKS8gBEIgMABgIAWgA8ugL4tgCAYgIw4gALAgAo8gFoXQBRSoBA4MAACeABSlAIBigEAAwBxxIAMAQAUIBdC8ACZSAAPjAF6AgAAHwCHM4BK0UAMuiAaFDAItDgBKMQDsbIAJBEASQ+AFEnAPZXgAGIQAmwIBGDUATwqAKjJAIi8gBOiwCPjIA+kMA9J6ASUhACGlgBixwAYgYAIGEAJseARqnAJ8cgAp5QByWYBAlUAQqqAI0XANNTgCMCwALl4AFh0A2+SABPPANGAgF4uwAWZYAwLwAQIBDpEAQ6cAOEAAQ6AHORAFfUgC33wB1BoAUH8AwYCAYSFAMNggGXEQBIXIA0ycAgqCALt9AEl2gCrIQA0F0TAAwlgHxSQAXa4Au98AptKAdFHAJZzgHsUQDFIYAcvkAQF+AKKHAOqCgHlqwBMDIBpJMAhaqAZDHAKaegGBSwBDEYATokAJQ+AOVpAOFNgEXUwAYVoAPTcAAHiARBJAPBQgEbiwBHH4Bzs0AcuGAZkRADgzgAM9wCgT4A0+kAEMCAIuxAPBLgCagwAUhoBxNMAGIKAVGxABDjgAXQBXbcAJrXAEaEwAwBEAB4VAAfHwBYQEASbeAD23UAX/NAHlDQAoDcANEpAHDqQAN40AYTvACNAgAAIA=="},Lm="Surprise_CKY0O";async function W8(e){if(document.querySelector(`script[src="${e}"]`))return;const t=document.createElement("script");t.src=e,t.defer=!0,document.head.appendChild(t)}function U8(){document.querySelectorAll('script[src*="pickaxeproject"]').forEach(e=>e.remove())}async function H8(){window.PICKAXE={pickaxes:[],style:$8.style},window.PICKAXE.pickaxes.push({id:Lm,type:"inline"});try{const e=await fetch(`https://embed.pickaxeproject.com/axe/api/script/${Lm}`),{v:t}=await e.json(),n=`https://cdn.jsdelivr.net/gh/pickaxeproject/cdn@${t}/dist/bundle.js`;await W8(n)}catch(e){console.error("Failed to initialize Pickaxe:",e)}}const G8=()=>(P.useEffect(()=>(H8(),()=>U8()),[]),x.jsx("div",{className:"max-w-4xl mx-auto",children:x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-8",children:x.jsx("div",{className:"flex justify-center",children:x.jsx("div",{id:`pickaxe-inline-${Lm}`,className:"w-full max-w-2xl"})})})}));async function K8(){try{const e=await fetch("https://api.example.com/tickers?window=2h");if(!e.ok)throw new Error("Failed to fetch tickers");return await e.json()}catch{return q8()}}function q8(){return["DOGE","SHIB","PEPE","FLOKI","WOJAK","BONK","ELON","SAMO"].map(t=>({symbol:t,mentions:Math.floor(Math.random()*15e3)+1e3,change:Number((Math.random()*20-10).toFixed(1))})).sort((t,n)=>n.mentions-t.mentions)}function X8(){const[e,t]=P.useState([]),[n,r]=P.useState(!0),[o,i]=P.useState(null),a=P.useCallback(async()=>{try{r(!0);const u=await K8();t(u),i(new Date)}catch(u){console.error("Failed to fetch tickers:",u)}finally{r(!1)}},[]),s=P.useCallback(()=>{a()},[a]);return P.useEffect(()=>{a();const u=setInterval(a,12e4);return()=>clearInterval(u)},[a]),{tickers:e,isLoading:n,refresh:s,lastUpdated:o}}const Y8=({rank:e,symbol:t,mentions:n,change:r})=>{const o=r>=0?"text-green-500":"text-red-500",i=r>=0?"":"";return x.jsxs("div",{className:"flex items-center justify-between p-4 bg-card text-card-foreground rounded-xl border border-border hover:bg-card/80 transition-colors",children:[x.jsxs("div",{className:"flex items-center gap-4",children:[x.jsx("span",{className:"text-foreground/60 font-mono w-6",children:e}),x.jsxs("span",{className:"text-primary font-bold",children:["$",t]})]}),x.jsxs("div",{className:"flex items-center gap-6",children:[x.jsxs("span",{className:"text-foreground/60",children:[n.toLocaleString()," mentions"]}),x.jsxs("span",{className:`${o} font-mono flex items-center gap-1`,children:[i," ",Math.abs(r),"%"]})]})]})},Q8=({count:e})=>x.jsx("div",{className:"max-w-4xl mx-auto",children:x.jsxs("div",{className:"bg-black/30 dark:bg-gray-900/30 backdrop-blur-xl rounded-2xl border border-white/10 p-6",children:[x.jsx("div",{className:"h-8 w-48 bg-white/5 rounded-lg mb-6 animate-pulse"}),x.jsx("div",{className:"space-y-4",children:Array.from({length:e}).map((t,n)=>x.jsx("div",{className:"h-16 bg-white/5 rounded-xl border border-white/10 animate-pulse"},n))})]})}),J8=({onRefresh:e,lastUpdated:t,isLoading:n})=>{const r=o=>new Intl.DateTimeFormat("en-US",{hour:"numeric",minute:"numeric",second:"numeric"}).format(o);return x.jsxs("div",{className:"flex items-center justify-between mb-6",children:[x.jsxs("div",{children:[x.jsx("h2",{className:"text-2xl font-bold",children:"Top Tickers"}),x.jsx("p",{className:"text-sm text-foreground/60 mt-1",children:"Last 2 hours"})]}),x.jsxs("div",{className:"flex items-center gap-4",children:[t&&x.jsxs("span",{className:"text-sm text-foreground/60",children:["Last updated: ",r(t)]}),x.jsx("button",{onClick:e,disabled:n,className:`
            p-2 rounded-lg text-primary hover:bg-primary/10 
            transition-colors disabled:opacity-50
            ${n?"animate-spin":""}
          `,title:"Refresh data",children:x.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})]})},Z8=()=>{const{tickers:e,isLoading:t,refresh:n,lastUpdated:r}=X8();return t&&!e.length?x.jsx(Q8,{count:10}):x.jsx("div",{className:"max-w-4xl mx-auto",children:x.jsxs("div",{className:"glass-panel p-6",children:[x.jsx(J8,{onRefresh:n,lastUpdated:r,isLoading:t}),x.jsx("div",{className:"space-y-4",children:e.map((o,i)=>x.jsx(Y8,{rank:i+1,symbol:o.symbol,mentions:o.mentions,change:o.change},o.symbol))})]})})},eW=({onSearch:e})=>{const[t,n]=P.useState(""),{currentProfile:r}=hr(),o=(r==null?void 0:r.color)||"#3B82F6",i=a=>{a.preventDefault(),t.trim()&&e(t.trim())};return x.jsxs("form",{onSubmit:i,className:"flex gap-2",children:[x.jsx("input",{type:"text",value:t,onChange:a=>n(a.target.value),placeholder:"Paste the Contract Address",className:`flex-1 px-4 py-2 bg-card border border-border rounded-lg 
          focus:outline-none focus:ring-2 text-foreground placeholder:text-muted-foreground`,style:{"--tw-ring-color":`${o}40`,"--tw-ring-opacity":.4}}),x.jsx("button",{type:"submit",style:{backgroundColor:o},className:`px-6 py-2 text-white rounded-lg transition-colors duration-200 
          hover:opacity-90 font-medium`,children:"Analyze"})]})},tW=({name:e,symbol:t,profileColor:n})=>x.jsxs(Ie.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex flex-col",children:[x.jsx("h1",{className:"text-4xl font-bold font-display mb-2",style:{background:`-webkit-linear-gradient(${n}, ${n}80)`,WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:e}),x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsxs("span",{className:"text-lg px-3 py-1 rounded-full font-medium",style:{backgroundColor:`${n}10`,color:n},children:["$",t]}),x.jsx("span",{className:"text-sm text-muted-foreground",children:"Contract Token"})]})]}),nW=({data:e,profileColor:t})=>x.jsxs("div",{className:"flex flex-col gap-3",children:[x.jsx(tW,{name:e.name,symbol:e.symbol,profileColor:t}),x.jsxs("div",{className:"flex gap-4 mt-1",children:[e.twitter&&x.jsxs("a",{href:`https://x.com/${e.twitter}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors",children:[x.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:x.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})}),x.jsx("span",{children:"Twitter"})]}),e.telegram&&x.jsxs("a",{href:e.telegram,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors",children:[x.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:x.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.64 6.8c-.15 1.58-.8 5.42-1.13 7.19-.14.75-.42 1-.68 1.03-.58.05-1.02-.38-1.58-.75-.88-.58-1.38-.94-2.23-1.5-.99-.65-.35-1.01.22-1.59.15-.15 2.71-2.48 2.76-2.69.01-.03.01-.14-.07-.2-.08-.06-.19-.04-.27-.02-.12.02-1.96 1.25-5.54 3.69-.52.36-1 .53-1.42.52-.47-.01-1.37-.26-2.03-.48-.82-.27-1.47-.42-1.42-.88.03-.24.27-.48.74-.74 2.93-1.27 4.88-2.11 5.87-2.51 2.8-1.14 3.37-1.34 3.75-1.34.08 0 .27.02.39.12.1.08.13.19.14.27-.01.06.01.24 0 .24z"})}),x.jsx("span",{children:"Telegram"})]}),e.website&&x.jsxs("a",{href:e.website,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors",children:[x.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})}),x.jsx("span",{children:"Website"})]})]})]});function Vs(e){return e===0?"0.000":e>=1e9?`${(e/1e9).toFixed(3)}B`:e>=1e6?`${(e/1e6).toFixed(3)}M`:e>=1e3?`${(e/1e3).toFixed(3)}K`:e.toFixed(3)}const rW=({address:e})=>{const t=[{name:"DEXScreener",url:`https://dexscreener.com/solana/${e}`},{name:"GMGN.ai",url:`https://gmgn.ai/sol/token/${e}`},{name:"Jupiter",url:`https://jup.ag/swap/${e}-SOL`}];return x.jsx("div",{className:"flex flex-wrap gap-3",children:t.map(n=>x.jsx("a",{href:n.url,target:"_blank",rel:"noopener noreferrer",className:`px-4 py-2 bg-primary/10 hover:bg-primary/20 
            text-primary rounded-lg transition-colors duration-200 border border-primary/20`,children:n.name},n.name))})},oW=({data:e,address:t})=>{const n=e.price<1e-4?e.price.toFixed(12):Vs(e.price);return x.jsxs("div",{className:"mt-4 space-y-4",children:[x.jsxs(Ie.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[x.jsxs("div",{className:"bg-background rounded-lg p-4 border border-border",children:[x.jsx("h3",{className:"text-sm text-muted-foreground mb-1",children:"Market Cap"}),x.jsxs("p",{className:"text-xl font-semibold text-foreground",children:["$",Vs(e.marketCap)]})]}),x.jsxs("div",{className:"bg-background rounded-lg p-4 border border-border",children:[x.jsx("h3",{className:"text-sm text-muted-foreground mb-1",children:"Price"}),x.jsxs("p",{className:"text-xl font-semibold text-foreground",children:["$",n]})]}),x.jsxs("div",{className:"bg-background rounded-lg p-4 border border-border",children:[x.jsx("h3",{className:"text-sm text-muted-foreground mb-1",children:"24h Volume"}),x.jsxs("p",{className:"text-xl font-semibold text-foreground",children:["$",Vs(e.volume24h)]})]}),x.jsxs("div",{className:"bg-background rounded-lg p-4 border border-border",children:[x.jsx("h3",{className:"text-sm text-muted-foreground mb-1",children:"Price Change 24h"}),x.jsxs("p",{className:`text-xl font-semibold ${e.priceChange24h>=0?"text-green-400":"text-red-400"}`,children:[e.priceChange24h>0?"+":"",e.priceChange24h.toFixed(2),"%"]})]})]}),x.jsxs(Ie.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-background rounded-lg p-4 border border-border",children:[x.jsx("h3",{className:"text-sm text-muted-foreground mb-3",children:"Trading Platforms"}),x.jsx(rW,{address:t})]})]})},iW=({indicators:e})=>x.jsxs("div",{className:"bg-card/80 backdrop-blur-xl rounded-xl border border-border p-6",children:[x.jsx("h3",{className:"text-xl font-semibold text-foreground mb-4",children:"Technical Analysis"}),x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{className:"bg-background rounded-lg p-4 border border-border",children:[x.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:"RSI (14)"}),x.jsx("div",{className:"text-xl font-semibold text-foreground",children:e.rsi.toFixed(2)})]}),x.jsxs("div",{className:"bg-background rounded-lg p-4 border border-border",children:[x.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:"MACD"}),x.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[x.jsxs("div",{children:[x.jsx("div",{className:"text-xs text-muted-foreground",children:"Value"}),x.jsx("div",{className:"text-sm font-medium text-foreground",children:e.macd.value.toFixed(2)})]}),x.jsxs("div",{children:[x.jsx("div",{className:"text-xs text-muted-foreground",children:"Signal"}),x.jsx("div",{className:"text-sm font-medium text-foreground",children:e.macd.signal.toFixed(2)})]}),x.jsxs("div",{children:[x.jsx("div",{className:"text-xs text-muted-foreground",children:"Histogram"}),x.jsx("div",{className:"text-sm font-medium text-foreground",children:e.macd.histogram.toFixed(2)})]})]})]}),x.jsxs("div",{className:"bg-background rounded-lg p-4 border border-border",children:[x.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:"Bollinger Bands"}),x.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[x.jsxs("div",{children:[x.jsx("div",{className:"text-xs text-muted-foreground",children:"Upper"}),x.jsx("div",{className:"text-sm font-medium text-foreground",children:e.bollingerBands.upper.toFixed(4)})]}),x.jsxs("div",{children:[x.jsx("div",{className:"text-xs text-muted-foreground",children:"Middle"}),x.jsx("div",{className:"text-sm font-medium text-foreground",children:e.bollingerBands.middle.toFixed(4)})]}),x.jsxs("div",{children:[x.jsx("div",{className:"text-xs text-muted-foreground",children:"Lower"}),x.jsx("div",{className:"text-sm font-medium text-foreground",children:e.bollingerBands.lower.toFixed(4)})]})]})]})]})]}),aW=({metrics:e})=>x.jsxs(Ie.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-card/80 backdrop-blur-xl rounded-xl border border-border p-6",children:[x.jsx("h3",{className:"text-xl font-semibold text-foreground mb-4",children:"Fundamental Analysis"}),x.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[x.jsxs("div",{className:"bg-background rounded-lg p-4 border border-border",children:[x.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Market Cap"}),x.jsxs("div",{className:"text-lg font-semibold text-foreground",children:["$",Vs(e.marketCap)]})]}),x.jsxs("div",{className:"bg-background rounded-lg p-4 border border-border",children:[x.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Volatility (24h)"}),x.jsxs("div",{className:"text-lg font-semibold text-foreground",children:[(e.volatility*100).toFixed(2),"%"]})]}),x.jsxs("div",{className:"bg-background rounded-lg p-4 border border-border",children:[x.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Liquidity"}),x.jsxs("div",{className:"text-lg font-semibold text-foreground",children:["$",Vs(e.liquidity)]})]})]})]}),Zl=({type:e,className:t="w-4 h-4"})=>{const n={bullish:"M7 14l5-5 5 5H7z",bearish:"M7 10l5 5 5-5H7z",neutral:"M5 11h14v2H5z"};return x.jsx("svg",{viewBox:"0 0 24 24",className:t,fill:"currentColor",children:x.jsx("path",{d:n[e]})})},L_=({emotion:e,className:t,color:n})=>{const r={happy:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z",sad:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 3c-2.33 0-4.31 1.46-5.11 3.5h10.22c-.8-2.04-2.78-3.5-5.11-3.5z",angry:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 3c-2.33 0-4.31 1.46-5.11 3.5h10.22c-.8-2.04-2.78-3.5-5.11-3.5z",fearful:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-5-9c.83 0 1.5-.67 1.5-1.5S7.83 8 7 8s-1.5.67-1.5 1.5S6.17 11 7 11zm5 0c.83 0 1.5-.67 1.5-1.5S12.83 8 12 8s-1.5.67-1.5 1.5.67 1.5 1.5 1.5zm5 0c.83 0 1.5-.67 1.5-1.5S17.83 8 17 8s-1.5.67-1.5 1.5.67 1.5 1.5 1.5zm-10 4h10c-.55 0-1 .45-1 1s.45 1 1 1h-10c.55 0 1-.45 1-1s-.45-1-1-1z",disgusted:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm4-12H8c.55 0 1-.45 1-1s-.45-1-1-1h8c-.55 0-1 .45-1 1s.45 1 1 1zm-3 6c.83 0 1.5-.67 1.5-1.5S13.83 8 13 8s-1.5.67-1.5 1.5.67 1.5 1.5 1.5zm-5 0c.83 0 1.5-.67 1.5-1.5S9.83 8 9 8s-1.5.67-1.5 1.5.67 1.5 1.5 1.5z",surprised:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-5-9c.83 0 1.5-.67 1.5-1.5S7.83 8 7 8s-1.5.67-1.5 1.5S6.17 11 7 11zm5 0c.83 0 1.5-.67 1.5-1.5S12.83 8 12 8s-1.5.67-1.5 1.5.67 1.5 1.5 1.5zm5 0c.83 0 1.5-.67 1.5-1.5S17.83 8 17 8s-1.5.67-1.5 1.5.67 1.5 1.5 1.5zm-10 5h10c0-1.1-.9-2-2-2h-6c-1.1 0-2 .9-2 2z",neutral:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-5-9c.83 0 1.5-.67 1.5-1.5S7.83 8 7 8s-1.5.67-1.5 1.5S6.17 11 7 11zm5 0c.83 0 1.5-.67 1.5-1.5S12.83 8 12 8s-1.5.67-1.5 1.5.67 1.5 1.5 1.5zm5 0c.83 0 1.5-.67 1.5-1.5S17.83 8 17 8s-1.5.67-1.5 1.5.67 1.5 1.5 1.5zm-10 4h10v2H7z"};return x.jsx("svg",{viewBox:"0 0 24 24",className:t,fill:n,children:x.jsx("path",{d:r[e]})})},sW=({sentiment:e,analysis:t})=>{const n=P0(t.emotion);return x.jsx("div",{className:"bg-white/80 dark:bg-card/80 backdrop-blur-xl rounded-xl border border-border p-6",children:x.jsxs("div",{className:"flex flex-col space-y-6",children:[x.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Technical Score"}),x.jsxs("div",{className:"flex items-center gap-4",children:[x.jsx(L_,{emotion:t.emotion,className:"w-8 h-8",color:n}),x.jsxs("div",{children:[x.jsx("h3",{className:"text-xl font-semibold capitalize",style:{color:n},children:t.emotion}),x.jsxs("p",{className:"text-muted-foreground",children:[Math.round(t.confidence*100),"% confidence"]})]})]}),x.jsx("div",{className:"grid grid-cols-3 gap-4",children:Object.entries(e).map(([r,o])=>x.jsxs(Ie.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"bg-background rounded-lg p-4 text-center border border-border",children:[x.jsx("div",{className:"text-sm text-muted-foreground mb-2 capitalize",children:r==="technical"?"Technical Analysis":`${r} Score`}),x.jsxs("div",{className:`text-2xl font-bold ${o>=80?"text-green-400":o>=60?"text-blue-400":o>=40?"text-yellow-400":"text-red-400"}`,children:[o,"%"]})]},r))}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.signals.bearish.length>0&&x.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-4",children:[x.jsx("h4",{className:"text-red-400 font-medium mb-2",children:"Bearish Signals"}),x.jsx("ul",{className:"space-y-2",children:t.signals.bearish.map((r,o)=>x.jsxs("li",{className:"text-sm text-foreground flex items-center gap-2",children:[x.jsx(Zl,{type:"bearish",className:"w-4 h-4 text-red-400"}),r]},o))})]}),t.signals.neutral.length>0&&x.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-4",children:[x.jsx("h4",{className:"text-blue-400 font-medium mb-2",children:"Neutral Signals"}),x.jsx("ul",{className:"space-y-2",children:t.signals.neutral.map((r,o)=>x.jsxs("li",{className:"text-sm text-foreground flex items-center gap-2",children:[x.jsx(Zl,{type:"neutral",className:"w-4 h-4 text-blue-400"}),r]},o))})]}),t.signals.bullish.length>0&&x.jsxs("div",{className:"bg-green-500/10 border border-green-500/20 rounded-lg p-4",children:[x.jsx("h4",{className:"text-green-400 font-medium mb-2",children:"Bullish Signals"}),x.jsx("ul",{className:"space-y-2",children:t.signals.bullish.map((r,o)=>x.jsxs("li",{className:"text-sm text-foreground flex items-center gap-2",children:[x.jsx(Zl,{type:"bullish",className:"w-4 h-4 text-green-400"}),r]},o))})]})]})]})})},Ki={change:0,volume:0,trades:0,signals:[]},Tb={m1:Ki,m15:Ki,m30:Ki,h1:Ki,h4:Ki,h24:Ki};function uW(e){const[t,n]=P.useState(Tb),[r,o]=P.useState(!0),i=P.useCallback(async()=>{var a;if(e){o(!0);try{const s=await fetch(`https://api.dexscreener.com/latest/dex/tokens/${e}`);if(!s.ok)throw new Error("Failed to fetch timeframe data");const l=(a=(await s.json()).pairs)==null?void 0:a[0];if(!l)throw new Error("No pair data found");const d=Object.entries({m1:{minutes:1,divider:60},m15:{minutes:15,divider:4},m30:{minutes:30,divider:2},h1:{minutes:60,divider:1},h4:{minutes:240,divider:.25},h24:{minutes:1440,divider:.0417}}).reduce((f,[h,{divider:p}])=>{var g,v,y,b,w,C;const m={change:(((g=l.priceChange)==null?void 0:g.h24)||0)*p,volume:(((v=l.volume)==null?void 0:v.h24)||0)*p,trades:Math.round((((b=(y=l.txns)==null?void 0:y.h24)==null?void 0:b.buys)||0+((C=(w=l.txns)==null?void 0:w.h24)==null?void 0:C.sells)||0)*p),signals:[]};return{...f,[h]:m}},{});n(d)}catch(s){console.error("Error fetching timeframe data:",s),n(Tb)}finally{o(!1)}}},[e]);return P.useEffect(()=>{i();const a=setInterval(i,6e4);return()=>clearInterval(a)},[i]),{analysis:t,isLoading:r,fetchData:i}}const lW=({data:e})=>x.jsxs("div",{className:"bg-background rounded-lg p-4 border border-border",children:[x.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Price Analysis"}),x.jsxs("div",{className:"flex justify-between text-center",children:[x.jsxs("div",{className:"flex-1 border-r border-border",children:[x.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Price Change"}),x.jsxs("div",{className:`text-lg font-semibold ${e.change>=0?"text-green-400":"text-red-400"}`,children:[e.change>=0?"+":"",e.change.toFixed(3),"%"]})]}),x.jsxs("div",{className:"flex-1",children:[x.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Volume"}),x.jsxs("div",{className:"text-lg font-semibold text-foreground",children:["$",(e.volume/1e3).toFixed(1),"K"]})]})]})]}),cW=({signals:e})=>x.jsxs("div",{className:"bg-background rounded-lg p-4 border border-border",children:[x.jsx("h4",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Market Activity"}),x.jsx("div",{className:"space-y-2",children:e.map((t,n)=>x.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[x.jsx(Zl,{type:t.type,className:`w-4 h-4 ${t.type==="bullish"?"text-green-400":t.type==="bearish"?"text-red-400":"text-blue-400"}`}),x.jsx("span",{className:"text-foreground",children:t.message})]},n))})]}),dW=({data:e,minutes:t})=>x.jsxs("div",{className:"bg-background rounded-lg p-4 border border-border",children:[x.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Trading Activity"}),x.jsxs("div",{className:"flex justify-between text-center",children:[x.jsxs("div",{className:"flex-1 border-r border-border",children:[x.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Trades"}),x.jsx("div",{className:"text-lg font-semibold text-foreground",children:e.trades.toLocaleString()})]}),x.jsxs("div",{className:"flex-1",children:[x.jsx("div",{className:"text-sm text-muted-foreground",children:"Trades/Min"}),x.jsx("div",{className:"text-lg font-semibold text-foreground",children:(e.trades/t).toFixed(2)})]})]})]}),fW=({address:e})=>{const{analysis:t,isLoading:n,fetchData:r}=uW(e),{currentProfile:o}=hr(),i=(o==null?void 0:o.color)||"#3B82F6",a=P.useCallback(()=>{r()},[r]),s=[{key:"m1",label:"1 Minute",data:t.m1},{key:"m15",label:"15 Minutes",data:t.m15},{key:"m30",label:"30 Minutes",data:t.m30},{key:"h1",label:"1 Hour",data:t.h1},{key:"h4",label:"4 Hours",data:t.h4},{key:"h24",label:"24 Hours",data:t.h24}];return x.jsxs(Ie.div,{className:"bg-white/80 dark:bg-card/80 backdrop-blur-xl rounded-xl border border-border p-6",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:[x.jsxs("div",{className:"flex items-center justify-between mb-6",children:[x.jsx("h3",{className:"text-xl font-semibold text-foreground",children:"Market Analysis"}),x.jsx(Ie.button,{onClick:a,className:"p-2 rounded-lg hover:bg-background transition-colors",style:{color:i},title:"Refresh data",whileTap:{scale:.95},whileHover:{scale:1.05},children:x.jsx(Ie.svg,{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",animate:{rotate:n?360:0},transition:{duration:1,repeat:n?1/0:0,ease:"linear"},children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),x.jsx(Id,{mode:"wait",children:n?x.jsx(Ie.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"h-[140px] flex items-center justify-center",children:x.jsx("div",{className:"animate-pulse",style:{color:i},children:"Loading timeframe analysis..."})},"loading"):x.jsx(Ie.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(({key:u,label:l,data:c},d)=>x.jsxs(Ie.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:d*.1},className:"bg-background rounded-lg border border-border p-4",children:[x.jsx("h4",{className:"text-lg font-medium text-foreground mb-4",children:l}),x.jsxs("div",{className:"space-y-4",children:[x.jsx(lW,{data:c}),x.jsx(dW,{data:c,minutes:parseInt(u.replace(/[mh]/,""))}),x.jsx(cW,{signals:c.signals})]})]},u))},"content")})]})},hW=e=>{switch(e){case"1m":return"1 minute";case"15m":return"15 minutes";case"30m":return"30 minutes";case"1h":return"1 hour";case"4h":return"4 hours";case"24h":return"24 hours";default:return e}},pW=({sentiments:e})=>x.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:Object.entries(e).map(([t,n],r)=>{const o=P0(n.emotion);return x.jsxs(Ie.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:r*.1},className:"bg-background/50 backdrop-blur-xl rounded-lg p-4 border border-border",style:{borderColor:`${o}40`},children:[x.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[x.jsx(L_,{emotion:n.emotion,className:"w-6 h-6",color:o}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("span",{className:"text-sm font-medium text-foreground",children:hW(t)}),x.jsx("span",{className:"text-sm capitalize",style:{color:o},children:n.emotion})]})]}),x.jsxs("div",{className:"text-sm text-muted-foreground",children:["Confidence: ",Math.round(n.confidence*100),"%"]})]},t)})});function mW(e){const t={bullish:[],bearish:[],neutral:[]};e.rsi>70?t.bearish.push("RSI indicates overbought conditions at "+e.rsi.toFixed(2)):e.rsi<30?t.bullish.push("RSI indicates oversold conditions at "+e.rsi.toFixed(2)):t.neutral.push("RSI in neutral territory at "+e.rsi.toFixed(2)),e.macd.histogram>0&&e.macd.histogram>e.macd.signal?t.bullish.push("MACD histogram showing increasing bullish momentum"):e.macd.histogram<0&&e.macd.histogram<e.macd.signal&&t.bearish.push("MACD histogram showing increasing bearish momentum");const n=e.bollingerBands.middle;return n>e.bollingerBands.upper?t.bearish.push("Price trading above upper Bollinger Band - potential reversal"):n<e.bollingerBands.lower&&t.bullish.push("Price trading below lower Bollinger Band - potential bounce"),t}function vW(e){const t={bullish:[],bearish:[],neutral:[]},n=e.volume24h/e.marketCap;return n>.3?t.bullish.push(`High trading volume at ${(n*100).toFixed(6)}% of market cap`):n<.05&&t.bearish.push(`Low trading volume at ${(n*100).toFixed(6)}% of market cap`),e.volume24h<e.marketCap*.01&&t.bearish.push("Declining volume"),t}function gW(e){const t={bullish:[],bearish:[],neutral:[]};return e.priceChange24h>20?t.bullish.push(`Strong upward momentum with ${e.priceChange24h.toFixed(1)}% gain`):e.priceChange24h>5?t.bullish.push(`Positive price action with ${e.priceChange24h.toFixed(1)}% gain`):e.priceChange24h<-20?t.bearish.push(`Sharp decline with ${Math.abs(e.priceChange24h).toFixed(1)}% loss`):e.priceChange24h<-5?t.bearish.push(`Negative price action with ${Math.abs(e.priceChange24h).toFixed(1)}% loss`):t.neutral.push(`Stable price action with ${e.priceChange24h.toFixed(1)}% change`),e.volatility>.2?t.bearish.push(`High volatility at ${(e.volatility*100).toFixed(1)}%`):e.volatility<.05&&t.neutral.push(`Low volatility at ${(e.volatility*100).toFixed(1)}%`),t}function yW(e){const t={bullish:[],bearish:[],neutral:[]};return e.holders>1e4?t.bullish.push(`Strong community with ${e.holders.toLocaleString()} holders`):e.holders>5e3?t.bullish.push(`Growing community with ${e.holders.toLocaleString()} holders`):e.holders>1e3?t.neutral.push(`Developing community with ${e.holders.toLocaleString()} holders`):e.holders>0&&t.bearish.push(`Early stage with ${e.holders.toLocaleString()} holders`),t}function xW(e,t){const n={bullish:[],bearish:[],neutral:[]},r=1e6;e.marketCap>r*100?n.bullish.push(`Strong market presence with ${Ab(e.marketCap)} market cap`):e.marketCap<r&&n.bearish.push(`Early stage project with ${Ab(e.marketCap)} market cap`);const{bollingerBands:o}=t,i=(e.price-o.lower)/(o.upper-o.lower);i>.8?n.bearish.push("Price near strong resistance level"):i<.2&&n.bullish.push("Price near strong support level");const a=e.liquidity/e.volume24h;return a>2?n.bullish.push(`Deep liquidity with ${a.toFixed(6)}x daily volume`):a<.5&&n.bearish.push(`Shallow liquidity with only ${a.toFixed(6)}x daily volume`),n}function Ab(e){return e>=1e9?`$${(e/1e9).toFixed(2)}B`:e>=1e6?`$${(e/1e6).toFixed(2)}M`:`$${(e/1e3).toFixed(2)}K`}function bW(e,t){const n={bullish:[],bearish:[],neutral:[]},r=e.volume24h/(e.marketCap*.1);r>3?n.bullish.push(`Surging volume at ${r.toFixed(6)}x normal levels`):r<.3&&n.bearish.push(`Declining volume at ${r.toFixed(6)}x normal levels`);const{macd:o}=t,i=Math.abs(o.histogram/o.signal);o.histogram>0&&i>1.5?n.bullish.push(`Strong bullish momentum with ${i.toFixed(6)}x MACD strength`):o.histogram<0&&i>1.5&&n.bearish.push(`Strong bearish momentum with ${i.toFixed(6)}x MACD strength`);const a=Math.abs(e.priceChange24h)/e.volatility;return a>2&&e.priceChange24h>0?n.bullish.push(`Strong uptrend with ${a.toFixed(6)}x volatility gain`):a>2&&e.priceChange24h<0&&n.bearish.push(`Strong downtrend with ${a.toFixed(6)}x volatility loss`),n}function wW(e){const t=mW(e.technicalIndicators),n=vW(e),r=gW(e),o=yW(e),i=xW(e,e.technicalIndicators),a=bW(e,e.technicalIndicators),s={bullish:[...t.bullish,...n.bullish,...r.bullish,...o.bullish,...i.bullish,...a.bullish],bearish:[...t.bearish,...n.bearish,...r.bearish,...o.bearish,...i.bearish,...a.bearish],neutral:[...t.neutral,...n.neutral,...r.neutral,...o.neutral,...i.neutral,...a.neutral]},u=s.bullish.length*20,l=s.bearish.length*20,c=s.bullish.length+s.bearish.length+s.neutral.length,d=Math.min(100,Math.max(0,(u-l)/c+50));let f,h;d>=80?(f="happy",h=.9):d>=65?(f="surprised",h=.8):d>=45?(f="neutral",h=.7):d>=35?(f="sad",h=.8):d>=25?(f="fearful",h=.85):d>=15?(f="angry",h=.9):(f="disgusted",h=.95);const p=`Market sentiment is ${f} with a ${d.toFixed(1)}% bullish bias. 
    Found ${s.bullish.length} bullish, ${s.bearish.length} bearish, and 
    ${s.neutral.length} neutral signals.`;return{emotion:f,confidence:h,reason:p,signals:s}}const qh={rsi:{"1m":.2,"15m":.25,"30m":.3,"1h":.35,"4h":.4,"24h":.45},macd:{"1m":.3,"15m":.35,"30m":.4,"1h":.45,"4h":.5,"24h":.55},bollinger:{"1m":.5,"15m":.4,"30m":.3,"1h":.2,"4h":.1,"24h":0}};function CW(e){const t=["1m","15m","30m","1h","4h","24h"],n={};return t.forEach(r=>{const o=SW(e,r);n[r]=o}),n}function SW(e,t){const n=EW(e,t),{emotion:r,confidence:o}=kW(n);return{emotion:r,confidence:o,timeframe:t}}function EW(e,t){let n=0,r=0;const o=qh.rsi[t],i=e.technicalIndicators.rsi>70?.2:e.technicalIndicators.rsi<30?.8:.5;n+=i*o,r+=o;const a=qh.macd[t],s=e.technicalIndicators.macd.histogram>0?.8:e.technicalIndicators.macd.histogram<0?.2:.5;n+=s*a,r+=a;const u=qh.bollinger[t],l=e.price,c=l>e.technicalIndicators.bollingerBands.upper?.2:l<e.technicalIndicators.bollingerBands.lower?.8:.5;return n+=c*u,r+=u,n/r}function kW(e){return e>=.8?{emotion:"happy",confidence:.9}:e>=.6?{emotion:"surprised",confidence:.8}:e>=.4?{emotion:"neutral",confidence:.7}:e>=.3?{emotion:"sad",confidence:.8}:e>=.2?{emotion:"fearful",confidence:.85}:{emotion:"disgusted",confidence:.9}}const _W=({data:e,address:t})=>{const n=wW(e),r=CW(e);return x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{className:"bg-white/80 dark:bg-card/80 backdrop-blur-xl rounded-xl border border-border p-6",children:[x.jsx("h3",{className:"text-xl font-semibold text-foreground mb-4",children:"Timeframe Analysis"}),x.jsx(pW,{sentiments:r})]}),x.jsx(sW,{sentiment:e.sentiment,analysis:n}),x.jsx(fW,{address:t}),x.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[x.jsx(iW,{indicators:e.technicalIndicators}),x.jsx(aW,{metrics:e})]})]})};function RW(e){const t=[];let n=0;const r=TW(e);n+=r.score,t.push(...r.insights);const o=AW(e);n+=o.score,t.push(...o.insights);const i=IW(e);n+=i.score,t.push(...i.insights);const a=NW(e);return n+=a.score,t.push(...a.insights),{score:n/4,insights:t}}function TW(e){const t=[];let n=0;return e.marketCap/e.volume24h>10&&(n+=25,t.push("Healthy market cap to volume ratio indicates stability")),e.marketCap>1e8&&(n+=25,t.push("Large market cap suggests established project")),{score:n,insights:t}}function AW(e){const t=[];let n=0;return e.liquidity/e.marketCap>.1&&(n+=25,t.push("Strong liquidity ratio indicates healthy trading environment")),e.liquidity>1e6&&(n+=25,t.push("High liquidity reduces potential for price manipulation")),{score:n,insights:t}}function IW(e){const t=[];let n=0;return e.holders>1e4&&(n+=25,t.push("Large holder base indicates wide distribution")),e.marketCap/e.holders<e.marketCap*.01&&(n+=25,t.push("Well-distributed token ownership reduces whale impact")),{score:n,insights:t}}function NW(e){const t=[];let n=0;return e.volatility<.1&&(n+=25,t.push("Low volatility indicates price stability")),Math.abs(e.priceChange24h)<10&&(n+=25,t.push("Moderate price movement suggests market maturity")),{score:n,insights:t}}function PW(e,t=14){if(e.length<t+1)return 50;let n=0,r=0;for(let s=1;s<=t;s++){const u=e[s]-e[s-1];u>=0?n+=u:r-=u}const o=n/t,i=r/t;return 100-100/(1+o/i)}function DW(e){const t=Xh(e,12),n=Xh(e,26),r=t-n,o=Xh([r],9);return{value:r,signal:o,histogram:r-o}}function Xh(e,t){const n=2/(t+1);let r=e[0];for(let o=1;o<e.length;o++)r=(e[o]-r)*n+r;return r}function MW(e,t=20){const n=e.slice(-t).reduce((o,i)=>o+i)/t,r=Math.sqrt(e.slice(-t).reduce((o,i)=>o+Math.pow(i-n,2),0)/t);return{upper:n+r*2,middle:n,lower:n-r*2}}const Yh=Array.from({length:30},()=>100+Math.random()*20-10);function FW(e){const[t,n]=P.useState(null),[r,o]=P.useState(!1),[i,a]=P.useState(null);return P.useEffect(()=>{if(!e)return;async function s(){var u,l,c,d;o(!0),a(null);try{const f=await fetch(`https://api.dexscreener.com/latest/dex/tokens/${e}`);if(!f.ok)throw new Error("Failed to fetch token data");const h=await f.json();if(!h.pairs||h.pairs.length===0)throw new Error("No data found for this token");const p=h.pairs[0],m={rsi:PW(Yh),macd:DW(Yh),bollingerBands:MW(Yh),ema:{short:0,medium:0,long:0}};let g=0;if(p.holders){const C=p.holders.replace(/[^0-9.]/g,"");g=parseInt(C,10)}const v={price:Number(p.priceUsd)||0,marketCap:Number(p.fdv)||0,volume24h:Number((u=p.volume)==null?void 0:u.h24)||0,priceChange24h:Number((l=p.priceChange)==null?void 0:l.h24)||0,holders:g,liquidity:Number((c=p.liquidity)==null?void 0:c.usd)||0,volatility:Math.abs(((d=p.priceChange)==null?void 0:d.h24)||0)/100},{score:y}=RW(v),b=m.rsi/100*100,w={overall:Math.round((y+b)/2),technical:Math.round(b),fundamental:Math.round(y)};n({name:p.baseToken.name,symbol:p.baseToken.symbol,website:p.baseToken.website,twitter:p.baseToken.twitter,telegram:p.baseToken.telegram,...v,technicalIndicators:m,sentiment:w})}catch(f){a(f instanceof Error?f.message:"Failed to fetch token data")}finally{o(!1)}}s()},[e]),{tokenData:t,isLoading:r,error:i}}const OW=()=>{const[e,t]=P.useState(""),{tokenData:n,isLoading:r,error:o}=FW(e),{currentProfile:i}=hr(),a=(i==null?void 0:i.color)||"#3B82F6";return x.jsx("div",{className:"max-w-6xl mx-auto",children:x.jsxs("div",{className:"glass-panel p-6 space-y-6",children:[x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Token Sentiment Analysis"}),x.jsx("div",{className:"px-4 py-1.5 rounded-full",style:{backgroundColor:`${a}20`,borderColor:`${a}30`,borderWidth:"1px",color:a},children:x.jsx("span",{className:"text-sm",children:"Solana Tokens Only"})})]}),x.jsx(eW,{onSearch:t}),o&&x.jsx(Ie.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"p-4 bg-red-500/10 border border-red-500/20 rounded-lg text-red-500",children:o}),r&&x.jsx("div",{className:"animate-pulse",style:{color:a},children:"Loading token data..."}),n&&e&&x.jsxs(Ie.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[x.jsxs("div",{className:"bg-white/80 dark:bg-card/80 backdrop-blur-xl rounded-xl border border-border p-6",children:[x.jsx(nW,{data:n,profileColor:a}),x.jsx(oW,{data:n,address:e})]}),x.jsx(_W,{data:n,address:e})]})]})})};function BW(e){return new Promise((t,n)=>{const r=new FileReader;r.onload=o=>{var i;(i=o.target)!=null&&i.result?t(o.target.result):n(new Error("Failed to read image file"))},r.onerror=()=>n(new Error("File reading failed")),r.readAsDataURL(e)})}function LW(e){return{handleFileChange:P.useCallback(async n=>{var o;const r=(o=n.target.files)==null?void 0:o[0];if(r)try{const i=await BW(r);e(i)}catch(i){console.error("Failed to read image file:",i)}n.target.value=""},[e])}}const jW=({onImageSelect:e})=>{const t=P.useRef(null),{handleFileChange:n}=LW(e),{currentProfile:r}=hr(),o=(r==null?void 0:r.color)||"#3B82F6";return x.jsxs("div",{children:[x.jsx("input",{type:"file",ref:t,onChange:n,accept:"image/*",className:"hidden"}),x.jsxs("button",{onClick:()=>{var i;return(i=t.current)==null?void 0:i.click()},style:{backgroundColor:o},className:`px-6 py-3 text-white rounded-lg hover:opacity-90 
          transition-colors flex items-center gap-2 font-medium`,children:[x.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Upload Chart"]})]})};function zW(e,t,n){const r=e.getContext("2d");r&&(r.drawImage(t,0,0,e.width,e.height),n.forEach(o=>{const i=e.height-o.price*e.height/100;r.beginPath(),r.moveTo(0,i),r.lineTo(e.width,i),r.strokeStyle=o.type==="support"?"#10B981":"#EF4444",r.lineWidth=2,r.setLineDash([5,5]),r.stroke(),r.font="14px sans-serif",r.fillStyle=o.type==="support"?"#10B981":"#EF4444";const a=o.type.toUpperCase(),s=10;o.type==="support"?(r.textAlign="left",r.fillText(a,s,i-5)):(r.textAlign="right",r.fillText(a,e.width-s,i-5))}))}const VW=({image:e,levels:t,isAnalyzing:n})=>{const r=P.useRef(null),o=P.useRef(null);return P.useEffect(()=>{if(r.current&&o.current&&e&&t.length>0){const i=new Image;i.src=e,i.onload=()=>{const a=i.width/i.height,s=o.current.offsetWidth,u=Math.min(s,i.width),l=u/a,c=r.current;c.width=u,c.height=l,zW(c,i,t)}}},[e,t]),x.jsxs("div",{ref:o,className:"relative flex justify-center items-center bg-black/20 rounded-lg p-4",children:[x.jsx("canvas",{ref:r,className:"w-full rounded-lg border border-white/10"}),n&&x.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 backdrop-blur-sm rounded-lg",children:x.jsx("div",{className:"text-primary animate-pulse",children:"Analyzing chart..."})})]})},$W=({levels:e,scenario:t})=>{const n={bullish:`Price likely to break above ${e.filter(r=>r.type==="resistance").length} resistance levels`,bearish:`Price likely to break below ${e.filter(r=>r.type==="support").length} support levels`,neutral:"Price likely to stay within the range"}[t];return x.jsxs("div",{className:"bg-white/5 rounded-lg p-4",children:[x.jsxs("h3",{className:`text-lg font-semibold mb-2 ${t==="bullish"?"text-green-400":t==="bearish"?"text-red-400":"text-blue-400"}`,children:[t.charAt(0).toUpperCase()+t.slice(1)," Scenario"]}),x.jsx("p",{className:"text-gray-400",children:n})]})},WW=({thresholds:e,onChange:t})=>x.jsxs("div",{className:"space-y-4",children:[x.jsx("h4",{className:"text-lg font-semibold text-foreground",children:"Color Detection"}),x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{children:[x.jsxs("label",{className:"flex items-center justify-between text-sm mb-2",children:[x.jsx("span",{className:"text-red-500 font-medium",children:"Red Channel"}),x.jsx("span",{className:"text-muted-foreground font-mono",children:e.red})]}),x.jsxs("div",{className:"relative",children:[x.jsx("div",{className:"absolute top-1/2 left-0 h-2 bg-red-500/20 rounded-lg -translate-y-1/2",style:{width:`${e.red/200*100}%`}}),x.jsx("input",{type:"range",min:"50",max:"200",value:e.red,onChange:n=>t({...e,red:Number(n.target.value)}),className:`relative w-full h-2 bg-background border border-border rounded-lg appearance-none cursor-pointer
                [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4
                [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-red-500
                [&::-webkit-slider-thumb]:border-2 [&::-webkit-slider-thumb]:border-background
                [&::-webkit-slider-thumb]:shadow-[0_0_10px_rgba(239,68,68,0.3)]
                [&::-moz-range-thumb]:appearance-none [&::-moz-range-thumb]:w-4 [&::-moz-range-thumb]:h-4
                [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-red-500
                [&::-moz-range-thumb]:border-2 [&::-moz-range-thumb]:border-background
                [&::-moz-range-thumb]:shadow-[0_0_10px_rgba(239,68,68,0.3)]`})]})]}),x.jsxs("div",{children:[x.jsxs("label",{className:"flex items-center justify-between text-sm mb-2",children:[x.jsx("span",{className:"text-green-500 font-medium",children:"Green Channel"}),x.jsx("span",{className:"text-muted-foreground font-mono",children:e.green})]}),x.jsxs("div",{className:"relative",children:[x.jsx("div",{className:"absolute top-1/2 left-0 h-2 bg-green-500/20 rounded-lg -translate-y-1/2",style:{width:`${e.green/200*100}%`}}),x.jsx("input",{type:"range",min:"50",max:"200",value:e.green,onChange:n=>t({...e,green:Number(n.target.value)}),className:`relative w-full h-2 bg-background border border-border rounded-lg appearance-none cursor-pointer
                [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4
                [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-green-500
                [&::-webkit-slider-thumb]:border-2 [&::-webkit-slider-thumb]:border-background
                [&::-webkit-slider-thumb]:shadow-[0_0_10px_rgba(34,197,94,0.3)]
                [&::-moz-range-thumb]:appearance-none [&::-moz-range-thumb]:w-4 [&::-moz-range-thumb]:h-4
                [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-green-500
                [&::-moz-range-thumb]:border-2 [&::-moz-range-thumb]:border-background
                [&::-moz-range-thumb]:shadow-[0_0_10px_rgba(34,197,94,0.3)]`})]})]})]})]}),UW=({scenario:e,onScenarioChange:t})=>x.jsx("div",{className:"flex flex-col gap-2",children:[{id:"bullish",color:"green"},{id:"bearish",color:"red"},{id:"neutral",color:"blue"}].map(({id:n,color:r})=>x.jsx("button",{onClick:()=>t(n),className:`
            w-full px-4 py-3 rounded-lg text-sm font-medium transition-colors
            ${e===n?`bg-${r}-500 text-white`:"bg-white/5 text-gray-400 hover:bg-white/10"}
          `,children:n.charAt(0).toUpperCase()+n.slice(1)},n))});function HW(e,t,n){const r=e[t],o=e[t+1],i=e[t+2],a=(r+o+i)/3;return{red:GW(r,o,i,a,n.red)?1:0,green:KW(r,o,i,a,n.green)?1:0}}function GW(e,t,n,r,o){const i=e/(t+n+1);return r<100&&i>1.3||r>=100&&e>o&&t<o-15&&n<o-15}function KW(e,t,n,r,o){const i=t/(e+n+1);return r<100&&i>1.3||r>=100&&t>o&&e<o-15&&n<o-15}function qW(e,t,n){const r=[],o=Math.floor(e*.02);for(let i=0;i<t;i++){let a=0,s=0;for(let u=0;u<e;u++){const l=n[i][u];a+=l.red,s+=l.green}(a>o||s>o)&&r.push({price:XW(i,t),red:a,green:s})}return r}function XW(e,t){return Math.round((t-e)*100/t)}const Qh={baseMultiplier:.02,supportSensitivity:.7,resistanceSensitivity:.8};function YW(e){const t=e*Qh.baseMultiplier;return{support:t*Qh.supportSensitivity,resistance:t*Qh.resistanceSensitivity}}const QW=2.5;function JW(e){const t=[];e.sort((n,r)=>n.price-r.price);for(const n of e){const r=t.find(o=>Math.abs(o.price-n.price)<QW&&o.type===n.type);r?(r.strength=Math.max(r.strength,n.strength),r.price=(r.price+n.price)/2):t.push({...n})}return t}const jm={SUPPORT_SENSITIVITY_MULTIPLIER:1.3,MIN_TOUCHES:2,CLUSTER_SIZE:5,THRESHOLD_MULTIPLIER:.02,SUPPORT_SENSITIVITY:.7,RESISTANCE_SENSITIVITY:.8};function ZW(e,t,n=jm.CLUSTER_SIZE){const r=new Map;return e.forEach(o=>{const i=Math.round(o/n)*n,a=r.get(i)||{count:0,touches:0};a.count++,!r.has(i-1)&&!r.has(i+1)&&a.touches++,r.set(i,a)}),Array.from(r.entries()).map(([o,i])=>({price:o/t*100,density:i.count,touches:i.touches})).filter(o=>o.touches>=jm.MIN_TOUCHES)}function eU(e,t){const n=[];for(let r=0;r<t;r++){let o=!1,i=0;for(let a=0;a<e[r].length;a++)e[r][a].green>0&&i++,(e[r][a].red>0||e[r][a].green>0)&&(o=!0);o&&i>0&&n.push(r)}return n}function tU(e,t,n,r){const o=[],i=YW(t);e.forEach(u=>{u.red>i.resistance&&o.push({type:"resistance",price:u.price,strength:u.red/(t*n)})});const a=eU(r,n);return ZW(a,n).forEach(u=>{o.push({type:"support",price:u.price,strength:u.density*u.touches*jm.SUPPORT_SENSITIVITY_MULTIPLIER/(t*n)})}),JW(o)}async function nU(e,t){const n=new Image;return n.src=e,new Promise(r=>{n.onload=()=>{const o=document.createElement("canvas"),i=o.getContext("2d");if(!i)return r([]);o.width=n.width,o.height=n.height,i.drawImage(n,0,0);const a=i.getImageData(0,0,o.width,o.height),{width:s,height:u,data:l}=a,c=Array(u).fill(0).map(()=>Array(s).fill(0).map(()=>({red:0,green:0})));for(let h=0;h<u;h++)for(let p=0;p<s;p++){const m=(h*s+p)*4;c[h][p]=HW(l,m,t)}const d=qW(s,u,c),f=tU(d,s,u,c);r(f)}})}function rU(){const[e,t]=P.useState([]),[n,r]=P.useState(!1),o=P.useCallback(()=>{t([]),r(!1)},[]),i=P.useCallback(async(a,s)=>{r(!0);try{const u=await nU(a,s);t(u)}catch(u){console.error("Chart analysis failed:",u)}finally{r(!1)}},[]);return{levels:e,isAnalyzing:n,analyze:i,reset:o}}function oU(e,t){const n=e.filter(o=>o.type==="support"),r=e.filter(o=>o.type==="resistance");switch(t){case"bullish":return[...n.slice(0,1),...r.filter(o=>{var i;return o.price>((i=n[0])==null?void 0:i.price)||0})];case"bearish":return[...r.slice(0,1),...n.filter(o=>{var i;return o.price<((i=r[0])==null?void 0:i.price)||1/0})];case"neutral":return[...n.slice(0,2),...r.slice(0,2)];default:return e}}const iU=()=>{const[e,t]=P.useState(null),[n,r]=P.useState("neutral"),[o,i]=P.useState({red:110,green:95}),{levels:a,isAnalyzing:s,analyze:u,reset:l}=rU(),c=oU(a,n),d=h=>{i(h),e&&u(e,h)},f=async h=>{l(),t(null),r("neutral"),await new Promise(p=>setTimeout(p,50)),t(h),u(h,o)};return x.jsx("div",{className:"max-w-7xl mx-auto",children:x.jsxs("div",{className:"glass-panel p-6",children:[x.jsxs("div",{className:"flex items-center justify-between mb-8",children:[x.jsxs("div",{children:[x.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2",children:"Chart Analysis"}),x.jsx("p",{className:"text-muted-foreground",children:"Upload a chart to detect support and resistance levels"})]}),x.jsx(jW,{onImageSelect:f})]}),e?x.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[x.jsx("div",{className:"lg:col-span-1 space-y-8",children:x.jsxs("div",{className:"bg-card rounded-lg border border-border p-6",children:[x.jsx("h3",{className:"text-lg font-semibold text-foreground mb-6",children:"Analysis Settings"}),x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{children:[x.jsx("h4",{className:"text-base font-medium text-foreground mb-3",children:"Scenario"}),x.jsx(UW,{scenario:n,onScenarioChange:r})]}),x.jsx(WW,{thresholds:o,onChange:d})]})]})}),x.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[x.jsx(VW,{image:e,levels:c,isAnalyzing:s},e),x.jsx($W,{levels:c,scenario:n})]})]}):x.jsx("div",{className:"flex items-center justify-center h-[400px] bg-card rounded-lg border-2 border-dashed border-border",children:x.jsxs("div",{className:"text-center",children:[x.jsx("p",{className:"text-xl text-muted-foreground mb-4",children:"No chart uploaded"}),x.jsx("p",{className:"text-sm text-muted-foreground",children:"Upload a chart to begin analysis"})]})})]})})},aU=({tabs:e,activeTab:t,onTabChange:n})=>{const{currentProfile:r}=hr(),{isDark:o}=gS(),i=(r==null?void 0:r.color)||"#3B82F6";return x.jsx("div",{className:"fixed bottom-6 left-1/2 -translate-x-1/2 z-50",children:x.jsx("div",{className:"bg-card border border-border rounded-2xl p-2 shadow-lg",children:x.jsx("div",{className:"flex gap-2",children:e.map((a,s)=>x.jsxs(Hn.Fragment,{children:[s>0&&x.jsx("div",{className:"w-px h-8 my-auto bg-border"}),x.jsxs("button",{onClick:()=>n(a.id),className:"relative group",children:[t===a.id&&x.jsx(Ie.div,{layoutId:"activeTab",className:"absolute inset-0 rounded-xl",style:{backgroundColor:`${i}20`,border:`1px solid ${i}30`},transition:{type:"spring",bounce:.2,duration:.6}}),x.jsxs("div",{className:`
                  relative z-10 px-4 py-2 rounded-xl flex items-center gap-2
                  transition-colors duration-200
                  ${t===a.id?"text-primary":"text-muted-foreground hover:text-foreground"}
                `,style:t===a.id?{color:i}:void 0,children:[typeof a.icon=="string"?x.jsx("span",{className:"text-lg",children:a.icon}):x.jsx(a.icon,{className:"w-5 h-5"}),x.jsx("span",{className:"text-sm font-medium whitespace-nowrap",children:a.label})]})]})]},a.id))})})})},sU=({className:e="w-5 h-5"})=>x.jsx("svg",{className:e,viewBox:"0 0 24 24",fill:"currentColor",children:x.jsx("path",{d:"M12 2L2 9.5V22h20V9.5L12 2zm7 18H5V10.8l7-5.8 7 5.8V20z"})}),j_=({className:e="w-5 h-5"})=>x.jsx("svg",{className:e,viewBox:"0 0 24 24",fill:"currentColor",children:x.jsx("path",{d:"M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"})}),z_=({className:e="w-5 h-5"})=>x.jsx("svg",{className:e,viewBox:"0 0 24 24",fill:"currentColor",children:x.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),V_=({className:e="w-5 h-5"})=>x.jsx("svg",{className:e,viewBox:"0 0 24 24",fill:"currentColor",children:x.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 14H6v-2h6v2zm4-4H6v-2h10v2zm0-4H6V7h10v2z"})}),$_=({className:e="w-5 h-5"})=>x.jsx("svg",{className:e,viewBox:"0 0 24 24",fill:"currentColor",children:x.jsx("path",{d:"M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zm4 18H6V4h7v5h5v11z"})}),uU=({className:e="w-5 h-5"})=>x.jsx("svg",{className:e,viewBox:"0 0 24 24",fill:"currentColor",children:x.jsx("path",{d:"M9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4zm2 2H5V5h14v14zm0-16H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"})}),lU=({className:e="w-5 h-5"})=>x.jsx("svg",{className:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),Ib=[{id:"landing",label:"Overview",icon:sU},{id:"live",label:"Live Analysis",icon:j_},{id:"upload",label:"Upload",icon:z_},{id:"monitor",label:"Token Sentiment Analysis",icon:V_},{id:"chart",label:"Chart Analysis",icon:lU},{id:"docs",label:"Docs",icon:$_}],cU=()=>{const{setActiveTab:e}=rg();return x.jsx("section",{className:"min-h-[80vh] flex flex-col items-center justify-center text-center px-4 py-16",children:x.jsxs(Ie.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"max-w-6xl mx-auto",children:[x.jsxs("div",{className:"flex items-center justify-center gap-8 mb-12",children:[x.jsxs("div",{className:"text-left",children:[x.jsx("h1",{className:"text-6xl font-bold font-display mb-2",children:x.jsx("span",{className:"bg-gradient-to-r from-blue-500 to-purple-500 bg-clip-text text-transparent",children:"PELIOS"})}),x.jsx("p",{className:"text-muted-foreground",children:"Powered by $PELIOS"})]}),x.jsx("div",{className:"h-16 w-px bg-gradient-to-b from-transparent via-border to-transparent"}),x.jsxs("div",{className:"text-left",children:[x.jsx("h2",{className:"text-4xl font-bold font-display mb-2",children:x.jsx("span",{className:"bg-gradient-to-r from-blue-500 to-purple-500 bg-clip-text text-transparent",children:"AI-Powered Analysis"})}),x.jsx("p",{className:"text-muted-foreground",children:"Advanced emotion detection & market sentiment"})]})]}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-12",children:[x.jsxs(Ie.div,{whileHover:{scale:1.02},className:"group relative bg-card border border-border rounded-2xl p-8 cursor-pointer",onClick:()=>e("live"),children:[x.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/10 to-purple-500/10 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),x.jsxs("div",{className:"relative",children:[x.jsx("h3",{className:"text-2xl font-bold mb-4 bg-gradient-to-r from-blue-400 to-blue-500 bg-clip-text text-transparent",children:"Live Analysis"}),x.jsx("p",{className:"text-muted-foreground mb-6",children:"Real-time emotion detection through your webcam with advanced AI technology."}),x.jsxs("div",{className:"flex items-center text-blue-400 font-medium",children:["Try Now",x.jsx("svg",{className:"w-5 h-5 ml-2 group-hover:translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]}),x.jsxs(Ie.div,{whileHover:{scale:1.02},className:"group relative bg-card border border-border rounded-2xl p-8 cursor-pointer",onClick:()=>e("monitor"),children:[x.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-500/10 to-pink-500/10 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),x.jsxs("div",{className:"relative",children:[x.jsx("h3",{className:"text-2xl font-bold mb-4 bg-gradient-to-r from-purple-400 to-pink-500 bg-clip-text text-transparent",children:"Token Analysis"}),x.jsx("p",{className:"text-muted-foreground mb-6",children:"Advanced market sentiment analysis using AI to detect trading signals."}),x.jsxs("div",{className:"flex items-center text-purple-400 font-medium",children:["Analyze Now",x.jsx("svg",{className:"w-5 h-5 ml-2 group-hover:translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})]}),x.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[{title:"Image Upload",description:"Upload and analyze emotions in photos",icon:"",tab:"upload"},{title:"Chart Analysis",description:"Detect support and resistance levels",icon:"",tab:"chart"},{title:"Documentation",description:"Learn about our AI algorithms",icon:"",tab:"docs"}].map(t=>x.jsxs(Ie.div,{whileHover:{scale:1.02},className:"group relative bg-card border border-border rounded-xl p-6 cursor-pointer",onClick:()=>e(t.tab),children:[x.jsx("div",{className:"text-2xl mb-3",children:t.icon}),x.jsx("h3",{className:"text-lg font-semibold mb-2",children:t.title}),x.jsx("p",{className:"text-muted-foreground text-sm",children:t.description})]},t.title))})]})})},dU=[{title:"Real-time Analysis",description:"Experience instant emotion detection through your webcam with advanced AI technology.",icon:j_,color:"#3B82F6"},{title:"Image Upload",description:"Upload and analyze emotions in photos with our powerful image processing capabilities.",icon:z_,color:"#10B981"},{title:"Token Sentiment",description:"Advanced market sentiment analysis using AI to detect bullish and bearish signals.",icon:V_,color:"#8B5CF6"},{title:"Chart Analysis",description:"Detect support and resistance levels with our intelligent chart pattern recognition.",icon:uU,color:"#EC4899"},{title:"Documentation",description:"Access detailed documentation about our emotion recognition algorithms and implementation.",icon:$_,color:"#F59E0B"}],fU=()=>x.jsx("section",{className:"py-32",children:x.jsx("div",{className:"max-w-6xl mx-auto",children:x.jsx("div",{className:"space-y-24",children:dU.map((e,t)=>x.jsxs("div",{className:`flex items-center gap-12 ${t%2===0?"flex-row":"flex-row-reverse"}`,children:[x.jsxs("div",{className:"flex-1",children:[x.jsx("h3",{className:"text-3xl font-bold mb-4",style:{color:e.color},children:e.title}),x.jsx("p",{className:"text-muted-foreground leading-relaxed",children:e.description})]}),x.jsx("div",{className:"flex-1 p-8 rounded-2xl",style:{backgroundColor:`${e.color}10`},children:x.jsx("div",{className:`aspect-video rounded-xl bg-card border border-border 
                  flex items-center justify-center`,children:x.jsx(e.icon,{className:"w-16 h-16 text-muted-foreground"})})})]},t))})})}),hU=[{name:"TensorFlow.js",description:"Real-time emotion detection using deep learning models optimized for browser performance.",icon:""},{name:"Face-API",description:"State-of-the-art facial detection and expression recognition algorithms.",icon:""},{name:"Chart Analysis",description:"Advanced pattern recognition for technical analysis and trading signals.",icon:""}],pU=()=>x.jsx("section",{className:"py-24",children:x.jsxs("div",{className:"max-w-6xl mx-auto px-4",children:[x.jsxs(Ie.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.8},viewport:{once:!0},className:"text-center mb-16",children:[x.jsx("h2",{className:"text-4xl font-bold font-display mb-4",children:"Powered by Advanced AI"}),x.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"Our platform leverages cutting-edge artificial intelligence to deliver accurate and real-time analysis."})]}),x.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:hU.map((e,t)=>x.jsx(Ie.div,{initial:{opacity:0,x:(t-1)*50},whileInView:{opacity:1,x:0},transition:{duration:.8,delay:t*.2},viewport:{once:!0},children:x.jsxs("div",{className:"bg-card/80 border border-border rounded-2xl p-8 h-full flex flex-col items-center text-center",children:[x.jsx("span",{className:"text-4xl mb-4",children:e.icon}),x.jsx("h3",{className:"text-xl font-bold mb-3",children:e.name}),x.jsx("p",{className:"text-muted-foreground text-sm leading-relaxed",children:e.description})]})},e.name))}),x.jsx(Ie.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.8,delay:.3},viewport:{once:!0},className:"mt-16 text-center",children:x.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-card border border-border",children:[x.jsx("span",{className:"w-2 h-2 rounded-full bg-primary animate-pulse"}),x.jsx("span",{className:"text-sm text-muted-foreground",children:"AI Models Running in Real-time"})]})})]})}),W_=()=>x.jsxs("div",{className:"max-w-6xl mx-auto px-4",children:[x.jsx(cU,{}),x.jsx(fU,{}),x.jsx(pU,{})]}),mU=()=>{const[e,t]=P.useState(!1),{activeTab:n,setActiveTab:r,previousTab:o}=rg(),i=d=>Ib.findIndex(f=>f.id===d),a=i(n),s=i(o),u=a>s?1:-1,l={enter:d=>({x:d*30,opacity:0}),center:{x:0,opacity:1},exit:d=>({x:d*-30,opacity:0})},c=()=>x.jsx(Id,{mode:"wait",initial:!1,custom:u,children:x.jsx(Ie.div,{custom:u,variants:l,initial:"enter",animate:"center",exit:"exit",transition:{x:{type:"spring",stiffness:500,damping:25},opacity:{duration:.1}},className:"w-full absolute",children:n==="landing"?x.jsx(W_,{}):n==="live"?x.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[x.jsx("div",{className:"lg:col-span-2",children:x.jsx(P8,{isActive:e,onToggle:()=>t(!e),isProcessing:!1})}),x.jsx("div",{className:"lg:col-span-1",children:x.jsx(M8,{})})]}):n==="upload"?x.jsx(F8,{}):n==="docs"?x.jsx(V8,{}):n==="tickers"?x.jsx(Z8,{}):n==="monitor"?x.jsx(OW,{}):n==="chart"?x.jsx(iU,{}):n==="surprised-chat"?x.jsx(G8,{}):null},n)});return x.jsxs(x.Fragment,{children:[x.jsx("main",{className:"min-h-screen px-4 sm:px-6 lg:px-8 py-8 pb-24",children:x.jsx("div",{className:"max-w-7xl mx-auto relative",style:{minHeight:"calc(100vh - 16rem)"},children:c()})}),x.jsx(aU,{tabs:Ib,activeTab:n,onTabChange:r})]})},vU=({profile:e,size:t="md",onClick:n})=>{const r={sm:"w-12 h-12 text-2xl",md:"w-24 h-24 text-4xl",lg:"w-32 h-32 text-6xl"};return x.jsx("button",{onClick:n,className:`${r[t]} rounded-xl overflow-hidden transition-all duration-200 
        hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary
        bg-gradient-to-br from-white/5 to-white/10 backdrop-blur-xl border border-white/10
        flex items-center justify-center`,style:{backgroundColor:e.color},children:x.jsx("span",{className:"transform hover:scale-110 transition-transform duration-200",children:e.emoji})})},gU=()=>x.jsx("div",{className:"fixed bottom-6 right-6",children:x.jsx("a",{href:"https://x.com",target:"_blank",rel:"noopener noreferrer",className:`w-10 h-10 flex items-center justify-center rounded-full 
          bg-black/30 backdrop-blur-xl border border-white/10 
          hover:bg-black/50 transition-colors`,"aria-label":"X (Twitter)",children:x.jsx("svg",{className:"w-5 h-5 text-white",viewBox:"0 0 24 24",fill:"currentColor",children:x.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})})})}),yU=[{id:"1",name:"Happy",color:"#D97706",emoji:""},{id:"2",name:"Sad",color:"#3B82F6",emoji:""},{id:"3",name:"Angry",color:"#EF4444",emoji:""},{id:"4",name:"Fearful",color:"#8B5CF6",emoji:""},{id:"5",name:"Disgusted",color:"#10B981",emoji:""},{id:"6",name:"Surprised",color:"#EC4899",emoji:""}],xU=()=>{const{setCurrentProfile:e}=hr();return x.jsxs("div",{className:"min-h-screen bg-background flex flex-col items-center justify-center px-4",children:[x.jsx("div",{className:"absolute top-6 right-6",children:x.jsx(yS,{})}),x.jsxs("div",{className:"flex items-center gap-8 mb-12",children:[x.jsx("img",{src:"/pill-icon.png",alt:"Pill Icon",className:"w-16 h-16 object-contain"}),x.jsxs("div",{className:"text-center",children:[x.jsx("h1",{className:"text-6xl font-bold font-display bg-gradient-to-r from-blue-500 to-purple-500 bg-clip-text text-transparent",children:"PELIOS"}),x.jsx("div",{className:"h-px w-full bg-gradient-to-r from-transparent via-border to-transparent my-3"}),x.jsx("p",{className:"text-xl text-muted-foreground font-display",children:"Choose Your Avatar"})]})]}),x.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-8 max-w-3xl",children:yU.map(t=>x.jsxs("div",{className:"flex flex-col items-center gap-4",children:[x.jsx(vU,{profile:t,size:"lg",onClick:()=>e(t)}),x.jsx("span",{className:"text-muted-foreground text-lg",children:t.name})]},t.id))}),x.jsx(gU,{})]})},bU=({children:e})=>x.jsx("div",{className:"min-h-screen bg-background text-foreground",children:x.jsx("div",{className:"relative z-50",children:e})}),wU=D_({palette:{mode:"dark",primary:{main:"#50fa7b"},secondary:{main:"#45E066"}}}),CU=()=>{const{currentProfile:e}=hr();if(!e)return x.jsx(xU,{});if(e.name==="Analyze")return x.jsx(W_,{});const t=x.jsxs(x.Fragment,{children:[x.jsx(HP,{}),x.jsx(mU,{})]});return e.name==="Disgusted"?x.jsx(bU,{children:t}):x.jsx("div",{className:"min-h-screen bg-background text-foreground",children:t})};function SU(){return x.jsx(H$,{theme:wU,children:x.jsx($P,{children:x.jsx(jP,{children:x.jsx(UP,{children:x.jsx(bj,{children:x.jsx(BP,{children:x.jsx(CU,{})})})})})})})}Jh.createRoot(document.getElementById("root")).render(x.jsx(Hn.StrictMode,{children:x.jsx(SU,{})}))});export default EU();
